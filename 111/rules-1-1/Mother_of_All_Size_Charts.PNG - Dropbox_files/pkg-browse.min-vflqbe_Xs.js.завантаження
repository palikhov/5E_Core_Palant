define("modules/clean/react/browse/model_types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FetchFolderSizeState=void 0,(function(e){e.LOADING="LOADING",e.COMPLETE="COMPLETE",e.NO_ACCESS="NO_ACCESS",e.ERROR="ERROR"})(t.FetchFolderSizeState||(t.FetchFolderSizeState={}))})),define("modules/clean/cloud_docs/create_api",["require","exports","tslib","apex-metrics/index","api_v2/user_client","modules/clean/cloud_docs/constants","modules/clean/cloud_docs/create_pointer_modal","modules/clean/cloud_docs/event_logging","modules/clean/cloud_docs/types","modules/clean/filepath/filepath","modules/clean/logging/hive/schemas/web-modal-activity","modules/clean/react/async_file_modal_controller","modules/clean/react/folder_dialog/async","modules/clean/react/components/modal","modules/clean/react/snackbar","modules/clean/react/browse/api","modules/clean/react/browse/action_logger","modules/clean/web_user_action_events","modules/core/browser","modules/core/cookies","modules/core/i18n","spectrum/util/uuid_generator","modules/clean/metrics/index","modules/clean/cloud_docs/constants"],(function(e,t,r,n,o,i,a,s,l,c,d,u,_,p,f,m,g,h,S,E,v,T,w,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCreateActionSource=t.createNewPointer=t.createNewCloudOnlyDoc=t.createPlaceholderTabForNewCloudDoc=t.constructFormForCreateNewMicrosoftFile=t.createNewFile=t.showAsyncFolderDialog=t.logCreateFileSuccessCallback=t.logCreateFileCallback=t.logCreateFileAttempt=t.getDepthFromPath=t.CloudDocSnackbarId=void 0,c=r.__importStar(c),u=r.__importStar(u),_=r.__importStar(_),m=r.__importStar(m),S=r.__importStar(S);var b=v.intl.formatMessage({id:"UpDkTB",defaultMessage:"Create file in..."}),F=v.intl.formatMessage({id:"7E4VWP",defaultMessage:"Create shortcut in..."}),C=v.intl.formatMessage({id:"bhV8Xa",defaultMessage:"Create"}),O=v.intl.formatMessage({id:"GDikFY",defaultMessage:"Choose folder"});t.CloudDocSnackbarId="create-cloud-doc",t.getDepthFromPath=function(e){return(e.replace(/\/$/,"").match(/\//g)||[]).length},t.logCreateFileAttempt=function(e,t){s.logUserAction({actionEvent:l.UserActionEventType.PRE_CREATE,userId:t.userId,actionSource:t.action_source,data:{webOpenId:e}})},t.logCreateFileCallback=function(e){var t=e.ts,o=e.documentType,i=e.selectionMode,a=e.emptyFolder,s=e.error;return r.__awaiter(void 0,void 0,void 0,(function(){var e,l;return r.__generator(this,(function(r){return e=w.getMetricsReporter(),(l={}).document_type=o||"unknown",l.selection_mode=i||"undefined",l.empty_folder=String(a),l.error=s?"true":"false",e.createStats({ns:I.CLOUD_DOCS_AMP_NAMESPACE,name:"web/createFile"},l).recordDuration(Date.now()-t,n.TimeUnit.MILLISECONDS),[2]}))}))},t.logCreateFileSuccessCallback=function(e){var r=e.ts,n=e.openId,o=e.selection_mode,i=e.empty_folder;return function(e){t.logCreateFileCallback({ts:Date.now(),documentType:e.documentType,selectionMode:o,emptyFolder:i}),g.logFileCreateSuccess({uid:e.userId,document_type:e.documentType,time_elapsed:Date.now()-r,open_id:n,selection_mode:o,empty_folder:i}),s.logUserAction({actionEvent:l.UserActionEventType.CREATE,userId:e.userId,docPathOrId:e.fq_path,actionSource:e.action_source,data:{webOpenId:n}})}},t.showAsyncFolderDialog=function(e){var r=e.user,n=e.source,o=e.documentType,a=e.selection_mode,s=e.empty_folder,l=e.handleClickNewFolder,c=e.initialPath,u=i.isPointerFileType(o),p=u?F:b,f=u?O:C;_.showFolderDialog({modalName:d.ModalName.CLOUD_DOCS_CREATE,user:r,title:p,primaryActionLabel:f,handleClickNewFolder:l,initialPath:c,useApiV2:!0,onSuccess:function(e,i){var l=e||"/";g.logFileCreateClick({uid:r.id,source:n,action:h.WebUserActionLogEvent.FILE_CREATE_HOME_FOLDER_SELECTED,depth_folder_selected:t.getDepthFromPath(l),selection_mode:a,empty_folder:s}),t.createNewFile({user:r,path:l,documentType:o,source:n,selection_mode:a,empty_folder:s})}})},t.createNewFile=function(n){var o=n.user,l=n.path,c=n.documentType,d=n.source,u=n.selection_mode,_=n.empty_folder;return r.__awaiter(void 0,void 0,Promise,(function(){return r.__generator(this,(function(n){return[2,Promise.all([new Promise((function(t,r){e(["modules/clean/account/email"],t,r)})).then(r.__importStar),new Promise((function(t,r){e(["modules/clean/account/email_verify_reasons"],t,r)})).then(r.__importStar)]).then((function(e){var r=e[0].EmailVerification,n=e[1].CLOUD_DOCS;if(r.get_for_user(o).verified_or_show(n)){var p=T.generateUUID("web-create");if(i.isMicrosoftFileType(c)){t.logCreateFileAttempt(p,{userId:o.id,action_source:s.getActionSourceFromNewFileMenuType(d)});var f=t.logCreateFileSuccessCallback({ts:Date.now(),openId:p,selection_mode:u,empty_folder:_});R({userId:o.id,path:l,documentType:c,logSuccessCallback:f,source:d})}else if(i.isPointerFileType(c))a.CreatePointerModal.showInstance({createOnSubmit:function(e){t.logCreateFileAttempt(p,{userId:o.id,action_source:s.getActionSourceFromNewFileMenuType(d)});var r=t.logCreateFileSuccessCallback({ts:Date.now(),openId:p,selection_mode:u,empty_folder:_});t.createNewPointer({userId:o.id,pathName:l,name:e.pointerData.name,url:e.pointerData.url,onError:e.onError,logSuccessCallback:r,source:d})}});else{t.logCreateFileAttempt(p,{userId:o.id,action_source:s.getActionSourceFromNewFileMenuType(d)});f=t.logCreateFileSuccessCallback({ts:Date.now(),openId:p,selection_mode:u,empty_folder:_});t.createNewCloudOnlyDoc({userId:o.id,pathName:l,title:v.intl.formatMessage({id:"j+AeKy",defaultMessage:"Untitled"}),documentType:c,logSuccessCallback:f,source:d,openId:p,selection_mode:u,empty_folder:_})}}}))]}))}))};var R=function(e){var r=e.userId,n=e.path,o=e.documentType,i=e.logSuccessCallback,a=e.source,l={fq_path:n,extension:o,action_source:t.getCreateActionSource(a),_subject_uid:String(r),t:E.Cookies.read("__Host-js_csrf")},c=t.constructFormForCreateNewMicrosoftFile(l);document.body.appendChild(c),c.submit(),i({userId:r,documentType:o,action_source:s.getActionSourceFromNewFileMenuType(a)})};t.constructFormForCreateNewMicrosoftFile=function(e){var t=document.createElement("form");t.action="/ow/msft/create_new_file",t.method="POST",t.target="_blank";for(var r=0,n=Object.keys(e);r<n.length;r++){var o=n[r],i=document.createElement("input");i.type="hidden",i.name=o,i.value=e[o],t.appendChild(i)}return t},t.createPlaceholderTabForNewCloudDoc=function(){return S.open_tab(i.LOADING_PAGE_URL,!0)},t.createNewCloudOnlyDoc=function(e){var r=e.userId,n=e.pathName,o=e.title,i=e.documentType,a=e.logSuccessCallback,l=e.source,c=e.openId,d=e.selection_mode,_=e.empty_folder,p=v.intl.formatMessage({id:"XcMi4Q",defaultMessage:"Creating new file…"}),g=v.intl.formatMessage({id:"5VrbkU",defaultMessage:"File created!"}),h=function(e){return e.preventDefault(),e.returnValue="",""};window.addEventListener("beforeunload",h);var S=t.createPlaceholderTabForNewCloudDoc(),E=function(e){f.Snackbar.sync(p,!0,t.CloudDocSnackbarId),m.createCloudDoc({pathName:n,title:o,documentType:i,userId:r,onSuccess:function(e){e.changesets;var n=e.createdFile,o=e.failureDetails;if(o){S.close(),f.Snackbar.close(t.CloudDocSnackbarId),window.removeEventListener("beforeunload",h),u.showFileSystemWarningsModal({fsws:o,confirmText:v.intl.formatMessage({id:"bhV8Xa",defaultMessage:"Create"}),onFinalAccept:function(){a=t.logCreateFileSuccessCallback({ts:Date.now(),openId:c,selection_mode:d,empty_folder:_}),S=t.createPlaceholderTabForNewCloudDoc(),E(!1)}})}else if(f.Snackbar.complete(g,t.CloudDocSnackbarId),window.removeEventListener("beforeunload",h),null!==n&&(a({userId:r,documentType:i,fq_path:n.fq_path,action_source:s.getActionSourceFromNewFileMenuType(l)}),S)){var p=n.open_to_url;try{var m=new URL(p);m.searchParams.set("web_open_id",c),p=m.toString()}catch(e){}S.location.replace(p)}},onError:function(e){t.logCreateFileCallback({ts:Date.now(),documentType:i,selectionMode:d,emptyFolder:_,error:!0}),f.Snackbar.fail(e,t.CloudDocSnackbarId),window.removeEventListener("beforeunload",h)},checkFSWs:e})};E(!0)},t.createNewPointer=function(e){var t=e.userId,r=e.pathName,n=e.name,a=e.url,d=e.onError,u=e.logSuccessCallback,_=e.source,m=new o.UserApiV2Client,g=v.intl.formatMessage({id:"l6L9q8",defaultMessage:"Creating new shortcut"}),h=v.intl.formatMessage({id:"EqUCHi",defaultMessage:"Created shortcut"});return f.Snackbar.sync(g,!0,"create-cloud-shortcut"),m.ns("cloud_docs").rpc("create",{to_path:c.normalize(r)||"/",title:n,cloud_doc_type:l.SimplePointer,pointer_url:a},{subjectUserId:t}).then((function(e){u({userId:t,documentType:i.PointerFileTypes.SIMPLE_POINTER,fq_path:e.result_path,action_source:s.getActionSourceFromNewFileMenuType(_)}),p.Modal.close(),f.Snackbar.complete(h+' "'+c.filename(e.result_path)+'"',"create-cloud-shortcut")})).catch((function(e){d(),f.Snackbar.fail(v.intl.formatMessage({id:"fi9Okp",defaultMessage:"Oops, something went wrong. Please try again later."}),"create-cloud-shortcut")}))},t.getCreateActionSource=function(e){switch(e){case i.NewFileMenuFromType.BROWSE:return i.ActionSourceValue.WEB_BROWSE;case i.NewFileMenuFromType.HOME:return i.ActionSourceValue.WEB_HOME;default:return i.ActionSourceValue.WEB}}})),define("modules/clean/cloud_docs/create_pointer_modal",["require","exports","tslib","react","modules/clean/cloud_docs/pointers_common","modules/clean/react/components/css","modules/clean/react/components/modal","modules/core/i18n","spectrum/button/index","spectrum/modal/index"],(function(e,t,r,n,o,i,a,s,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CreatePointerModal=void 0,n=r.__importDefault(n);var d=s.intl.formatMessage({id:"Qq0yqO",defaultMessage:"Create a new shortcut"}),u=s.intl.formatMessage({id:"bhV8Xa",defaultMessage:"Create"}),_=s.intl.formatMessage({id:"KOp2Z9",defaultMessage:"Creating..."}),p=s.intl.formatMessage({id:"d9/SE1",defaultMessage:"Cancel"}),f=s.intl.formatMessage({id:"cJojIg",defaultMessage:"Name"}),m=s.intl.formatMessage({id:"Di2bB3",defaultMessage:"URL"}),g=s.intl.formatMessage({id:"vtIvYJ",defaultMessage:"Invalid URL"}),h=(function(e){function t(t){var r=e.call(this,t)||this;return r.onChange=function(e){r.setState({pointerData:e})},r.handleCreateOnClick=function(){r.setState({creationInProgress:!0}),r.props.createOnSubmit({pointerData:{name:r.state.pointerData.name.trim(),url:r.state.pointerData.url.trim()},onError:r.handleSubmitError})},r.handleSubmitError=function(){r.setState({creationInProgress:!1})},r.renderCreateButton=function(){var e=o.CreatePointerFields.canSubmit(r.state.pointerData)&&!r.state.creationInProgress;return n.default.createElement(l.Button,{variant:"primary",disabled:!e,onClick:r.handleCreateOnClick},r.state.creationInProgress?_:u)},r.closeModal=function(){a.Modal.close()},r.renderCancelButton=function(){return n.default.createElement(l.Button,{variant:"secondary",onClick:r.closeModal},p)},r.state={pointerData:{name:"",url:""},creationInProgress:!1},r}return r.__extends(t,e),t.prototype.render=function(){return n.default.createElement(c.UtilityModal,{title:d,ariaLabel:"Shortcut Creation Modal",primaryAction:this.renderCreateButton,secondaryAction:this.renderCancelButton,open:!0,shouldRequestCloseOnActions:!1,overlayClickClose:!0,variant:"regular"},n.default.createElement(o.CreatePointerFields,{name:this.state.pointerData.name,url:this.state.pointerData.url,onChange:this.onChange,onSubmit:this.handleCreateOnClick,nameLabel:f,urlLabel:m,urlValidationMessage:g}))},t.showInstance=function(e){return a.Modal.showInstance(n.default.createElement(S,r.__assign({},e)))},t.displayName="CreatePointerModal",t})(n.default.Component);t.CreatePointerModal=h;var S=i.requireCssWithComponent(h,["/static/css/spectrum/index.web-vfliw9181.css","/static/css/cloud_docs/create_pointer_modal-vflATc8Dt.css"])})),define("modules/clean/cloud_docs/event_logging",["require","exports","tslib","api_v2/user_client","api_v2/noauth_client","modules/clean/cloud_docs/types","modules/clean/web_timing_logger","modules/clean/web_user_action_events","modules/clean/logging/hive/schemas/web-user-action","modules/clean/logging/telemetry","modules/constants/python","modules/clean/cloud_docs/constants","modules/core/browser","modules/clean/perf_tools/web_timing_utils","modules/core/exception","modules/clean/filepath/filepath"],(function(e,t,r,n,o,i,a,s,l,c,d,u,_,p,f,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logLoggedOutUXSnackBarAction=t.logInterstitialLoginAction=t.logFileConvertPromptAction=t.logFileOpenPromptAction=t.getActionSourceFromNewFileMenuType=t.getActionSourceFromSourceArgs=t.getActionSourceFromSurface=t.checkAndLogNpu=t.logLoggedOutUserAction=t.logUserAction=t.logClientEvent=t.logViewEvent=t.getStartTime=void 0,a=r.__importStar(a),c=r.__importStar(c),_=r.__importStar(_);var g=void 0;t.getStartTime=function(){try{g=g||_.performance().timing.fetchStart}catch(e){f.reportStack("Unable to get fetchStart from browser.",{severity:f.SEVERITY.NONCRITICAL}),g=a.start_time()}return g},t.logViewEvent=function(e,t,r){var o={file_views:[{file_info:{shared_link_details:{url:t}},platform_type:{".tag":r}}]};(new n.UserApiV2Client).ns("seen_state").rpc("log_file_view",o,{subjectUserId:e})},t.logClientEvent=function(e,r,n,s,l){var c=l||[];c.push({key:"time_on_page_with_redirect",value:a.time_since_start().toString()}),c.some((function(e){return"time_now"===e.key}))||c.push({key:"time_now",value:Date.now().toString()}),(new o.NoAuthApiV2Client).ns("cloud_docs").rpc("log_client_event",{client:i.editorTypeToClient[r],doc_id:e,event_name:n,auth_token:s,time_on_page:p.WebTimingUtil.getNow()-t.getStartTime(),extras:c},{})},t.logUserAction=function(e){var t,r=(new n.UserApiV2Client).ns("cloud_docs");e.hasOwnProperty("docPathOrId")&&e.docPathOrId&&(t={".tag":"path_or_id",path_or_id:e.docPathOrId});var o=e.data&&e.data.webOpenId,i=e.data&&e.data.origDest,a=e.data&&e.data.routingDest;r.rpc("log_user_action",{action:e.actionEvent,doc_id:t,source:e.actionSource,open_id:o,orig_dest:i,routing_dest:a,extra_info:e.extra},{subjectUserId:e.userId})},t.logLoggedOutUserAction=function(e){var t,r=(new o.NoAuthApiV2Client).ns("cloud_docs");e.hasOwnProperty("docPathOrId")&&e.docPathOrId&&(t={".tag":"path_or_id",path_or_id:e.docPathOrId});var n=e.data&&e.data.webOpenId,i=e.data&&e.data.origDest,a=e.data&&e.data.routingDest;r.rpc("logged_out/log_user_action",{action:e.actionEvent,doc_id:t,source:e.actionSource,open_id:n,orig_dest:i,routing_dest:a,extra_info:e.extra},{})},t.checkAndLogNpu=function(e,t,r,o,i){(new n.UserApiV2Client).ns("cloud_docs").rpc("log_new_partner_users",{partner:t,cloud_doc_type:m.file_extension(r),cloud_editor:o,platform:i},{subjectUserId:e})},t.getActionSourceFromSurface=function(e){return"search"===e?i.UserActionSourceType.WEB_SEARCH:"previews"===e?i.UserActionSourceType.WEB_PREVIEW:"home_recent"===e||"home_starred"===e?i.UserActionSourceType.WEB_HOME:"browse"===e||"sidebar"===e?i.UserActionSourceType.WEB_BROWSE:i.UserActionSourceType.WEB},t.getActionSourceFromSourceArgs=function(e){return e.fileViewAction===d.FileViewActionType.SEARCH||e.fileViewOrigin===d.FileViewOriginType.SEARCH?i.UserActionSourceType.WEB_SEARCH:e.fileViewOrigin===d.FileViewOriginType.BROWSE?i.UserActionSourceType.WEB_BROWSE:e.fileViewOrigin===d.FileViewOriginType.HOME?i.UserActionSourceType.WEB_HOME:i.UserActionSourceType.WEB},t.getActionSourceFromNewFileMenuType=function(e){switch(e){case u.NewFileMenuFromType.BROWSE:return i.UserActionSourceType.WEB_BROWSE;case u.NewFileMenuFromType.HOME:return i.UserActionSourceType.WEB_HOME;default:return i.UserActionSourceType.WEB}},t.logFileOpenPromptAction=function(e,t,r,n,o){(new c.HiveLogger).log(new l.WebUserActionRow({user_id:e,event_name:s.WebUserActionLogEvent.FILE_OPEN_PROMPT_ACTION,extra:{file_type:t,integration_name:r,prompt_action:n,ask_again:o}}))},t.logFileConvertPromptAction=function(e,t,r,n){(new c.HiveLogger).log(new l.WebUserActionRow({user_id:e,event_name:s.WebUserActionLogEvent.FILE_CONVERT_PROMPT_ACTION,extra:{prompt_action:t,integration_name:r,file_extension:n}}))},t.logInterstitialLoginAction=function(e,t,r){(new c.HiveLogger).log(new l.WebUserActionRow({event_name:s.WebUserActionLogEvent.INTERSTITIAL_LOGIN_ACTION,extra:{prompt_action:e,logged_out_ux_google_variant:t,file_extension:r}}))},t.logLoggedOutUXSnackBarAction=function(e,t,r){(new c.HiveLogger).log(new l.WebUserActionRow({event_name:s.WebUserActionLogEvent.LOGGED_OUT_UX_SNACKBAR_ACTION,extra:{prompt_action:e,file_extension:t,logged_out_ux_google_variant:r||""}}))}})),define("modules/clean/cloud_docs/open_with_utils",["require","exports","tslib","apex-metrics/index","modules/core/browser","modules/clean/cloud_docs/constants","modules/clean/cloud_docs/event_logging","modules/clean/cloud_docs/types","modules/clean/referrer_cleansing_redirect","modules/clean/cloud_docs/constants","modules/core/uri","modules/clean/cloud_docs/utils","modules/clean/open_with","spectrum/util/uuid_generator","modules/core/browser_detection","modules/clean/cloud_docs/create_api","modules/clean/metrics/index"],(function(e,t,r,n,o,i,a,s,l,c,d,u,_,p,f,m,g){"use strict";function h(){return r.__awaiter(this,void 0,Promise,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t,r){e(["api_v2/user_client"],t,r)})).then(r.__importStar)];case 1:return[2,(new(0,t.sent().UserApiV2Client)).ns("cloud_docs")]}}))}))}var S,E;function v(e){if(void 0!==e&&void 0!==e.error&&void 0!==e.error[".tag"])return e.error[".tag"]}function T(e){switch(v(e)){case"invalid_file_id":case"permission_denied":case"other":default:return}}function w(e,t,r,n,i,l,c){var u=p.generateUUID("web_open_id"),_=d.URI.parse(e.cloud_editor_url).updateQuery({cloud_editor:i,web_open_id:u});l&&_.updateQuery({ignore_lock:"1"});var f=_.toString();f&&(void 0===c&&(c=s.UserActionSourceType.WEB),a.logUserAction({actionEvent:s.UserActionEventType.PRE_OPEN,userId:n,docPathOrId:r,actionSource:c,data:{webOpenId:u}}),null!=t?o.redirect(f,t):o.open_tab(f))}function I(e){return[".gdoc",".gsheet",".gslides"].indexOf(u.getFileExt(e))>=0}function b(e){return".web"===u.getFileExt(e)}function F(e,t){for(var r=u.getFileExt(e),n=0,o=Object.keys(c.DSS_TYPE_TO_SUPPORTED_EXTS);n<o.length;n++){var i=o[n];if(c.DSS_TYPE_TO_SUPPORTED_EXTS[i].indexOf(r)>=0)return i}switch(r){case".gdoc":return c.GoogleFileTypes.GOOGLE_DSS_DOC;case".gsheet":return c.GoogleFileTypes.GOOGLE_DSS_SHEET;case".gslides":return c.GoogleFileTypes.GOOGLE_DSS_SLIDES}return null}Object.defineProperty(t,"__esModule",{value:!0}),t.getGoogleEditorType=t.isCloudBasedDoc=t.isShortcut=t.isGoogleDoc=t.getOpenWithWopiEditorInfo=t.getOpenWithGoogleEditorInfo=t.getOpenWithCloudEditorInfo=t.OpenWithCloudDocProvider=t.openCloudDoc=t.openWithCloudEditor=t.fileToOpenWithParams=t.openCloudEditorUrl=t.isInEdgeIframe=t.handleError=t.decodeAPIError=t.getCloudEditorUrl=t.getCloudEditorUrlCached=void 0,l=r.__importStar(l),_=r.__importDefault(_),f=r.__importStar(f),t.getCloudEditorUrlCached=function(e,n){return r.__awaiter(void 0,void 0,Promise,(function(){return r.__generator(this,(function(r){return S||(S=t.getCloudEditorUrl(e,n)),[2,S]}))}))},t.getCloudEditorUrl=function(e,t){return r.__awaiter(void 0,void 0,Promise,(function(){return r.__generator(this,(function(r){switch(r.label){case 0:return[4,h()];case 1:return[2,r.sent().rpc("get_cloud_editor_url",{file_id:t},{subjectUserId:e})]}}))}))},t.decodeAPIError=v,t.handleError=T,t.isInEdgeIframe=function(){var e=!1;if(f.edge||f.msie||f.edgeChromium())try{e=window.self!==window.top}catch(t){e=!0}return e},t.openCloudEditorUrl=w,t.fileToOpenWithParams=function(e){return{fileId:e.file_id,openToUrl:e.open_to_url}},t.openWithCloudEditor=function(e,o,a,s,l){var c=e.fileId,d=e.openToUrl;return r.__awaiter(void 0,void 0,void 0,(function(){var e,u,_,p,f,h,S;return r.__generator(this,(function(r){switch(r.label){case 0:r.trys.push([0,11,,12]),e=performance.now(),u=g.getMetricsReporter(),_={},r.label=1;case 1:return r.trys.push([1,8,9,10]),_.editor=a,l&&(_.source=l[".tag"]),p=t.isInEdgeIframe(),_.isInEdgeIframe=String(p),d&&d.startsWith("https://www.dropbox.com/scl/fi/")?(_.usedOpenToURLFromFile="true",w({cloud_editor_url:d},null,c,o,a,s,l),[3,7]):[3,2];case 2:return _.usedOpenToURLFromFile="false",f=p?null:m.createPlaceholderTabForNewCloudDoc(),p?[4,t.getCloudEditorUrlCached(o,c)]:[3,4];case 3:return h=r.sent(),[3,6];case 4:return[4,t.getCloudEditorUrl(o,c)];case 5:h=r.sent(),r.label=6;case 6:w(h,f,c,o,a,s,l),r.label=7;case 7:return _.error="false",[3,10];case 8:return S=r.sent(),_.error="true",T(S),[3,10];case 9:return u.createStats({ns:i.CLOUD_DOCS_AMP_NAMESPACE,name:"web/openWithCloudEditor"},_).recordDuration(performance.now()-e,n.TimeUnit.MILLISECONDS),[7];case 10:return[3,12];case 11:return T(r.sent()),[3,12];case 12:return[2]}}))}))},t.openCloudDoc=function(t,n,c){if(c||(c=s.UserActionSourceType.WEB),t.href)if(i.isPointerByExtension(t.ns_path))l.safe_open_tab_and_redirect(t.href),a.logUserAction({actionEvent:s.UserActionEventType.PRE_OPEN,userId:n.id,docPathOrId:t.file_id,actionSource:c});else{var u=p.generateUUID("web_open_id"),_=d.URI.parse(t.href).updateQuery("web_open_id",u).toString();o.open_tab(_),a.logUserAction({actionEvent:s.UserActionEventType.PRE_OPEN,userId:n.id,docPathOrId:t.file_id,actionSource:c,data:{webOpenId:u}})}else{var f=m.createPlaceholderTabForNewCloudDoc();new Promise((function(t,r){e(["modules/clean/previews/data/actions"],t,r)})).then(r.__importStar).then((function(e){return e.fetchPreviewUrl(t,n)})).then((function(e){e&&null!==f&&l.redirect(e,f,!0)}))}},(function(e){e.OfficeOnline="OfficeOnline",e.GoogleDSS="GoogleDSS"})(E=t.OpenWithCloudDocProvider||(t.OpenWithCloudDocProvider={})),t.getOpenWithCloudEditorInfo=function(e,r,n,o){var i=[],a=t.getOpenWithWopiEditorInfo(e,r,o);a&&n.wopi&&i.push(a);var s=t.getOpenWithGoogleEditorInfo(e,r,o);return s&&n.gdd&&i.push(s),i},t.getOpenWithGoogleEditorInfo=function(e,r,n){var o=F(e,r);return o?{text:c.DSS_TYPE_TO_TEXT[o],iconUrl:c.DSS_TYPE_TO_OPEN_WITH_ICONS[o],handler:function(){return t.openWithCloudEditor(t.fileToOpenWithParams(e),r.id,o,!1,n)},provider:E.GoogleDSS}:null},t.getOpenWithWopiEditorInfo=function(e,r,n){var o=_.default.getWopiOpenWithButtonInfo(e);return o?{text:o.name,spriteName:o.icon,handler:function(){return t.openWithCloudEditor(t.fileToOpenWithParams(e),r.id,o.editor,!1,n)},provider:E.OfficeOnline}:null},t.isGoogleDoc=I,t.isShortcut=b,t.isCloudBasedDoc=function(e){return!!I(e)||!!b(e)},t.getGoogleEditorType=F})),define("modules/clean/cloud_docs/pointers_common",["require","exports","tslib","ts-keycode-enum","react","spectrum/input/index"],(function(e,t,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CreatePointerFields=void 0;var a=(function(e){function t(){var r=null!==e&&e.apply(this,arguments)||this;return r.handleKeyPress=function(e){e.charCode===n.Key.Enter&&t.canSubmit({name:r.props.name,url:r.props.url})&&r.props.onSubmit()},r.handleNameChange=function(e){var t=e.target.value;r.props.onChange({name:t,url:r.props.url})},r.handleUrlChange=function(e){var t=e.target.value;r.props.onChange({name:r.props.name,url:t})},r.setNameFieldRef=function(e){r.nameRef=e},r}return r.__extends(t,e),t.prototype.render=function(){var e=""===this.props.url||t.isUrlValid(this.props.url),r=e?"default":"invalid",n="";return e||(n=this.props.urlValidationMessage),o.createElement("div",{className:"create-pointer--fields"},o.createElement("div",{className:"create-pointer--fieldset"},o.createElement("label",{htmlFor:"create-pointer--link_input"},this.props.urlLabel),o.createElement("div",{className:"create-pointer--fieldset-with-icon"},this.props.urlIcon,o.createElement(i.Input,{id:"create-pointer--link_input",className:"create-pointer--link_input",variant:r,onChange:this.handleUrlChange,onKeyPress:this.handleKeyPress,value:this.props.url,autoFocus:!0}))),o.createElement("div",{className:"create-pointer--url-validation-warning"},n),o.createElement("div",{className:"create-pointer--fieldset"},o.createElement("label",{htmlFor:"create-pointer--name_input"},this.props.nameLabel),o.createElement(i.Input,{id:"create-pointer--name_input",className:"create-pointer--name_input",onChange:this.handleNameChange,onKeyPress:this.handleKeyPress,forwardedRef:this.setNameFieldRef})))},t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,(function(){var e;return r.__generator(this,(function(t){switch(t.label){case 0:return this.props.urlPrepopulateFunction?[4,this.props.urlPrepopulateFunction()]:[3,2];case 1:(e=t.sent())&&(this.props.onChange({name:this.props.name,url:e}),this.nameRef.focus()),t.label=2;case 2:return[2]}}))}))},t.isUrlValid=function(e){return/^((http|https):\/\/)?([^.:/\\?#@!]+?\.)+[^.:/\\?#@!]+/i.test(e.trim())},t.canSubmit=function(e){return""!==e.name&&""!==e.url&&t.isUrlValid(e.url)},t.displayName="CreatePointerFields",t})((o=r.__importStar(o)).Component);t.CreatePointerFields=a})),define("modules/clean/cloud_docs/preferred_editor_utils",["require","exports","tslib","modules/core/i18n","modules/core/browser","modules/core/exception","modules/clean/cloud_docs/event_logging","modules/clean/cloud_docs/utils","modules/clean/cloud_docs/types","react","modules/clean/filepath/filepath","modules/clean/cloud_docs/open_with_utils","modules/core/uri","modules/clean/cloud_docs/cloud_doc_api_client","spectrum/util/uuid_generator","modules/clean/cloud_docs/preferred_editor_constants","modules/clean/cloud_docs/create_api"],(function(e,t,r,n,o,i,a,s,l,c,d,u,_,p,f,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPreferredEditorPrompt=t.openInPreferredEditor=t.hasPreferredEditorSupport=void 0,c=r.__importDefault(c),t.hasPreferredEditorSupport=function(e){var t=s.getFileExt(e);return m.PREFERRED_EDITOR_SUPPORTED_EXTS.indexOf(t)>=0},t.openInPreferredEditor=function(e,t,r,n,c){var d=s.getFileExt(t),h=r[e.id],S="";if(h)try{var E=h[m.EXTENSION_TO_DOC_TYPE[d]],v=E===m.PreferredEditorTypes.GoogleDSS||E===m.PreferredEditorTypes.OfficeOnline,T=f.generateUUID("web_open_id");if(t.is_in_vault_folder)return v&&a.logUserAction({actionEvent:l.UserActionEventType.PRE_OPEN,userId:e.id,docPathOrId:t.file_id,actionSource:a.getActionSourceFromSourceArgs(c),data:{webOpenId:T},extra:{block_vault_content:"true"}}),void n();if(v){var w=g.createPlaceholderTabForNewCloudDoc();u.getCloudEditorUrl(e.id,t.file_id).then((function(r){S=_.URI.parse(r.cloud_editor_url).updateQuery("web_open_id",T).toString(),w?w.location.replace(S):n(),a.logUserAction({actionEvent:l.UserActionEventType.PRE_OPEN,userId:e.id,docPathOrId:t.file_id,actionSource:a.getActionSourceFromSourceArgs(c),data:{webOpenId:T}})})).catch((function(e){i.reportStack("Error getting cloud editor url from preferred editor open.",{severity:i.SEVERITY.CRITICAL,exc_extra:{preferred_editor_url:S,file_ext:d,preferred_editor_configs:h,error:e.message}}),w&&w.close(),n()}))}else p.getPreferredUrl(e.id,t.file_id,d).then((function(r){r.preferred_editor_url&&(S=_.URI.parse(r.preferred_editor_url).updateQuery("web_open_id",T).toString(),a.logUserAction({actionEvent:l.UserActionEventType.PRE_OPEN,userId:e.id,docPathOrId:t.file_id,actionSource:a.getActionSourceFromSourceArgs(c),data:{webOpenId:T}}),o.redirect(S))})).catch((function(e){i.reportStack("Error getting preferred editor url from preferred editor open.",{severity:i.SEVERITY.CRITICAL,exc_extra:{preferred_editor_url:S,file_ext:d,preferred_editor_configs:h,error:e.message}})})),n()}catch(e){i.reportStack("Error opening docs in preferred editor.",{severity:i.SEVERITY.CRITICAL,exc_extra:{preferred_editor_url:S,file_ext:d,preferred_editor_configs:h,error:e.message}}),n()}else n()},t.getPreferredEditorPrompt=function(e,t){var r="."+d.file_extension(e),o=m.EXTENSION_TO_DOC_TYPE[r],i=m.INTEGRATION_NAME_TO_PROMPT[t][o];return i?{title:n.intl.formatMessage({id:"jXF9I9",defaultMessage:"Would you like to open <b>{file_extension}</b> files with {web_editor_name} by default?"},{file_extension:r,web_editor_name:i,b:function(e){return c.default.createElement("b",null,e)}}),body:n.intl.formatMessage({id:"f37GH8",defaultMessage:"{web_editor_name} will automatically be used to open your <b>{file_extension}</b> files in Dropbox. You can always update this later in your Dropbox settings."},{file_extension:r,web_editor_name:i,b:function(e){return c.default.createElement("b",null,e)}})}:null}})),define("modules/clean/cloud_docs/preferred_editor_constants",["require","exports","modules/core/i18n","modules/clean/cloud_docs/types"],(function(e,t,r,n){"use strict";var o,i,a,s,l,c,d;Object.defineProperty(t,"__esModule",{value:!0}),t.IntegrationNameToPreferredEditorEnums=t.INTEGRATION_NAME_TO_PROMPT=t.PREFERRED_EDITOR_SUPPORTED_EXTS=t.EXTENSION_TO_DOC_TYPE=t.PreferredEditorOptionsMap=t.PreferredEditorDocTypes=t.PreferredEditorTypes=void 0,(function(e){e[e.Unknown=0]="Unknown",e[e.FileViewer=1]="FileViewer",e[e.OfficeOnline=2]="OfficeOnline",e[e.GoogleDSS=3]="GoogleDSS"})(c=t.PreferredEditorTypes||(t.PreferredEditorTypes={})),(function(e){e.WORD="ms_word",e.EXCEL="ms_excel",e.POWERPOINT="ms_powerpoint"})(d=t.PreferredEditorDocTypes||(t.PreferredEditorDocTypes={})),t.PreferredEditorOptionsMap=((o={})[d.WORD]={1:r.intl.formatMessage({id:"5+Wabe",defaultMessage:"View in dropbox.com"}),2:r.intl.formatMessage({id:"Y9FcUQ",defaultMessage:"Word for the web"}),3:r.intl.formatMessage({id:"+HsOFj",defaultMessage:"Google Docs"})},o[d.EXCEL]={1:r.intl.formatMessage({id:"5+Wabe",defaultMessage:"View in dropbox.com"}),2:r.intl.formatMessage({id:"o3mRdr",defaultMessage:"Excel for the web"}),3:r.intl.formatMessage({id:"cpuRML",defaultMessage:"Google Sheets"})},o[d.POWERPOINT]={1:r.intl.formatMessage({id:"5+Wabe",defaultMessage:"View in dropbox.com"}),2:r.intl.formatMessage({id:"RTj2SO",defaultMessage:"PowerPoint for the web"}),3:r.intl.formatMessage({id:"PcJCVL",defaultMessage:"Google Slides"})},o),t.EXTENSION_TO_DOC_TYPE={".docx":d.WORD,".doc":d.WORD,".xlsx":d.EXCEL,".xls":d.EXCEL,".pptx":d.POWERPOINT,".ppt":d.POWERPOINT},t.PREFERRED_EDITOR_SUPPORTED_EXTS=Object.keys(t.EXTENSION_TO_DOC_TYPE),t.INTEGRATION_NAME_TO_PROMPT=((i={})[n.IntegrationName.GOOGLE_DSS]=((a={})[d.WORD]=r.intl.formatMessage({id:"+HsOFj",defaultMessage:"Google Docs"}),a[d.EXCEL]=r.intl.formatMessage({id:"cpuRML",defaultMessage:"Google Sheets"}),a[d.POWERPOINT]=r.intl.formatMessage({id:"PcJCVL",defaultMessage:"Google Slides"}),a),i[n.IntegrationName.OFFICE_ONLINE]=((s={})[d.WORD]=r.intl.formatMessage({id:"Y9FcUQ",defaultMessage:"Word for the web"}),s[d.EXCEL]=r.intl.formatMessage({id:"o3mRdr",defaultMessage:"Excel for the web"}),s[d.POWERPOINT]=r.intl.formatMessage({id:"RTj2SO",defaultMessage:"PowerPoint for the web"}),s),i[n.IntegrationName.PAPER_INTEGRATION]={},i),t.IntegrationNameToPreferredEditorEnums=((l={})[n.IntegrationName.GOOGLE_DSS]=c.GoogleDSS,l[n.IntegrationName.OFFICE_ONLINE]=c.OfficeOnline,l[n.IntegrationName.PAPER_INTEGRATION]=c.Unknown,l)})),define("modules/clean/cloud_docs/utils",["require","exports","modules/clean/filepath/filepath","spectrum-sharing/utils/sharing_constants","modules/clean/cloud_docs/types"],(function(e,t,r,n,o){"use strict";function i(e){return e.replace(/[/?<>:*\\]/g,"_")}Object.defineProperty(t,"__esModule",{value:!0}),t.replaceInvalidURLFilenameChars=t.replaceInvalidFilenameChars=t.integrationNameToShareActionOrigin=t.getFileExt=void 0,t.getFileExt=function(e){var t="";return e.hasOwnProperty("ext")?t=e.ext:e.hasOwnProperty("filename")?(t=r.file_extension(e.filename))&&(t="."+t):(t=r.file_extension(e))&&(t="."+t),t},t.integrationNameToShareActionOrigin=function(e){switch(e){case o.IntegrationName.GOOGLE_DSS:return n.SHARE_ACTION_ORIGIN_TYPE.GOOGLE_DSS;case o.IntegrationName.PAPER_INTEGRATION:return n.SHARE_ACTION_ORIGIN_TYPE.PAPER_INTEGRATION;case o.IntegrationName.OFFICE_ONLINE:return n.SHARE_ACTION_ORIGIN_TYPE.OFFICE_INTEGRATION;default:throw"No mapping for integration to share action origin: "+e}},t.replaceInvalidFilenameChars=i,t.replaceInvalidURLFilenameChars=function(e){return i(e).replace(/\ /g,"-")}})),define("modules/clean/file_actions/create-folder",["require","exports","tslib","modules/clean/file_actions/metrics","modules/clean/file_actions/strings","modules/clean/metrics/index","modules/clean/react/async_file_modal_controller","modules/clean/react/browse/action_logger","modules/clean/react/files_view/file_actions/api_v2","modules/clean/react/snackbar","modules/clean/web_user_action_events","modules/core/i18n","modules/clean/user_survey/user_survey","modules/clean/react/growth/rich_snackbar_actions/create_folder_actions","modules/clean/react/browse/data/store","modules/clean/react/browse/data/selectors"],(function(e,t,r,n,o,i,a,s,l,c,d,u,_,p,f,m){"use strict";function g(e){return r.__awaiter(this,void 0,Promise,(function(){return r.__generator(this,(function(t){return[2,new Promise((function(t){a.showFileSystemWarningsModal({fsws:e,onFinalAccept:function(){t(!0)},onAbortAction:function(){t(!1)},confirmText:u.intl.formatMessage(o.createFolderFswConfirmText)})}))]}))}))}function h(e,t,r){s.logWebUserAction({event_name:d.WebUserActionLogEvent.CREATE_FOLDER_ERROR,extra:{error_summary:e||null,error:t||null,origin:r||null}})}function S(e){s.logWebUserAction({event_name:d.WebUserActionLogEvent.CREATE_FOLDER_CANCEL,extra:{origin:e||null}})}function E(e){s.logWebUserAction({event_name:d.WebUserActionLogEvent.CREATE_FOLDER_PENDING,extra:{origin:e||null}})}function v(e){s.logWebUserAction({event_name:d.WebUserActionLogEvent.CREATE_FOLDER_SUCCESS,extra:{origin:e||null}}),_.UserSurvey.trackEvent("create_item","browse")}Object.defineProperty(t,"__esModule",{value:!0}),t.logCreateFolderSuccess=t.logCreateFolderPending=t.logCreateFolderCancel=t.logCreateFolderError=t.logCreateFolder=t.createFolder=void 0,a=r.__importStar(a),l=r.__importStar(l),m=r.__importStar(m),t.createFolder=function(e){var a=e.user,s=e.name,d=e.destination,_=e.checkFsw,T=e.origin,w=e.surface;return r.__awaiter(void 0,void 0,Promise,(function(){var e,I,b,F,C,O,R,A,y;return r.__generator(this,(function(r){switch(r.label){case 0:return e=i.getMetricsReporter(),I={surface:w},b={latency:e.createTimer({ns:n.FILE_ACTIONS_AMP_NAMESPACE,name:"create-folder/latency_ms"},I),completed:e.createStats({ns:n.FILE_ACTIONS_AMP_NAMESPACE,name:"create-folder/completed"},I)},E(T),c.Snackbar.sync(u.intl.formatMessage(o.createFolderSnackbarProgress),!1,"browse-action"),[4,l.createFolder(d,s,a,_)];case 1:return(F=r.sent()).isError&&"path"===F.error[".tag"]&&"file_system_warnings"===F.error.path[".tag"]?(c.Snackbar.close("browse-action"),[4,g(F.error.path.details)]):[3,5];case 2:return r.sent()?[4,t.createFolder({user:a,name:s,destination:d,checkFsw:!1,origin:T,surface:w})]:[3,4];case 3:return[2,r.sent()];case 4:return S(T),[2,{type:"cancel"}];case 5:return b.latency.record(),F.isError?("path"===F.error[".tag"]&&"malformed_path"===F.error.path[".tag"]?(c.Snackbar.fail(u.intl.formatMessage(o.createFolderErrorMalformedPath),"browse-action"),b.completed.record(1)):(c.Snackbar.fail(u.intl.formatMessage(o.createFolderErrorGeneric),"browse-action"),b.completed.record(0)),h(F.error_summary,F.error[".tag"],T),[2,{type:"error",summary:F.error_summary,error:F.error[".tag"]}]):(C=f.getStoreForBrowse().getState(),O=m.getUsersJtbdInterestInfo(C),R=void 0!==F.result.metadata.path_lower?F.result.metadata.path_lower:"",A={richSnackbarProps:p.getRichSnackbarPropsForCreateFolder(a.home_ns_id,R,{expFullFunnelVideoSnackbar:O})},y=void 0!==A.richSnackbarProps,c.Snackbar.complete(u.intl.formatMessage(o.createFolderSnackbarSuccess),"browse-action",void 0,A,y),v(T),b.completed.record(1),[2,{type:"success",folder:F.result.metadata}])}}))}))},t.logCreateFolder=function(e){var t=e.uid,n=e.view_type,o=e.origin,i=e.source;s.logWebUserAction({user_id:t,event_name:d.WebUserActionLogEvent.CREATE_FOLDER,view_type:n||null,extra:r.__assign({origin:o},i&&{source:i})})},t.logCreateFolderError=h,t.logCreateFolderCancel=S,t.logCreateFolderPending=E,t.logCreateFolderSuccess=v})),define("modules/clean/file_actions/metrics",["require","exports","tslib","modules/clean/metrics/index"],(function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.recordPathLookupErrors=t.batchContentType=t.bucketForBatchSize=t.FILE_ACTIONS_AMP_NAMESPACE=void 0,t.FILE_ACTIONS_AMP_NAMESPACE="web_file_actions",t.bucketForBatchSize=function(e){return 1===e?"single":e<=10?"small":e<=100?"medium":e<=1e3?"large":"massive"},t.batchContentType=function(e){return e.every((function(e){return e.is_dir}))?"folders":e.every((function(e){return!e.is_dir}))?"files":"mixed"};t.recordPathLookupErrors=function(e,o,i){var a={};for(var s in e.forEach((function(e){if("path_lookup"===e.failure[".tag"]){var t=e.failure.path_lookup[".tag"];a[t]=(a[t]||0)+1}})),a)a.hasOwnProperty(s)&&n.getMetricsReporter().createStats({ns:t.FILE_ACTIONS_AMP_NAMESPACE,name:"common/failure/path_lookup"},r.__assign(r.__assign({},i),{lookupFailureType:s,operation:o})).record(a[s])}})),define("modules/clean/file_actions/strings",["require","exports","react-intl"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unstarSnackbarError=t.starSnackbarError=t.unstarSnackbarSuccess=t.starSnackbarSuccess=t.createFolderSnackbarSuccess=t.createFolderFswConfirmText=t.createFolderErrorGeneric=t.createFolderErrorMalformedPath=t.createFolderSnackbarProgress=t.renameSnackbarSuccessMessage=t.renameUndoSnackbarSuccessMessage=t.renameUndoSnackbarErrorMessage=t.renameUndoSnackbarProgressMessage=t.renameFswConfirmText=t.renameSnackbarProgressMessage=t.renameErrorInvalidName=t.deleteUndoSnackbarMessage=t.deleteFswConfirmText=t.deleteSnackbarProgressMessage=void 0,t.deleteSnackbarProgressMessage=r.defineMessage({id:"z7/sbf",defaultMessage:"{count, plural, one{Deleting {count} item...} other{Deleting {count} items...}}"}),t.deleteFswConfirmText=r.defineMessage({id:"da2lvf",defaultMessage:"Delete"}),t.deleteUndoSnackbarMessage=r.defineMessage({id:"hCpZct",defaultMessage:"Delete undone."}),t.renameErrorInvalidName=r.defineMessage({id:"KYHY0Z",defaultMessage:"Name was invalid."}),t.renameSnackbarProgressMessage=r.defineMessage({id:"8j6sBp",defaultMessage:"Renaming"}),t.renameFswConfirmText=r.defineMessage({id:"NYv8Vp",defaultMessage:"Rename"}),t.renameUndoSnackbarProgressMessage=r.defineMessage({id:"deJ8cD",defaultMessage:"Undoing rename..."}),t.renameUndoSnackbarErrorMessage=r.defineMessage({id:"n4o67d",defaultMessage:"Undo failed."}),t.renameUndoSnackbarSuccessMessage=r.defineMessage({id:"6RXx/7",defaultMessage:"Rename undone."}),t.renameSnackbarSuccessMessage=r.defineMessage({id:"NqCfwG",defaultMessage:"Renamed 1 item."}),t.createFolderSnackbarProgress=r.defineMessage({id:"U3y3i9",defaultMessage:"Creating folder..."}),t.createFolderErrorMalformedPath=r.defineMessage({id:"HOb8Zp",defaultMessage:'The following characters are not allowed: angle brackets \\ / : ? * " |'}),t.createFolderErrorGeneric=r.defineMessage({id:"qZTFM0",defaultMessage:"Can’t create folder."}),t.createFolderFswConfirmText=r.defineMessage({id:"VDjS9+",defaultMessage:"Create folder"}),t.createFolderSnackbarSuccess=r.defineMessage({id:"1zC4ih",defaultMessage:"Folder created."}),t.starSnackbarSuccess=r.defineMessage({id:"m96IvY",defaultMessage:"Starred {itemName}."}),t.unstarSnackbarSuccess=r.defineMessage({id:"Yn2gx1",defaultMessage:"Unstarred {itemName}."}),t.starSnackbarError=r.defineMessage({id:"LdcLnn",defaultMessage:"There was a problem starring {itemName}"}),t.unstarSnackbarError=r.defineMessage({id:"t8Eqso",defaultMessage:"There was a problem unstarring {itemName}"})})),define("modules/clean/file_operations/notifications",["require","exports","tslib","lodash","modules/clean/browse_interface","modules/clean/em_string","modules/clean/filepath/filepath","modules/clean/react/browse/api","modules/clean/undo","modules/core/html","modules/core/i18n","modules/core/notify"],(function(e,t,r,n,o,i,a,s,l,c,d,u){"use strict";function _(e,t,r,n){l.notifyWithUndo(e,r,(function(){return s.rollbackChangeSets({changesets:r,userId:t.id,progressText:d.intl.formatMessage({id:"wKzr7W",defaultMessage:"Undoing…"}),onSuccess:function(){u.Notify.success(d.intl.formatMessage({id:"t6mPeQ",defaultMessage:"Undo complete."})),n&&n()}})}))}function p(e,t){var r=o.browse_uri_for_fq_path(t,e),s=i.Emstring.em_snippet(a.filename(e),40);return{href:r,text:n.escape(s)}}Object.defineProperty(t,"__esModule",{value:!0}),t.notifyRestoreSuccess=t.notifyPurgeSuccess=t.notifyFolderCreationSuccess=t.notifyRenameSuccess=t.notifyDeleteSuccess=t.notifyMoveSuccess=t.notifyCopySuccess=void 0,n=r.__importStar(n),o=r.__importStar(o),a=r.__importStar(a),s=r.__importStar(s),l=r.__importStar(l),t.notifyCopySuccess=function(e,t,r,n,o){var i;if(n){var a=p(n,t);i=d.intl.formatMessage({id:"UZ+XVI",defaultMessage:"{count, plural, one{Copied {count} item to {dest}.} other{Copied {count} items to {dest}.}}"},{count:e,dest:'<a href="'+a.href.toString()+'">'+a.text+"</a>"}),i=new c.HTML(i)}else i=d.intl.formatMessage({id:"BDtFp+",defaultMessage:"{count, plural, one{Copied {count} item.} other{Copied {count} items.}}"},{count:e});_(i,t,r,o)},t.notifyMoveSuccess=function(e,t,r,n,o){var i;if(n){var a=p(n,t);i=d.intl.formatMessage({id:"GBu2Ic",defaultMessage:"{count, plural, one{Moved {count} item to {dest}.} other{Moved {count} items to {dest}.}}"},{count:e,dest:'<a href="'+a.href.toString()+'">'+a.text+"</a>"}),i=new c.HTML(i)}else i=d.intl.formatMessage({id:"tFGyx0",defaultMessage:"{count, plural, one{Moved {count} item.} other{Moved {count} items.}}"},{count:e});_(i,t,r,o)},t.notifyDeleteSuccess=function(e,t,r,n){_(d.intl.formatMessage({id:"THAbub",defaultMessage:"{count, plural, one{Deleted {count} item.} other{Deleted {count} items.}}"},{count:e}),t,r,n)},t.notifyRenameSuccess=function(e,t,r){_(d.intl.formatMessage({id:"sAZa2U",defaultMessage:"Rename complete."}),e,t,r)},t.notifyFolderCreationSuccess=function(e,t,r){_(d.intl.formatMessage({id:"ndMNx/",defaultMessage:"Created folder {folder_name}."},{folder_name:e}),t,r)},t.notifyPurgeSuccess=function(e){var t=d.intl.formatMessage({id:"jh+GyF",defaultMessage:"{count, plural, one{Permanently deleted {count} item.} other{Permanently deleted {count} items.}}"},{count:e});u.Notify.success(t)},t.notifyRestoreSuccess=function(e){var t,r=e.length;if(1===r){var o=n.escape(a.filename(e[0].fq_path));t=d.intl.formatMessage({id:"TAukDw",defaultMessage:"Restored <strong>{filename}</strong>."},{strong:function(e){return"<strong>"+e+"</strong>"},filename:o}),t=new c.HTML(t)}else t=d.intl.formatMessage({id:"8N7KT8",defaultMessage:"{count, plural, one{Restored {count} file.} other{Restored {count} files.}}"},{count:r});u.Notify.success(t,30)}})),define("modules/clean/growth/smb_funnel/smb_funnel_logger",["require","exports","tslib","modules/clean/metrics/index","modules/core/exception","apex-metrics/index"],(function(e,t,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SMBFunnelLogger=t.SMBFunnelLoggerSingleton=t.Platform=void 0,(function(e){e.WEB="web",e.DESKTOP_SSCV="desktop_sscv",e.MOBILE_WEB="mobile_web"})(t.Platform||(t.Platform={}));var a=["platform","variant"],s=function(e){var t={};return Object.keys(e).forEach((function(r){a.indexOf(r)>=0&&(t[r]=e[r])})),t},l=function(e){var t=this;void 0===e&&(e={}),this.setCommonTags=function(e){var r=s(e);Object.keys(r).forEach((function(r){t.commonTags[r]&&t.commonTags[r]!==e[r]&&o.reportStack("Attempting to change "+r+" after it was already set",{severity:o.SEVERITY.NONCRITICAL,tags:["onboarding-activation-multiplayer","smb-funnel"]})})),t.commonTags=r},this.log=function(e,n){void 0===n&&(n={});var o=r.__assign(r.__assign({},t.commonTags),n),i=t.metricsReporter.createCounter({ns:"smb_funnel",name:e},o);i.increment(),i.record()},this.logDuration=function(e,n,o){void 0===o&&(o={});var a=r.__assign(r.__assign({},t.commonTags),o);t.metricsReporter.createStats({ns:"smb_funnel",name:e},a).recordDuration(n,i.TimeUnit.MILLISECONDS)},this.commonTags=s(e),this.metricsReporter=n.getMetricsReporter()};t.SMBFunnelLoggerSingleton=l,t.SMBFunnelLogger=new l})),define("modules/clean/react/admin/teams/onboarding/web/constants",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContUrl=t.FlowId=t.AMPMetrics=t.Platform=t.BackgroundColors=t.StepStatus=t.Steps=t.MODULE_NAME=t.FRAMEWORK=void 0,t.FRAMEWORK="team_setup_essential",t.MODULE_NAME="smooth_transitions",(function(e){e.VERIFICATION="verification",e.RIGHTSIZING="rightsizing",e.TEAM_INFO="team_info",e.MOVE_FOLDERS="move_folders",e.CONFIRM_FOLDERS="confirm_folders",e.RESULTS_FOLDERS="results_folders",e.INVITE_MEMBERS="invite_members",e.SUGGESTED_INVITE_MEMBERS="suggested_invite_members",e.INVITE_MOBILE="invite_mobile",e.INSTALL="install",e.INSTALL_MOBILE="install_mobile",e.ROLE="role",e.COLLABORATION="collaboration",e.LOADING_SCREEN="loading_screen",e.PAIR="team_install_page_pair",e.OPEN="team_install_page_open",e.DOWNLOAD="team_install_page_download",e.DOWNLOAD_COMPLETE="download_complete",e.MOBILE_INSTALL="mobile_install",e.DOCSEND_ONBOARD="docsend_onboard",e.JOIN_ACCEPT="join_accept",e.JOIN_LOGIN="join_login",e.JOIN_MOVE_FILES="join_move_files",e.JOIN_PRIVACY_QUESTION="privacy_question",e.JOIN_TWO_ACCOUNT_SUGGESTION="two_account_suggestion",e.JOIN_ONE_ACCOUNT_SUGGESTION="one_account_suggestion",e.JOIN_CREATE_NEW_PERSONAL="create_new_personal",e.JOIN_PERSONAL_VERIFICATION="personal_verification",e.HELP_US_HELP_YOU="help_us_help_you"})(t.Steps||(t.Steps={})),(function(e){e.Inactive="inactive",e.Active="active",e.Completed="completed"})(t.StepStatus||(t.StepStatus={})),(function(e){e.CELADON="celadon",e.CLOUD="cloud",e.NAVY="navy",e.ORCHID="orchid",e.SAPPHIRE="sapphire",e.SAND="sand",e.VANILLA="vanilla",e.WHITE="white"})(t.BackgroundColors||(t.BackgroundColors={})),(function(e){e.DESKTOP_WEB="desktop_web",e.DESKTOP_SSCV="desktop_sscv",e.MOBILE_WEB="mobile_web"})(t.Platform||(t.Platform={})),(function(e){e.SETUP_START="setup/start",e.SETUP_FINISH="setup/finish",e.SETUP_STEP_START="setup/step/start",e.SETUP_STEP_FINISH="setup/step/finish",e.SETUP_STEP_ERROR="setup/step/error",e.SETUP_STEP_INTERRUPT="setup/step/interrupt",e.SETUP_STEP_CTA="setup/step/cta",e.SETUP_STEP_FETCH="setup/step/fetch",e.ACTIVATION_IMM_VIEW="activation/imm/view",e.ACTIVATION_IMM_ADD_MEMBERS="activation/imm/add_members",e.ACTIVATION_DESKTOP_ICON_OPEN="activation/desktop_icon/open",e.ACTIVATION_EMPTY_STATE_VIEW="activation/empty_state/view",e.ACTIVATION_SUGGESTED_FOLDER_CREATE="activation/suggested_folder/create",e.ACTIVATION_SUGGESTED_FOLDER_DISMISS="activation/suggested_folder/dismiss",e.ACTIVATION_SUGGESTED_FOLDER_TOGGLE="activation/suggested_folder/toggle",e.ACTIVATION_QUICK_ACTIONS_PANEL_VIEW="activation/quick_actions_panel/view",e.ACTIVATION_QUICK_ACTION_CREATE_CF="activation/quick_action/create_cf",e.ACTIVATION_QUICK_ACTION_REDIRECT="activation/quick_action/redirect",e.ACTIVATION_QUICK_ACTION_SEE_SF="activation/quick_action/see_sf",e.ACTIVATION_QUICK_ACTION_DISMISS="activation/quick_action/dismiss",e.ACTIVATION_COLLECTION_FOLDER_VIEW="activation/collection_folder/view",e.ACTIVATION_COLLECTIONS_ACTION_REDIRECT="activation/collections_action/redirect",e.ACTIVATION_COLLECTIONS_ACTION_UPLOAD="activation/collections_action/upload",e.ACTIVATION_COLLECTIONS_ACTION_CREATE="activation/collections_action/create",e.ACTIVATION_COLLECTIONS_ACTION_PAPER="activation/collections_action/paper",e.ACTIVATION_COLLECTIONS_ACTION_OPEN_DESKTOP="activation/collections_action/open_desktop",e.ACTIVATION_COLLECTIONS_ACTION_OPEN_SETTINGS="activation/collections_action/open_settings",e.ACTIVATION_INVITE_LINK_CREATE="activation/invite_link/create",e.ACTIVATION_MOBILE_LINK_SEND="activation/mobile_link/send",e.ACTIVATION_DESKTOP_LINK_DISMISS="activation/desktop_link/dismiss",e.ACTIVATION_DESKTOP_LINK_INIT="activation/desktop_link/init",e.ACTIVATION_DESKTOP_LINK_SEND="activation/desktop_link/send"})(t.AMPMetrics||(t.AMPMetrics={})),(function(e){e[e.ESSENTIAL_SETUP=1]="ESSENTIAL_SETUP",e[e.PERSONALIZATION=2]="PERSONALIZATION",e[e.MOBILE_APP_LINKS=5]="MOBILE_APP_LINKS",e[e.P13N_COLLECTIONS=6]="P13N_COLLECTIONS",e[e.PISCES_BIZ_BASIC=7]="PISCES_BIZ_BASIC",e[e.TEAM_JOINER_FLOW=9]="TEAM_JOINER_FLOW",e[e.SPLIT_TMF_TSD=10]="SPLIT_TMF_TSD",e[e.HELP_US_HELP_YOU=11]="HELP_US_HELP_YOU"})(t.FlowId||(t.FlowId={})),(function(e){e.DEFAULT="",e.WORK="/work",e.ESSENTIAL_SETUP="/team/setup/essential",e.ESSENTIAL_JOIN="/team/join/essential"})(t.ContUrl||(t.ContUrl={}))})),define("modules/clean/react/growth/rich_snackbar_actions/create_folder_actions",["require","exports","dig-components/icons/src","modules/core/i18n","modules/core/browser","modules/clean/react/onboarding/logging/logging","modules/clean/react/onboarding/logging/events","modules/clean/react/growth/personalization/util"],(function(e,t,r,n,o,i,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRichSnackbarPropsForCreateFolder=void 0;var l={REQUEST_FILES:{name:"request_files",icon:r.FileRequestLine,onClick:function(e){var t=e.ns_id,r=e.ns_path;i.OALogger.logToTeamsWeb(a.FullFunnelOptimizationForVideoEvents.CLICK_REQUEST_FILES),o.redirect("/requests?ns_id="+t+"&path="+r)},text:n.intl.formatMessage({id:"JsXSfu",defaultMessage:"Request files"})}};t.getRichSnackbarPropsForCreateFolder=function(e,t,r){var o,c,d={userId:0,filePath:"",ns_id:e,ns_path:t};return s.shouldEnableFullFunnelVideoSnackbar(null==r?void 0:r.expFullFunnelVideoSnackbar)&&(c={actions:[l.REQUEST_FILES],helperText:n.intl.formatMessage({id:"EU51uM",defaultMessage:"Share and send a request for video or other files."}),clickHandlerArgs:d,onCloseClick:function(){i.OALogger.logToTeamsWeb(a.FullFunnelOptimizationForVideoEvents.DISMISS_SNACKBAR,{action:"request_files"})}}),s.shouldLogFullFunnelVideoSnackbarExposure(null==r?void 0:r.expFullFunnelVideoSnackbar)&&i.OALogger.logToTeamsWeb(a.FullFunnelOptimizationForVideoEvents.EXPOSURE,{variant:null===(o=null==r?void 0:r.expFullFunnelVideoSnackbar)||void 0===o?void 0:o.variant,exposure:"new_folder"}),c}})),define("modules/clean/react/folder_overview/api",["require","exports","tslib","api_v2/types","api_v2/user_client"],(function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getUserAccount=t.isFormatVersionError=t.isConflictError=t.getLoggingFileId=t.getSharedFolderPath=t.getFolderAccess=t.addContentReferencesToPath=t.addContentReferences=t.removeContentReferences=t.getContentReferences=t.setDescription=t.getDescription=void 0;var i=new o.UserApiV2Client,a=(function(e){function t(t,r){var n=e.call(this,r)||this;return n.user=t,n}return r.__extends(t,e),t.prototype._headers=function(t){var o;return this.user.is_cdm_member&&this.user.is_team_admin&&this.user.team_member_id?r.__assign(((o={})[n.ApiV2HeaderNames.DropboxApiSelectAdmin]=this.user.team_member_id,o),e.prototype._headers.call(this,t)):e.prototype._headers.call(this,t)},t})(o.UserApiV2Client);t.getDescription=function(e,t){return i.ns("files").rpc("get_description_batch",{file_ids:[t]},{subjectUserId:e}).then((function(e){if(!e||!e.items||1!==e.items.length)throw new Error("Unexpected response from get_description_batch");return e.items[0]}))},t.setDescription=function(e,t,r,n,o){return new a(e).ns("files").rpc("set_description",{file_id:t,current_revision_id:r,text:n,format_version:o},{subjectUserId:e.id})},t.getContentReferences=function(e,t){return i.ns("files").rpc("get_content_references_info",{file_id:t},{subjectUserId:e})},t.removeContentReferences=function(e,t,r){return i.ns("files").rpc("remove_content_references",{anchor_file_id:t,return_roots_as_ns_ids:!0,file_ids:r},{subjectUserId:e})},t.addContentReferences=function(e,t,r){return i.ns("files").rpc("add_content_references",{anchor_file_id:t,return_roots_as_ns_ids:!0,file_ids:r},{subjectUserId:e})},t.addContentReferencesToPath=function(e,t,r){return i.ns("files").rpc("add_content_references_to_path",{path:t,return_roots_as_ns_ids:!0,file_ids:r},{subjectUserId:e})},t.getFolderAccess=function(e){var t=e.userId,r=e.sharedFolderId,n=e.accountId,o=e.accountEmail;return i.ns("folder_overview").rpc("has_folder_access",{shared_folder_id:r,account_id:n,account_email:o},{subjectUserId:t})},t.getSharedFolderPath=function(e){var t=e.userId,r=e.sharedFolderId;return i.ns("files").rpc("get_metadata",{path:"ns:"+r},{subjectUserId:t}).then((function(e){return e.is_shareable?e.path_display:void 0}))},t.getLoggingFileId=function(e){var t=e.userId,r=e.path;return i.ns("files").rpc("get_metadata",{path:r},{subjectUserId:t}).then((function(e){return e.id}))},t.isConflictError=function(e){return e.error&&e.error.status&&"conflict"===e.error.status[".tag"]},t.isFormatVersionError=function(e){return e.error&&e.error.status&&"bad_format_version"===e.error.status[".tag"]},t.getUserAccount=function(e){var t=e.userId,r=e.accountId;return i.ns("users").rpc("get_account",{account_id:r},{subjectUserId:t})}})),define("modules/clean/react/folder_overview/constants",["require","exports","modules/core/i18n","react-intl"],(function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CONFLICT_POPUP_BUTTON=t.CONFLICT_POPUP_CONTENT_YOU=t.CONFLICT_POPUP_CONTENT=t.CONFLICT_POPUP_TITLE_YOU=t.CONFLICT_POPUP_TITLE=t.DESCRIPTION_LAST_EDIT=t.DESCRIPTION_LAST_EDIT_YOU=t.DESCRIPTION_LAST_EDIT_EMPTY=t.DESCRIPTION_LAST_EDIT_EMPTY_YOU=t.PIN_TO_READ_ONLY_FOLDER=t.PIN_TO_FAILURE_PERMISSION_DENIED=t.PIN_TO_MODAL_TITLE_MULTIPLE=t.PIN_TO_MODAL_TITLE_SINGLE=t.DESCRIPTION_VERSION=t.SHARING_MODAL_MESSAGE_PARENT_FOLDER_NO_NAME=t.SHARING_MODAL_MESSAGE_SAME_FOLDER_NO_NAME=t.SHARING_MODAL_MESSAGE_PARENT_FOLDER=t.SHARING_MODAL_MESSAGE_SAME_FOLDER=t.FOLDER_OVERVIEW_EDITOR_EDITING=t.CMD_KEY=t.CTRL_KEY=t.ALT_KEY=t.OPT_KEY=t.DESCRIPTION_SAVE_ERROR_DELAY_MS=t.DESCRIPTION_SAVE_DELAY_MS=t.SNACKBAR_SHOW_BUTTON_TEXT=t.SNACKBAR_CLOSE_BUTTON_TEXT=t.UNPIN_FROM_SNACKBAR_MESSAGE=t.PIN_TO_SNACKBAR_MESSAGE=t.ERROR_SHARE_NO_PERMISSION=t.ERROR_SHARE_MEMBER_FOLDER=t.ERROR_SHARE_PERSONAL_FOLDER=t.ERROR_DESCRIPTION_SAVE=t.ERROR_DESCRIPTION_FORMAT_VERSION=t.ERROR_DESCRIPTION_CONFLICT=t.FOLDER_EXAMPLES_LINK_URI=t.FOLDER_EXAMPLES_LINK_LABEL=t.DESCRIPTION_PLACEHOLDER_READ_ONLY=t.DESCRIPTION_PLACEHOLDER_EXAMPLES_BUTTON=t.DESCRIPTION_PLACEHOLDER_FOR_SPACE=t.DESCRIPTION_PLACEHOLDER=t.DESCRIPTION_PLACEHOLDER_RIGHT_RAIL=t.DATA_CACHE_TTL_MS=void 0,t.DATA_CACHE_TTL_MS=3e4,t.DESCRIPTION_PLACEHOLDER_RIGHT_RAIL=r.intl.formatMessage({id:"A5Lqjf",defaultMessage:"Add a few details about this folder here."}),t.DESCRIPTION_PLACEHOLDER=r.intl.formatMessage({id:"5wJAeB",defaultMessage:"Click here to describe this folder and turn it into a Space"}),t.DESCRIPTION_PLACEHOLDER_FOR_SPACE=r.intl.formatMessage({id:"uBopyb",defaultMessage:"Click here to describe this Space"}),t.DESCRIPTION_PLACEHOLDER_EXAMPLES_BUTTON=r.intl.formatMessage({id:"PR6SPH",defaultMessage:"Show examples"}),t.DESCRIPTION_PLACEHOLDER_READ_ONLY=r.intl.formatMessage({id:"PYQBlc",defaultMessage:"To edit this overview, ask the folder admin for access"}),t.FOLDER_EXAMPLES_LINK_LABEL=r.intl.formatMessage({id:"PR6SPH",defaultMessage:"Show examples"}),t.FOLDER_EXAMPLES_LINK_URI="https://www.dropbox.com/help/desktop-web/folder-overviews",t.ERROR_DESCRIPTION_CONFLICT=r.intl.formatMessage({id:"ssdefa",defaultMessage:"Can’t save changes. Paste text elsewhere to save, then click Refresh."}),t.ERROR_DESCRIPTION_FORMAT_VERSION=r.intl.formatMessage({id:"5dt0hu",defaultMessage:"Can’t save changes. Reload the page and try again."}),t.ERROR_DESCRIPTION_SAVE=r.intl.formatMessage({id:"PM6K+P",defaultMessage:"Can’t save changes."}),t.ERROR_SHARE_PERSONAL_FOLDER=r.intl.formatMessage({id:"9C/lc5",defaultMessage:"Can’t @mention someone in your Personal Dropbox."}),t.ERROR_SHARE_MEMBER_FOLDER=r.intl.formatMessage({id:"+dhj1b",defaultMessage:"Can’t @mention someone in your member folder."}),t.ERROR_SHARE_NO_PERMISSION=r.intl.formatMessage({id:"b7//2e",defaultMessage:"You don’t have permission to share this folder."}),t.PIN_TO_SNACKBAR_MESSAGE=n.defineMessage({id:"mjXnuX",defaultMessage:"Pinned to {folderName}"}),t.UNPIN_FROM_SNACKBAR_MESSAGE=n.defineMessage({id:"A1Fokf",defaultMessage:"Unpinned from {folderName}"}),t.SNACKBAR_CLOSE_BUTTON_TEXT=n.defineMessage({id:"Ww9LPX",defaultMessage:"Close"}),t.SNACKBAR_SHOW_BUTTON_TEXT=n.defineMessage({id:"8msMyU",defaultMessage:"Show"}),t.DESCRIPTION_SAVE_DELAY_MS=3e3,t.DESCRIPTION_SAVE_ERROR_DELAY_MS=10*t.DESCRIPTION_SAVE_DELAY_MS,t.OPT_KEY=r.intl.formatMessage({id:"HRXOjw",defaultMessage:"opt"}),t.ALT_KEY=r.intl.formatMessage({id:"RIxWSs",defaultMessage:"alt"}),t.CTRL_KEY=r.intl.formatMessage({id:"FL9yea",defaultMessage:"ctrl"}),t.CMD_KEY=r.intl.formatMessage({id:"NWv/3R",defaultMessage:"⌘"}),t.FOLDER_OVERVIEW_EDITOR_EDITING=r.intl.formatMessage({id:"Kud10T",defaultMessage:"Everyone in this folder can see notes, tasks, and pinned items"}),t.SHARING_MODAL_MESSAGE_SAME_FOLDER=n.defineMessage({id:"xkXFjI",defaultMessage:"Hi {user_name}, I @mentioned you in this folder. Take a look."}),t.SHARING_MODAL_MESSAGE_PARENT_FOLDER=n.defineMessage({id:"YzaJIx",defaultMessage:"Hi {user_name}, I @mentioned you in the {folder_name} folder. Take a look."}),t.SHARING_MODAL_MESSAGE_SAME_FOLDER_NO_NAME=r.intl.formatMessage({id:"sl5Fj7",defaultMessage:"I @mentioned you in this folder. Take a look."}),t.SHARING_MODAL_MESSAGE_PARENT_FOLDER_NO_NAME=n.defineMessage({id:"erm7J0",defaultMessage:"I @mentioned you in the {folder_name} folder. Take a look."}),t.DESCRIPTION_VERSION=[1,0,1],t.PIN_TO_MODAL_TITLE_SINGLE=n.defineMessage({id:"kh62rs",defaultMessage:"Pin “{name}” to..."}),t.PIN_TO_MODAL_TITLE_MULTIPLE=n.defineMessage({id:"oU0z79",defaultMessage:"Pin {num} items to..."}),t.PIN_TO_FAILURE_PERMISSION_DENIED=n.defineMessage({id:"BGyZpk",defaultMessage:"You do not have permission to pin to {path}"}),t.PIN_TO_READ_ONLY_FOLDER=n.defineMessage({id:"UD2+LM",defaultMessage:"Can't pin files or folders to a read-only folder"}),t.DESCRIPTION_LAST_EDIT_EMPTY_YOU=n.defineMessage({id:"PX5Hq1",defaultMessage:"Deleted {time_ago} by you"}),t.DESCRIPTION_LAST_EDIT_EMPTY=n.defineMessage({id:"7V5b6j",defaultMessage:"Deleted {time_ago} by {name}"}),t.DESCRIPTION_LAST_EDIT_YOU=n.defineMessage({id:"oA46AW",defaultMessage:"Updated {time_ago} by you"}),t.DESCRIPTION_LAST_EDIT=n.defineMessage({id:"MP7zas",defaultMessage:"Updated {time_ago} by {name}"}),t.CONFLICT_POPUP_TITLE=n.defineMessage({id:"PHRYz8",defaultMessage:"Your changes weren’t saved because you and {user} are editing at the same time."}),t.CONFLICT_POPUP_TITLE_YOU=r.intl.formatMessage({id:"tc/4YZ",defaultMessage:"Your changes weren’t saved because you are editing this description elsewhere."}),t.CONFLICT_POPUP_CONTENT=r.intl.formatMessage({id:"4aEgv5",defaultMessage:"Please wait until they’re done before making changes."}),t.CONFLICT_POPUP_CONTENT_YOU=r.intl.formatMessage({id:"oYSO1Z",defaultMessage:"Please save your other changes before making them here."}),t.CONFLICT_POPUP_BUTTON=r.intl.formatMessage({id:"nOO9Qi",defaultMessage:"OK"})})),define("modules/clean/react/folder_overview/data/action_creators",["require","exports","tslib","react","modules/clean/filepath/filepath","modules/clean/react/browse/data/selectors","modules/clean/react/folder_overview/api","modules/clean/react/folder_overview/constants","modules/clean/react/folder_overview/data/selectors","modules/clean/react/folder_overview/data/types","modules/clean/react/folder_overview/errors","modules/clean/react/folder_overview/live_update","modules/clean/react/folder_overview/logging","modules/clean/react/folder_overview/utils","modules/clean/react/snackbar","modules/core/persistence/storage","modules/clean/viewer","modules/clean/web_user_action_events","modules/core/exception","modules/core/i18n","modules/clean/react/right_rail/user_education/right_rail_user_education_tracker"],(function(e,t,r,n,o,i,a,s,l,c,d,u,_,p,f,m,g,h,S,E,v){"use strict";function T(e){f.Snackbar.complete(E.intl.formatMessage({id:"sz+AhS",defaultMessage:"{count, plural, one{Pinned {count} item.} other{Pinned {count} items.}}"},{count:e}),"folder-overview-pin-current-folder")}Object.defineProperty(t,"__esModule",{value:!0}),t.subscribeToBolt=t.initializeUserInteractionState=t.dismissEducationTooltip=t.interactedPinnedItems=t.interactedFolderOverview=t.fetchLoggingFileId=t.fetchAccountForUserId=t.fetchSharedFolderName=t.setDescriptionHasFocus=t.setRequiredComponents=t.updateFolderDataCache=t.removeContentReferences=t.addContentReferencesForPath=t.addContentReferences=t.reloadContentReferences=t.setContentReferencesData=t.saveDescriptionDraft=t.reloadDescription=t.setDescriptionData=t.setFailedToLoad=t.removeLoadedComponent=t.addLoadedComponent=t.saveFolderPreferences=t.loadFolderPreferences=t.handlePrefetch=t.fetchDataForFolder=void 0,n=r.__importStar(n),o=r.__importStar(o),i=r.__importStar(i),a=r.__importStar(a),l=r.__importStar(l),p=r.__importStar(p),S=r.__importStar(S),t.fetchDataForFolder=function(e){var n=e.path,o=e.nsId,i=e.componentNamespace,d=e.fetchContentReferences;return function(e,u){return r.__awaiter(void 0,void 0,void 0,(function(){var _,f,m,g,h,E,v,T,w,I,b,F,C,O,y;return r.__generator(this,(function(r){switch(r.label){case 0:f=!1,m=p.normalizePath(n),g=Date.now(),(h=l.componentDataCache(u())[i])&&0!==h.requiredComponents.length||(E=d?["content_references","description","draftjs"]:["description","draftjs"],e(t.setRequiredComponents({componentNamespace:i,requiredComponents:E}))),v=[],r.label=1;case 1:if(r.trys.push([1,3,,4]),T=l.user(u()).id,_=l.fileIdCache(u())[m],!(w=_||l.nsIdCache(u())[m]||o))throw new Error("Unable to get file ID or NS ID for current folder");return e(t.setFailedToLoad({componentNamespace:i,hasFailedToLoad:!1})),(I=_?l.folderDataCache(u())[_]:void 0)&&I.descriptionLastUpdated&&g-I.descriptionLastUpdated<s.DATA_CACHE_TTL_MS?(f=!!I.descriptionBaseRevision,e(t.addLoadedComponent({componentNamespace:i,component:"description"})),v.push(Promise.resolve(null))):(e(t.removeLoadedComponent({componentNamespace:i,component:"description"})),v.push(a.getDescription(T,w))),I&&I.contentReferencesLastUpdated&&g-I.contentReferencesLastUpdated<s.DATA_CACHE_TTL_MS?(e(t.addLoadedComponent({componentNamespace:i,component:"content_references"})),v.push(Promise.resolve(null))):d&&(e(t.removeLoadedComponent({componentNamespace:i,component:"content_references"})),v.push(a.getContentReferences(T,w))),[4,Promise.all(v)];case 2:if(b=r.sent(),F=b[0],C=b[1],F&&(_=F.file_obj_id),!_)throw new Error("Did not get a file ID from the Sprinkle description payload");return e({type:c.ActionTypes.UPDATE_FILE_ID_CACHE,payload:{fileIdCache:(y={},y[p.normalizePath(n)]=_,y)}}),f=!!F&&R(e,_,F,i,g),C&&A(e,_,C,f,i,g),(I=l.folderDataCache(u())[_])&&I.sharedFolderPath||e(t.fetchSharedFolderName({path:n})),I&&I.loggingFileId||e(t.fetchLoggingFileId({path:n})),e(t.loadFolderPreferences({folderFileId:_})),[3,4];case 3:return O=r.sent(),S.reportException({err:O,severity:"non-critical",exc_extra:{path:n}}),e(t.setFailedToLoad({componentNamespace:i,hasFailedToLoad:!0})),[3,4];case 4:return[2]}}))}))}},t.handlePrefetch=function(e){var n=e.path,o=e.content_references,i=e.description,a=e.componentNamespace,s=e.ts,l=void 0===s?Date.now():s;return function(e){return r.__awaiter(void 0,void 0,void 0,(function(){var s,d,u,_,f;return r.__generator(this,(function(r){try{if(d=o||{},!(u=(s=i||{}).file_obj_id))throw new Error("Did not get a file ID from the Odyssey prefetch payload");e({type:c.ActionTypes.UPDATE_FILE_ID_CACHE,payload:{fileIdCache:(f={},f[p.normalizePath(n)]=u,f)}}),_=s&&R(e,u,s,a,l),d&&A(e,u,d,_,a,l)}catch(r){S.reportException({err:r,severity:"non-critical",exc_extra:{path:n}}),e(t.setFailedToLoad({componentNamespace:a,hasFailedToLoad:!0}))}return[2]}))}))}},t.loadFolderPreferences=function(e){var n=e.folderFileId;return function(e,o){return r.__awaiter(void 0,void 0,void 0,(function(){var i,a;return r.__generator(this,(function(r){return i=l.user(o()).id,m.UserLocalStorage.clearOtherUsers([i]),(a=m.UserLocalStorage.get(i,"folder-overview-"+n))?(e(t.updateFolderDataCache({fileId:n,folderData:a})),[2]):[2]}))}))}},t.saveFolderPreferences=function(e){var t=e.folderFileId;return function(e,n){return r.__awaiter(void 0,void 0,void 0,(function(){var e,o;return r.__generator(this,(function(r){return e=l.user(n()).id,m.UserLocalStorage.clearOtherUsers([e]),(o=l.folderDataCache(n())[t])?(m.UserLocalStorage.set(e,"folder-overview-"+t,{isCollapsed:o.isCollapsed}),[2]):[2]}))}))}},t.addLoadedComponent=function(e){var t=e.componentNamespace,r=e.component;return{type:c.ActionTypes.ADD_LOADED_COMPONENT,payload:{componentNamespace:t,component:r}}},t.removeLoadedComponent=function(e){var t=e.componentNamespace,r=e.component;return{type:c.ActionTypes.REMOVE_LOADED_COMPONENT,payload:{componentNamespace:t,component:r}}},t.setFailedToLoad=function(e){var t=e.componentNamespace,r=e.hasFailedToLoad;return{type:c.ActionTypes.SET_FAILED_TO_LOAD,payload:{componentNamespace:t,hasFailedToLoad:r}}},t.setDescriptionData=function(e,r,n){var o=e.text,i=e.latest_revision_id,a=e.file_obj_id,s=e.bolt_channel_state,l=e.format_version,d=e.last_modified_time,u=e.last_modified_user;if(!a)throw new Error("Unexpected response from Sprinkle");var _=i||"";r(t.updateFolderDataCache({fileId:a,folderData:{description:o,descriptionBaseRevision:_,descriptionDraft:void 0,descriptionSaveState:c.DescriptionSaveState.IDLE,descriptionFormatVersion:l,descriptionBoltChannelState:s,descriptionLastUpdated:Date.now()}})),r(t.addLoadedComponent({componentNamespace:n,component:"description"})),r(C({folderFileId:a,modifiedInfo:{timestamp:d,userId:u},field:"description"})),t.subscribeToBolt("description",s)},t.reloadDescription=function(e){var n=e.folderFileId,o=e.componentNamespace;return function(e,i){return r.__awaiter(void 0,void 0,void 0,(function(){var s,c,d;return r.__generator(this,(function(r){switch(r.label){case 0:s=l.user(i()),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,a.getDescription(s.id,n)];case 2:return c=r.sent(),e(t.updateFolderDataCache({fileId:n,folderData:{descriptionBaseRevision:""}})),t.setDescriptionData(c,e,o),[3,4];case 3:return d=r.sent(),S.reportException({err:d,severity:S.SEVERITY.NONCRITICAL,tags:["browse","folder_overview"],exc_extra:{fileId:n,isReload:!0}}),[3,4];case 4:return[2]}}))}))}},t.saveDescriptionDraft=function(e){var n=e.folderFileId,o=e.componentNamespace,i=e.isInRightRail;return function(e,u){return r.__awaiter(void 0,void 0,void 0,(function(){function p(r){e(t.updateFolderDataCache({fileId:n,folderData:r}))}var f,m,g,S,E,v,T,w,F,C,R,A;return r.__generator(this,(function(r){switch(r.label){case 0:f=l.user(u()),r.label=1;case 1:return r.trys.push([1,3,,4]),m=l.folderDataCache(u()),(g=m[n])&&b(g)?(p({descriptionSaveState:c.DescriptionSaveState.SAVING}),[4,a.setDescription(f,n,g.descriptionLatestRevision,g.descriptionDraft,s.DESCRIPTION_VERSION.join("."))]):[2];case 2:return S=r.sent(),(null==(E=l.componentDataCache(u())[o])?void 0:E.descriptionHasFocus)||void 0===g.descriptionOpenedAtRevision||I(g),v=S.text,T=S.latest_revision_id,w=S.last_modified_time,F=S.last_modified_user,i&&e(t.interactedFolderOverview()),p({description:v,descriptionSaveState:c.DescriptionSaveState.IDLE,descriptionLastModified:{timestamp:w,userId:F},descriptionBaseRevision:T,descriptionLatestRevision:T}),C="BROWSE"===o?h.ActionSurfaceLogValue.CENTER_PANE:h.ActionSurfaceLogValue.RIGHT_SIDEBAR,R="search-sidebar"===o?h.RetrievalSourceValue.SEARCH:h.RetrievalSourceValue.BROWSE,_.logOverviewEdited({folderFileId:n,action_surface:C,retrievalSource:R,loggingFileId:g.loggingFileId}),[3,4];case 3:return A=r.sent(),a.isConflictError(A)?(p({descriptionSaveState:c.DescriptionSaveState.CONFLICT,descriptionLastModified:{userId:void 0}}),e(O({folderFileId:n}))):a.isFormatVersionError(A)?(d.showDescriptionFormatError(),p({descriptionSaveState:c.DescriptionSaveState.ERROR})):(d.showDescriptionSaveError(),p({descriptionSaveState:c.DescriptionSaveState.ERROR})),[3,4];case 4:return[2]}}))}))}},t.setContentReferencesData=function(e,r,n,o){var i=r.content_references||[],a=r.latest_revision_id,s=r.last_modified_time,l=r.last_modified_user;n(t.updateFolderDataCache({fileId:e,folderData:{contentReferences:i,contentReferencesRevision:a,contentReferencesBoltChannelState:r.bolt_channel_state,contentReferencesLastUpdated:Date.now()}})),n(C({folderFileId:e,modifiedInfo:{timestamp:s,userId:l},field:"contentReferences"})),n(t.addLoadedComponent({componentNamespace:o,component:"content_references"})),t.subscribeToBolt("content_references",r.bolt_channel_state)},t.reloadContentReferences=function(e){var n=e.folderFileId,o=e.componentNamespace;return function(e,i){return r.__awaiter(void 0,void 0,void 0,(function(){var s,c,d;return r.__generator(this,(function(r){switch(r.label){case 0:s=l.user(i()),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,a.getContentReferences(s.id,n)];case 2:return c=r.sent(),t.setContentReferencesData(n,c,e,o),[3,4];case 3:return d=r.sent(),S.reportException({err:d,severity:S.SEVERITY.NONCRITICAL,tags:["browse","folder_overview"],exc_extra:{fileId:n,isReload:!0}}),[3,4];case 4:return[2]}}))}))}};var w=function(e){var t=e.folderName,r=e.onShow;f.Snackbar.show(n.createElement(f.Snackbar,{title:E.intl.formatMessage(s.PIN_TO_SNACKBAR_MESSAGE,{folderName:t}),timeoutDelayMs:5e3,actionButtonText:r?E.intl.formatMessage(s.SNACKBAR_SHOW_BUTTON_TEXT):void 0,closeButtonText:E.intl.formatMessage({id:"HBT96k",defaultMessage:"Close"}),onActionClick:r?function(){f.Snackbar.close("folder-overview-pin"),r()}:void 0,id:"folder-overview-pin"}))};function I(e){var t=e.description?E.intl.formatMessage({id:"BV1uZg",defaultMessage:"Folder overview changed."}):E.intl.formatMessage({id:"MLktc7",defaultMessage:"Folder overview added."});f.Snackbar.generic(t,"folder-overview-change")}t.addContentReferences=function(e){var n=e.folderFileId,o=e.fileIds,i=e.componentNamespace,s=e.snackbarConfig;return function(e,c){return r.__awaiter(void 0,void 0,void 0,(function(){var d,u;return r.__generator(this,(function(r){switch(r.label){case 0:if(null===o||0===o.length)return[2];d=l.user(c()).id,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,a.addContentReferences(d,n,o)];case 2:return r.sent(),s?w(s):T(o.length),e(t.reloadContentReferences({folderFileId:n,componentNamespace:i})),[3,4];case 3:return u=r.sent(),S.reportException({err:u,severity:S.SEVERITY.NONCRITICAL,tags:["browse","folder_overview"]}),[3,4];case 4:return[2]}}))}))}},t.addContentReferencesForPath=function(e){var n=e.path,i=e.files,c=e.currentPath,d=e.snackbarConfig;return function(e,u){return r.__awaiter(void 0,void 0,void 0,(function(){var _,m,h,v;return r.__generator(this,(function(r){switch(r.label){case 0:_=l.user(u()),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,a.addContentReferencesToPath(_.id,n,i.map(p.fileToContentReferenceId))];case 2:return r.sent(),d?w(d):c!==n?f.Snackbar.complete(E.intl.formatMessage({id:"Mflc9Z",defaultMessage:"{count, plural, one{Pinned {count} item to {folder}.} other{Pinned {count} items to {folder}.}}"},{count:i.length,folder:o.filename(n,g.Viewer.get_root_name(_))}),"folder-overview-pin"):T(i.length),(m=l.fileIdCache(u())[p.normalizePath(n)])&&e(t.reloadContentReferences({folderFileId:m,componentNamespace:"BROWSE"})),[3,4];case 3:h=r.sent(),S.reportException({err:h,severity:S.SEVERITY.NONCRITICAL,tags:["browse","folder_overview"]});try{if("permission_denied"===h.error.status[".tag"])return v=d?E.intl.formatMessage(s.PIN_TO_READ_ONLY_FOLDER):E.intl.formatMessage(s.PIN_TO_FAILURE_PERMISSION_DENIED,{path:o.filename(n,g.Viewer.get_root_name(_))}),f.Snackbar.fail(v,"folder-overview-pin"),[2]}catch(e){}return f.Snackbar.fail(E.intl.formatMessage({id:"LYVKP8",defaultMessage:"{count, plural, one{Failed to pin {count} item to {folder}.} other{Failed to pin {count} items to {folder}.}}"},{count:i.length,folder:o.filename(n,g.Viewer.get_root_name(_))}),"folder-overview-pin"),[3,4];case 4:return[2]}}))}))}},t.removeContentReferences=function(e){var o=e.folderFileId,i=e.fileIds,c=e.componentNamespace,d=e.snackbarConfig;return function(e,u){return r.__awaiter(void 0,void 0,void 0,(function(){var _,p;return r.__generator(this,(function(r){switch(r.label){case 0:_=l.user(u()).id,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,a.removeContentReferences(_,o,i)];case 2:return r.sent(),d?f.Snackbar.show(n.createElement(f.Snackbar,{title:E.intl.formatMessage(s.UNPIN_FROM_SNACKBAR_MESSAGE,{folderName:d.folderName}),variant:"complete",actionButtonText:E.intl.formatMessage({id:"GUtve/",defaultMessage:"Undo"}),closeButtonText:E.intl.formatMessage({id:"HBT96k",defaultMessage:"Close"}),onActionClick:function(){f.Snackbar.close("folder-overview-unpin"),e(t.addContentReferences({folderFileId:o,fileIds:i,componentNamespace:c,snackbarConfig:d}))},timeoutDelayMs:5e3,id:"folder-overview-unpin"})):f.Snackbar.generic(E.intl.formatMessage({id:"0bkx9E",defaultMessage:"{count, plural, one{Unpinned {count} item.} other{Unpinned {count} items.}}"},{count:i.length}),"folder-overview-unpin"),e(t.reloadContentReferences({folderFileId:o,componentNamespace:c})),[3,4];case 3:return p=r.sent(),S.reportException({err:p,severity:S.SEVERITY.NONCRITICAL,tags:["browse","folder_overview"]}),[3,4];case 4:return[2]}}))}))}},t.updateFolderDataCache=function(e){var t=e.fileId,r=e.folderData;return{type:c.ActionTypes.UPDATE_FOLDER_DATA_CACHE,payload:{fileId:t,folderData:r}}},t.setRequiredComponents=function(e){var t=e.componentNamespace,r=e.requiredComponents;return{type:c.ActionTypes.SET_REQUIRED_COMPONENTS,payload:{componentNamespace:t,requiredComponents:r}}},t.setDescriptionHasFocus=function(e){var r=e.componentNamespace,n=e.descriptionHasFocus,o=e.folderFileId;return function(e,i){var a=l.componentDataCache(i())[r];if(n&&a&&!a.descriptionHasFocus){var s=l.folderDataCache(i())[o].descriptionBaseRevision;e(t.updateFolderDataCache({fileId:o,folderData:{descriptionLatestRevision:s,descriptionOpenedAtRevision:s}}))}else if(!n&&(null==a?void 0:a.descriptionHasFocus)){var d=l.folderDataCache(i())[o];d&&(null==d?void 0:d.descriptionOpenedAtRevision)!==(null==d?void 0:d.descriptionLatestRevision)&&(I(d),e(t.updateFolderDataCache({fileId:o,folderData:{descriptionOpenedAtRevision:void 0}})))}e({type:c.ActionTypes.SET_DESCRIPTION_HAS_FOCUS,payload:{componentNamespace:r,descriptionHasFocus:n}})}};var b=function(e){return!!e&&(e.descriptionSaveState!==c.DescriptionSaveState.CONFLICT&&(e.descriptionSaveState!==c.DescriptionSaveState.SAVING&&p.hasUnsavedDescriptionDraft(e)))};t.fetchSharedFolderName=function(e){var n=e.path;return function(e,i){return r.__awaiter(void 0,void 0,void 0,(function(){var s,c,d,u,_,f,m;return r.__generator(this,(function(r){switch(r.label){case 0:if(o.paths_are_equal(n,"/"))return[2];if(s=p.normalizePath(n),!(c=l.nsIdCache(i())[s]))return[2];if(d=l.fileIdCache(i())[s],u=l.user(i()).id,!(_=p.extractSharedFolderId(c)))return[2];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,a.getSharedFolderPath({userId:u,sharedFolderId:_})];case 2:return f=r.sent(),e(t.updateFolderDataCache({fileId:d,folderData:{sharedFolderPath:f}})),[3,4];case 3:return m=r.sent(),S.reportException({err:m,severity:S.SEVERITY.NONCRITICAL,tags:["browse","folder_overview"]}),[3,4];case 4:return[2]}}))}))}},t.fetchAccountForUserId=function(e){var t=e.accountId;return function(e,n){return r.__awaiter(void 0,void 0,void 0,(function(){var o,i,s;return r.__generator(this,(function(r){switch(r.label){case 0:return o=l.user(n()),t?t in l.accountCache(n())?[2]:t===o.account_id?[2]:[4,a.getUserAccount({userId:o.id,accountId:t})]:[2];case 1:return i=r.sent(),e({type:c.ActionTypes.UPDATE_ACCOUNT_CACHE,payload:{accountCache:(s={},s[t]=i,s)}}),[2]}}))}))}},t.fetchLoggingFileId=function(e){var n=e.path;return function(e,s){return r.__awaiter(void 0,void 0,void 0,(function(){var c,d,u,_,f;return r.__generator(this,(function(r){switch(r.label){case 0:if(o.paths_are_equal(n,"/"))return[2];if(o.paths_are_equal(i.context(s()).currentFQPath,n)&&!i.context(s()).currentNSPath)return[2];c=p.normalizePath(n),d=l.fileIdCache(s())[c],u=l.user(s()).id,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,a.getLoggingFileId({userId:u,path:c})];case 2:return _=r.sent(),e(t.updateFolderDataCache({fileId:d,folderData:{loggingFileId:_}})),[3,4];case 3:return f=r.sent(),S.reportException({err:f,severity:S.SEVERITY.NONCRITICAL,tags:["browse","folder_overview"]}),[3,4];case 4:return[2]}}))}))}},t.interactedFolderOverview=function(){return function(e,t){var r=l.getRightRailUserEducationTracker(t()),n=l.getUserEducationTooltips(t());n.tooltipsEnabled&&!n.hasInteractedWithOverview&&(e({type:c.ActionTypes.UPDATE_EDUCATION_TOOLTIPS_STATE,payload:{hasInteractedWithOverview:!0}}),r.track(v.RightRailUserEducationActions.FOLDER_OVERVIEW_INTERACTION))}},t.interactedPinnedItems=function(){return function(e,t){var r=l.getRightRailUserEducationTracker(t()),n=l.getUserEducationTooltips(t());n.tooltipsEnabled&&!n.hasInteractedWithPinnedItems&&(e({type:c.ActionTypes.UPDATE_EDUCATION_TOOLTIPS_STATE,payload:{hasInteractedWithPinnedItems:!0}}),r.track(v.RightRailUserEducationActions.PINNED_BLADE_INTERACTION))}},t.dismissEducationTooltip=function(){return function(e,t){var r=l.getRightRailUserEducationTracker(t());e({type:c.ActionTypes.UPDATE_EDUCATION_TOOLTIPS_STATE,payload:{hasSeenTooltip:!0}}),r.track(v.RightRailUserEducationActions.TOOLTIP_SEEN)}};var F=function(e,t){return r.__awaiter(void 0,void 0,void 0,(function(){var n;return r.__generator(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,t.hasPerfomed(e)];case 1:return[2,r.sent()];case 2:return n=r.sent(),S.reportException({err:n,force:!0,severity:S.SEVERITY.NONCRITICAL,tags:["browse","folder_overview","browse_right_rail"]}),[2,!0];case 3:return[2]}}))}))};t.initializeUserInteractionState=function(e){return function(t,n){return r.__awaiter(void 0,void 0,void 0,(function(){var o,i,a,s,d;return r.__generator(this,(function(r){switch(r.label){case 0:return e?(o=l.getRightRailUserEducationTracker(n()),[4,Promise.all([F(v.RightRailUserEducationActions.PINNED_BLADE_INTERACTION,o),F(v.RightRailUserEducationActions.FOLDER_OVERVIEW_INTERACTION,o),F(v.RightRailUserEducationActions.TOOLTIP_SEEN,o)])]):[2];case 1:return i=r.sent(),a=i[0],s=i[1],d=i[2],t({type:c.ActionTypes.UPDATE_EDUCATION_TOOLTIPS_STATE,payload:{hasSeenTooltip:d,hasInteractedWithOverview:s,hasInteractedWithPinnedItems:a,tooltipsEnabled:!0}}),[2]}}))}))}};var C=function(e){var r=e.folderFileId,n=e.modifiedInfo,o=e.field;return function(e,i){var a;if(n.timestamp&&n.userId){var s=l.folderDataCache(i())[r];if(s){var c="contentReferences"===o?"contentReferencesLastModified":"descriptionLastModified",d=s[c];(null==d?void 0:d.timestamp)&&n.timestamp<d.timestamp||(e(t.updateFolderDataCache({fileId:r,folderData:(a={},a[c]=n,a)})),e(t.fetchAccountForUserId({accountId:n.userId})))}}}};t.subscribeToBolt=function(e,t){if(void 0!==t)try{var r=t.channel_id,n=t.revision,o=t.token;if(void 0===r||void 0===n||void 0===o)return;var i=r.unique_id,a=r.app_id;if(void 0===i||void 0===a)return;u.folderOverviewLiveUpdateManager.setUpdateChannelForType(e,{uniqueId:i,appId:a,token:o,revision:""+n})}catch(e){S.reportException({err:e,severity:S.SEVERITY.NONCRITICAL,tags:["browse","folder_overview"]})}};var O=function(e){var t=e.folderFileId;return function(e,n){return r.__awaiter(void 0,void 0,void 0,(function(){var o,i,s,c;return r.__generator(this,(function(r){switch(r.label){case 0:return o=l.user(n()),[4,a.getDescription(o.id,t)];case 1:return i=r.sent(),s=i.last_modified_time,c=i.last_modified_user,e(C({folderFileId:t,modifiedInfo:{timestamp:s,userId:c},field:"description"})),[2]}}))}))}},R=function(e,r,n,o,i){return n.latest_revision_id?(t.setDescriptionData(n,e,o),!0):(e(t.addLoadedComponent({componentNamespace:o,component:"description"})),e(t.updateFolderDataCache({fileId:r,folderData:{descriptionBoltChannelState:n.bolt_channel_state,descriptionLastUpdated:i}})),t.subscribeToBolt("description",n.bolt_channel_state),!1)},A=function(e,r,n,o,i,a){return n.latest_revision_id?(t.setContentReferencesData(r,n,e,i),!0):(e(t.updateFolderDataCache({fileId:r,folderData:{contentReferences:[],contentReferencesBoltChannelState:n.bolt_channel_state,contentReferencesLastUpdated:a}})),e(t.addLoadedComponent({componentNamespace:i,component:"content_references"})),!1)}})),define("modules/clean/react/folder_overview/data/reducer",["require","exports","tslib","modules/clean/react/browse/data/types","modules/clean/react/browse/models","modules/clean/react/folder_overview/data/types","modules/clean/react/folder_overview/utils","modules/clean/search/single_page/data/types"],(function(e,t,r,n,o,i,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.folderOverviewReducer=t.defaultFolderOverviewState=void 0,t.defaultFolderOverviewState={folderDataCache:{},fileIdCache:{},accountCache:{},nsIdCache:{},componentDataCache:{},educationTooltips:{hasSeenTooltip:!0}};var l=function(e,t){var r=e.componentDataCache[t];return r||{requiredComponents:[],loadedComponents:[],hasFailedToLoad:!1,descriptionHasFocus:!1}},c=function(e){var t={};return e.forEach((function(e){t[a.normalizePath(e.fq_path)]=e.target_ns?"ns:"+e.target_ns+"/":"ns:"+e.ns_id+"/"+e.ns_path})),t};t.folderOverviewReducer=function(e,d){switch(void 0===e&&(e=t.defaultFolderOverviewState),d.type){case i.ActionTypes.UPDATE_FOLDER_DATA_CACHE:return(function(e,t){var n,o=t.fileId,i=t.folderData;return r.__assign(r.__assign({},e),{folderDataCache:r.__assign(r.__assign({},e.folderDataCache),(n={},n[o]=r.__assign(r.__assign({},e.folderDataCache[o]),i),n))})})(e,d.payload);case i.ActionTypes.UPDATE_FILE_ID_CACHE:return(function(e,t){var n=t.fileIdCache;return r.__assign(r.__assign({},e),{fileIdCache:r.__assign(r.__assign({},e.fileIdCache),n)})})(e,d.payload);case i.ActionTypes.UPDATE_ACCOUNT_CACHE:return(function(e,t){var n=t.accountCache;return r.__assign(r.__assign({},e),{accountCache:r.__assign(r.__assign({},e.accountCache),n)})})(e,d.payload);case i.ActionTypes.SET_REQUIRED_COMPONENTS:return(function(e,t){var n,o=t.componentNamespace,i=t.requiredComponents,a=l(e,o);return r.__assign(r.__assign({},e),{componentDataCache:r.__assign(r.__assign({},e.componentDataCache),(n={},n[o]=r.__assign(r.__assign({},a),{requiredComponents:i}),n))})})(e,d.payload);case n.ActionTypes.SET_CONTEXT:return(function(e,t){var n,o=t.context;return r.__assign(r.__assign({},e),{nsIdCache:r.__assign(r.__assign({},e.nsIdCache),(n={},n[a.normalizePath(o.currentFQPath)]="ns:"+o.currentNSID+"/"+o.currentNSPath,n))})})(e,d.payload);case i.ActionTypes.REMOVE_LOADED_COMPONENT:return(function(e,t){var n,o=t.componentNamespace,i=t.component,a=l(e,o),s=a.loadedComponents;return r.__assign(r.__assign({},e),{componentDataCache:r.__assign(r.__assign({},e.componentDataCache),(n={},n[o]=r.__assign(r.__assign({},a),{loadedComponents:s.filter((function(e){return e!==i}))}),n))})})(e,d.payload);case i.ActionTypes.ADD_LOADED_COMPONENT:return(function(e,t){var n,o=t.componentNamespace,i=t.component,a=l(e,o),s=a.loadedComponents;return s.includes(i)?e:r.__assign(r.__assign({},e),{componentDataCache:r.__assign(r.__assign({},e.componentDataCache),(n={},n[o]=r.__assign(r.__assign({},a),{loadedComponents:r.__spreadArrays(s,[i])}),n))})})(e,d.payload);case i.ActionTypes.SET_FAILED_TO_LOAD:return(function(e,t){var n,o=t.componentNamespace,i=t.hasFailedToLoad,a=l(e,o);return r.__assign(r.__assign({},e),{componentDataCache:r.__assign(r.__assign({},e.componentDataCache),(n={},n[o]=r.__assign(r.__assign({},a),{hasFailedToLoad:i}),n))})})(e,d.payload);case i.ActionTypes.SET_DESCRIPTION_HAS_FOCUS:return(function(e,t){var n,o=t.componentNamespace,i=t.descriptionHasFocus,a=l(e,o);return r.__assign(r.__assign({},e),{componentDataCache:r.__assign(r.__assign({},e.componentDataCache),(n={},n[o]=r.__assign(r.__assign({},a),{descriptionHasFocus:i}),n))})})(e,d.payload);case n.ActionTypes.SET_UNSORTED_FILES:return(function(e,t){var n=t.unsortedFiles.filter((function(e){return e.is_dir})).toArray();return r.__assign(r.__assign({},e),{nsIdCache:r.__assign(r.__assign({},e.nsIdCache),c(n))})})(e,d.payload);case s.ActionTypes.SET_RESULTS:case s.ActionTypes.APPEND_RESULTS:return(function(e,t){var n=t.searchResults.results.filter((function(e){return e instanceof o.File&&e.is_dir}));return r.__assign(r.__assign({},e),{nsIdCache:r.__assign(r.__assign({},e.nsIdCache),c(n))})})(e,d.payload);case i.ActionTypes.UPDATE_EDUCATION_TOOLTIPS_STATE:return(function(e,t){return r.__assign(r.__assign({},e),{educationTooltips:r.__assign(r.__assign({},e.educationTooltips),t)})})(e,d.payload)}return e}})),define("modules/clean/react/folder_overview/data/selectors",["require","exports","tslib","reselect","modules/clean/filepath/filepath","modules/clean/react/folder_overview/constants","modules/clean/react/folder_overview/data/reducer","modules/clean/react/folder_overview/utils","typescript/libraries/comments2/src/components/folder_overview_utils/index","modules/clean/redux/namespaces","modules/clean/redux/selectors","modules/clean/user","modules/clean/react/right_rail/user_education/right_rail_user_education_tracker"],(function(e,t,r,n,o,i,a,s,l,c,d,u,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.canShowToolFolderOverviewTooltip=t.getUserEducationTooltips=t.getRightRailUserEducationTracker=t.makeDoesFolderOverviewExistSelector=t.makeIsSpaceSelector=t.makeIsFolderOverviewEmptySelector=t.makePinnedItemsSelector=t.makeDescriptionContentSelector=t.makeLoggingFileIdSelector=t.makeSharedFolderNameSelector=t.makeSharedFolderPathSelector=t.makeHasUnsavedDescriptionDraftSelector=t.makeDescriptionFormatValidSelector=t.makeDescriptionSaveStateSelector=t.makeLastModifiedUserSelector=t.makeLastModifiedUserIdSelector=t.makeLastModifiedTimeSelector=t.makeDescriptionBaseRevisionSelector=t.makeIsCollapsedSelector=t.descriptionAuthorSelector=t.makeSharedFolderIdSelector=t.makeFolderNsIdSelector=t.makeFolderFileIdSelector=t.makeDescriptionHasFocusSelector=t.makeHasFailedToLoadSelector=t.makeHaveAllComponentsLoadedSelector=t.makeLoadedComponentsSelector=t.user=t.componentDataCache=t.accountCache=t.nsIdCache=t.fileIdCache=t.folderDataCache=void 0,o=r.__importStar(o),s=r.__importStar(s);var p=[],f=function(e){return d.getStateAtNamespace(e,c.FOLDER_OVERVIEW_NAMESPACE_KEY)||a.defaultFolderOverviewState};t.folderDataCache=function(e){return f(e).folderDataCache},t.fileIdCache=function(e){return f(e).fileIdCache};var m=function(e,r){return t.fileIdCache(e)[s.normalizePath(r.path)]};t.nsIdCache=function(e){return f(e).nsIdCache};var g=function(e,r){return t.nsIdCache(e)[s.normalizePath(r.path)]};t.accountCache=function(e){return f(e).accountCache},t.componentDataCache=function(e){return f(e).componentDataCache},t.user=function(e){return e.BROWSE&&e.BROWSE.user||u.mkUser(e.SEARCH.user)};var h=function(e,r){return t.componentDataCache(e)[r.componentNamespace]},S=function(e,r){var n=m(e,r);return t.folderDataCache(e)[n]},E=function(e,t){var r=S(e,t);return r?r.sharedFolderPath||t.path:void 0},v=function(e,t){var r,n=T(e,t);return null!==(r=null==n?void 0:n.userId)&&void 0!==r?r:void 0},T=function(e,t){var r=S(e,t)||{},n=r.descriptionLastModified,o=r.contentReferencesLastModified;return t.isInRightRail?n:(null==n?void 0:n.timestamp)&&(null==o?void 0:o.timestamp)?n.timestamp<o.timestamp?o:n:n||o},w=n.createSelector(S,(function(e){return e?e.descriptionFormatVersion:void 0})),I=n.createSelector(S,(function(e){if(e&&e.description)try{return JSON.parse(e.description)}catch(e){return}})),b=n.createSelector(S,(function(e){if(void 0!==e&&void 0!==e.contentReferences)return 0===e.contentReferences.length?p:s.convertContentReferencesToSortedFiles(e.contentReferences)})),F=n.createSelector(I,l.isEmptyDescription);t.makeLoadedComponentsSelector=function(){return n.createSelector(h,(function(e){return e?e.loadedComponents:void 0}))},t.makeHaveAllComponentsLoadedSelector=function(){return n.createSelector(h,(function(e){return!(!e||0===e.requiredComponents.length)&&0===e.requiredComponents.filter((function(t){return!e.loadedComponents.includes(t)})).length}))},t.makeHasFailedToLoadSelector=function(){return n.createSelector(h,(function(e){return!!e&&e.hasFailedToLoad}))},t.makeDescriptionHasFocusSelector=function(){return n.createSelector(h,(function(e){return!!e&&e.descriptionHasFocus}))},t.makeFolderFileIdSelector=function(){return n.createSelector(m,(function(e){return e}))},t.makeFolderNsIdSelector=function(){return n.createSelector(g,(function(e){return e}))},t.makeSharedFolderIdSelector=function(){return n.createSelector(g,(function(e){if(e)return s.extractSharedFolderId(e)}))},t.descriptionAuthorSelector=n.createSelector(t.user,s.convertDbxUserToIUser),t.makeIsCollapsedSelector=function(){return n.createSelector(S,(function(e){return!!e&&!!e.isCollapsed}))},t.makeDescriptionBaseRevisionSelector=function(){return n.createSelector(S,(function(e){return e?e.descriptionBaseRevision:void 0}))},t.makeLastModifiedTimeSelector=function(){return n.createSelector(T,(function(e){var t;return null!==(t=null==e?void 0:e.timestamp)&&void 0!==t?t:void 0}))},t.makeLastModifiedUserIdSelector=function(){return n.createSelector(v,(function(e){return e}))},t.makeLastModifiedUserSelector=function(){return n.createSelector(v,t.accountCache,(function(e,t){return e?t[e]:void 0}))},t.makeDescriptionSaveStateSelector=function(){return n.createSelector(S,(function(e){return e?e.descriptionSaveState:void 0}))},t.makeDescriptionFormatValidSelector=function(){return n.createSelector(w,(function(e){if(!e)return!0;var t=e.split(".").map((function(e){return parseInt(e,10)}));return!(t[0]>i.DESCRIPTION_VERSION[0])&&!(t[0]===i.DESCRIPTION_VERSION[0]&&t[1]>i.DESCRIPTION_VERSION[1])}))},t.makeHasUnsavedDescriptionDraftSelector=function(){return n.createSelector(S,s.hasUnsavedDescriptionDraft)},t.makeSharedFolderPathSelector=function(){return n.createSelector(E,(function(e){return e}))},t.makeSharedFolderNameSelector=function(){return n.createSelector(E,(function(e){return e?o.filename(e):void 0}))},t.makeLoggingFileIdSelector=function(){return n.createSelector(S,(function(e){return e?e.loggingFileId:void 0}))},t.makeDescriptionContentSelector=function(){return n.createSelector(I,(function(e){return e}))},t.makePinnedItemsSelector=function(){return n.createSelector(b,(function(e){return e}))},t.makeIsFolderOverviewEmptySelector=function(){return n.createSelector(F,b,(function(e,t){return t.isInRightRail}),(function(e,t,r){return e&&(r||!(t&&t.length))}))},t.makeIsSpaceSelector=function(){return n.createSelector(F,b,(function(e,t){return!e||!(!t||!t.length)}))},t.makeDoesFolderOverviewExistSelector=function(){return n.createSelector(S,(function(e){return!!e&&(!!e.descriptionBaseRevision||!!e.contentReferencesRevision)}))},t.getRightRailUserEducationTracker=n.createSelector(t.user,(function(e){return new _.RightRailUserEducationTracker(e.id)})),t.getUserEducationTooltips=function(e){return f(e).educationTooltips},t.canShowToolFolderOverviewTooltip=n.createSelector(F,b,t.getUserEducationTooltips,(function(e,t,r){var n=r.tooltipsEnabled,o=r.hasInteractedWithOverview,i=r.hasInteractedWithPinnedItems,a=r.hasSeenTooltip,s=!(!t||!t.length);return Boolean(n&&!a&&(!o&&!e||!i&&s))}))})),define("modules/clean/react/folder_overview/data/store",["require","exports","modules/clean/react/folder_overview/data/reducer","modules/clean/redux/store","modules/clean/redux/namespaces"],(function(e,t,r,n,o){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.getStoreForFolderOverview=void 0,t.getStoreForFolderOverview=function(){var e;return i||(i=n.getStoreAndRegisterReducers(((e={})[o.FOLDER_OVERVIEW_NAMESPACE_KEY]=r.folderOverviewReducer,e))),i}})),define("modules/clean/react/folder_overview/data/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DescriptionSaveState=t.ActionTypes=void 0,(function(e){e.UPDATE_FOLDER_DATA_CACHE="FOLDER_OVERVIEW/UPDATE_FOLDER_DATA_CACHE",e.UPDATE_FILE_ID_CACHE="FOLDER_OVERVIEW/UPDATE_FILE_ID_CACHE",e.REMOVE_LOADED_COMPONENT="FOLDER_OVERVIEW/REMOVE_LOADED_COMPONENT",e.ADD_LOADED_COMPONENT="FOLDER_OVERVIEW/ADD_LOADED_COMPONENT",e.SET_FAILED_TO_LOAD="FOLDER_OVERVIEW/SET_FAILED_TO_LOAD",e.SET_DESCRIPTION_HAS_FOCUS="FOLDER_OVERVIEW/SET_DESCRIPTION_HAS_FOCUS",e.UPDATE_ACCOUNT_CACHE="FOLDER_OVERVIEW/UPDATE_ACCOUNT_CACHE",e.SET_REQUIRED_COMPONENTS="FOLDER_OVERVIEW/SET_REQUIRED_COMPONENTS",e.UPDATE_EDUCATION_TOOLTIPS_STATE="FOLDER_OVERVIEW/UPDATE_EDUCATION_TOOLTIPS_STATE"})(t.ActionTypes||(t.ActionTypes={})),(function(e){e.IDLE="IDLE",e.SAVING="SAVING",e.CONFLICT="CONFLICT",e.ERROR="ERROR"})(t.DescriptionSaveState||(t.DescriptionSaveState={}))})),define("modules/clean/react/folder_overview/errors",["require","exports","modules/clean/react/folder_overview/constants","modules/clean/react/snackbar"],(function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showDescriptionSaveError=t.showDescriptionFormatError=void 0,t.showDescriptionFormatError=function(){n.Snackbar.fail(r.ERROR_DESCRIPTION_FORMAT_VERSION,"folder-overview")},t.showDescriptionSaveError=function(){n.Snackbar.fail(r.ERROR_DESCRIPTION_SAVE,"folder-overview")}})),define("modules/clean/react/folder_overview/live_update",["require","exports","tslib","lodash","eventemitter3","modules/clean/bolt/bolt"],(function(e,t,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.folderOverviewLiveUpdateManager=t.FolderOverviewLiveUpdateManager=void 0,n=r.__importStar(n);var a=(function(e){function t(){var t=e.call(this)||this;return t.setUpdateChannelForType=function(e,r){t.signedChannelStates[e]=new i.SignedChannelState(r.appId,r.uniqueId,r.revision,r.token),t.boltClient.update_states(n.values(t.signedChannelStates)),t.boltClient.start()},t.handleUpdate=function(e){var r=[];e.forEach((function(e){var o=n.findKey(t.signedChannelStates,{app_id:e.app_id,unique_id:e.unique_id});o&&!r.includes(o)&&(t.emit("update",{type:o}),r.push(o))}))},t.handleRefresh=function(){t.boltClient.update_states(n.values(t.signedChannelStates))},t.boltClient=new i.BoltClient([],t.handleUpdate,t.handleRefresh),t.signedChannelStates={},t}return r.__extends(t,e),t.prototype.stop=function(){this.boltClient.unsubscribe()},t})((o=r.__importDefault(o)).default);t.FolderOverviewLiveUpdateManager=a,t.folderOverviewLiveUpdateManager=new a})),define("modules/clean/react/folder_overview/logging",["require","exports","tslib","sjcl","immutable","modules/clean/filepath/filepath","modules/clean/logging/hive/schemas/web-user-action","modules/clean/logging/telemetry","modules/clean/react/folder_overview/data/selectors","modules/clean/react/folder_overview/data/store","modules/clean/react/folder_overview/utils","modules/clean/web_user_action_events"],(function(e,t,r,n,o,i,a,s,l,c,d,u){"use strict";function _(e){return e.blocks.map((function(e){return e.text.length})).reduce((function(e,t){return e+t}),0)}function p(e){var t=o.OrderedSet();return t=t.merge(e.blocks.map((function(e){return e.type})).filter((function(e){return"unstyled"!==e}))),e.blocks.forEach((function(e){return e.inlineStyleRanges.forEach((function(e){t=t.add(e.style)}))})),e.blocks.forEach((function(r){return r.entityRanges.forEach((function(r){t=t.add(e.entityMap[r.key].type)}))})),t.toArray().sort()}Object.defineProperty(t,"__esModule",{value:!0}),t.logFolderOverviewAction=t.logOverviewEdited=t.makeOverviewResourceExtras=t.makeEditedData=t.extractNsIdAndPath=t.hashPath=t.hiveLogger=void 0,n=r.__importStar(n),i=r.__importStar(i),s=r.__importStar(s),l=r.__importStar(l),t.hiveLogger=new s.HiveLogger;var f=function(e,t){var r=l.folderDataCache(t)[e];return r&&r.contentReferences||[]},m=function(e){if(!e)return"";var t=n.hash.sha256.hash(e.toLowerCase());return n.codec.hex.fromBits(t)};t.hashPath=function(e){return(e||"/").split("/").map(m).join("/")};var g=function(e){var t=i.normalize(e).split("/");return m(t.pop())};t.extractNsIdAndPath=function(e){return e?{nsId:d.extractSharedFolderId(e),nsPath:d.extractSharedFolderPath(e)}:{}},t.makeEditedData=function(e){var n,o,i=e.folderFileId,a=e.loggingFileId,s=e.action_surface,d=e.retrievalSource,u=c.getStoreForFolderOverview().getState(),m=(n=(function(e,t){var r=l.folderDataCache(t)[e];if(r&&r.descriptionDraft)try{return JSON.parse(r.descriptionDraft)}catch(e){return}})(i,u),o=(function(e){var t={all:0,checked:0};return e?(e.blocks.forEach((function(e){"task-block"===e.type&&(t.all+=1,e.data&&e.data.checked&&(t.checked+=1))})),t):t})(n),{length:n?_(n):0,features:n?p(n):[],tasks:o.all,checkedTasks:o.checked}),h=t.makeOverviewResourceExtras({folderFileId:i,loggingFileId:a,action_surface:s,retrievalSource:d});if(h)return r.__assign(r.__assign({},h),{length:m.length.toString(),formatting:JSON.stringify(m.features),tasks:m.tasks.toString(),checkedTasks:m.checkedTasks.toString(),pins:JSON.stringify(f(i,u).map((function(e){return{file_id:e.ns_path?e.file_id:e.ns_id,file_obj_id:e.file_id,resource:{resource_title:g(e.fq_path),resource_type:e.is_dir?"SFJ_FOLDER":"SFJ_FILE",ns_id:""+e.ns_id,resource_path:t.hashPath(e.fq_path),resource_namespace_path:t.hashPath(e.ns_path)}}})))})},t.makeOverviewResourceExtras=function(e){var r=e.folderFileId,n=e.loggingFileId,o=e.action_surface,i=e.retrievalSource,a=c.getStoreForFolderOverview().getState(),s=(function(e,t){var r=l.fileIdCache(t);for(var n in r)if(r[n]===e)return n})(r,a);if(void 0!==s){var d=t.extractNsIdAndPath(l.nsIdCache(a)[s]),u=d.nsId,_=d.nsPath;if(u)return{resource_type:"SFJ_FOLDER",resource_title:g(s),ns_id:u,resource_path:t.hashPath(s),resource_namespace_path:t.hashPath(_),file_id:(_?n:u)||null,file_obj_id:r,is_offline:"false",action_surface:o,retrieval_source:i}}},t.logOverviewEdited=function(e){var r=e.folderFileId,n=e.loggingFileId,o=e.action_surface,i=e.retrievalSource,a=c.getStoreForFolderOverview().getState();t.logFolderOverviewAction(u.WebUserActionLogEvent.FOLDER_OVERVIEW_EDITED,l.user(a).id,null,t.makeEditedData({folderFileId:r,loggingFileId:n,action_surface:o,retrievalSource:i}))},t.logFolderOverviewAction=function(e,n,o,s){void 0===s&&(s={});var l={user_id:n,event_name:e};o&&(l=r.__assign(r.__assign({},l),{file_nsid:o.ns_id,file_sjid:o.sjid,file_id:o.file_id,file_name:i.filename(o.fq_path),file_path:o.fq_path,file_extension:o.ext})),t.hiveLogger.log(new a.WebUserActionRow(r.__assign(r.__assign({},l),{extra:r.__assign({},s)})))}})),define("modules/clean/react/folder_overview/utils",["require","exports","tslib","modules/clean/filepath/filepath","modules/clean/react/browse/models","modules/core/i18n","typescript/libraries/comments2/src/components/folder_overview_utils/index"],(function(e,t,r,n,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.canEditOverviewForFile=t.userInitials=t.fileToContentReferenceId=t.pathFromSharingFolder=t.extractSharedFolderPath=t.extractSharedFolderId=t.getFileExtension=t.convertContentReferencesToSortedFiles=t.hasUnsavedDescriptionDraft=t.normalizePath=t.convertDbxUserToIUser=void 0,n=r.__importStar(n),t.convertDbxUserToIUser=function(e){return{id:e.id.toString(),name:{display:e.display_name,initials:[e.fname.substr(0,1),e.lname.substr(0,1)].join(""),public:e.familiar_name},photoUrl:e.initials_url}},t.normalizePath=function(e){return n.normalize(e).toLowerCase()},t.hasUnsavedDescriptionDraft=function(e){if(!e)return!1;try{var t=void 0===e.description||""===e.description||a.isEmptyDescription(JSON.parse(e.description)),r=void 0===e.descriptionDraft||""===e.descriptionDraft||a.isEmptyDescription(JSON.parse(e.descriptionDraft));if(t&&r)return!1}catch(e){}return e.description!==e.descriptionDraft&&void 0!==e.descriptionDraft},t.convertContentReferencesToSortedFiles=function(e){var r=[];e.forEach((function(e){var n={file_id:e.file_id,fq_path:e.fq_path,href:e.href,icon:e.icon,is_cloud_doc:e.is_cloud_doc,is_dir:e.is_dir,thumbnail_url_tmpl:e.thumbnail_url_tmpl,ns_id:e.ns_id,ns_path:e.ns_path,sjid:e.sjid,isDeleted:e.is_deleted,ext:t.getFileExtension(e.fq_path)},i=new o.File(n);r.push(i)}));var n=i.case_insensitive_comparator(!0);return r.sort((function(e,t){return n(o.File.getFilename(e),o.File.getFilename(t))}))},t.getFileExtension=function(e){if(!e)return"";var t=n.file_extension(e);return t?"."+t:""},t.extractSharedFolderId=function(e){var t=/^ns:([0-9]+)\/?/.exec(e);return t?t[1]:void 0},t.extractSharedFolderPath=function(e){var t=/^ns:[0-9]+\/?(.*)/.exec(e);return t?t[1]:void 0},t.pathFromSharingFolder=function(e,t){return e.length>=t.length?n.filename(t):r.__spreadArrays([n.filename(e)],t.substr(e.length).split("/").filter((function(e){return!!e}))).join(" › ")},t.fileToContentReferenceId=function(e){return e.is_dir&&e.target_ns?"ns:"+e.target_ns:e.file_id};t.userInitials=function(e){return(function(e){return"fname"in e})(e)?e.fname.substr(0,1)+e.lname.substr(0,1):e.name.given_name.substr(0,1)+e.name.surname.substr(0,1)},t.canEditOverviewForFile=function(e){return(!e.is_dir||!e.isDeleted)&&(e.target_ns?!e._mount_access_perms||!(!e._mount_access_perms||!e._mount_access_perms.includes("can_edit")):!e.read_only)}})),define("modules/clean/react/folder_subscriptions/customization/query_param_filter",["require","exports","tslib","react","modules/clean/history","modules/clean/react/folder_subscriptions/data/types"],(function(e,t,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QueryParamFilter=void 0,n=r.__importStar(n),o=r.__importDefault(o),t.QueryParamFilter=function(e){var t=e.children,r=n.useState(o.default.deconstruct_url().qargs[i.FOLLOW_MODAL_QUERY_PARAM]),a=r[0],s=r[1];return n.useEffect((function(){function e(e,t){s(t[i.FOLLOW_MODAL_QUERY_PARAM])}var t="/"+o.default.get_url().split(/[/?]/)[1];return o.default.add_callback(t,e),function(){o.default.remove_callback(t,e)}}),[a]),void 0===a||Array.isArray(a)?null:n.default.cloneElement(t,{param:a})},t.QueryParamFilter.displayName="QueryParamFilter"})),define("modules/clean/react/folder_subscriptions/data/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActionTypes=t.FolderSubscriptionState=t.RequestFlightStatus=t.Frequencies=t.FOLLOW_MODAL_QUERY_PARAM=void 0,t.FOLLOW_MODAL_QUERY_PARAM="manage_folder_subscription",t.Frequencies={INSTANT:{".tag":"instant"},DAILY:{".tag":"daily"}},(function(e){e.IDLE="idle",e.READY="ready",e.INFLIGHT="inflight",e.ERROR="error"})(t.RequestFlightStatus||(t.RequestFlightStatus={})),(function(e){e.FOLLOWING="FOLLOWING",e.FOLLOWING_PARENT="FOLLOWING_PARENT",e.NOT_FOLLOWING="NOT_FOLLOWING"})(t.FolderSubscriptionState||(t.FolderSubscriptionState={})),(function(e){e.FETCHING_FOLDER_SUBSCRIPTION="FOLDER_SUBSCRIPTION/FETCHING_FOLDER_SUBSCRIPTION",e.OPTIMISTIC_SET_FOLDER_SUBSCRIPTION="FOLDER_SUBSCRIPTION/OPTIMISTIC_SET_FOLDER_SUBSCRIPTION",e.CONFIRM_FOLDER_SUBSCRIPTION="FOLDER_SUBSCRIPTION/CONFIRM_FOLDER_SUBSCRIPTION",e.ERROR_FOLDER_SUBSCRIPTION="FOLDER_SUBSCRIPTION/ERROR_FOLDER_SUBSCRIPTION"})(t.ActionTypes||(t.ActionTypes={}))})),define("modules/clean/react/folder_subscriptions/data/action_creators",["require","exports","tslib","modules/clean/react/browse/action_logger","modules/clean/react/browse/constants","modules/clean/react/browse/data/selectors","modules/clean/react/browse/logger_util","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/folder_subscriptions/data/api","modules/clean/react/folder_subscriptions/data/selectors","modules/clean/react/folder_subscriptions/data/types","modules/clean/react/folder_subscriptions/follow/snackbar","modules/clean/web_user_action_events"],(function(e,t,r,n,o,i,a,s,l,c,d,u,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.editFolderSubscription=t.deleteFolderSubscriptionFromEmail=t.deleteFolderSubscription=t.createFolderSubscription=t.logAction=t.FolderSubscriptionOrigin=t.fetchFolderSubscription=void 0,i=r.__importStar(i),a=r.__importStar(a),s=r.__importStar(s),l=r.__importStar(l),c=r.__importStar(c);var p,f=function(e,t,r){e({type:d.ActionTypes.CONFIRM_FOLDER_SUBSCRIPTION,payload:{folderSubscription:r,path:t,timestamp:new Date}})},m=function(e,t,r){e({type:d.ActionTypes.ERROR_FOLDER_SUBSCRIPTION,payload:{folderSubscription:r,path:t}})};t.fetchFolderSubscription=function(e){return function(t,n){return r.__awaiter(void 0,void 0,void 0,(function(){var o,a;return r.__generator(this,(function(r){return o=n(),a=i.user(o).id,c.getRequestState(o,e).status===d.RequestFlightStatus.INFLIGHT?[2]:((function(e,t){e({type:d.ActionTypes.FETCHING_FOLDER_SUBSCRIPTION,payload:{path:t}})})(t,e),l.getFolderSubscription(e,a).then((function(r){return f(t,e,r)}),(function(){return m(t,e)})),[2])}))}))}},(function(e){e.Email="email",e.SideMenu="side_menu",e.Thumbnail="thumbnail"})(p=t.FolderSubscriptionOrigin||(t.FolderSubscriptionOrigin={})),t.logAction=function(e,t,r,l){var d,u,_=i.user(t).id,p=i.selectedFiles(t),f=a.countFilesAndFolders(p),m=f.num_files_selected,g=f.num_folders_selected,h=c.folderSubscription(t,r),S=null===(d=null==h?void 0:h.settings)||void 0===d?void 0:d.activity_types;n.logBrowseAction({action:e,uid:_,num_files_selected:m,num_folders_selected:g,view_type:s.selectViewType(t,{instanceId:o.BROWSE_FILES_VIEW_ID}),extra:{ns_id:l.ns_id.toString(),origin:l.origin||null,frequency:(null===(u=null==h?void 0:h.settings)||void 0===u?void 0:u.frequency[".tag"])||null,file_add:S?S.file_added.toString():null,file_delete:S?S.file_deleted.toString():null}})};var g=function(e){var r=e.dispatch,n=e.getState,o=e.path,i=e.newValue,a=e.apiUpdate,s=e.onSuccess,l=e.onError,u=n(),_=c.folderSubscription(u,o);return(function(e,t,r){e({type:d.ActionTypes.OPTIMISTIC_SET_FOLDER_SUBSCRIPTION,payload:{folderSubscription:r,path:t}})})(r,o,i),a().then((function(e){f(r,o,i),s(e)}),(function(){m(r,o,_),r(t.fetchFolderSubscription(o)),l()}))};t.createFolderSubscription=function(e,r,n){return function(o,a){var s=a(),p=i.user(s).id;if(c.folderSubscriptionState(s,e)===d.FolderSubscriptionState.NOT_FOLLOWING)return g({dispatch:o,getState:a,path:e,newValue:{subscriptionState:d.FolderSubscriptionState.FOLLOWING,followingPath:e,settings:r},apiUpdate:function(){return l.createFolderSubscription(e,r,p)},onSuccess:function(){u.showSetOptionsConfirmationSnackbar(e),t.logAction(_.WebUserActionLogEvent.FOLLOW_FOLDER,a(),e,n)},onError:function(){return u.showSetOptionsErrorSnackbar(e)}})}},t.deleteFolderSubscription=function(e,r){return function(n,o){var a=o(),s=i.user(a).id;if(c.folderSubscriptionState(a,e)===d.FolderSubscriptionState.FOLLOWING)return g({dispatch:n,getState:o,path:e,newValue:{subscriptionState:d.FolderSubscriptionState.NOT_FOLLOWING},apiUpdate:function(){return l.deleteFolderSubscription(e,s)},onSuccess:function(){u.showUnfollowConfirmationSnackbar(e),t.logAction(_.WebUserActionLogEvent.UNFOLLOW_FOLDER,o(),e,r)},onError:function(){return u.showUnfollowErrorSnackbar(e)}})}},t.deleteFolderSubscriptionFromEmail=function(e,r){return function(n,o){var a=o(),s=i.user(a).id;return l.deleteFolderSubscription(e,s).then((function(){u.showUnfollowConfirmationSnackbar(e),t.logAction(_.WebUserActionLogEvent.UNFOLLOW_FOLDER,a,e,{ns_id:r,origin:p.Email})}),(function(){return u.showUnfollowErrorSnackbar(e)}))}},t.editFolderSubscription=function(e,r,n){return function(o,a){var s=a(),p=i.user(s).id;if(c.folderSubscriptionState(s,e)===d.FolderSubscriptionState.FOLLOWING)return g({dispatch:o,getState:a,path:e,newValue:{subscriptionState:d.FolderSubscriptionState.FOLLOWING,followingPath:e,settings:r},apiUpdate:function(){return l.editFolderSubscription(e,r,p)},onSuccess:function(){u.showSetOptionsConfirmationSnackbar(e),t.logAction(_.WebUserActionLogEvent.EDIT_FOLDER_FOLLOW_SETTINGS,a(),e,n)},onError:function(){return u.showSetOptionsErrorSnackbar(e)}})}}})),define("modules/clean/react/folder_subscriptions/data/api",["require","exports","tslib","api_v2/user_client","modules/clean/react/folder_subscriptions/data/types"],(function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.editFolderSubscription=t.deleteFolderSubscription=t.createFolderSubscription=t.getFolderSubscription=void 0;t.getFolderSubscription=function(e,t){return r.__awaiter(this,void 0,Promise,(function(){return r.__generator(this,(function(r){return[2,(new n.UserApiV2Client).ns("awareness_subscriptions").rpc("folder_subscriptions/get",{identifier:e},{subjectUserId:t}).then((i=e,function(e){var t=e.subscription;if(!t)return{subscriptionState:o.FolderSubscriptionState.NOT_FOLLOWING};var r=t.fq_path;return r!==i?{subscriptionState:o.FolderSubscriptionState.FOLLOWING_PARENT,followingPath:r}:{subscriptionState:o.FolderSubscriptionState.FOLLOWING,followingPath:r,settings:t.settings}}))];var i}))}))},t.createFolderSubscription=function(e,t,o){return r.__awaiter(this,void 0,Promise,(function(){return r.__generator(this,(function(r){return[2,(new n.UserApiV2Client).ns("awareness_subscriptions").rpc("folder_subscriptions/create",{identifier:e,settings:t},{subjectUserId:o})]}))}))},t.deleteFolderSubscription=function(e,t){return r.__awaiter(this,void 0,Promise,(function(){return r.__generator(this,(function(r){return[2,(new n.UserApiV2Client).ns("awareness_subscriptions").rpc("folder_subscriptions/delete",{identifier:e},{subjectUserId:t})]}))}))},t.editFolderSubscription=function(e,t,o){return r.__awaiter(this,void 0,Promise,(function(){return r.__generator(this,(function(r){return[2,(new n.UserApiV2Client).ns("awareness_subscriptions").rpc("folder_subscriptions/edit",{identifier:e,settings:t},{subjectUserId:o})]}))}))}})),define("modules/clean/react/folder_subscriptions/data/reducer",["require","exports","tslib","immutable","modules/clean/react/folder_subscriptions/data/types"],(function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.folderSubscriptionsReducer=t.defaultFolderSubscriptionsState=void 0,n=r.__importStar(n),t.defaultFolderSubscriptionsState={requests:n.Map(),folderSubscriptions:n.Map()},t.folderSubscriptionsReducer=function(e,n){switch(void 0===e&&(e=t.defaultFolderSubscriptionsState),n.type){case o.ActionTypes.OPTIMISTIC_SET_FOLDER_SUBSCRIPTION:return(function(e,t){var n=t.payload,i=n.path,a=n.folderSubscription;return r.__assign(r.__assign({},e),{requests:e.requests.set(i,{status:o.RequestFlightStatus.INFLIGHT}),folderSubscriptions:e.folderSubscriptions.set(i,a)})})(e,n);case o.ActionTypes.FETCHING_FOLDER_SUBSCRIPTION:return(function(e,t){var n=t.payload.path;return r.__assign(r.__assign({},e),{requests:e.requests.set(n,{status:o.RequestFlightStatus.INFLIGHT})})})(e,n);case o.ActionTypes.CONFIRM_FOLDER_SUBSCRIPTION:return(function(e,t){var n=t.payload,i=n.path,a=n.folderSubscription,s=n.timestamp;return r.__assign(r.__assign({},e),{requests:e.requests.set(i,{status:o.RequestFlightStatus.READY,lastUpdated:s}),folderSubscriptions:e.folderSubscriptions.set(i,a)})})(e,n);case o.ActionTypes.ERROR_FOLDER_SUBSCRIPTION:return(function(e,t){var n=t.payload,i=n.path,a=n.folderSubscription;return r.__assign(r.__assign({},e),{requests:e.requests.set(i,{status:o.RequestFlightStatus.ERROR}),folderSubscriptions:a?e.folderSubscriptions.set(i,a):e.folderSubscriptions})})(e,n)}return e}})),define("modules/clean/react/folder_subscriptions/data/selectors",["require","exports","modules/clean/redux/selectors","modules/clean/redux/namespaces","modules/clean/react/folder_subscriptions/data/types","modules/clean/react/folder_subscriptions/data/reducer"],(function(e,t,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.folderSubscriptions=t.folderSubscription=t.folderSubscriptionState=t.getRequestState=t.getFolderSubscriptionsState=void 0,t.getFolderSubscriptionsState=function(e){return r.getStateAtNamespace(e,n.FOLDER_SUBSCRIPTIONS_NAMESPACE_KEY)||i.defaultFolderSubscriptionsState},t.getRequestState=function(e,r){return t.getFolderSubscriptionsState(e).requests.get(r,{status:o.RequestFlightStatus.IDLE})},t.folderSubscriptionState=function(e,r){var n;return null===(n=t.folderSubscription(e,r))||void 0===n?void 0:n.subscriptionState},t.folderSubscription=function(e,r){return t.folderSubscriptions(e).get(r)},t.folderSubscriptions=function(e){return t.getFolderSubscriptionsState(e).folderSubscriptions}})),define("modules/clean/react/folder_subscriptions/data/store",["require","exports","modules/clean/react/folder_subscriptions/data/reducer","modules/clean/redux/store","modules/clean/redux/namespaces"],(function(e,t,r,n,o){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.getStoreForFolderSubscriptions=void 0,t.getStoreForFolderSubscriptions=function(){var e;return i||(i=n.getStoreAndRegisterReducers(((e={})[o.FOLDER_SUBSCRIPTIONS_NAMESPACE_KEY]=r.folderSubscriptionsReducer,e))),i}})),define("modules/clean/react/folder_subscriptions/follow/snackbar",["require","exports","tslib","react","modules/clean/filepath/filepath","modules/clean/react/snackbar","modules/core/i18n"],(function(e,t,r,n,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showFollowFailedSnackbar=t.showUnfollowErrorSnackbar=t.showUnfollowConfirmationSnackbar=t.showSetOptionsErrorSnackbar=t.showSetOptionsConfirmationSnackbar=t.showFolderSubscriptionSnackbar=void 0,n=r.__importDefault(n);var s=a.intl.formatMessage({id:"JBINyn",defaultMessage:"Close"}),l=a.intl.formatMessage({id:"Wzr+Eu",defaultMessage:"Unfollow"});function c(e){var t=e.callToActionFn,r=e.isSuccess,o=e.message,a=r?"complete":"fail",c=r&&t?l:void 0,d=r?t:void 0,u=r&&t?void 0:s,_=n.default.createElement(i.Snackbar,{title:o,variant:a,actionButtonText:c,onActionClick:d,closeButtonText:u,timeoutDelayMs:5e3,id:"browse-action"});i.Snackbar.show(_)}t.showFolderSubscriptionSnackbar=c,t.showSetOptionsConfirmationSnackbar=function(e){c({isSuccess:!0,message:a.intl.formatMessage({id:"74emIA",defaultMessage:'Notification options for "{folderName}" have been set'},{folderName:o.filename(e)})})},t.showSetOptionsErrorSnackbar=function(e){c({isSuccess:!1,message:a.intl.formatMessage({id:"fwZe/f",defaultMessage:'Couldn\'t set options for "{folderName}"'},{folderName:o.filename(e)})})},t.showUnfollowConfirmationSnackbar=function(e){c({isSuccess:!0,message:a.intl.formatMessage({id:"nQncys",defaultMessage:'You’ll no longer get notifications about "{folderName}"'},{folderName:o.filename(e)})})},t.showUnfollowErrorSnackbar=function(e){c({isSuccess:!1,message:a.intl.formatMessage({id:"/QEApB",defaultMessage:'Unable to unfollow "{folderName}"'},{folderName:o.filename(e)})})},t.showFollowFailedSnackbar=function(e){c({isSuccess:!1,message:a.intl.formatMessage({id:"0G1Llb",defaultMessage:'Unable to follow "{folderName}"'},{folderName:e})})}})),define("modules/clean/pagination_manager",["require","exports","tslib","modules/clean/deprecated_ajax/ajax","modules/core/i18n","modules/core/notify","modules/clean/react/snackbar"],(function(e,t,r,n,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PaginationManager=t.BasePaginationManager=void 0,n=r.__importStar(n);var s=(function(){function e(e){this.hasMoreItems=e}return e.prototype.areAllItemsReady=function(){return!this.hasMoreItems},e.prototype.invalidateHasMore=function(){this.hasMoreItems=!0},e.prototype.addDataToAjax=function(e){},e})(),l=(function(){function e(e){var t=this;this.handleNextPageSuccess=function(e){t.nextRequestVoucher=e.next_request_voucher,t.mode.hasMoreItems=e.has_more_items,t.autoFetching&&t.fetchNext(),t.addPage(e.items)},this.ajaxURL=e.ajaxURL,this.newDataCallback=e.newDataAvailableCallback,this.autoFetching=!1,this.mode=e.mode,this.keyName=e.keyName,this.items={},this.pages=[],this.nextRequestVoucher=e.firstPage.next_request_voucher,this.userID=e.userID,this.fqPathPrefix=e.fqPathPrefix?"/"+e.fqPathPrefix:"",this.addPage(e.firstPage.items),this.fetchNextFn=e.fetchNextFn}return e.prototype.areAllItemsReady=function(){return this.mode.areAllItemsReady()},e.prototype.addPage=function(e){for(var t=[],r=[],n=0,a=e;n<a.length;n++){var s=a[n],l=s[this.keyName];if(null==l)return void i.Notify.warning(o.intl.formatMessage({id:"xlabvw",defaultMessage:"Invalid server response"}));null==this.items[l]&&(this.items[l]=s,r.push(s),t.push(l))}this.pages.push(t),this.newDataCallback(this,r)},e.prototype.startAutoFetching=function(){this.autoFetching=!0,this.fetchNext()},e.prototype.stopAutoFetching=function(){this.autoFetching=!1},e.prototype.reSync=function(e){void 0===e&&(e=!1),e&&(this.nextRequestVoucher=null,this.items={},this.pages=[]);var t=this.autoFetching&&this.mode.areAllItemsReady();this.mode.invalidateHasMore(),t&&this.startAutoFetching()},e.prototype.fetchNext=function(){var e=this;if(!this.mode.areAllItemsReady()){var t={};this.nextRequestVoucher&&(t.voucher=this.nextRequestVoucher),this.mode.addDataToAjax(t),this.fetchNextFn?this.fetchNextFn(this.nextRequestVoucher||"",this.fqPathPrefix,this.userID).then((function(t){e.handleNextPageSuccess(t)})).catch((function(){a.Snackbar.fail(o.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."}),"browse")})):n.WebRequest({url:this.ajaxURL,data:t,dataType:"text",subject_user:this.userID,success:function(t,r){for(var n=JSON.parse(r),o=0,i=n.items;o<i.length;o++){var a=i[o];a.fq_path=e.fqPathPrefix+a.fq_path}var s={next_request_voucher:n.next_request_voucher,has_more_items:n.has_more_items,items:n.items};e.handleNextPageSuccess(s)},error:function(){a.Snackbar.fail(o.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."}),"browse")}})}},e.prototype.loadedPageCount=function(){return this.pages.length},e.prototype.getLoadedPage=function(e){var t=this,r=this.pages[e];return null==r?null:r.map((function(e){return t.items[e]}))},e.prototype.getLastLoadedPage=function(){return this.getLoadedPage(this.loadedPageCount()-1)},e})();t.BasePaginationManager=l;var c=(function(e){function t(t){return e.call(this,r.__assign(r.__assign({},t),{mode:new s(t.firstPage.has_more_items)}))||this}return r.__extends(t,e),t.create=function(e){return new t(e)},t})(l);t.PaginationManager=c})),define("modules/clean/react/browse/actions",["require","exports","tslib","immutable","modules/clean/file_actions/create-folder","modules/clean/file_operations/notifications","modules/clean/filepath/filepath","modules/clean/flux/dispatcher","modules/clean/history","modules/clean/react/async_file_modal_controller","modules/clean/react/browse/api","modules/clean/react/browse/constants","modules/clean/react/browse/data/action_creators/index","modules/clean/react/browse/data/action_creators/file_actions","modules/clean/react/browse/data/selectors","modules/clean/react/browse/data/store","modules/clean/react/file_uploader/constants","modules/clean/react/files_view/types","modules/clean/react/snackbar","modules/clean/sharing/browse_exports","modules/core/i18n","modules/clean/react/browse/fss_experiment_carousel_util","modules/clean/react/browse/model_types"],(function(e,t,r,n,o,i,a,s,l,c,d,u,_,p,f,m,g,h,S,E,v,T,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.browseActions=void 0,n=r.__importStar(n),i=r.__importStar(i),a=r.__importStar(a),l=r.__importDefault(l),c=r.__importStar(c),d=r.__importStar(d),_=r.__importStar(_),p=r.__importStar(p),f=r.__importStar(f);var I=(function(){function I(){var I=this;this.initializeEverything=function(e){var t=e.path,o=e.files,i=e.paginatedTotalNumFiles,a=e.context,l=e.mountPoints,c=e.fqPathsToSelect,d=e.loadingState,p=e.teamFolders,f=e.currentFolderInfo;I.reduxStore.dispatch(_.setPath({path:t})),I.reduxStore.dispatch(_.appendFiles({path:t,files:r.__spreadArrays(o,p),currentFolderInfo:f})),I.reduxStore.dispatch(_.setPaginatedTotalNumFiles({paginatedTotalNumFiles:i})),I.reduxStore.dispatch(_.setMountPoints({mountPoints:l})),I.reduxStore.dispatch(_.setLoadingState({loadingState:d,path:t})),d===h.LoadingState.LOADED?I.reduxStore.dispatch(_.selectFilesByFqPath({fqPathsToSelect:c})):I.reduxStore.dispatch(_.setFilePathsToSelectOnNextUpdate({filePathsToSelectOnNextUpdate:n.Set(c)})),I.reduxStore.dispatch(_.setContext({context:a})),I.reduxStore.dispatch(_.setCurrentFolderInfo({currentFolderInfo:f})),s.Dispatcher.dispatch({type:g.UploaderActionType.SET_PATH,data:{path:t,hasPermissionToUploadToFolder:a.isCurrentPathWriteable(),isMovingIntoVault:a.isInsideVaultFolder}}),s.Dispatcher.dispatch({type:u.SharedWithActionType.BROWSE_FILES_LOADED,data:{parentPath:t,files:o}})},this.addFilesAndSetLoadingState=function(e){var t=e.path,r=e.loadingState,n=e.files,o=e.paginatedTotalNumFiles;I.reduxStore.dispatch(_.appendFiles({path:t,files:n})),I.reduxStore.dispatch(_.setPaginatedTotalNumFiles({paginatedTotalNumFiles:o})),I.reduxStore.dispatch(_.setLoadingState({loadingState:r,path:t})),s.Dispatcher.dispatch({type:u.SharedWithActionType.BROWSE_FILES_LOADED,data:{parentPath:t,files:n}})},this.setUrl=function(e){var t=e.path,r=e.qargs,n=e.expandedBlade,o=e.forceExpandRightRail;I.reduxStore.dispatch(_.setUrl({path:t,qargs:r,expandedBlade:n,forceExpandRightRail:o}))},this.nameNewFolder=function(){I.reduxStore.dispatch(_.setNewFolderCreationState({newFolderCreationState:h.NewFolderCreationState.PENDING_INPUT}))},this.createFolderPending=function(){o.logCreateFolderPending(),I.reduxStore.dispatch(_.setNewFolderCreationState({newFolderCreationState:h.NewFolderCreationState.SAVING_INPUT}))},this.cancelCreateFolder=function(e){o.logCreateFolderCancel(e),I.reduxStore.dispatch(_.setNewFolderCreationState({newFolderCreationState:h.NewFolderCreationState.CREATE_FOLDER_INACTIVE}))},this.createFolderComplete=function(){o.logCreateFolderSuccess(),I.reduxStore.dispatch(_.setNewFolderCreationState({newFolderCreationState:h.NewFolderCreationState.CREATE_FOLDER_INACTIVE})),S.Snackbar.complete(v.intl.formatMessage({id:"a26imc",defaultMessage:"Folder created."}),"browse-action")},this.createFolder=function(e){I.reduxStore.dispatch(_.createFolder(e))},this.createFolderInNewFolderModal=function(e){var r=e.folderName,n=e.isConfidential,o=e.user,i=e.context,a=e.redirectOnSuccess,s=e.redirectOnCancel,l=e.fqPath,c=e.selectCreatedFolder,d=e.origin,u=e.shouldSuppressRedirectToBrowse,_=e.handleSuccessSharing,p=e.handleCancelSharing,f=i?i.currentFQPath:l,m=i?i.rootNSID:o.root_ns_id;if(n&&i&&!i.isInsideTeamFolderTree)E.asyncShowNewFolderShareModal({defaultBasePath:f,initialContentName:r,onCancel:p,onSuccessSharing:_,setUrl:I.setUrl,shouldSuppressRedirectToBrowse:u,user:o});else{var g=(o.is_cdm_member||n)&&!!i&&i.isInsideTeamFolderTree;t.browseActions.createFolder({pathName:f,folderName:r,nsId:m,checkFSWs:!1,showShareModalOnSuccess:g?I.handleShowShareModal:null,redirectOnSuccess:a,redirectOnCancel:s,selectCreatedFolder:c,origin:d})}},this.handleNewFolderRedirectOnSuccess=function(e){I.setUrl({path:e})},this.doDeleteFilesWithModal=function(e){var t=e.files,n=f.user(I.reduxStore.getState()),o=f.context(I.reduxStore.getState());c.showDelete(n,t,o,a.filename(o.currentFQPath),(function(){return r.__awaiter(I,void 0,void 0,(function(){return r.__generator(this,(function(e){return this.reduxStore.dispatch(p.deleteFiles({files:r.__spreadArrays(t),checkFSWs:!0})),[2]}))}))}))},this.purgeSuccessCallback=function(e){t.browseActions.reloadCurrentPath()},this.onPurgeBatch=function(t,n){new Promise((function(t,r){e(["modules/clean/react/trash/actions"],t,r)})).then(r.__importStar).then((function(e){(0,e.purgeByPathBatch)(t,n,I.purgeSuccessCallback)}))},this.doPermanentDeleteWithModal=function(e){var t=f.user(I.reduxStore.getState()),r=f.context(I.reduxStore.getState());c.showPurgeModal({userId:t.id,context:r,files:e,onPurge:I.onPurgeBatch})},this.onRestore=function(e,t,r){d.restoreFiles({files:t,userId:e,onSuccess:function(){i.notifyRestoreSuccess(t)},isSearchMode:r})},this.doRestoreFilesWithUnifiedTrashModal=function(e){var t=e.files,r=f.user(I.reduxStore.getState()),n=f.context(I.reduxStore.getState());c.showUnifiedTrashModal({userId:r.id,context:n,files:t,onRestore:function(e,t){I.onRestore(e,t,!1)}})},this.handleShowRewindPanel=function(){l.default.update_query_param(u.BrowseQueryArg.rewind,"true"),I.reduxStore.dispatch(_.showRewind())},this.fetchFolderSizes=function(e){var t=e.file;return r.__awaiter(I,void 0,Promise,(function(){var e,n,o,i,a,s,l,c;return r.__generator(this,(function(p){switch(p.label){case 0:e=f.user(this.reduxStore.getState()),n=u.MAX_FOLDER_SIZE_ITERATIONS,p.label=1;case 1:return p.trys.push([1,7,,8]),this.reduxStore.dispatch(_.requestFolderSizes({fqPath:t.fq_path})),[4,d.fetchSharedFolderSizes(e.id,{fq_path:t.fq_path})];case 2:return o=p.sent(),this.reduxStore.dispatch(_.setFolderSizesPending({fetchFolderSizesResp:o})),i=[],[4,this.fetchAndSetSameNamespaceFolderSize(e.id,{fq_path:t.fq_path,folder_limit:u.MAX_FOLDERS_PER_CALL})];case 3:(a=p.sent()).queue&&(i=r.__spreadArrays(i,a.queue)),p.label=4;case 4:return i.length>0&&n>0?(n--,s=Math.min(u.MAX_FOLDER_SIZE_QUEUE_SIZE,i.length),l=i.splice(0,s),[4,this.fetchAndSetSameNamespaceFolderSize(e.id,{fq_path:t.fq_path,folder_limit:u.MAX_FOLDERS_PER_CALL,queue:l})]):[3,6];case 5:return(a=p.sent()).queue&&i&&(i=r.__spreadArrays(i,a.queue)),[3,4];case 6:return c=0!==n&&a.queue&&0===a.queue.length?w.FetchFolderSizeState.COMPLETE:w.FetchFolderSizeState.ERROR,this.reduxStore.dispatch(_.completeFolderSizes({fetchFolderSizeState:c})),[3,8];case 7:return p.sent(),this.reduxStore.dispatch(_.setFolderSizesPending({fetchFolderSizesResp:{sizes_dict:[{fq_path:t.fq_path,size:0}],queue:[]}})),this.reduxStore.dispatch(_.completeFolderSizes({fetchFolderSizeState:w.FetchFolderSizeState.ERROR})),[3,8];case 8:return[2]}}))}))},this.fetchMultipleFolderSizes=function(e){var t=e.files;return r.__awaiter(I,void 0,Promise,(function(){var e,n,o;return r.__generator(this,(function(r){switch(r.label){case 0:e=0,n=t.toArray(),r.label=1;case 1:return e<n.length?(o=n[e],[4,this.fetchFolderSizes({file:o})]):[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))},this.handleShowShareModal=function(e,t){var r=f.user(I.reduxStore.getState()),n=f.context(I.reduxStore.getState());E.asyncShowShareModal(r,e,{browseContext:n,origin:t,onCancel:function(){T.asyncShowFssExpr(r,e.ns_id,e.ns_path,e.is_dir)},onSuccessSharing:function(){T.asyncShowFssExpr(r,e.ns_id,e.ns_path,e.is_dir)}},I.setUrl)},this.handleFileUpload=function(){I.reduxStore.dispatch(_.setHasUserUploadedFiles(!0))},this.reduxStore=m.getStoreForBrowse()}return I.prototype.reloadCurrentPath=function(){this.setUrl({path:f.path(this.reduxStore.getState()),qargs:{reload:!0}})},I.prototype.selectRowsFromBoltClient=function(e){void 0===e&&(e=[]),this.reduxStore.dispatch(_.setFilePathsToSelectOnNextUpdate({filePathsToSelectOnNextUpdate:n.Set(e.map((function(e){return e.fq_path})))}))},I.prototype.selectFilesAfterUpload=function(e){var t=e.fqPathsToSelect,r=f.unsortedFilesWithFolderSizes(this.reduxStore.getState());t.every((function(e){return r.has(e)}))?this.reduxStore.dispatch(_.selectFilesByFqPath({fqPathsToSelect:t})):this.reduxStore.dispatch(_.setFilePathsToSelectOnNextUpdate({filePathsToSelectOnNextUpdate:n.Set(t)}))},I.prototype.selectFilesByFqPath=function(e){var t=e.fqPathsToSelect;this.reduxStore.dispatch(_.selectFilesByFqPath({fqPathsToSelect:t}))},I.prototype.setShouldShowDeletedFiles=function(e){e.shouldShowDeletedFiles?l.default.update_query_param(u.BrowseQueryArg.d,"1"):l.default.remove_query_param(u.BrowseQueryArg.d)},I.prototype.fetchAndSetSameNamespaceFolderSize=function(e,t){return r.__awaiter(this,void 0,Promise,(function(){var n;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,d.fetchSameNamespaceFolderSizes(e,t)];case 1:return n=r.sent(),this.reduxStore.dispatch(_.setFolderSizesPending({fetchFolderSizesResp:n})),[2,n]}}))}))},I})();t.browseActions=new I})),define("modules/clean/react/browse/api",["require","exports","tslib","lodash","modules/clean/deprecated_ajax/ajax","api_v2/user_client","modules/clean/filepath/filepath","modules/clean/react/browse/models","modules/core/assert","modules/core/html","modules/core/i18n","modules/core/notify","modules/core/uri","modules/clean/sharing/api/client"],(function(e,t,r,n,o,i,a,s,l,c,d,u,_,p){"use strict";function f(e){try{return JSON.parse(e)}catch(e){if(!(e instanceof SyntaxError))throw e}return null}function m(e){if(void 0===e)return{};for(var t={},r=0,n=e;r<n.length;r++){var o=n[r];void 0!==o.ns_id&&void 0!==o.mount_point&&(t[o.ns_id]=o.mount_point)}return t}Object.defineProperty(t,"__esModule",{value:!0}),t.getFolderMemberCounts=t.fetchSameNamespaceFolderSizes=t.fetchSharedFolderSizes=t.getChangesForDirectory=t.createCloudDoc=t.rollbackChangeSets=t.restoreFiles=t.moveFiles=t.isRewindButtonEnabled=t.copyFiles=t.loadPath2Continue=t.loadPath2=void 0,n=r.__importStar(n),o=r.__importStar(o),a=r.__importStar(a),t.loadPath2=function(e){var t,n,o,a;return r.__awaiter(this,void 0,Promise,(function(){var c,d,u,_,p,f;return r.__generator(this,(function(r){switch(r.label){case 0:return c=e.userId,d=e.path,u=e.sortType,_=e.sortIsAscending,p=e.includeDeleted,[4,(new i.UserApiV2Client).ns("files").rpc("browse",{fq_path:d,include_deleted:p,sort_type:u,sort_is_ascending:_,sort_folders_first:!0,include_xattrs:!0,include_folder_overview:!0},{subjectUserId:c})];case 1:return f=r.sent(),l.assert(void 0!==f.context,"context is undefined"),l.assert(void 0!==f.paginated_file_info,"paginated_file_info is undefined"),l.assert(void 0!==f.total_count,"total_count is undefined"),[2,{folderOverview:null!==(t=f.folder_overview)&&void 0!==t?t:null,mountPoints:m(f.context.ns_id_infos),context:s.BrowseContext.fromApiV2Object(f.context),items:f.paginated_file_info.map((function(e){return e.file_info})),hasMore:null!==(n=f.has_more)&&void 0!==n&&n,nextRequestVoucher:null!==(o=f.next_request_voucher)&&void 0!==o?o:null,paginatedTotalNumFiles:f.total_count,currentFolderInfo:null===(a=f.folder_info)||void 0===a?void 0:a.file_info}]}}))}))},t.loadPath2Continue=function(e,t){return(new i.UserApiV2Client).ns("files").rpc("browse_continue",{cursor:e},{subjectUserId:t})},t.copyFiles=function(e){var t=e.files,r=e.newPath,n=e.userId,i=e.onSuccess,a=e.checkFSWs,l=t.map((function(e){return e.fq_path}));return l.includes(r)?(u.Notify.error(d.intl.formatMessage({id:"wWiDtY",defaultMessage:"You can’t copy a folder into itself."})),!1):(o.WebProgressRequest({url:"/cmd/copy",data:{files:l,to_path:r,fsw_request:a?"check":void 0},dataType:"text",subject_user:n,progress_text:d.intl.formatMessage({id:"AZPIG5",defaultMessage:"Copying files..."}),success:function(e,t){try{var n=JSON.parse(t),o=n.new_browse_files?n.new_browse_files.map(s.File.fromServerObject):[];i({newFiles:o,destinationPath:r,changesets:n.changesets,failureDetails:n.failure_details})}catch(e){}}}),!0)},t.isRewindButtonEnabled=function(e,t){return r.__awaiter(this,void 0,Promise,(function(){return r.__generator(this,(function(r){2;try{return"/"===e&&(e=""),[2,(new i.UserApiV2Client).ns("chronicle").rpc("can_rewind",{path:e,version:2},{subjectUserId:t})]}catch(e){return[2,{can_rewind:!1}]}return[2]}))}))},t.moveFiles=function(e){var t=e.path,r=e.files,n=e.newPath,i=e.userId,l=e.onSuccess,_=e.allowOwnershipTransfer,p=e.checkFSWs;if(void 0!==t&&a.paths_are_equal(t,n))return u.Notify.error(d.intl.formatMessage({id:"V6/bVk",defaultMessage:"Those files already exist in that folder."})),!1;var f=r.map((function(e){return e.fq_path}));return f.includes(n)?(u.Notify.error(d.intl.formatMessage({id:"blAaiJ",defaultMessage:"You can’t move a folder into itself."})),!1):(o.WebProgressRequest({url:"/cmd/move",data:{files:f,to_path:n,allow_ownership_transfer:_,fsw_request:p?"check":void 0},dataType:"text",subject_user:i,progress_text:d.intl.formatMessage({id:"FdTkAn",defaultMessage:"Moving files..."}),skipNotifyError:!_,success:function(e,r){try{var o=JSON.parse(r),i=o.new_browse_files?o.new_browse_files.map(s.File.fromServerObject):[];l({path:t,destinationPath:n,newFiles:i,changesets:o.changesets,failureDetails:o.failure_details})}catch(e){}},error:function(t,r,n){u.Notify.error(new c.HTML(n.message)),e.onError&&e.onError(n.message)}}),!0)},t.restoreFiles=function(e){var t=e.files,r=e.userId,n=e.onSuccess,i=e.isSearchMode;o.WebProgressRequest({url:"/cmd/restore",data:{files:t.map((function(e){return e.fq_path})),source:i?"search":"browse"},dataType:"text",subject_user:r,progress_text:d.intl.formatMessage({id:"kBkLSN",defaultMessage:"Restoring…"}),success:function(){n()}})},t.rollbackChangeSets=function(e){var t=e.userId,r=e.changesets,n=void 0===r?null:r,i=e.progressText,a=e.onSuccess;o.WebProgressRequest({url:"/cmd/rollback",data:{ns_to_cs:JSON.stringify(n)},dataType:"text",subject_user:t,progress_text:i,success:function(){a()}})},t.createCloudDoc=function(e){var t=e.pathName,r=e.title,n=e.documentType,i=e.userId,a=e.onSuccess,l=e.onError,c=e.checkFSWs,d=e.actionSource,u=(t+"/"+r+"."+n).replace("//","/");o.WebRequest({url:new _.URI({path:"/cmd/create_cloud_doc"}).toString(),subject_user:i,data:{to_path:u,title:r,fsw_request:c?"check":void 0,action_source:d},dataType:"text",success:function(e,t){var r=f(t);if(r){var n=r.new_browse_files?s.File.fromServerObject(r.new_browse_files[0]):null;a({changesets:null,createdFile:n,failureDetails:r.failure_details})}},error:function(e,t,r){l(r.message)},skipNotifyError:!0})},t.getChangesForDirectory=function(e){var t=e.path,r=e.userId,i=e.namespaceToJournalIdMap,a=e.onSuccess,s=e.includeDeletedFiles,l={fq_dir:"/"===t?"":t,ns_map:n.map(i,(function(e,t){return t+"_"+e})).join(","),show_deleted:!!s},c=new AbortController;return o.WebRequest({url:"/update/list_dir",subject_user:r,data:l,dataType:"text",signal:c.signal,success:function(e,t){var r=f(t);r&&a(r)}}),c},t.fetchSharedFolderSizes=function(e,t){return(new i.UserApiV2Client).ns("folders").rpc("get_shared_subfolder_sizes",t,{subjectUserId:e})},t.fetchSameNamespaceFolderSizes=function(e,t){return(new i.UserApiV2Client).ns("folders").rpc("get_subfolder_sizes_in_same_namespace",t,{subjectUserId:e})},t.getFolderMemberCounts=function(e,t){return r.__awaiter(this,void 0,Promise,(function(){var n,o;return r.__generator(this,(function(r){switch(r.label){case 0:n=0,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,new p.FolderShareApiClient({userId:t,client:new i.UserApiV2Client}).getMemberCounts({contentId:e})];case 2:return(o=r.sent())?[2,o.total_unique_users]:[2,n];case 3:return r.sent(),[2,n];case 4:return[2]}}))}))}})),define("modules/clean/react/browse/async_extensions",["require","exports","tslib","modules/clean/web_timing_logger","modules/clean/redux/store"],(function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.asyncExtensions=void 0;var i=(function(){function t(){var e=this;this.initOnce=!1,this.emptyState={},this.sharingServiceInfo=function(){return e.emptyState},this.getFeatureFlags=function(){return e.emptyState},this.initializeStore=function(t,r){return e.files=r,e.user=t,o.getStoreAndRegisterReducers({})}}return t.prototype.init=function(){var e=this;this.initOnce||(n.waitForTTI().then((function(){return e.loadExtensionsStore()})),this.initOnce=!0)},t.prototype.loadExtensionsStore=function(){return r.__awaiter(this,void 0,void 0,(function(){var t,n,o,i,a,s,l;return r.__generator(this,(function(c){switch(c.label){case 0:return[4,Promise.all([new Promise((function(t,r){e(["modules/clean/react/extensions/data/store"],t,r)})).then(r.__importStar),new Promise((function(t,r){e(["modules/clean/react/extensions/data/selectors"],t,r)})).then(r.__importStar)])];case 1:return t=c.sent(),n=t[0],o=n.getStore,i=n.initializeStore,a=t[1],s=a.sharingServiceInfo,l=a.getFeatureFlags,o(),this.sharingServiceInfo=s,this.getFeatureFlags=l,this.initializeStore=i,this.user&&this.initializeStore(this.user,this.files),[2]}}))}))},t})();t.asyncExtensions=new i})),define("modules/clean/react/browse/crypto_subtle_digest",["require","exports","tslib"],(function(e,t,r){"use strict";function n(e){if(t.windowHasCryptoSubtleDigest())return new Promise((function(t){window.crypto.subtle.digest("SHA-256",e).then(t)}));throw new Error("window.crypto.subtle.digest not available")}Object.defineProperty(t,"__esModule",{value:!0}),t.hashString=t.encryptArrayBuffer=t.windowHasCryptoSubtleDigest=void 0,t.windowHasCryptoSubtleDigest=function(){return!!window.crypto.subtle&&!!window.crypto.subtle.digest},t.encryptArrayBuffer=n,t.hashString=function(e){return r.__awaiter(this,void 0,Promise,(function(){var o;return r.__generator(this,(function(r){switch(r.label){case 0:if(!t.windowHasCryptoSubtleDigest()||void 0===window.TextEncoder||void 0===window.TextDecoder)return[2,null];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,n((new TextEncoder).encode(e))];case 2:return o=r.sent(),[2,new TextDecoder("utf-16").decode(o)];case 3:return r.sent(),[2,null];case 4:return[2]}}))}))}})),define("modules/clean/react/browse/data/action_creators/index",["require","exports","tslib","lodash","immutable","dropbox/proto/hql_events/browse/web_browse","spectrum-sharing/utils/sharing_constants","modules/clean/file_actions/create-folder","modules/clean/filepath/filepath","modules/clean/filetypes","modules/clean/flux/dispatcher","modules/clean/history","modules/clean/tagging/experiments","modules/clean/hql/index","modules/clean/react/browse/action_logger","modules/clean/react/browse/api","modules/clean/react/browse/async_extensions","modules/clean/react/browse/constants","modules/clean/react/browse/crypto_subtle_digest","modules/clean/react/browse/data/folder_overview_selectors","modules/clean/react/browse/data/helpers","modules/clean/react/browse/data/selectors","modules/clean/react/browse/data/types","modules/clean/react/browse/logger_util","modules/clean/react/browse/models","modules/clean/react/browse/uri_helper","modules/clean/react/file_uploader/constants","modules/clean/react/files_view/data/action_creators","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/file_actions/file_from_metadata","modules/clean/react/files_view/types","modules/clean/react/files_view/sort_types","modules/clean/react/folder_overview/data/action_creators","modules/clean/react/selection","modules/clean/react/snackbar","modules/clean/redux/tests/store","modules/clean/tagging/experiments","modules/clean/web_user_action_events","modules/constants/trademark","modules/core/exception","modules/core/i18n","modules/core/uri","modules/clean/react/browse/right_rail_preferences","modules/clean/tagging/data/action_creators"],(function(e,t,r,n,o,i,a,s,l,c,d,u,_,p,f,m,g,h,S,E,v,T,w,I,b,F,C,O,R,A,y,D,L,M,N,P,U,x,k,V,W,H,B,G){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setCreateMenuOpenRequest=t.setBackupFolders=t.setOverflowMenuCloseRequest=t.setInlineOverflowMenuOpenRequest=t.setOverflowMenuCoordinates=t.setOverflowMenuOpenRequest=t.setFlowsFolderRulesConfig=t.getFlowsFolderRulesConfig=t.expandBlade=t.setFileHasAutomatedRuleMap=t.setRightRailIsCollapsed=t.setHideFilesAndSidebar=t.setViewType=t.setHasUserUploadedFiles=t.showPersonalizationSuggestedFolders=t.setArePostTTIModulesLoaded=t.setIsFileViewerShown=t.appendFiles=t.applyBoltUpdates=t.completeFolderSizes=t.setFolderSizesPending=t.requestFolderSizes=t.setUnsortedFiles=t.setAndStoreSortOrder=t.setShouldShowDeletedFiles=t.clearSelection=t.setSelection=t.setPathData=t.setPath=t.setUrl=t.setPaginatedTotalNumFiles=t.setNewFolderCreationState=t.setMountPoints=t.setLoadingState=t.setFolderSizes=t.createFolder=t.refreshPinnedItems=t.toggleSpacesEntryPoint=t.hideFolderHistoryPanel=t.showFolderHistoryPanel=t.hideRewind=t.showRewind=t.setFolderMemberCounts=t.setIsRewindButtonEnabled=t.setFilePathsToSelectOnNextUpdate=t.resetFileJumpFilter=t.addFileJumpKeyCode=t.setBrowsePostTTIData=t.setBrowsePostTTIExperiments=t.setCurrentFolderInfo=t.setContext=t.pasteFilesFromClipboard=t.setFilesToClipboard=t.setCanDisplayFolderSizes=t.selectFilesByFqPath=t.popBoltIgnore=t.pushBoltIgnore=t.handleAppCleanup=t.appInit=void 0,n=r.__importStar(n),o=r.__importStar(o),s=r.__importStar(s),l=r.__importStar(l),u=r.__importDefault(u),m=r.__importStar(m),E=r.__importStar(E),T=r.__importStar(T),I=r.__importStar(I),O=r.__importStar(O),R=r.__importStar(R),B=r.__importStar(B),t.appInit=function(e){var t=e.props,r=e.user,n=e.viewer;return function(e){e({type:w.ActionTypes.APP_INIT,payload:{props:t,user:r,viewer:n}}),e(O.loadScopedSortOrders({user:r,defaultSort:{sortField:D.SortField.FILENAME,sortDirection:D.SortDirection.ASCENDING}})),d.Dispatcher.dispatch({type:C.UploaderActionType.SET_USER,data:{user:r}})}},t.handleAppCleanup=function(){return{type:w.ActionTypes.HANDLE_APP_CLEANUP}},t.pushBoltIgnore=function(e){return{type:w.ActionTypes.PUSH_BOLT_IGNORE,payload:e}},t.popBoltIgnore=function(e){return{type:w.ActionTypes.POP_BOLT_IGNORE,payload:e}},t.selectFilesByFqPath=function(e){var t=e.fqPathsToSelect;return{type:w.ActionTypes.SELECT_FILES_BY_FQ_PATH,payload:{fqPathsToSelect:t}}},t.setCanDisplayFolderSizes=function(e){var t=e.canDisplayFolderSizes;return{type:w.ActionTypes.SET_CAN_DISPLAY_FOLDER_SIZES,payload:{canDisplayFolderSizes:t}}};var q=function(e){var t=e.clipboard;return{type:w.ActionTypes.SET_CLIPBOARD_FILES,payload:{clipboard:t}}};t.setFilesToClipboard=function(e){var t=e.clipboard;return function(e){var r=t.files;r.length&&(r.some((function(e){return e.isDeleted||e.is_unmounted}))?N.Snackbar.fail(W.intl.formatMessage({id:"jdnaZR",defaultMessage:"Deleted files cannot be added to the clipboard"}),"browse-clipboard-copy"):r.some(b.File.isTeamSharedFolder)||r.some(b.File.isTeamMemberFolder)?N.Snackbar.fail(W.intl.formatMessage({id:"0Nkg/N",defaultMessage:"Team Folders cannot be added to the clipboard"}),"browse-clipboard-copy"):r.some(b.File.isFamilySharedFolder)?N.Snackbar.fail(W.intl.formatMessage({id:"KMcV0/",defaultMessage:"Family shared folders cannot be added to the clipboard"}),"browse-clipboard-copy"):r.some((function(e){return e.type===c.FileTypes.VAULT_FOLDER}))?N.Snackbar.fail(W.intl.formatMessage({id:"La991r",defaultMessage:"{TRADEMARK_VAULT} cannot be added to the clipboard"},{TRADEMARK_VAULT:k.TRADEMARK_VAULT}),"browse-clipboard-copy"):(N.Snackbar.complete(W.intl.formatMessage({id:"BvUPS9",defaultMessage:"{count, plural, one{Added {count} item to clipboard.} other{Added {count} items to clipboard.}}"},{count:r.length}),"browse-clipboard-copy"),e(q({clipboard:t}))))}},t.pasteFilesFromClipboard=function(e){var t=e.copyFiles,r=e.moveFiles;return function(e,n){var o=n(),i=T.user(o),a=T.clipboard(n()),s=a.files,c=a.action,d=T.path(n());s.length<=0||("cut"===c?(l.paths_are_equal(l.parent_dir(s[0].fq_path),d)||r({user:i,files:s,newPath:"/"===d?"":d,checkFSWs:!0,synchronousSingleFileActions:!!T.postTTIExperiments(n()).expSynchronousSingleFileActions}),e(q({clipboard:{files:[]}}))):t({user:i,files:s,newPath:d,checkFSWs:!0,isPasteAction:!0,synchronousSingleFileActions:Boolean(T.postTTIExperiments(n()).expSynchronousSingleFileActions),onSuccess:function(e){}}))}},t.setContext=function(e){var t=e.context;return{type:w.ActionTypes.SET_CONTEXT,payload:{context:t}}},t.setCurrentFolderInfo=function(e){var t=e.currentFolderInfo;return{type:w.ActionTypes.SET_CURRENT_FOLDER_INFO,payload:{currentFolderInfo:t}}},t.setBrowsePostTTIExperiments=function(e){var t=e.browsePostTTIExperiments;return{type:w.ActionTypes.SET_BROWSE_POST_TTI_EXPERIMENTS,payload:{browsePostTTIExperiments:t}}},t.setBrowsePostTTIData=function(e){var t=e.browsePostTTIData,n=r.__assign({},t);return Object.keys(n).forEach((function(e){void 0===n[e]&&delete n[e]})),{type:w.ActionTypes.SET_BROWSE_POST_TTI_DATA,payload:{browsePostTTIData:n}}};var z=function(e){var t=e.fileJumpFilter;return{type:w.ActionTypes.SET_FILE_JUMP_FILTER,payload:{fileJumpFilter:t}}};t.addFileJumpKeyCode=function(e){var r=e.keyChar;return function(e,n){var o=T.fileJumpFilter(n())+r.toLowerCase();e(z({fileJumpFilter:o}));for(var i=null,a=0,s=T.fileJumpIndex(n());a<s.length;a++){var l=s[a],c=l.fqPath;if(l.filename>=o){i=c;break}}null!=i&&e(t.selectFilesByFqPath({fqPathsToSelect:[i]}))}},t.resetFileJumpFilter=function(){return function(e,t){f.logKeyboardShortcutUsage({user_id:T.user(t()).id,keyboard_shortcut_type:"jump",view_type:R.selectViewType(t(),{instanceId:h.BROWSE_FILES_VIEW_ID})}),e(z({fileJumpFilter:""}))}},t.setFilePathsToSelectOnNextUpdate=function(e){var t=e.filePathsToSelectOnNextUpdate;return{type:w.ActionTypes.SET_FILE_PATHS_TO_SELECT_ON_NEXT_UPDATE,payload:{filePathsToSelectOnNextUpdate:t}}},t.setIsRewindButtonEnabled=function(e){return function(t,n){return r.__awaiter(void 0,void 0,void 0,(function(){var n,o,i;return r.__generator(this,(function(r){switch(r.label){case 0:return n=e.path,o=e.userId,e.userSkuHasRewind?[4,m.isRewindButtonEnabled(n,o)]:(t({type:w.ActionTypes.SET_IS_REWIND_ENABLED,payload:{value:!0}}),[2]);case 1:return i=r.sent(),t({type:w.ActionTypes.SET_IS_REWIND_ENABLED,payload:{value:!!i.can_rewind}}),[2]}}))}))}},t.setFolderMemberCounts=function(e){return function(t,n){return r.__awaiter(void 0,void 0,void 0,(function(){var n,o,i;return r.__generator(this,(function(r){switch(r.label){case 0:return n=e.contentId,o=e.userId,[4,m.getFolderMemberCounts(n,o)];case 1:return i=r.sent(),t({type:w.ActionTypes.SET_FOLDER_MEMBER_COUNTS,payload:{value:i}}),[2]}}))}))}},t.showRewind=function(){return{type:w.ActionTypes.SHOW_TIMELINE,payload:{timestamp:(new Date).getTime()}}},t.hideRewind=function(){return{type:w.ActionTypes.HIDE_TIMELINE,payload:{}}},t.showFolderHistoryPanel=function(){return{type:w.ActionTypes.SHOW_FOLDER_HISTORY_PANEL,payload:{timestamp:(new Date).getTime()}}},t.hideFolderHistoryPanel=function(){return{type:w.ActionTypes.HIDE_FOLDER_HISTORY_PANEL,payload:{}}},t.toggleSpacesEntryPoint=function(e){var t=e.value;return{type:w.ActionTypes.TOGGLE_SPACES_ENTRY_POINT,payload:{value:t}}},t.refreshPinnedItems=function(){return function(e,t){return r.__awaiter(void 0,void 0,void 0,(function(){var n;return r.__generator(this,(function(r){return n=E.folderOverviewFolderFileId(t()),e(L.reloadContentReferences({folderFileId:n,componentNamespace:h.BrowseFolderOverviewComponentNamespace})),[2]}))}))}},t.createFolder=function(e){var n=e.pathName,o=e.folderName,i=e.checkFSWs,l=e.showShareModalOnSuccess,c=e.redirectOnSuccess,d=e.redirectOnCancel,u=e.selectCreatedFolder,_=void 0===u||u,p=e.origin;return function(e,u){return r.__awaiter(void 0,void 0,void 0,(function(){var f,m,g;return r.__generator(this,(function(r){switch(r.label){case 0:return f=T.user(u()),e(t.setNewFolderCreationState({newFolderCreationState:y.NewFolderCreationState.SAVING_INPUT})),[4,s.createFolder({destination:n,name:o,user:f,checkFsw:i,origin:p,surface:"browse"})];case 1:return m=r.sent(),e(t.setNewFolderCreationState({newFolderCreationState:y.NewFolderCreationState.CREATE_FOLDER_INACTIVE})),"success"===m.type?(g=A.folderFromFolderMetadata(m.folder),_&&e(t.selectFilesByFqPath({fqPathsToSelect:[g.fq_path]})),c&&c(g.fq_path),l&&l(g,a.SHARE_ACTION_ORIGIN_TYPE.BROWSE_NEW_FOLDER_MODAL)):d&&d(),[2]}}))}))}},t.setFolderSizes=function(e){var t=e.folderSizes;return{type:w.ActionTypes.SET_FOLDER_SIZES,payload:{folderSizes:t}}},t.setLoadingState=function(e){var t=e.loadingState,r=e.path;return{type:w.ActionTypes.SET_LOADING_STATE,payload:{loadingState:t,path:r}}},t.setMountPoints=function(e){var t=e.mountPoints;return{type:w.ActionTypes.SET_MOUNT_POINTS,payload:{mountPoints:t}}},t.setNewFolderCreationState=function(e){var t=e.newFolderCreationState;return{type:w.ActionTypes.SET_NEW_FOLDER_CREATION_STATE,payload:{newFolderCreationState:t}}},t.setPaginatedTotalNumFiles=function(e){var t=e.paginatedTotalNumFiles;return{type:w.ActionTypes.SET_PAGINATED_TOTAL_NUM_FILES,payload:{paginatedTotalNumFiles:t}}},t.setUrl=function(e){var o=e.path,i=void 0===o?"":o,a=e.qargs,s=e.expandedBlade,l=void 0===s?"info":s,c=e.forceExpandRightRail,d=void 0!==c&&c;return function(e,o){u.default.push_state(T.urlPrefix(o())+H.URI.encode_parts(i),n.omitBy(r.__assign(r.__assign({},n.pick(F.getQueryArgs(),["d"])),a),n.isUndefined)),e(t.clearSelection({skipLogging:!0})),e(t.expandBlade(l)),d&&e(t.setRightRailIsCollapsed(!1))}},t.setPath=function(e){var t=e.path;return function(e,n){return r.__awaiter(void 0,void 0,void 0,(function(){var n;return r.__generator(this,(function(r){switch(r.label){case 0:return e({type:w.ActionTypes.SET_PATH,payload:{path:t}}),[4,S.hashString(t)];case 1:return(n=r.sent())||V.reportException({err:new Error("hashString returned null"),tags:["browse"],severity:V.SEVERITY.NONCRITICAL}),e({type:w.ActionTypes.SET_VIEW_SCOPE,payload:{viewScope:n}}),t&&(document.title=W.intl.formatMessage({id:"dbYCaa",defaultMessage:"{folder_name} - Dropbox"},{folder_name:l.filename(t,W.intl.formatMessage({id:"bObFEu",defaultMessage:"Files"}))})),[2]}}))}))}},t.setPathData=function(e){var n=e.path,i=e.files,a=e.paginatedTotalNumFiles,s=e.context,c=e.currentFolderInfo;return function(e,u){if(l.paths_are_equal(n,T.path(u()))){var _=o.Map(i.map((function(e){return[e.fq_path,e]})));e(t.setContext({context:s})),e(t.setCurrentFolderInfo({currentFolderInfo:c})),t.setUnsortedFiles({unsortedFiles:_})(e,u,P.mockExtraArguments),e(t.setPaginatedTotalNumFiles({paginatedTotalNumFiles:a})),e(t.clearSelection({skipLogging:!0})),j({unsortedFiles:_})(e,u,P.mockExtraArguments),U.isFetchTagsOnBrowseEnabled(T.manualTaggingVariant(u()))&&e(G.fetchTagsForFiles({user:T.user(u()),files:c?r.__spreadArrays(i,[c]):r.__spreadArrays(i),override:!0})),setTimeout((function(){d.Dispatcher.dispatch({type:h.SharedWithActionType.BROWSE_FILES_LOADED,data:{parentPath:n,files:i}}),d.Dispatcher.dispatch({type:C.UploaderActionType.SET_PATH,data:{path:n,hasPermissionToUploadToFolder:s.isCurrentPathWriteable(),isMovingIntoVault:s.isInsideVaultFolder}})}),1)}}},t.setSelection=function(e){var t=e.selection,r=e.actionSource,n=e.skipLogging;return function(e,o){if(!n){var a=o(),s=I.makeSelectionEvent(T.selection(a),t),l=s.event,c=s.itemId,d=T.selectFileByFullPath(a,{path:c}),u=T.experiments(a).browseWebHqlPilot;if(d){var _=I.countFilesAndFolders(T.selectFilesForSelection(a,{selection:t})),m=_.num_files_selected,g=_.num_folders_selected;u&&l===x.WebUserActionLogEvent.SELECT_ROW&&p.logEvent(i.hql_events.WebBrowseSelectRow.create({actionSource:r})),f.logBrowseAction({uid:T.user(a).id,action:l,action_source:r,num_files_selected:m,num_folders_selected:g,view_type:R.selectViewType(o(),{instanceId:h.BROWSE_FILES_VIEW_ID}),result:d,extra:{entity_type:d.is_dir?"folder":"file"}})}}e({type:w.ActionTypes.SET_SELECTION,payload:{selection:t,actionSource:r}}),K(e,o,t)}},t.clearSelection=function(e){var r=void 0===e?{}:e,n=r.actionSource,o=r.skipLogging;return t.setSelection({actionSource:n,skipLogging:o,selection:M.createSelection()})},t.setShouldShowDeletedFiles=function(e){var t=e.shouldShowDeletedFiles;return{type:w.ActionTypes.SET_SHOULD_SHOW_DELETED_FILES,payload:{shouldShowDeletedFiles:t}}};t.setAndStoreSortOrder=function(e){return function(t,r){var n=r(),o=T.user(n);f.logSortRecords({uid:o.id,sort_by:e.sortField,sort_direction:e.sortDirection,view_type:R.selectViewType(n,{instanceId:h.BROWSE_FILES_VIEW_ID})}),t(O.setSort({user:o,sort:e,viewScope:R.selectViewTypeScope(n,{instanceId:h.BROWSE_FILES_VIEW_ID}),updateGlobalScope:!0})),t((function(e){var t=e.sortOrder;return{type:w.ActionTypes.SET_SORT_ORDER,payload:{sortOrder:t}}})({sortOrder:e}))}},t.setUnsortedFiles=function(e){var t=e.unsortedFiles;return function(e,n){return r.__awaiter(void 0,void 0,void 0,(function(){var o;return r.__generator(this,(function(r){return o=T.user(n()),e({type:w.ActionTypes.SET_UNSORTED_FILES,payload:{unsortedFiles:t}}),g.asyncExtensions.initializeStore(o,t.toArray()),[2]}))}))}},t.requestFolderSizes=function(e){var t=e.fqPath;return{type:w.ActionTypes.REQUEST_FOLDER_SIZES,payload:{fqPath:t}}},t.setFolderSizesPending=function(e){var t=e.fetchFolderSizesResp;return{type:w.ActionTypes.SET_FOLDER_SIZES_PENDING,payload:{fetchFolderSizesResp:t}}},t.completeFolderSizes=function(e){var t=e.fetchFolderSizeState;return{type:w.ActionTypes.COMPLETE_FOLDER_SIZES,payload:{fetchFolderSizeState:t}}},t.applyBoltUpdates=function(e){var r=e.path,n=e.updates;return function(e,o){var i=n.parent_changes,a=T.user(o());if(l.paths_are_equal(r,T.path(o()))){if(i&&i.change_to_fq_path)return v.showUserNotificationForPathChange(a,i),void t.setUrl({path:i.change_to_fq_path})(e,o,P.mockExtraArguments);(function(e,r,n){var o=n.mount_points,i=T.path(r()),a=v.getMountPointUpdateForCurrentPath(o,i,T.mountPoints(r())),s=a[0],l=a[1];s&&!l&&N.Snackbar.complete(W.intl.formatMessage({id:"QB9ZqK",defaultMessage:"The folder was unshared."}),"browse-unshare");var c=v.getPathForNewMountPoint(s,l,i);if(c)return void e(t.setPath({path:c}));e(t.setMountPoints({mountPoints:o}))})(e,o,n),(function(e,r,n){var o=n.added,i=n.moved,a=n.removed,s=T.path(r()),c=T.unsortedFiles(r()),u=T.folderSizes(r()),_=c.size,p={added:new Set([]),moved:new Set([]),removed:new Set([])};e(t.popBoltIgnore(p)),(c=c.withMutations((function(e){u=u.withMutations((function(t){for(var r=function(t){(function(e){return l.paths_are_equal(l.parent_dir(e.fq_path),s)})(t)&&(e.set(t.fq_path,b.File.fromServerObject(t)),_+=1)},n=function(n,o){var i=e.get(n);if(!(i&&i.sjid>=o.sjid&&n===o.fq_path)){e.remove(n),r(o);var a=t.get(n);a&&(t.remove(n),t.set(o.fq_path,a))}},c=0,d=o;c<d.length;c++){var u=d[c];e.has(u.fq_path)?n(u.fq_path,u):r(u)}for(var p=0,f=i;p<f.length;p++){var m=f[p],g=m[0];u=m[1];e.has(g)?n(g,u):r(u)}for(var h=function(r){var n=e.find((function(e){return e.fq_path.toLowerCase()===r.toLowerCase()}));n&&(function(r){e.remove(r),t.remove(r),_-=1})(n.fq_path)},S=0,E=a;S<E.length;S++){h(g=E[S])}}))}))).size!==_&&V.reportException({err:new Error("applyBoltUpdates ended up with unexpected number of items"),tags:["browse_file_collections_mismatch"],severity:V.SEVERITY.CRITICAL,exc_extra:{expected_unsorted_files_size:_,actual_unsorted_files_size:c.size,is_deleted_files_on:T.shouldShowDeletedFiles(r()),filesAdded:o,filesRemoved:a,filesMove:i}});c!==T.unsortedFiles(r())&&(t.setUnsortedFiles({unsortedFiles:c})(e,r,P.mockExtraArguments),d.Dispatcher.dispatch({type:h.SharedWithActionType.BROWSE_FILES_UPDATED,data:{parentPath:s,files:c.toArray()}}));u!==T.folderSizes(r())&&e(t.setFolderSizes({folderSizes:u}));j({unsortedFiles:c})(e,r,P.mockExtraArguments)})(e,o,n),_.isTaggingEnabled(T.manualTaggingVariant(o()))&&(function(e,t,r,n){if(0===r.moved.length)return;for(var o=[],i=0,a=r.moved;i<a.length;i++){var s=a[i][1].fq_path,l=T.selectFileByFullPath(t(),{path:s});void 0!==l&&o.push(l)}e(G.fetchTagsForFiles({user:n,files:o}))})(e,o,n,a)}}};var j=function(e){var r=e.unsortedFiles;return function(e,n){var i=T.filePathsToSelectOnNextUpdate(n()).toArray(),a=i.filter((function(e){return r.has(e)})),s=i.filter((function(e){return!r.has(e)}));0!==a.length&&(e(t.selectFilesByFqPath({fqPathsToSelect:a})),e(t.setFilePathsToSelectOnNextUpdate({filePathsToSelectOnNextUpdate:o.Set(s)})))}};t.appendFiles=function(e){var n=e.path,i=e.files,a=e.currentFolderInfo;return function(e,s){if(l.paths_are_equal(n,T.path(s()))){var c=T.unsortedFiles(s()).size,u=T.unsortedFiles(s()).merge(o.Map(i.map((function(e){return[e.fq_path,e]}))));t.setUnsortedFiles({unsortedFiles:u})(e,s,P.mockExtraArguments),j({unsortedFiles:u})(e,s,P.mockExtraArguments),U.isFetchTagsOnBrowseEnabled(T.manualTaggingVariant(s()))&&(a=null!=a?a:T.getCurrentFolderInfo(s()),e(G.fetchTagsForFiles({user:T.user(s()),files:a?r.__spreadArrays(i,[a]):r.__spreadArrays(i),override:0===c}))),setTimeout((function(){d.Dispatcher.dispatch({type:h.SharedWithActionType.BROWSE_FILES_LOADED,data:{parentPath:n,files:i}})}),1),u.size!==c+i.length&&V.reportException({err:new Error("appendFiles ended up with unexpected number of files."),tags:["browse_file_collections_mismatch"],severity:V.SEVERITY.CRITICAL,exc_extra:{previous_unsorted_files_size:c,incoming_files_size:i.length,updated_unsorted_files_size:u.size,is_deleted_files_on:T.shouldShowDeletedFiles(s())}})}}},t.setIsFileViewerShown=function(e){var t=e.isShown;return{type:w.ActionTypes.SET_IS_FILE_VIEWER_SHOWN,payload:{isShown:t}}},t.setArePostTTIModulesLoaded=function(e){var t=e.arePostTTIModulesLoaded;return{type:w.ActionTypes.SET_ARE_POST_TTI_MODULES_LOADED,payload:{arePostTTIModulesLoaded:t}}};var K=function(e,t,r){if(r&&0!==r.selected.count()){var n=T.unsortedFiles(t()),o=null==n?void 0:n.filter((function(e){return r.selected.has(e.fq_path)&&!e.thumbnail_url_tmpl})),i=[];if(null==o||o.forEach((function(e){i.push({file_id:e.file_id,sj_id:e.sjid,ns_id:e.ns_id})})),i.length>0){var a=T.user(t()).id;e(O.loadPreviewThumbnails(i,a,h.BROWSE_FILES_VIEW_ID))}}};t.showPersonalizationSuggestedFolders=function(e){return{type:w.ActionTypes.SHOW_PERSONALIZATION_SUGGESTED_FOLDERS,payload:{showSuggestedFolders:e}}},t.setHasUserUploadedFiles=function(e){return{type:w.ActionTypes.SET_HAS_USER_UPLOADED_FILES,payload:{hasUserUploadedFiles:e}}},t.setViewType=function(e){return function(t,r){var n=r();t(O.setViewType({user:T.user(n),viewType:e,viewTypeScope:T.selectViewTypeScope(n),updateGlobalScope:!0}))}},t.setHideFilesAndSidebar=function(e){var t=e.shouldHideFilesAndSidebar;return{type:w.ActionTypes.SET_HIDE_FILES_AND_SIDEBAR,payload:{shouldHideFilesAndSidebar:t}}},t.setRightRailIsCollapsed=function(e){return function(t,r){var n=T.user(r());t({type:w.ActionTypes.SET_RIGHTRAIL_IS_COLLAPSED,payload:{collapsed:e}}),B.setIsCollapsed(n.id,e)}},t.setFileHasAutomatedRuleMap=function(e){var t=e.fileHasAutomatedRuleMap;return{type:w.ActionTypes.SET_FILE_HAS_AUTOMATED_RULE_MAP,payload:{fileHasAutomatedRuleMap:t}}},t.expandBlade=function(e){return{type:w.ActionTypes.SET_EXPANDED_BLADE,payload:{expandedBlade:e}}},t.getFlowsFolderRulesConfig=function(){return function(n){return r.__awaiter(void 0,void 0,void 0,(function(){var o,i,a,s,l,c,d;return r.__generator(this,(function(u){switch(u.label){case 0:return n(t.setFlowsFolderRulesConfig({status:"pending"})),[4,new Promise((function(t,r){e(["modules/clean/react/flows/lib/api"],t,r)})).then(r.__importStar)];case 1:o=u.sent(),u.label=2;case 2:return u.trys.push([2,4,,5]),[4,o.getFolderRulesConfig()];case 3:return i=u.sent(),a=(null===(c=i.folder_rules_config)||void 0===c?void 0:c.actions)||[],s=(null===(d=i.folder_rules_config)||void 0===d?void 0:d.action_experiments)||[],n(t.setFlowsFolderRulesConfig({status:"completed",data:a,hasDashboardAccess:Boolean(i.exp_flows_dashboard_ui),newApplyToExistingFiles:i.new_apply_to_existing_files,actionExperiments:s})),[3,5];case 4:return l=u.sent(),n(t.setFlowsFolderRulesConfig({status:"errored",error:l.message})),[3,5];case 5:return[2]}}))}))}},t.setFlowsFolderRulesConfig=function(e){return{type:w.ActionTypes.SET_FLOWS_FOLDER_RULES_CONFIG,payload:{folderRulesConfig:e}}},t.setOverflowMenuOpenRequest=function(e){return{type:w.ActionTypes.SET_OVERFLOW_MENU_OPEN_REQUEST,payload:{overflowMenuOpenRequest:e}}},t.setOverflowMenuCoordinates=function(e){return{type:w.ActionTypes.SET_OVERFLOW_MENU_COORDINATES,payload:{overflowMenuCoordinates:e}}},t.setInlineOverflowMenuOpenRequest=function(e){return{type:w.ActionTypes.SET_INLINE_OVERFLOW_MENU_OPEN_REQUEST,payload:{inlineOverflowMenuOpenRequest:e}}},t.setOverflowMenuCloseRequest=function(e){return{type:w.ActionTypes.SET_OVERFLOW_MENU_CLOSE_REQUEST,payload:{overflowMenuCloseRequest:e}}},t.setBackupFolders=function(t){return function(n,o){return r.__awaiter(void 0,void 0,void 0,(function(){var i;return r.__generator(this,(function(a){switch(a.label){case 0:return null!==T.backupFolders(o())?[2]:[4,new Promise((function(t,r){e(["modules/clean/sync_everything/api"],t,r)})).then(r.__importStar)];case 1:return[4,(0,a.sent().fetchBackups)(t)];case 2:return i=a.sent(),n({type:w.ActionTypes.SET_BACKUP_FOLDERS,payload:{backupFolders:i.map((function(e){return e.browsePath.substring(e.browsePath.indexOf("/",1))}))}}),[2]}}))}))}},t.setCreateMenuOpenRequest=function(e){return{type:w.ActionTypes.SET_CREATE_MENU_OPEN_REQUEST,payload:{createMenuOpenRequest:e}}}})),define("modules/clean/react/browse/data/action_creators/file_actions",["require","exports","tslib","modules/clean/file_actions/metrics","modules/clean/file_actions/strings","modules/clean/filepath/filepath","modules/clean/metrics/index","modules/clean/react/async_file_modal_controller","modules/clean/react/browse/action_logger","modules/clean/react/browse/constants","modules/clean/react/browse/data/action_creators/index","modules/clean/react/browse/data/selectors","modules/clean/react/browse/logger_util","modules/clean/react/browse/models","modules/clean/react/files_view/data/action_creators","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/file_actions/api_v2","modules/clean/react/files_view/file_actions/file_from_metadata","modules/clean/react/files_view/file_actions/rollback","modules/clean/react/files_view/file_actions/snackbars","modules/clean/react/files_view/types","modules/clean/tagging/data/action_creators","modules/clean/react/snackbar","modules/clean/undo","modules/clean/web_user_action_events","modules/core/i18n","modules/core/exception","modules/clean/react/browse/data/selectors"],(function(e,t,r,n,o,i,a,s,l,c,d,u,_,p,f,m,g,h,S,E,v,T,w,I,b,F,C,O){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renameFile=t.renameUndo=t.deleteFiles=void 0,i=r.__importStar(i),s=r.__importStar(s),u=r.__importStar(u),_=r.__importStar(_),f=r.__importStar(f),m=r.__importStar(m),g=r.__importStar(g),E=r.__importStar(E),O=r.__importStar(O);var R=function(e){var t=e.state,r=e.eventName,n=e.num_files_selected,o=e.num_folders_selected,i=e.batch_success_count,a=e.batch_fail_count,s=e.lookup_error_type,d=e.error_summary;l.logBrowseAction({uid:u.user(t).id,action:r,num_files_selected:n,num_folders_selected:o,view_type:m.selectViewType(t,{instanceId:c.BROWSE_FILES_VIEW_ID}),batch_success_count:i,batch_fail_count:a,lookup_error_type:s,error_summary:d})};t.deleteFiles=function(e){var l=e.files,c=e.checkFSWs;return function(e,f){return r.__awaiter(void 0,void 0,void 0,(function(){var m,h,v,T,C,O,A,y,D,L,M,N,P,U,x,k,V,W,H;return r.__generator(this,(function(B){switch(B.label){case 0:return m=u.user(f()),h=u.path(f()),v=u.shouldShowDeletedFiles(f()),T=a.getMetricsReporter(),C={surface:"browse",batchSizeBucket:n.bucketForBatchSize(l.length),contentType:n.batchContentType(l)},O=T.createTimer({ns:n.FILE_ACTIONS_AMP_NAMESPACE,name:"delete/batch/latency_total_ms"},C),A=Date.now(),y=T.createStats({ns:n.FILE_ACTIONS_AMP_NAMESPACE,name:"delete/batch/latency_average_ms"},C),D=T.createStats({ns:n.FILE_ACTIONS_AMP_NAMESPACE,name:"delete/batch/completed"},C),w.Snackbar.sync(F.intl.formatMessage(o.deleteSnackbarProgressMessage,{count:l.length}),!0,"browse-action"),1!==l.length||v||e(d.pushBoltIgnore({removed:new Set([l[0].fq_path])})),R({state:f(),eventName:b.WebUserActionLogEvent.DELETE_REQUEST_ATTEMPT,num_files_selected:l.length,num_folders_selected:0}),[4,g.deleteFiles(l,m.id,c)];case 1:return(L=B.sent()).isError&&"path"===L.error[".tag"]&&"file_system_warnings"===L.error.path[".tag"]?(e((function(e){var n=e.files,i=e.details;return function(e,a){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(r){return w.Snackbar.close("browse-action"),s.showFileSystemWarningsModal({fsws:i,onFinalAccept:function(){e(t.deleteFiles({files:n,checkFSWs:!1}))},confirmText:F.intl.formatMessage(o.deleteFswConfirmText)}),[2]}))}))}})({files:l,details:L.error.path.details})),[2]):(O.record(),y.record((Date.now()-A)/l.length),L.isError?(e((function(e){var t=e.files,n=e.result;return function(e,o){return r.__awaiter(void 0,void 0,void 0,(function(){var i,a,s,l,c;return r.__generator(this,(function(r){return i=u.shouldShowDeletedFiles(o()),1!==t.length||i||e(d.popBoltIgnore({removed:new Set([t[0].fq_path])})),w.Snackbar.fail(E.deleteError(t.length,n.error),"browse-action"),a=u.selectedFiles(o()),s=_.countFilesAndFolders(a),l=s.num_files_selected,c=s.num_folders_selected,R({state:o(),eventName:b.WebUserActionLogEvent.DELETE_REQUEST_FAIL,num_files_selected:l,num_folders_selected:c,batch_success_count:0,batch_fail_count:t.length,error_summary:n.error_summary}),[2]}))}))}})({files:l,result:L})),D.record(0),[2]):(M=function(e){return"success"===e[".tag"]},N=L.result.entries.filter(M),e((function(e){var t=e.pathAtRequestTime,n=e.successEntries;return function(e,o){return r.__awaiter(void 0,void 0,void 0,(function(){var a,s,l,c;return r.__generator(this,(function(_){return a=u.shouldShowDeletedFiles(o()),i.paths_are_equal(u.path(o()),t)?(s=n.map((function(e){return e.metadata.path_display})),l=u.unsortedFiles(o()),c=s.reduce((function(e,t){if(void 0===t)return e;var n=l.get(t);return a&&void 0!==n?e.set(t,new p.File(r.__assign(r.__assign({},n),{isDeleted:!0}))):e.delete(t)}),l),e(d.setUnsortedFiles({unsortedFiles:c})),[2]):[2]}))}))}})({pathAtRequestTime:h,successEntries:N})),P=(function(e,t){return function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(r){return w.Snackbar.close("browse-action"),R({state:e,eventName:b.WebUserActionLogEvent.DELETE_UNDO,num_files_selected:t.result.changeset_data.length,num_folders_selected:0}),S.rollback({changeset_data:t.result.changeset_data,userId:u.user(e).id,onSuccess:function(){w.Snackbar.complete(F.intl.formatMessage(o.deleteUndoSnackbarMessage),"browse-action"),R({state:e,eventName:b.WebUserActionLogEvent.DELETE_UNDO_REQUEST_SUCCESS,num_files_selected:t.result.changeset_data.length,num_folders_selected:0})}}),[2]}))}))}})(f(),L),I.setHandleUndo(P),U=L.result.entries.filter(g.isFailure),void 0!==(x=U[0])&&(W=x.failure,k=W[".tag"],g.isPathLookupFailure(W)&&(V=W.path_lookup[".tag"])),H=L.result.entries.filter((function(e){return g.isFailure(e)&&!g.isPathLookupFailure(e.failure)})).length,D.record(H>0?0:1),n.recordPathLookupErrors(U,"delete",C),U.length===L.result.entries.length?(w.Snackbar.fail(E.deleteCompleteError(U),"browse-action"),R({state:f(),eventName:b.WebUserActionLogEvent.DELETE_REQUEST_FAIL,num_files_selected:L.result.changeset_data.length,num_folders_selected:0,batch_success_count:L.result.entries.length-U.length,batch_fail_count:U.length,error_summary:k,lookup_error_type:V})):(w.Snackbar.completeWithUndo(E.deleteCompleteSuccess(l.length,N.length),P,"browse-action"),R({state:f(),eventName:b.WebUserActionLogEvent.DELETE_REQUEST_SUCCESS,num_files_selected:L.result.changeset_data.length,num_folders_selected:0,batch_success_count:L.result.entries.length,batch_fail_count:0,error_summary:k,lookup_error_type:V})),[2]))}}))}))}};var A=function(e,t,r,n){var o=u.selectedFiles(e),i=_.countFilesAndFolders(o),a=i.num_files_selected,s=i.num_folders_selected;l.logBrowseAction({uid:u.user(e).id,action:t,num_files_selected:a,num_folders_selected:s,view_type:m.selectViewType(e,{instanceId:c.BROWSE_FILES_VIEW_ID}),result:r,error_summary:n})};t.renameUndo=function(e){var t=e.file,s=e.pathAtRequestTime,l=e.resultEntry,c=e.changeset;return function(e,_){return r.__awaiter(void 0,void 0,void 0,(function(){var p,f,m,S,E,v;return r.__generator(this,(function(r){switch(r.label){case 0:return p=u.user(_()),f=h.fileFromMetadata(t,l.success),m=a.getMetricsReporter(),S={surface:"browse",contentType:t.is_dir?"folders":"files",batchSizeBucket:"single"},E={latency:m.createTimer({ns:n.FILE_ACTIONS_AMP_NAMESPACE,name:"undo/latency_ms"},S),completed:m.createStats({ns:n.FILE_ACTIONS_AMP_NAMESPACE,name:"undo/completed"},S)},w.Snackbar.sync(F.intl.formatMessage(o.renameUndoSnackbarProgressMessage),!1,"browse-action"),e(d.pushBoltIgnore({added:new Set([t.fq_path]),removed:new Set([f.fq_path])})),A(_(),b.WebUserActionLogEvent.RENAME_UNDO,t),[4,g.undo(c,p)];case 1:return(v=r.sent()).isError?(w.Snackbar.fail(F.intl.formatMessage(o.renameUndoSnackbarErrorMessage),"browse-action"),e(d.popBoltIgnore({added:new Set([t.fq_path]),removed:new Set([f.fq_path])})),A(_(),b.WebUserActionLogEvent.RENAME_UNDO_REQUEST_FAIL,t,v.error_summary),E.completed.record(0)):(w.Snackbar.complete(F.intl.formatMessage(o.renameUndoSnackbarSuccessMessage),"browse-action"),i.paths_are_equal(u.path(_()),s)&&(e(d.setUnsortedFiles({unsortedFiles:u.unsortedFiles(_()).remove(f.fq_path).set(t.fq_path,t)})),e(d.refreshPinnedItems())),e(d.selectFilesByFqPath({fqPathsToSelect:[t.fq_path]})),A(_(),b.WebUserActionLogEvent.RENAME_UNDO_REQUEST_SUCCESS,t),E.completed.record(1)),E.latency.record(),[2]}}))}))}},t.renameFile=function(e){var l=e.file,c=e.name,_=e.checkFSWs,p=e.onSuccessSnackbarClose,m=e.synchronousSingleFileActions;return function(e,S){return r.__awaiter(void 0,void 0,void 0,(function(){var R,y,D,L,M,N,P,U,x,k;return r.__generator(this,(function(V){switch(V.label){case 0:return R=u.user(S()),y=u.path(S()),D=a.getMetricsReporter(),L={surface:"browse",contentType:l.is_dir?"folders":"files",synchronousSingleFileActions:m.toString()},M={latency:D.createTimer({ns:n.FILE_ACTIONS_AMP_NAMESPACE,name:"rename/latency_ms"},L),completed:D.createStats({ns:n.FILE_ACTIONS_AMP_NAMESPACE,name:"rename/completed"},L)},-1!==c.indexOf("/")?(w.Snackbar.fail(F.intl.formatMessage(o.renameErrorInvalidName),"browse-action"),e(f.setFileRename({file:l,renameState:null})),[2]):(e(f.setFileRename({file:l,renameState:v.RenameState.SAVING_INPUT})),w.Snackbar.sync(F.intl.formatMessage(o.renameSnackbarProgressMessage),!1,"browse-action"),[4,g.renameFile(l.fq_path,c,R.id,{checkFSWs:_,synchronousSingleFileActions:m})]);case 1:return(N=V.sent()).isError&&"to"===N.error[".tag"]&&"file_system_warnings"===N.error.to[".tag"]?(e((function(e){var n=e.file,i=e.name,a=e.details;return function(e,l){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(r){return w.Snackbar.close("browse-action"),s.showFileSystemWarningsModal({fsws:a,onFinalAccept:function(){e(t.renameFile({file:n,name:i,checkFSWs:!1,synchronousSingleFileActions:Boolean(O.postTTIExperiments(l()).expSynchronousSingleFileActions)}))},onAbortAction:function(){e(f.setFileRename({file:n,renameState:null})),e(d.pushBoltIgnore({moved:new Set([n.fq_path])}))},confirmText:F.intl.formatMessage(o.renameFswConfirmText)}),[2]}))}))}})({file:l,name:c,details:N.error.to.details})),[2]):(M.latency.record(),N.isError||"success"!==N.result.entries[0][".tag"]?(C.reportStack("Unsuccessful result from rename file client",{severity:C.SEVERITY.NON_CRITICAL,exc_extra:{result:N},tags:[g.EXCLOG_TAG]}),P=N.isError?N:g.createUndefinedRpcResult(),e((function(e){var t=e.file,n=e.result;return function(e,o){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(r){return e(d.pushBoltIgnore({moved:new Set([t.fq_path])})),e(f.setFileRename({file:t,renameState:null})),w.Snackbar.fail(E.renameError(n.error,t.fq_path),"browse-action"),A(o(),b.WebUserActionLogEvent.RENAME_REQUEST_FAIL,t,n.error_summary),[2]}))}))}})({file:l,result:P})),M.completed.record(0),D.createStats({ns:n.FILE_ACTIONS_AMP_NAMESPACE,name:"rename/error"},r.__assign(r.__assign({},L),{error:P.error[".tag"]})).record(1),[2]):(U=N.result.entries[0],x=h.fileFromMetadata(l,U.success),i.paths_are_equal(u.path(S()),y)&&(e(d.setUnsortedFiles({unsortedFiles:u.unsortedFiles(S()).remove(l.fq_path).set(x.fq_path,x)})),e(T.fileRename({file:l,newFile:x})),e(d.refreshPinnedItems())),e(d.selectFilesByFqPath({fqPathsToSelect:[x.fq_path]})),e(f.setFileRename({file:l,renameState:null})),M.completed.record(1),k=function(){e(t.renameUndo({file:l,resultEntry:U,pathAtRequestTime:y,changeset:N.result.changeset_data}))},I.setHandleUndo(k),w.Snackbar.completeWithUndo(F.intl.formatMessage(o.renameSnackbarSuccessMessage),k,"browse-action",{onClosed:function(){null==p||p(x)}}),A(S(),b.WebUserActionLogEvent.RENAME_REQUEST_SUCCESS,x),[2]))}}))}))}}})),define("modules/clean/react/browse/data/helpers",["require","exports","tslib","lodash","modules/clean/filepath/filepath","modules/clean/react/snackbar","modules/core/i18n"],(function(e,t,r,n,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isBackupFolder=t.getPathForNewMountPoint=t.getMountPointUpdateForCurrentPath=t.showUserNotificationForPathChange=void 0,n=r.__importStar(n),o=r.__importStar(o),t.showUserNotificationForPathChange=function(e,t){switch(null!=t.change_type?t.change_type.toLowerCase():null){case"moved":i.Snackbar.complete(a.intl.formatMessage({id:"dte+6z",defaultMessage:"This folder has been moved"}),"browse-notification");break;case"renamed":i.Snackbar.complete(a.intl.formatMessage({id:"y/ubfn",defaultMessage:"This folder has been renamed to “{folder_name}”"},{folder_name:r(t.change_to_fq_path)}),"browse-notification");break;case"deleted":i.Snackbar.fail(a.intl.formatMessage({id:"MK7bBv",defaultMessage:"The folder “{folder_name}” has been deleted"},{folder_name:r(t.old_fq_path)}),"browse-notification")}function r(e){return n.escape(o.filename(e))}},t.getMountPointUpdateForCurrentPath=function(e,t,r){var o,i,a=function(e){return t===e};return r&&r.find(a)?(i=r.find(a)||null,o=e[r.findKey(a)]||null):(i=null,o=n.find(e,a)||null),[i,o]},t.getPathForNewMountPoint=function(e,t,r){return e&&!t?r:e&&t?o.paths_are_equal(e,t)?null:t:!e&&t?r:null},t.isBackupFolder=function(e){var t;return["folder_se_mac_32","folder_se_win_32","folder_se_generic_32","external_drive_32"].includes(null!==(t=null==e?void 0:e.icon)&&void 0!==t?t:"")}})),define("modules/clean/react/browse/data/reducer",["require","exports","tslib","immutable","modules/clean/filepath/filepath","modules/clean/react/browse/data/types","modules/clean/react/files_view/types","modules/core/assert","modules/clean/react/browse/right_rail_preferences","modules/clean/react/browse/model_types"],(function(e,t,r,n,o,i,a,s,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.browseReducer=void 0,n=r.__importStar(n),o=r.__importStar(o),l=r.__importStar(l),t.browseReducer=function(e,t){switch(void 0===e&&(e=i.defaultBrowseState),t.type){case i.ActionTypes.APP_INIT:return(function(e,t){var n=t.payload,o=n.props,i=n.user,a=n.viewer;s.assert(null===e.user,"Cannot reinitialize Browse store; changing invariants such as `user` is untested");var c=o.browseExperiments,d=r.__rest(o,["browseExperiments"]);return r.__assign(r.__assign(r.__assign(r.__assign({},e),{user:i,viewer:a,experiments:c}),d),{isRightRailCollapsed:l.getIsCollapsed(i.id)})})(e,t);case i.ActionTypes.PUSH_BOLT_IGNORE:return(function(e,t){var n=e.boltIgnore,o=n.added,i=n.moved,a=n.removed;return t.payload.added&&(o=new Set(o),t.payload.added.forEach((function(e){return o.add(e)}))),t.payload.moved&&(i=new Set(i),t.payload.moved.forEach((function(e){return i.add(e)}))),t.payload.removed&&(a=new Set(a),t.payload.removed.forEach((function(e){return a.add(e)}))),r.__assign(r.__assign({},e),{boltIgnore:{added:o,moved:i,removed:a}})})(e,t);case i.ActionTypes.POP_BOLT_IGNORE:return(function(e,t){var n=e.boltIgnore,o=n.added,i=n.moved,a=n.removed;return t.payload.added&&(o=new Set(o),t.payload.added.forEach((function(e){return o.delete(e)}))),t.payload.moved&&(i=new Set(i),t.payload.moved.forEach((function(e){return i.delete(e)}))),t.payload.removed&&(a=new Set(a),t.payload.removed.forEach((function(e){return a.delete(e)}))),r.__assign(r.__assign({},e),{boltIgnore:{added:o,moved:i,removed:a}})})(e,t);case i.ActionTypes.SELECT_FILES_BY_FQ_PATH:return(function(e,t){var o=t.payload.fqPathsToSelect.map((function(e){return e.toLowerCase()})),i=e.unsortedFiles.toList().filter((function(e){return o.includes(e.fq_path.toLowerCase())})).map((function(e){return e.fq_path})),a=n.OrderedSet(i),s=i.size?i.get(0):null;return r.__assign(r.__assign({},e),{selection:e.selection.set("selected",a).set("anchor",s)})})(e,t);case i.ActionTypes.SET_CAN_DISPLAY_FOLDER_SIZES:return(function(e,t){var n=t.payload.canDisplayFolderSizes;return r.__assign(r.__assign({},e),{canDisplayFolderSizes:n})})(e,t);case i.ActionTypes.SET_CLIPBOARD_FILES:return(function(e,t){var n=t.payload.clipboard;return r.__assign(r.__assign({},e),{clipboard:n})})(e,t);case i.ActionTypes.SET_CONTEXT:return(function(e,t){var n=t.payload.context;return r.__assign(r.__assign({},e),{context:n})})(e,t);case i.ActionTypes.SET_CURRENT_FOLDER_INFO:return(function(e,t){var n=t.payload.currentFolderInfo;return r.__assign(r.__assign({},e),{currentFolderInfo:n})})(e,t);case i.ActionTypes.SET_FILE_HAS_AUTOMATED_RULE_MAP:return(function(e,t){return r.__assign(r.__assign({},e),{fileHasAutomatedRuleMap:e.fileHasAutomatedRuleMap.merge(t.payload.fileHasAutomatedRuleMap)})})(e,t);case i.ActionTypes.SET_FILE_JUMP_FILTER:return(function(e,t){var n=t.payload.fileJumpFilter;return r.__assign(r.__assign({},e),{fileJumpFilter:n})})(e,t);case i.ActionTypes.SET_FILE_PATHS_TO_SELECT_ON_NEXT_UPDATE:return(function(e,t){var n=t.payload.filePathsToSelectOnNextUpdate;return r.__assign(r.__assign({},e),{filePathsToSelectOnNextUpdate:n})})(e,t);case i.ActionTypes.SET_FOLDER_SIZES:return(function(e,t){var n=t.payload.folderSizes;return r.__assign(r.__assign({},e),{folderSizes:n})})(e,t);case i.ActionTypes.SET_LOADING_STATE:return(function(e,t){var i=t.payload,s=i.loadingState,l=i.path;return o.paths_are_equal(l,e.path)?s===a.LoadingState.LOADED?r.__assign(r.__assign({},e),{loadingState:s,filePathsToSelectOnNextUpdate:n.Set()}):r.__assign(r.__assign({},e),{loadingState:s}):e})(e,t);case i.ActionTypes.SET_MOUNT_POINTS:return(function(e,t){var o=t.payload.mountPoints;return r.__assign(r.__assign({},e),{mountPoints:n.Map(o)})})(e,t);case i.ActionTypes.SET_NEW_FOLDER_CREATION_STATE:return(function(e,t){var n=t.payload.newFolderCreationState;return r.__assign(r.__assign({},e),{newFolderCreationState:n})})(e,t);case i.ActionTypes.SET_PAGINATED_TOTAL_NUM_FILES:return(function(e,t){var n=t.payload.paginatedTotalNumFiles;return r.__assign(r.__assign({},e),{paginatedTotalNumFiles:n})})(e,t);case i.ActionTypes.SET_PATH:return(function(e,t){var n=t.payload.path;return r.__assign(r.__assign({},e),{path:n})})(e,t);case i.ActionTypes.SET_SELECTION:return(function(e,t){var n=t.payload.selection;return r.__assign(r.__assign({},e),{selection:n})})(e,t);case i.ActionTypes.SET_SHOULD_SHOW_DELETED_FILES:return(function(e,t){var n=t.payload.shouldShowDeletedFiles;return r.__assign(r.__assign({},e),{shouldShowDeletedFiles:n})})(e,t);case i.ActionTypes.SET_UNSORTED_FILES:return(function(e,t){var n=t.payload.unsortedFiles;return r.__assign(r.__assign({},e),{unsortedFiles:n})})(e,t);case i.ActionTypes.SHOW_TIMELINE:return(function(e,t){return r.__assign(r.__assign({},e),{isRewindVisible:!0,clickRewindTimestamp:t.payload.timestamp})})(e,t);case i.ActionTypes.HIDE_TIMELINE:return(function(e,t){return r.__assign(r.__assign({},e),{isRewindVisible:!1})})(e);case i.ActionTypes.SHOW_FOLDER_HISTORY_PANEL:return(function(e,t){return r.__assign(r.__assign({},e),{isFolderHistoryVisible:!0,clickFolderHistoryTimestamp:t.payload.timestamp})})(e,t);case i.ActionTypes.HIDE_FOLDER_HISTORY_PANEL:return(function(e,t){return r.__assign(r.__assign({},e),{isFolderHistoryVisible:!1})})(e);case i.ActionTypes.SET_IS_FILE_VIEWER_SHOWN:return(function(e,t){return r.__assign(r.__assign({},e),{isFileViewerShown:t.payload.isShown})})(e,t);case i.ActionTypes.SET_IS_REWIND_ENABLED:return(function(e,t){return r.__assign(r.__assign({},e),{isRewindButtonEnabled:t.payload.value})})(e,t);case i.ActionTypes.SET_FOLDER_MEMBER_COUNTS:return(function(e,t){return r.__assign(r.__assign({},e),{folderMemberCounts:t.payload.value})})(e,t);case i.ActionTypes.TOGGLE_SPACES_ENTRY_POINT:return(function(e,t){return r.__assign(r.__assign({},e),{isSpacesEntryPointEnabled:t.payload.value})})(e,t);case i.ActionTypes.REQUEST_FOLDER_SIZES:return(function(e,t){var n=t.payload.fqPath;if(e.isQueryingFolderSizes)return e;var o=e.folderSizes.withMutations((function(e){e.set(n,{size:0,state:c.FetchFolderSizeState.LOADING})}));return r.__assign(r.__assign({},e),{folderSizes:o,isQueryingFolderSizes:!0})})(e,t);case i.ActionTypes.SET_FOLDER_SIZES_PENDING:return(function(e,t){var n=t.payload.fetchFolderSizesResp,o=e.currentFolderSizesQuery,i=e.folderSizes.withMutations((function(e){for(var t=function(t){e.update(t.fq_path,{size:0,state:c.FetchFolderSizeState.LOADING},(function(){return{size:t.size,state:c.FetchFolderSizeState.LOADING}})),o=o.withMutations((function(e){return e.add(t.fq_path)}))},r=0,i=n.sizes_dict;r<i.length;r++){t(i[r])}}));return r.__assign(r.__assign({},e),{currentFolderSizesQuery:o,folderSizes:i})})(e,t);case i.ActionTypes.COMPLETE_FOLDER_SIZES:return(function(e,t){var o=t.payload.fetchFolderSizeState,i=e.folderSizes.withMutations((function(t){e.currentFolderSizesQuery.forEach((function(r){var n=e.folderSizes.get(r);n&&t.update(r,(function(){return{size:n.size,state:o}}))}))}));return r.__assign(r.__assign({},e),{currentFolderSizesQuery:n.Set(),folderSizes:i,isQueryingFolderSizes:!1})})(e,t);case i.ActionTypes.SET_ARE_POST_TTI_MODULES_LOADED:return(function(e,t){return r.__assign(r.__assign({},e),{arePostTTIModulesLoaded:t.payload.arePostTTIModulesLoaded})})(e,t);case i.ActionTypes.SET_VIEW_SCOPE:return(function(e,t){return r.__assign(r.__assign({},e),{viewScope:t.payload.viewScope})})(e,t);case i.ActionTypes.SET_HIDE_FILES_AND_SIDEBAR:return(function(e,t){return r.__assign(r.__assign({},e),{shouldHideFilesAndSidebar:t.payload.shouldHideFilesAndSidebar})})(e,t);case i.ActionTypes.SET_IS_CREATING_SHARED_LINK:return(function(e,t){return r.__assign(r.__assign({},e),{isCreatingSharedLinkMap:e.isCreatingSharedLinkMap.set(t.payload.fileIdOrPath,t.payload.isCreatingSharedLink)})})(e,t);case i.ActionTypes.SET_RIGHTRAIL_IS_COLLAPSED:return(function(e,t){return r.__assign(r.__assign({},e),{isRightRailCollapsed:t.payload.collapsed})})(e,t);case i.ActionTypes.SET_EXPANDED_BLADE:return(function(e,t){return r.__assign(r.__assign({},e),{expandedBlade:t.payload.expandedBlade})})(e,t);case i.ActionTypes.SET_HAS_USER_UPLOADED_FILES:return(function(e,t){return r.__assign(r.__assign({},e),{hasUserUploadedFiles:t.payload.hasUserUploadedFiles})})(e,t);case i.ActionTypes.SET_FLOWS_FOLDER_RULES_CONFIG:return(function(e,t){return r.__assign(r.__assign({},e),{flowsFolderRulesConfig:t.payload.folderRulesConfig})})(e,t);case i.ActionTypes.SET_OVERFLOW_MENU_OPEN_REQUEST:return(function(e,t){return r.__assign(r.__assign({},e),{overflowMenuOpenRequest:t.payload.overflowMenuOpenRequest})})(e,t);case i.ActionTypes.SET_OVERFLOW_MENU_CLOSE_REQUEST:return(function(e,t){return r.__assign(r.__assign({},e),{overflowMenuCloseRequest:t.payload.overflowMenuCloseRequest})})(e,t);case i.ActionTypes.SET_INLINE_OVERFLOW_MENU_OPEN_REQUEST:return(function(e,t){return r.__assign(r.__assign({},e),{inlineOverflowMenuOpenRequest:t.payload.inlineOverflowMenuOpenRequest})})(e,t);case i.ActionTypes.SET_OVERFLOW_MENU_COORDINATES:return(function(e,t){return r.__assign(r.__assign({},e),{overflowMenuCoordinates:t.payload.overflowMenuCoordinates})})(e,t);case i.ActionTypes.SET_BROWSE_POST_TTI_EXPERIMENTS:return(function(e,t){var n=t.payload.browsePostTTIExperiments;return r.__assign(r.__assign({},e),{browsePostTTIExperiments:n})})(e,t);case i.ActionTypes.SET_BROWSE_POST_TTI_DATA:return(function(e,t){var n=t.payload.browsePostTTIData;return r.__assign(r.__assign({},e),{browsePostTTIData:r.__assign(r.__assign({},e.browsePostTTIData),n)})})(e,t);case i.ActionTypes.SET_BACKUP_FOLDERS:return(function(e,t){return r.__assign(r.__assign({},e),{backupFolders:t.payload.backupFolders})})(e,t);case i.ActionTypes.SET_CREATE_MENU_OPEN_REQUEST:return(function(e,t){return r.__assign(r.__assign({},e),{createMenuOpenRequest:t.payload.createMenuOpenRequest})})(e,t);case i.ActionTypes.SHOW_PERSONALIZATION_SUGGESTED_FOLDERS:return(function(e,t){var n=e.browsePostTTIExperimentsOverrides,o=t.payload.showSuggestedFolders;return r.__assign(r.__assign({},e),{browsePostTTIExperimentsOverrides:r.__assign(r.__assign({},n),{showPersonalizationSuggestedFolders:o})})})(e,t);case i.ActionTypes.HANDLE_APP_CLEANUP:return i.defaultBrowseState}return e}})),define("modules/clean/react/browse/data/selectors",["require","exports","tslib","immutable","reselect","modules/clean/filepath/filepath","modules/clean/filetypes","modules/clean/react/browse/constants","modules/clean/react/browse/data/types","modules/clean/react/browse/models","modules/clean/react/browse/uri_helper","modules/clean/react/browse/util","modules/clean/react/files_view/data/selectors/files_view_selectors","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/types","modules/clean/react/growth/personalization/util","modules/clean/redux/namespaces","modules/clean/redux/selectors","modules/core/assert","modules/clean/react/flows/types","modules/clean/tagging/data/selectors/index","modules/clean/tagging/experiments","modules/clean/tagging/utils","modules/clean/filetypes","modules/clean/react/browse/data/helpers"],(function(e,t,r,n,o,i,a,s,l,c,d,u,_,p,f,m,g,h,S,E,v,T,w,I,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.backupNewLocationHintEnabled=t.getIndexOfFile=t.createMenuOpenRequest=t.selectCurrentFolderInfoWithTags=t.selectedFilesWithTags=t.sortedFilesWithFolderSizesAndTags=t.selectIsTagsColumnEnabled=t.selectIsTaggingEnabled=t.autoTagAwarenessVariant=t.flowsAutoTagUiVariant=t.flowsAutomatedFolderUiVariant=t.manualTaggingVariant=t.isInsideBackupFolder=t.backupFolderPath=t.isSelectedBackupFolder=t.backupFolders=t.isContinuousOnboardingBackgroundActive=t.newApplyToExistingFilesEnabled=t.hasFlowsDashboardAccess=t.getFlowsFolderRulesActionExperiments=t.getFlowsFolderRulesConfigData=t.getFlowsFolderRulesConfig=t.browseBoostSharing=t.getHasUserUploadedFiles=t.showBrowseViewToggleInToolbar=t.showShareViewInToolbar=t.expandedBlade=t.fileHasAutomatedRuleMap=t.isInsideFlowsEligibleFolder=t.flowsFolderRule=t.isRightRailCollapsed=t.showSelectionIndicatorInToolbar=t.isFamilyRoomFacepileEnhancementsEnabled=t.isModifiedFamilyRoomFacepileEnabled=t.expActionBarRedesignVariant=t.browseCommentsEnabled=t.getCurrentFolderInfo=t.selectionMode=t.selectViewTypeScope=t.getUsersJtbdInterestInfo=t.getFullFunnelOptimizationVideoVariant=t.shouldLogCreateSuggestedFolderTooltipExposure=t.shouldDisplayCreateSuggestedFolderTooltip=t.isEligibleForOnboardingChecklist=t.isEligibleForSuggestedFoldersToMove=t.shouldShowTeamSpaceEmptyZone=t.isInsideEmptyCollectionFolder=t.isInsideCollectionFolder=t.selectFileByFullPath=t.canEditFolderOverview=t.shouldShowSidebarFolderOverview=t.unsortedFilesWithFolderSizes=t.sortedFilesWithFolderSizes=t.urlPrefix=t.selectFilesForSelection=t.allFilesSelected=t.selectedFilesForSidebar=t.selectedFiles=t.sortedFiles=t.fileJumpIndex=t.isCurrentPathRoot=t.arePostTTIModulesLoaded=t.unsortedFiles=t.browsePostTTIExperimentsOverrides=t.browsePostTTIExperiments=t.isSpacesEntryPointEnabled=t.folderMemberCounts=t.isRewindButtonEnabled=t.isFileViewerShown=t.clickFolderHistoryTimestamp=t.clickRewindTimestamp=t.isFolderHistoryVisible=t.isRewindVisible=t.viewer=t.user=t.isCreatingSharedLinkForFile=t.shouldHideFilesAndSidebar=t.autoTeamGroupId=t.hasLinkedMobile=t.browsePostTTIData=t.boltIgnore=t.sortOrder=t.shouldShowDeletedFiles=t.selection=t.path=t.newFolderCreationState=t.mountPoints=t.browseLoadingState=t.isQueryingFolderSizes=t.isFileJumping=t.folderSizes=t.filePathsToSelectOnNextUpdate=t.fileJumpFilter=t.selectPostTTIExperimentsOptional=t.postTTIExperiments=t.selectBrowseExperimentsOptional=t.experiments=t.inlineOverflowMenuOpenRequest=t.overflowMenuCoordinates=t.overflowMenuCloseRequest=t.overflowMenuOpenRequest=t.context=t.clipboard=t.canDisplayFolderSizes=t.getBrowseState=void 0,n=r.__importStar(n),i=r.__importStar(i),t.getBrowseState=function(e){return h.getStateAtNamespace(e,g.BROWSE_NAMESPACE_KEY)||l.defaultBrowseState},t.canDisplayFolderSizes=function(e){return t.getBrowseState(e).canDisplayFolderSizes},t.clipboard=function(e){return t.getBrowseState(e).clipboard},t.context=function(e){return t.getBrowseState(e).context},t.overflowMenuOpenRequest=function(e){return t.getBrowseState(e).overflowMenuOpenRequest},t.overflowMenuCloseRequest=function(e){return t.getBrowseState(e).overflowMenuCloseRequest},t.overflowMenuCoordinates=function(e){return t.getBrowseState(e).overflowMenuCoordinates},t.inlineOverflowMenuOpenRequest=function(e){return t.getBrowseState(e).inlineOverflowMenuOpenRequest},t.experiments=function(e){return t.getBrowseState(e).experiments},t.selectBrowseExperimentsOptional=function(e){var t;return null===(t=e[g.BROWSE_NAMESPACE_KEY])||void 0===t?void 0:t.experiments},t.postTTIExperiments=function(e){return t.getBrowseState(e).browsePostTTIExperiments},t.selectPostTTIExperimentsOptional=function(e){var t;return null===(t=e[g.BROWSE_NAMESPACE_KEY])||void 0===t?void 0:t.browsePostTTIExperiments},t.fileJumpFilter=function(e){return t.getBrowseState(e).fileJumpFilter},t.filePathsToSelectOnNextUpdate=function(e){return t.getBrowseState(e).filePathsToSelectOnNextUpdate},t.folderSizes=function(e){return t.getBrowseState(e).folderSizes},t.isFileJumping=function(e){return t.getBrowseState(e).fileJumpFilter.length>0},t.isQueryingFolderSizes=function(e){return t.getBrowseState(e).isQueryingFolderSizes},t.browseLoadingState=function(e){return t.getBrowseState(e).loadingState},t.mountPoints=function(e){return t.getBrowseState(e).mountPoints},t.newFolderCreationState=function(e){return t.getBrowseState(e).newFolderCreationState},t.path=function(e){return t.getBrowseState(e).path},t.selection=function(e){return t.getBrowseState(e).selection},t.shouldShowDeletedFiles=function(e){return t.getBrowseState(e).shouldShowDeletedFiles},t.sortOrder=function(e){var t=p.selectScopedSort(e,{instanceId:s.BROWSE_FILES_VIEW_ID});return t||s.BROWSE_DEFAULT_SORT_ORDER},t.boltIgnore=function(e){return t.getBrowseState(e).boltIgnore},t.browsePostTTIData=function(e){return t.getBrowseState(e).browsePostTTIData},t.hasLinkedMobile=function(e){return t.getBrowseState(e).hasLinkedMobile},t.autoTeamGroupId=function(e){return t.getBrowseState(e).autoTeamGroupId},t.shouldHideFilesAndSidebar=function(e){return t.getBrowseState(e).shouldHideFilesAndSidebar},t.isCreatingSharedLinkForFile=function(e,r){return Boolean(t.getBrowseState(e).isCreatingSharedLinkMap.get(r))},t.user=function(e){var r=t.getBrowseState(e).user;return S.assert(null!=r,"Browse store `user` accessed before APP_INIT action"),r},t.viewer=function(e){var r=t.getBrowseState(e).viewer;return S.assert(null!=r,"Browse store `viewer` accessed before APP_INIT action"),r},t.isRewindVisible=function(e){return t.getBrowseState(e).isRewindVisible},t.isFolderHistoryVisible=function(e){return t.getBrowseState(e).isFolderHistoryVisible},t.clickRewindTimestamp=function(e){return t.getBrowseState(e).clickRewindTimestamp},t.clickFolderHistoryTimestamp=function(e){return t.getBrowseState(e).clickFolderHistoryTimestamp},t.isFileViewerShown=function(e){return t.getBrowseState(e).isFileViewerShown},t.isRewindButtonEnabled=function(e){return t.getBrowseState(e).isRewindButtonEnabled},t.folderMemberCounts=function(e){return t.getBrowseState(e).folderMemberCounts},t.isSpacesEntryPointEnabled=function(e){return t.getBrowseState(e).isSpacesEntryPointEnabled},t.browsePostTTIExperiments=function(e){return t.getBrowseState(e).browsePostTTIExperiments||{}},t.browsePostTTIExperimentsOverrides=function(e){return t.getBrowseState(e).browsePostTTIExperimentsOverrides||{}},t.unsortedFiles=function(e){return t.getBrowseState(e).unsortedFiles},t.arePostTTIModulesLoaded=function(e){return t.getBrowseState(e).arePostTTIModulesLoaded},t.isCurrentPathRoot=function(e){return i.paths_are_equal(t.path(e),"/")},t.fileJumpIndex=o.createSelector(t.unsortedFiles,(function(e){return e.keySeq().toArray().map((function(e){return{filename:i.filename(e).toLowerCase(),fqPath:e}})).sort((function(e,t){return e.filename<t.filename?-1:e.filename>t.filename?1:0}))})),t.sortedFiles=o.createSelector(t.unsortedFiles,t.sortOrder,t.folderSizes,t.context,t.experiments,(function(e,t,r,n,o){return u.sortFiles(e.toList(),t,r)})),t.selectedFiles=o.createSelector(t.unsortedFiles,t.selection,(function(e,t){return F(e,t)})),t.selectedFilesForSidebar=o.createSelector(t.selectedFiles,_.previewThumbnails,(function(e,t){return e.count()>0?e.withMutations((function(e){e.forEach((function(n,o){var i;if(!n.thumbnail_url_tmpl&&(null===(i=t[n.file_id])||void 0===i?void 0:i.preview_url)){var a=t[n.file_id].preview_url;e.set(o,new c.File(r.__assign(r.__assign({},n),{thumbnail_url_tmpl:a})))}}))})):e})),t.allFilesSelected=o.createSelector(t.selectedFiles,t.unsortedFiles,(function(e,t){return e.size===t.size})),t.selectFilesForSelection=function(e,r){return F(t.unsortedFiles(e),r.selection)};var F=function(e,t){return t.selected.isEmpty()||e.isEmpty()?n.OrderedMap():n.OrderedMap(t.selected.map((function(t){var r=e.find((function(e){return e.fq_path===t}));return r?[r.fq_path,r]:void 0})))};t.urlPrefix=o.createSelector(t.user,t.viewer,(function(e,t){return d.browse_root(t,e)})),t.sortedFilesWithFolderSizes=o.createSelector(t.sortedFiles,t.folderSizes,(function(e,t){return e.map((function(e){var r=t.get(e.fq_path);return r?e.updateSize(r.size,r.state):e}))})),t.unsortedFilesWithFolderSizes=o.createSelector(t.unsortedFiles,t.folderSizes,(function(e,t){return e.withMutations((function(r){t.forEach((function(t,n){var o=e.get(n);if(o&&t){var i=o.updateSize(t.size,t.state);r.set(n,i)}}))}))})),t.shouldShowSidebarFolderOverview=o.createSelector(t.selectedFiles,(function(e){return e&&1===e.size&&e.first().is_dir&&!c.File.isNoAccessSharedFolder(e.first())})),t.canEditFolderOverview=o.createSelector(t.user,t.context,(function(e,t){return e.is_cdm_member&&e.is_team_admin&&t.isCurrentlyInRoot||!!t.isCurrentPathWriteable()})),t.selectFileByFullPath=function(e,r){return t.sortedFilesWithFolderSizes(e).find((function(e){return e.fq_path===r.path}))},t.isInsideCollectionFolder=o.createSelector(t.context,(function(e){var t;return(null!==(t=e.collectionFolderType)&&void 0!==t?t:a.CollectionFolderType.UNSPECIFIED)!==a.CollectionFolderType.UNSPECIFIED})),t.isInsideEmptyCollectionFolder=o.createSelector(t.isInsideCollectionFolder,t.unsortedFiles,(function(e,t){return e&&0===t.count()})),t.shouldShowTeamSpaceEmptyZone=o.createSelector(t.context,t.experiments,t.browsePostTTIData,t.browsePostTTIExperiments,t.browseLoadingState,(function(e,t,r,n,o){var i=t.splitTmfTsd&&"/Team Files"===e.currentFQPath;return!(r.mobileWebInvites||!n.expPersonalizedFirstPaths&&!r.firstTaskProps.is_eligible_team||!e.isInsideMyTeamFolderTree||!(e.isCurrentlyInRoot&&!t.splitTmfTsd||i)||o===f.LoadingState.LOADING_FIRST_PAGE)})),t.isEligibleForSuggestedFoldersToMove=o.createSelector(t.context,t.experiments,t.browsePostTTIData,t.browseLoadingState,(function(e,t,r,n){var o,i=null===(o=r.suggestedFoldersToMoveInfo)||void 0===o?void 0:o.is_dismissed,a=t.splitTmfTsd&&"/Team Files"===e.currentFQPath;return Boolean(!i&&!r.mobileWebInvites&&e.isInsideMyTeamFolderTree&&(e.isCurrentlyInRoot&&!t.splitTmfTsd||a)&&n!==f.LoadingState.LOADING_FIRST_PAGE)})),t.isEligibleForOnboardingChecklist=o.createSelector(t.context,t.experiments,t.browsePostTTIData,t.browseLoadingState,(function(e,t,r,n){return Boolean(!r.mobileWebInvites&&!t.splitTmfTsd&&e.isCurrentlyInRoot&&e.isInsideMyTeamFolderTree&&n===f.LoadingState.LOADED)})),t.shouldDisplayCreateSuggestedFolderTooltip=o.createSelector(t.browsePostTTIData,(function(e){var t,r,n;return"V1"===(null===(t=e.usersJtbdInterestInfo)||void 0===t?void 0:t.variant)&&(null===(r=e.usersJtbdInterestInfo)||void 0===r?void 0:r.onboarding_interest)===m.OnboardingInterest.VIDEO_SHARE&&!1===(null===(n=e.usersJtbdInterestInfo)||void 0===n?void 0:n.is_tooltip_dismissed)})),t.shouldLogCreateSuggestedFolderTooltipExposure=o.createSelector(t.browsePostTTIData,(function(e){var t,r,n;return void 0!==(null===(t=e.usersJtbdInterestInfo)||void 0===t?void 0:t.variant)&&["CONTROL","V1"].includes(e.usersJtbdInterestInfo.variant)&&(null===(r=e.usersJtbdInterestInfo)||void 0===r?void 0:r.onboarding_interest)===m.OnboardingInterest.VIDEO_SHARE&&!1===(null===(n=e.usersJtbdInterestInfo)||void 0===n?void 0:n.is_tooltip_dismissed)})),t.getFullFunnelOptimizationVideoVariant=o.createSelector(t.browsePostTTIData,(function(e){var t;return null===(t=e.usersJtbdInterestInfo)||void 0===t?void 0:t.variant})),t.getUsersJtbdInterestInfo=o.createSelector(t.browsePostTTIData,(function(e){return e.usersJtbdInterestInfo})),t.selectViewTypeScope=function(e){return t.getBrowseState(e).viewScope||void 0},t.selectionMode=o.createSelector(t.selectedFiles,(function(e){return e.count()>0?"selected":"unselected"})),t.getCurrentFolderInfo=function(e){return t.getBrowseState(e).currentFolderInfo},t.browseCommentsEnabled=o.createSelector(t.postTTIExperiments,(function(e){return"ON"===e.expBrowseWebComments})),t.expActionBarRedesignVariant=o.createSelector(t.postTTIExperiments,(function(e){return e.expActionBarRedesign?e.expActionBarRedesign:"OFF"})),t.isModifiedFamilyRoomFacepileEnabled=o.createSelector(t.postTTIExperiments,(function(e){return!!e.expFamilyMay2021Updates})),t.isFamilyRoomFacepileEnhancementsEnabled=o.createSelector(t.postTTIExperiments,(function(e){return!!e.expFamilyRoomFacepileEnhancements})),t.showSelectionIndicatorInToolbar=function(e){return t.isFamilyRoomFacepileEnhancementsEnabled(e)&&t.getBrowseState(e).context.isInsideFamilySharedFolder},t.isRightRailCollapsed=function(e){return t.getBrowseState(e).isRightRailCollapsed||!1},t.flowsFolderRule=function(e,r){return t.getBrowseState(e).fileHasAutomatedRuleMap.get(r)||E.FlowsRuleType.None},t.isInsideFlowsEligibleFolder=function(e){var r=t.getCurrentFolderInfo(e),n=t.getBrowseState(e).context;return r&&n.isInFolderMode&&!n.isCurrentlyInRoot&&!n.isInsideTeamFolderRoot&&!n.isInsideVaultFolder&&r.type!==I.FileTypes.TEAM_MEMBER_FOLDER&&!c.File.isReadOnlySharedFolder(r)},t.fileHasAutomatedRuleMap=function(e){return t.getBrowseState(e).fileHasAutomatedRuleMap},t.expandedBlade=function(e){return t.getBrowseState(e).expandedBlade},t.showShareViewInToolbar=function(e,r){var n=!r.isResponsive||r.isMatchedLarge,o=!n&&r.isMatchedMedium,i=t.isModifiedFamilyRoomFacepileEnabled(e)&&t.getBrowseState(e).context.isInsideFamilySharedFolder;return(t.isRightRailCollapsed(e)&&n||o)&&!i},t.showBrowseViewToggleInToolbar=function(e){return t.isModifiedFamilyRoomFacepileEnabled(e)&&t.getBrowseState(e).context.isInsideFamilySharedFolder},t.getHasUserUploadedFiles=function(e){return!!t.getBrowseState(e).hasUserUploadedFiles},t.browseBoostSharing=o.createSelector(t.selectBrowseExperimentsOptional,(function(e){return e?e.browseBoostSharing:"OFF"})),t.getFlowsFolderRulesConfig=function(e){return t.getBrowseState(e).flowsFolderRulesConfig},t.getFlowsFolderRulesConfigData=function(e){var r=t.getBrowseState(e).flowsFolderRulesConfig;return"completed"===r.status?r.data:[]},t.getFlowsFolderRulesActionExperiments=function(e){var r=t.getBrowseState(e).flowsFolderRulesConfig;return"completed"===r.status&&r.actionExperiments||[]},t.hasFlowsDashboardAccess=function(e){var r=t.getBrowseState(e).flowsFolderRulesConfig;return"completed"===r.status&&r.hasDashboardAccess},t.newApplyToExistingFilesEnabled=function(e){var r=t.getBrowseState(e).flowsFolderRulesConfig;return"completed"===r.status&&!!r.newApplyToExistingFiles},t.isContinuousOnboardingBackgroundActive=o.createSelector(t.context,t.experiments,t.unsortedFiles,t.selectedFiles,(function(e,t,r,n){var o=n.size>0,i="V1"===t.coreO21nInFolderActivationM1&&!e.isCurrentlyInRoot&&r.size<=0;return o||i})),t.backupFolders=function(e){return t.getBrowseState(e).backupFolders},t.isSelectedBackupFolder=o.createSelector(t.selectedFiles,t.browsePostTTIExperiments,(function(e,t){return!!t.expEnableBackupWeb&&b.isBackupFolder(e.first())})),t.backupFolderPath=function(e){var n=t.backupFolders(e);if(null===n)return null;var o=t.path(e),a=r.__spreadArrays([o],i.parent_dirs(o)),s=n.filter((function(e){return a.includes(e)}));return 0===s.length?null:s[0]},t.isInsideBackupFolder=function(e){return!!t.browsePostTTIExperiments(e).expEnableBackupWeb&&(!!b.isBackupFolder(t.getCurrentFolderInfo(e))||null!==t.backupFolderPath(e))},t.manualTaggingVariant=o.createSelector(t.selectBrowseExperimentsOptional,(function(e){var t;return null!==(t=null==e?void 0:e.manualTagging)&&void 0!==t?t:"OFF"})),t.flowsAutomatedFolderUiVariant=o.createSelector(t.selectBrowseExperimentsOptional,(function(e){var t;return null!==(t=null==e?void 0:e.flowsAutomatedFolderUi)&&void 0!==t&&t})),t.flowsAutoTagUiVariant=o.createSelector(t.selectBrowseExperimentsOptional,(function(e){var t;return null!==(t=null==e?void 0:e.flowsAutoTagUi)&&void 0!==t&&t})),t.autoTagAwarenessVariant=o.createSelector(t.selectBrowseExperimentsOptional,(function(e){var t;return null!==(t=null==e?void 0:e.autoTagAwareness)&&void 0!==t&&t})),t.selectIsTaggingEnabled=o.createSelector(t.manualTaggingVariant,T.isTaggingEnabled),t.selectIsTagsColumnEnabled=o.createSelector(t.manualTaggingVariant,T.isTagsColumnOnBrowseEnabled);var C=function(e,t){var n=t[w.getFileMapKey(e)],o=e;return void 0!==n&&(o=new c.File(r.__assign(r.__assign({},e),{tags:n.map((function(e){return{value:e,highlighted:!1}}))}))),o};t.sortedFilesWithFolderSizesAndTags=o.createSelector(t.sortedFilesWithFolderSizes,v.selectTagsByFile,(function(e,t){return e.map((function(e){return C(e,t)}))}));var O=o.createSelector(t.unsortedFiles,v.selectTagsByFile,(function(e,t){return e.withMutations((function(e){e.forEach((function(r,n){e.set(n,C(r,t))}))}))}));t.selectedFilesWithTags=o.createSelector(O,t.selection,(function(e,t){return F(e,t)})),t.selectCurrentFolderInfoWithTags=o.createSelector(t.getCurrentFolderInfo,v.selectTagsByFile,(function(e,t){if(void 0!==e)return C(e,t)})),t.createMenuOpenRequest=function(e){return t.getBrowseState(e).createMenuOpenRequest},t.getIndexOfFile=function(e,r){return t.sortedFiles(r).findIndex((function(t){return t.sjid===e.sjid&&t.ns_id===e.ns_id}))},t.backupNewLocationHintEnabled=o.createSelector(t.selectPostTTIExperimentsOptional,(function(e){return"ON"===(null==e?void 0:e.expBackupNewLocationHint)}))})),define("modules/clean/react/browse/data/folder_overview_selectors",["require","exports","tslib","modules/clean/react/browse/constants","modules/clean/react/folder_overview/data/selectors","modules/clean/react/browse/data/selectors","reselect","modules/clean/react/files_view/types","modules/clean/filepath/filepath"],(function(e,t,r,n,o,i,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldShowFamilyEmptyState=t.shouldShowVaultEmptyState=t.paginatedTotalNumFiles=t.folderOverviewPinnedItems=t.folderOverviewLoggingFileId=t.folderOverviewFolderFileId=t.hasFailedToLoad=t.haveAllComponentsLoaded=void 0,o=r.__importStar(o),l=r.__importStar(l);var c=o.makeHaveAllComponentsLoadedSelector(),d=o.makeHasFailedToLoadSelector(),u=o.makeFolderFileIdSelector(),_=o.makeLoggingFileIdSelector(),p=o.makePinnedItemsSelector();t.haveAllComponentsLoaded=function(e){return c(e,{componentNamespace:n.BrowseFolderOverviewComponentNamespace})},t.hasFailedToLoad=function(e){return d(e,{componentNamespace:n.BrowseFolderOverviewComponentNamespace})},t.folderOverviewFolderFileId=function(e){return u(e,{path:i.path(e)})},t.folderOverviewLoggingFileId=function(e){return _(e,{path:i.path(e)})},t.folderOverviewPinnedItems=function(e){return p(e,{path:i.path(e)})},t.paginatedTotalNumFiles=function(e){return i.browseLoadingState(e)===s.LoadingState.LOADED?i.sortedFiles(e).count():i.getBrowseState(e).paginatedTotalNumFiles},t.shouldShowVaultEmptyState=a.createSelector(i.context,t.paginatedTotalNumFiles,(function(e,t){return e.isInsideVaultFolder&&null!=e.currentNSPath&&l.paths_are_equal(e.currentNSPath,"")&&0===t})),t.shouldShowFamilyEmptyState=a.createSelector(i.context,t.paginatedTotalNumFiles,i.experiments,(function(e,t,r){return e.isInFamilySharedFolder&&null!=e.currentNSPath&&l.paths_are_equal(e.currentNSPath,"")&&0===t}))})),define("modules/clean/react/browse/data/store",["require","exports","modules/clean/redux/namespaces","modules/clean/react/browse/data/reducer","modules/clean/redux/store","modules/clean/tagging/data/store"],(function(e,t,r,n,o,i){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),t.getStoreForBrowse=void 0,t.getStoreForBrowse=function(){var e;return a||(a=o.getStoreAndRegisterReducers(((e={})[r.BROWSE_NAMESPACE_KEY]=n.browseReducer,e))),i.getStoreForTagging(),a}})),define("modules/clean/react/browse/right_rail_preferences",["require","exports","modules/core/persistence/storage","modules/core/exception"],(function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setIsCollapsed=t.getIsCollapsed=t.RIGHTRAIL_COLLAPSED_STORAGE_KEY=void 0,t.RIGHTRAIL_COLLAPSED_STORAGE_KEY="browse_right_rail_collapsed_preferences",t.getIsCollapsed=function(e){try{return r.UserLocalStorage.get(e,t.RIGHTRAIL_COLLAPSED_STORAGE_KEY)||!1}catch(e){return n.reportException({err:e,severity:"non-critical"}),!1}},t.setIsCollapsed=function(e,o){try{r.UserLocalStorage.set(e,t.RIGHTRAIL_COLLAPSED_STORAGE_KEY,o)}catch(e){n.reportException({err:e,severity:"non-critical"})}}})),define("modules/clean/react/right_rail/user_education/right_rail_user_education_tracker",["require","exports","tslib","modules/clean/growth/user_action/tracker"],(function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RightRailUserEducationTracker=t.RightRailUserEducationActions=void 0,(function(e){e.FOLDER_OVERVIEW_INTERACTION="folder_overview_interaction",e.PINNED_BLADE_INTERACTION="pinned_blade_interaction",e.TOOLTIP_SEEN="tooltip_seen"})(t.RightRailUserEducationActions||(t.RightRailUserEducationActions={}));var o=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.project="right_rail_user_education",t}return r.__extends(t,e),t.prototype.hasPerfomed=function(e){return r.__awaiter(this,void 0,Promise,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,this.client.rpc("performed_user_action",{project:this.project,action:e},{subjectUserId:this.userId})];case 1:return[2,t.sent().has_performed]}}))}))},t})(n.GrowthUserActionTracker);t.RightRailUserEducationTracker=o})),define("modules/clean/react/file_uploader/action_logger",["require","exports","tslib","modules/clean/filepath/filepath","modules/clean/react/file_uploader/constants","modules/clean/react/file_uploader/web_upload_action_logger","modules/clean/web_user_action_logger","modules/clean/react/file_uploader/web_upload_action_events","modules/clean/web_user_action_events","modules/core/browser","modules/clean/react/file_uploader/utils","modules/core/exception"],(function(e,t,r,n,o,i,a,s,l,c,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logUploadAction=void 0,n=r.__importStar(n),c=r.__importStar(c),t.logUploadAction=function(e){var t,_=e.action,p=e.upload,f=e.chooser_type,m=e.upload_method,g=e.num_files,h=e.num_dirs,S=e.errorType,E=e.extra,v=e.batchId,T=e.user,w=e.uploadPath,I=e.useUploadKit,b=e.source,F={num_files:g,num_dirs:h,chooser_type:f,upload_method:m,extra:r.__assign({origin:(t=c.get_pathname(),"/h"===t?"HOME":"/recents"===t?"RECENTS":"/starred"===t?"STARRED":t.startsWith("/share")?"SHARED":"/requests"===t?"FILE_REQUESTS":"/deleted_files"===t?"DELETED_FILES":"BROWSE"),use_upload_kit:I?"true":"false"},b&&{source:b})};if((function(e){return e&&!!e.uploadId})(p)){var C=p,O=_===s.WebUploadActionEvent.UPLOAD_FAILURE?C.errorType===o.UploadErrorType.GENERIC&&S?S:C.errorType:void 0;F=r.__assign(r.__assign({},F),{upload_id:C.uploadId,file_size:C.size,file_extension:n.file_extension(C.name),failure_reason:O,batch_id:C.batchId,upload_destination:C.dest,current_path:c.get_pathname(),file_name:C.name})}else if((function(e){return e&&!!e.batchId})(p)){C=p;F=r.__assign(r.__assign({},F),{file_size:C.size,file_extension:n.file_extension(C.name),batch_id:C.batchId})}return!F.chooser_type&&p&&"chooserType"in p&&p.chooserType&&(F.chooser_type=p.chooserType),v&&(F.batch_id=v),w&&(F.batch_dest_folder_level=d.getFolderLevel(w),T&&(F.member_folder=d.isInMemberFolder(T,w))),E&&(F.extra=r.__assign(r.__assign({},F.extra),E)),T?(function(e){return e===l.WebUserActionLogEvent.UPLOAD_BUTTON_CLICK||e===l.WebUserActionLogEvent.ADD_MORE_FILES_CLICK||e===l.WebUserActionLogEvent.VIEW_DETAILS_CLICK||e===l.WebUserActionLogEvent.CLOSE_MODAL_CLICK||e===l.WebUserActionLogEvent.UPLOAD_CLICK||e===l.WebUserActionLogEvent.UPLOAD_FILES_CLICK||e===l.WebUserActionLogEvent.UPLOAD_FOLDER_CLICK||e===l.WebUserActionLogEvent.CANCEL_UPLOAD_CLICK})(_)?a.WebUserActionLog.log(T.id,_,F):(_=_,F.client_timestamp=Math.round(Date.now()/1e3),i.WebUploadActionLog.log(T.id,_,F)):void u.reportStack("Trying to log web upload event but user is null",{severity:u.SEVERITY.NONCRITICAL})}})),define("modules/clean/react/file_uploader/constants",["require","exports","tslib","immutable"],(function(e,t,r,n){"use strict";var o,i;Object.defineProperty(t,"__esModule",{value:!0}),t.ValidChunkSizeStrings=t.UPLOAD_ERROR_EVENT=t.ALL_UPLOADS_COMPLETE_EVENT=t.UPLOAD_COMPLETE_EVENT=t.UPLOAD_BEGIN_EVENT=t.FileUpload=t.OverQuotaStatusType=t.UploadErrorType=t.TeamAccessLevel=t.FileStatusType=t.UploaderActionType=t.ChooserType=void 0,n=r.__importStar(n),(function(e){e.FILE="file",e.FOLDER="folder",e.FILE_FOLDER="file_folder",e.UNKNOWN="unknown"})(t.ChooserType||(t.ChooserType={})),(function(e){e.ALL_UPLOADS_COMPLETE="ALL_UPLOADS_COMPLETE",e.SET_PATH="UPLOADER_SET_PATH",e.SET_FOLDER_NS_ID="UPLOADER_SET_FOLDER_NS_ID",e.SET_USER="UPLOADER_SET_USER",e.SET_NUM_DRAGGING_FILES="SET_NUM_DRAGGING_FILES",e.READY_UPLOADS="READY_UPLOADS",e.QUEUE_UPLOADS="QUEUE_UPLOADS",e.START_UPLOAD="START_UPLOAD",e.COMPLETE_UPLOAD="COMPLETE_UPLOAD",e.CANCEL_UPLOADS="CANCEL_UPLOADS",e.SET_CURRENT_UPLOAD_PROGRESS="SET_CURRENT_UPLOAD_PROGRESS",e.UPLOAD_ERROR="UPLOAD_ERROR",e.SET_IS_UPLOAD_MODAL_OPEN="SET_IS_UPLOAD_MODAL_OPEN",e.SET_INLINE_STATUS_SHOULD_BE_DISMISSED="SET_INLINE_STATUS_SHOULD_BE_DISMISSED",e.ADD_NEW_FAILED_FILE="ADD_NEW_FAILED_FILE",e.CONFIRM_FSW="CONFIRM_FSW",e.ADD_FILES_TO_PLU="ADD_FILES_TO_PLU",e.ADD_DIRECTORIES_TO_PLU="ADD_DIRECTORIES_TO_PLU",e.REMOVE_FILES="REMOVE_FILES",e.SET_HAS_OVERQUOTA_ERROR="SET_HAS_OVERQUOTA_ERROR",e.SET_IS_PERMISSIONS_AT_UPLOAD_MODAL_OPEN="SET_IS_PERMISSIONS_AT_UPLOAD_MODAL_OPEN",e.ADD_TEAM_ACCESS_LEVEL="ADD_TEAM_ACCESS_LEVEL",e.RESET_TEAM_ACCESS_LEVELS="RESET_TEAM_ACCESS_LEVELS",e.SET_UPLOAD_PROGRESS="SET_UPLOAD_PROGRESS",e.SET_CURRENT_FILE_UPLOAD_PROGRESS="SET_CURRENT_FILE_UPLOAD_PROGRESS"})(t.UploaderActionType||(t.UploaderActionType={})),(function(e){e.SET_PERMISSIONS="SET_PERMISSIONS",e.PENDING="PENDING",e.UPLOADING="UPLOADING",e.COMPLETE="COMPLETE",e.CANCELLED="CANCELLED",e.FAILED="FAILED"})(o=t.FileStatusType||(t.FileStatusType={})),(function(e){e.WRITER="WRITER",e.READER="READER",e.NO_ACCESS="NO_ACCESS",e.INHERIT="INHERIT"})(t.TeamAccessLevel||(t.TeamAccessLevel={})),(function(e){e.FILE_SIZE_ERROR="FILE_SIZE_ERROR",e.HTTP_ERROR="HTTP_ERROR",e.CONNECTION_ERROR="CONNECTION_ERROR",e.OVER_QUOTA_ERROR="OVER_QUOTA_ERROR",e.LOCKED_TEAM_ERROR="LOCKED_TEAM_ERROR",e.IGNORED="IGNORED",e.INVALID_EXTENSION="INVALID_EXTENSION",e.EMPTY_OR_FOLDER="EMPTY_OR_FOLDER",e.FOLDER_SAFARI="FOLDER_SAFARI",e.PACKAGE_FILE="PACKAGE_FILE",e.GENERIC="GENERIC",e.BLOCKS_MISSING_ERROR="BLOCKS_MISSING_ERROR",e.COMMIT_HTTP_ERROR="COMMIT_HTTP_ERROR",e.COMMIT_INVALID_ARGS="COMMIT_INVALID_ARGS",e.UPLOAD_BLOCK_ERROR="UPLOAD_BLOCK_ERROR",e.CHUNKS_NOT_ENABLED_ERROR="CHUNKS_NOT_ENABLED_ERROR",e.SERVER_RESPONSE_ERROR="SERVER_RESPONSE_ERROR",e.SERVER_TOKEN_EMPTY_ERROR="SERVER_TOKEN_EMPTY_ERROR",e.SERVER_TOKENS_MISSING_ERROR="SERVER_TOKENS_MISSING_ERROR",e.SERVER_HASH_RESPONSE_ERROR="SERVER_HASH_RESPONSE_ERROR",e.BLOCK_RUNTIME_ID_MISSING_ERROR="BLOCK_RUNTIME_ID_MISSING",e.CLIENT_HASH_EMPTY_ERROR="CLIENT_HASH_EMPTY_ERROR",e.SERVER_HASH_EMPTY_ERROR="SERVER_HASH_EMPTY_ERROR",e.HASHES_NOT_EQUAL_ERROR="HASHES_NOT_EQUAL_ERROR",e.BLOCK_INDEX_ERROR="BLOCK_INDEX_ERROR",e.BLOCK_EMPTY_ERROR="BLOCK_EMPTY_ERROR",e.BLOB_EMPTY_ERROR="BLOB_EMPTY_ERROR",e.BLOB_MISSING_ERROR="BLOB_MISSING_ERROR",e.CLIENT_HASH_DIGEST_ERROR="CLIENT_HASH_DIGEST_ERROR",e.FILE_READER_NULL_RESULT_ERROR="FILE_READER_NULL_RESULT_ERROR",e.COMMIT_READINESS_ERROR="COMMIT_READINESS_ERROR",e.UPLOAD_PRECHECK_ERROR="UPLOAD_PRECHECK_ERROR",e.UPLOAD_PRECHECK_INVALID_CHAR_ERROR="UPLOAD_PRECHECK_INVALID_CHAR_ERROR",e.PERMISSIONS_AT_UPLOAD_ERROR="PERMISSIONS_AT_UPLOAD_ERROR"})(i=t.UploadErrorType||(t.UploadErrorType={})),(function(e){e.NONE="NONE",e.BASIC_OVER_QUOTA="BASIC_OVER_QUOTA",e.BASIC_NEAR_QUOTA="BASIC_NEAR_QUOTA",e.LIMITED_TEAM_USER_OVER_QUOTA="LIMITED_TEAM_USER_OVER_QUOTA",e.LIMITED_TEAM_TSD_OVER_QUOTA="LIMITED_TEAM_TSD_OVER_QUOTA",e.LOCKED_TEAM_USER_OVER_QUOTA="LOCKED_TEAM_USER_OVER_QUOTA"})(t.OverQuotaStatusType||(t.OverQuotaStatusType={}));var a=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t})(n.Record({uploadId:void 0,dest:"",ns_id:null,ns_path:null,userId:null,name:"",size:0,percentUploaded:0,status:o.SET_PERMISSIONS,errorType:i.GENERIC,errorMessage:"",batchId:void 0,chooserType:void 0},"FileUpload"));t.FileUpload=a,t.UPLOAD_BEGIN_EVENT="dbxUploadBegin",t.UPLOAD_COMPLETE_EVENT="dbxUploadComplete",t.ALL_UPLOADS_COMPLETE_EVENT="dbxAllUploadsComplete",t.UPLOAD_ERROR_EVENT="dbxUploadError",(function(e){e[e["4mb"]=0]="4mb",e[e["8mb"]=1]="8mb"})(t.ValidChunkSizeStrings||(t.ValidChunkSizeStrings={}))})),define("modules/clean/react/file_uploader/utils",["require","exports","tslib","react","dig-components/tooltips","modules/clean/base64","modules/clean/filepath/filepath","modules/clean/react/async_file_modal_controller","modules/clean/react/file_uploader/constants","modules/clean/react/upload_kit/lib/types","modules/core/browser","modules/core/i18n"],(function(e,t,r,n,o,i,a,s,l,c,d,u){"use strict";function _(){for(var e="",t=0;t<16;++t)e+=String.fromCharCode(Math.floor(256*Math.random()));var r=i.encode(e);return r=(r=(r=r.replace(/\+/g,"-")).replace(/\//g,"_")).replace(/\=*$/,"")}function p(e,t){return!e.is_team||!e.is_cdm_member||""!==a.normalize(t)&&(a.paths_are_equal(e.cdm_tmf_path,t)||a.inSubDirectory(e.cdm_tmf_path,t))}function f(e,t){for(var r=e.dest,n=g(t);g(r)-1>n;)r=a.parent_dir(r);return r}function m(e,t){var r=e.toArray().map((function(e){return f(e,t)}));return Array.from(new Set(r))}function g(e){return(a.normalize(e).match(/\//g)||[]).length+1}function h(e){switch(e){case c.UploadErrorType.EmptyFile:return u.intl.formatMessage({id:"KZETkM",defaultMessage:"Empty files cannot be uploaded."});case c.UploadErrorType.OverMaxFileSize:return u.intl.formatMessage({id:"Hg3ZgC",defaultMessage:"File is too large to be uploaded."});default:return u.intl.formatMessage({id:"WQDOGQ",defaultMessage:"This file is not supported by Dropbox and cannot be uploaded."})}}Object.defineProperty(t,"__esModule",{value:!0}),t.folderModalTitle=t.getDestinationDir=t.showInvalidFileWarning=t.getFolderLevel=t.getFileUploadsWithStatus=t.isUploadInTmf=t.uploadContainsFolder=t.isMultifolderUpload=t.getRootDests=t.getRootDest=t.getFSWMetadataToLog=t.PERMISSION_FSW_IDS=t.getUploadLocationMetadataToLog=t.isInMemberFolder=t.getOQmodalOQALocationCode=t.getNsId=t.calculateSizeOfUploads=t.generateBatchId=t.generateUploadId=void 0,n=r.__importDefault(n),i=r.__importStar(i),a=r.__importStar(a),s=r.__importStar(s),d=r.__importStar(d),t.generateUploadId=function(){return _()},t.generateBatchId=function(){return"batch-"+_()},t.calculateSizeOfUploads=function(e,t){var r=0;return e.forEach((function(e){-1!==t.indexOf(e.status)&&(r+=e.size)})),r},t.getNsId=function(e,t,r){var n=t,o=0;return e.forEach((function(e,t){for(var i=0,a=e.split("/"),s=r.split("/");i<a.length&&i<s.length&&a[i]===s[i];)i++;i===a.length&&i>1&&i>o&&(o=i,n=Number(t))})),n},t.getOQmodalOQALocationCode=function(e){return"/h"===(e||d.get_uri().path)?"ho":"fb"},t.isInMemberFolder=p,t.getUploadLocationMetadataToLog=function(e,t){return{root_folder:""===a.normalize(t),member_folder:p(e,t),folder_level:a.normalize(t).split("/").length}},t.PERMISSION_FSW_IDS=["action_commit_to_tsd_root","action_missing_parent"],t.getFSWMetadataToLog=function(e){return{has_permissions:e.includes("action_commit_to_tsd_root"),has_permissions_nonroot:e.includes("action_missing_parent"),has_other:e.some((function(e){return!t.PERMISSION_FSW_IDS.includes(e)}))}},t.getRootDest=f,t.getRootDests=m,t.isMultifolderUpload=function(e,t){var r=m(e.filter((function(e){return l.FileStatusType.SET_PERMISSIONS===e.status})),t);return!r.every((function(e){return e===r[0]}))},t.uploadContainsFolder=function(e,t){var r=e.filter((function(e){return l.FileStatusType.SET_PERMISSIONS===e.status})),n=g(t);return m(r,t).some((function(e){return g(e)>n}))},t.isUploadInTmf=function(e,t){if(!t.cdm_tmf_path)return!1;var r=e.filter((function(e){return l.FileStatusType.SET_PERMISSIONS===e.status})),n=a.normalize(t.cdm_tmf_path);return r.some((function(e){return e.dest===n||a.inSubDirectory(n,e.dest)}))},t.getFileUploadsWithStatus=function(e,t){return e.valueSeq().toArray().filter((function(e){return t.includes(e.status)}))},t.getFolderLevel=g,t.showInvalidFileWarning=function(e,t,r){return new Promise((function(n,o){if(e.length){var i=(function(e){if(1===e.length){var t=e[0],r=t.name,n=t.validationError;return{title:u.intl.formatMessage({id:"uQF0D4",defaultMessage:"Unable to upload {file}"},{file:r}),text:h(n)}}var o=u.intl.formatMessage({id:"Chf30m",defaultMessage:"Unable to upload one or more files"}),i=e.map((function(e){return e.name}));if(e.length<=3)return{title:o,text:u.intl.formatMessage({id:"fKAsp7",defaultMessage:"The following files are not supported by Dropbox and cannot be uploaded: {files}"},{files:i.join(", ")})};var a=i.length-3;return{title:o,text:u.intl.formatMessage({id:"z9swUK",defaultMessage:"{count, plural, one{The following files are not supported by Dropbox and cannot be uploaded: {files} and {count} more} other{The following files are not supported by Dropbox and cannot be uploaded: {files} and {count} more}}"},{files:i.slice(0,3).join(", "),count:a})}})(e),a=i.title,l=i.text;s.showFileSystemWarningsModal({confirmText:u.intl.formatMessage({id:"Bmo28B",defaultMessage:"{count, plural, one{Skip this file} other{Skip these files}}"},{count:e.length}),fsws:[{id:"action_upload_invalid_extension",blocking:t,title:a,text:l,learn_more:"https://www.dropbox.com/help/syncing-uploads/web-based-files"}],onFinalAccept:n,onAbortAction:r?o:void 0})}else n()}))},t.getDestinationDir=function(e,t){var r=a.normalize(e),n=a.parent_dir(t);return""===r?"/"===n?"/":"/"+n:"/"===n?r:r+"/"+n},t.folderModalTitle=n.default.createElement(n.default.Fragment,null,u.intl.formatMessage({id:"2sJoAc",defaultMessage:"Upload file in..."}),n.default.createElement(o.Toggletip,{"aria-label":"More information",iconButtonSize:"standard",title:u.intl.formatMessage({id:"Grmp0v",defaultMessage:"Choose a folder you have access to"})}))})),define("modules/clean/react/files_view/column_helpers",["require","exports","modules/clean/immutability_helper"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.swapColumns=void 0,t.swapColumns=function(e,t,n){var o=e.map((function(e){return e.sortField})).indexOf(t),i=e.map((function(e){return e.sortField})).indexOf(n);if(o===i||-1===o||-1===i)return e;var a=e[o],s=e[i];return r.splice(r.splice(e,o,1,s),i,1,a)}})),define("modules/clean/react/files_view/column_manager",["require","exports","tslib","lodash","react","modules/clean/react/hooks/usePrevious","spectrum/dimensions/index","modules/clean/immutability_helper","modules/clean/react/files_view/column_helpers","modules/clean/react/files_view/resizing/column_size_context","modules/clean/react/files_view/sort_types","modules/clean/react/files_view/view_type"],(function(e,t,r,n,o,i,a,s,l,c,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColumnManagerComponent=t.ColumnManager=void 0,n=r.__importStar(n),o=r.__importDefault(o),t.ColumnManager=function(e){var n=e.responsiveContainer,i=r.__rest(e,["responsiveContainer"]);return(i.isMatchedLarge||i.isMatchedMedium)&&n?o.default.createElement(a.Dimensions,null,(function(e){var n=e.width,a=r.__assign({},i);return n&&(a.isMatchedLarge=n>824,a.isMatchedMedium=!a.isMatchedLarge&&n>588),o.default.createElement(t.ColumnManagerComponent,r.__assign({},a,{containerWidth:n}))})):o.default.createElement(t.ColumnManagerComponent,r.__assign({},i))},t.ColumnManager.displayName="ColumnManager",t.ColumnManagerComponent=function(e){var t=o.default.useState((function(){return e.preferredColumns?E(e):(function(e){return e.columns.slice(0,I(e))})(e)})),a=t[0],_=t[1],p=o.default.useState((function(){return b(a)})),f=p[0],m=p[1],g=o.default.useRef(),h=o.default.useRef(),S=i.usePrevious(e);function E(e){var t=e.currentSort,r=e.viewType,n=e.preferredColumns;if(r===u.ViewType.Grid||r===u.ViewType.LargeGrid){var o=n.find((function(e){return e.sortField===t.sortField}));n=[o||n[0]]}else n=n.slice(0,I(e));return n}function v(t,r){void 0===r&&(r=!1);var n=b(t);_(t),m(n),r?g.current=setTimeout((function(){T(),e.onCanDisplayFolderSizesChanged(n)})):e.onCanDisplayFolderSizesChanged(n)}o.default.useEffect((function(){if(S)if(e.preferredColumns){var t=E(e);n.isEqual(t,a)||v(t,!0)}else{var o=e.columns,i=e.currentSort,s=I(S),c=I(e);if(n.isEqual(e.columns,S.columns)&&e.viewType===S.viewType){if(c<s)v(a.slice(0,c),!0);else if(c>s){var d=c-a.length,p=n.filter(o,(function(e){return!n.find(a,(function(t){return t.sortField===e.sortField}))})).slice(0,d);v(r.__spreadArrays(a,p),!0)}}else if(1===c&&o.length&&i){var g=e.viewType,T=e.viewTypeColumns,F=T?T[u.ViewType.Grid]:void 0;switch(g){case u.ViewType.List:case u.ViewType.CondensedList:v([o[0]],!0);break;case u.ViewType.Grid:case u.ViewType.LargeGrid:if(F){var C=o.find((function(e){return e.sortField===i.sortField}))||o[0];(function(t,r,n){w();var o=b(t);_(t),m(o),h.current=setTimeout((function(){w(),e.onColumnsChanged({columns:r,viewType:n,canDisplayFolderSizes:o})}))})([C],l.swapColumns(F,F[0].sortField,C.sortField),g)}}}else v(o.slice(0,c),!0)}else e.onCanDisplayFolderSizesChanged(f)}),[e.columns,e.viewType,e.isMatchedLarge,e.isMatchedMedium,e.numVisibleColumns,e.preferredColumns]);var T=function(){g.current&&(clearTimeout(g.current),g.current=void 0)};function w(){h.current&&(clearTimeout(h.current),h.current=void 0)}function I(e){var t=e.isMatchedLarge,r=e.isMatchedMedium,n=e.viewType,o=e.numVisibleColumns,i=e.isMoreColumnsEnabled,a=e.isSearchMode;switch(n){case u.ViewType.Grid:case u.ViewType.LargeGrid:return 1;case u.ViewType.List:case u.ViewType.CondensedList:default:return i?a?3:o||3:t?3:r?2:1}}function b(e){return e.some((function(e){return e.sortField===d.SortField.SIZE}))}var F=e.children,C=e.containerWidth;if(!F)return null;var O=F;return"function"==typeof F&&(O=F({visibleColumns:a,canDisplayFolderSizes:f,handleSelection:function(t,n){var o=e.isMoreColumnsEnabled,i=e.preferredColumns,c=e.viewType;o&&i&&(c===u.ViewType.List||c===u.ViewType.CondensedList)?(function(t,n,o){var i=e.onColumnsChanged,l=e.viewType,c=a.indexOf(t),d=a.includes(n)?a.indexOf(n):a.length-1,u=c>=0?s.splice(a,c,1):s.splice(a,d+1,0,t);v(u),i({columns:r.__spreadArrays(u,o.filter((function(e){return!u.includes(e)}))),viewType:l,canDisplayFolderSizes:b(u),numVisibleColumns:u.length})})(t,n,i):(function(t,r){var n=e.viewType,o=e.onColumnsChanged,i=e.viewTypeColumns,c=e.preferredColumns,_=c||(i?i[u.ViewType.List]:void 0),p=i?i[u.ViewType.Grid]:void 0;if(_&&p){var f=a.indexOf(r);if(-1===f||a.includes(t))v(a);else{var m=s.splice(a,f,1,t);v(m);var g=b(m);n===u.ViewType.List||n===u.ViewType.CondensedList?o({columns:l.swapColumns(_,r.sortField,t.sortField),viewType:u.ViewType.List,canDisplayFolderSizes:g}):(c||o({columns:l.swapColumns(p,r.sortField,t.sortField),viewType:n,canDisplayFolderSizes:g}),t.sortField!==d.SortField.FILENAME&&o({columns:l.swapColumns(_,_[1].sortField,t.sortField),viewType:u.ViewType.List,canDisplayFolderSizes:g}))}}})(t,n)},handleReorder:function(t,n){var o=e.preferredColumns,i=e.onColumnsChanged,l=e.viewType;if(o&&a[t]&&a[n]){var c=s.splice(s.splice(a,n,1),t,0,a[n]);v(c),i({columns:r.__spreadArrays(c,o.filter((function(e){return!c.includes(e)}))),viewType:l,canDisplayFolderSizes:b(c),numVisibleColumns:c.length})}},containerWidth:C})),o.default.createElement(c.ColumnResizingProvider,{storageSetting:e.columnResizeStorageSetting||c.noStorage,columnResizingEnabled:!!e.isMoreColumnsEnabled,scrollContainerWidth:e.scrollContainerWidth,visibleColumns:a},O)}})),define("modules/clean/react/files_view/column_headers/column_header_cell",["require","exports","tslib","classnames","react","dig-components/buttons","dig-components/icons","dig-components/icons/src","dig-components/typography","spectrum/table/index","modules/clean/react/files_view/column_headers/draggable_reorder","modules/clean/react/files_view/resizing/column_size_context","modules/clean/react/files_view/sort_types","focus-visible"],(function(e,t,r,n,o,i,a,s,l,c,d,u,_){"use strict";function p(e){return e===_.SortDirection.ASCENDING?"ascending":e===_.SortDirection.DESCENDING?"descending":"none"}Object.defineProperty(t,"__esModule",{value:!0}),t.ColumnHeaderCell=void 0,n=r.__importDefault(n),o=r.__importDefault(o),s=r.__importStar(s);var f=function(e,t){return function(r){r.getModifierState("Alt")&&"ArrowLeft"===r.key&&e(),r.getModifierState("Alt")&&"ArrowRight"===r.key&&t()}},m=function(e){var t=e.column,r=e.sortDirection,c=e.setSort,d=e.onDecreaseSize,p=e.onIncreaseSize,m=o.default.useContext(u.ColumnResizingContext).columnResizingEnabled;return t.isSortDisabled||t.isSortOrderOptionDisabled?o.default.createElement(l.Text,{variant:"label",isBold:void 0!==r,className:n.default("files-view-column-header-unclickable","files-view-column-header-text",{"column-resizing-enabled":m}),tabIndex:m?0:void 0,onKeyDown:f(d,p)},t.label):o.default.createElement(i.Button,{variant:"transparent",hasNoUnderline:!0,onClick:function(){return c(t.sortField,(function(e){switch(e){case _.SortDirection.ASCENDING:return _.SortDirection.DESCENDING;default:return _.SortDirection.ASCENDING}})(r))},className:n.default("files-view-column-header-text",{"column-resizing-enabled":m}),onKeyDown:f(d,p)},o.default.createElement(l.Text,{variant:"label",isBold:void 0!==r},t.label),r&&o.default.createElement(a.UIIcon,{src:r===_.SortDirection.ASCENDING?s.ArrowUpLine:s.ArrowDownLine,size:"small",className:"files-view-column-header-sort-button"}))};m.displayName="ColumnHeaderCellContent",m.displayName="ColumnHeaderCellContent";var g=function(e){var t=e.index,i=e.className,a=r.__rest(e,["index","className"]),s=d.useDraggableReorder(t),l=s.className,u=r.__rest(s,["className"]);return o.default.createElement(c.TableHeadCell,r.__assign({className:n.default(i,l)},a,u))};g.displayName="DraggableTableHeadCell",t.ColumnHeaderCell=function(e){var t,n=e.children,i=e.column,a=e.index,s=e.role,l=e.setSort,d=e.sortDirection,_=e.canMove,f=e.onDecreaseSize,h=e.onIncreaseSize,S=o.default.useContext(u.ColumnResizingContext);S.columnResizingEnabled&&(t=S.columnSizes[i.sortField]);var E=void 0===t?{}:{width:t,minWidth:t,maxWidth:t},v={key:a,role:s,scope:"col","aria-sort":p(d),className:"files-view-column-header-table-cell",style:E,children:o.default.createElement(o.default.Fragment,null,o.default.createElement(m,{column:i,sortDirection:d,setSort:l,onDecreaseSize:f,onIncreaseSize:h}),n)};return _?o.default.createElement(g,r.__assign({index:a},v)):o.default.createElement(c.TableHeadCell,r.__assign({},v))},t.ColumnHeaderCell.displayName="ColumnHeaderCell",t.ColumnHeaderCell.displayName="ColumnHeaderCell"})),define("modules/clean/react/files_view/column_headers/column_header_menu",["require","exports","tslib","classnames","react","react-redux","dig-components/buttons","dig-components/icons","dig-components/icons/src","dig-components/menu","modules/core/i18n","modules/clean/react/browse/data/selectors","modules/clean/tagging/experiments","modules/clean/react/files_view/column_headers/tags_column_tooltip/index"],(function(e,t,r,n,o,i,a,s,l,c,d,u,_,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColumnHeaderMenu=t.AvailableMoves=void 0,n=r.__importDefault(n),o=r.__importDefault(o);var f;(function(e){e[e.NONE=0]="NONE",e[e.LEFT=1]="LEFT",e[e.RIGHT=2]="RIGHT",e[e.BOTH=3]="BOTH"})(f=t.AvailableMoves||(t.AvailableMoves={})),t.ColumnHeaderMenu=function(e){var t=e.columns,m=e.index,g=e.onSelection,h=e.onMenuOpen,S=e.selectedColumns,E=e.title,v=e.allowUnchecking,T=e.availableMoves,w=e.isSearchMode,I=[f.BOTH,f.LEFT].includes(T),b=[f.BOTH,f.RIGHT].includes(T),F=I||b,C=o.default.useState(!1),O=C[0],R=C[1],A=i.useSelector(u.manualTaggingVariant),y=0===m&&!w&&_.isTagsColumnOnBrowseEnabled(A);return o.default.createElement(c.Menu.Wrapper,{onSelection:function(e){return g(m,e)},onToggle:function(e){return e.isOpen&&h(m,S[m].popoverTriggerLabel)}},(function(e){var i=e.getContentProps,u=e.getTriggerProps,_=e.triggerRef;return o.default.createElement(o.default.Fragment,null,o.default.createElement(a.IconButton,r.__assign({},u(),{variant:"transparent",size:"small","aria-label":d.intl.formatMessage({id:"+D26UW",defaultMessage:"Change column"}),className:n.default("files-view-column-header-menu-button",{"files-view-column-header-menu-open":i().open||O}),"data-testid":"files-view-column-header-menu-trigger"}),o.default.createElement(s.UIIcon,{src:l.ChevronDownLine,size:"small"})),o.default.createElement(c.Menu.Content,r.__assign({},i(),{placement:"bottom-end"}),o.default.createElement(c.Menu.Segment,{withLabel:E},t.map((function(e){return o.default.createElement(c.Menu.SelectItem,{"aria-label":e.popoverTriggerLabel,key:e.popoverTriggerLabel,value:{type:"ColumnSelection",payload:e},selected:S.includes(e),disabled:e.isLocked||!v&&S.includes(e)},e.label)}))),F&&o.default.createElement(c.Menu.Segment,{withLabel:d.intl.formatMessage({id:"Yzabjr",defaultMessage:"Adjust"})},o.default.createElement(c.Menu.Submenu,{withTriggerContent:d.intl.formatMessage({id:"qKy/7I",defaultMessage:"Column order"})},o.default.createElement(c.Menu.Segment,null,o.default.createElement(c.Menu.ActionItem,{value:{type:"ColumnOrderSelection",payload:"left"},disabled:!I},d.intl.formatMessage({id:"obFNpg",defaultMessage:"Move left"})),o.default.createElement(c.Menu.ActionItem,{value:{type:"ColumnOrderSelection",payload:"right"},disabled:!b},d.intl.formatMessage({id:"7QBrxY",defaultMessage:"Move right"})))))),y&&o.default.createElement(p.TagsColumnTooltip,{showTooltip:O,setShowTooltip:R,triggerRef:_}))}))},t.ColumnHeaderMenu.displayName="ColumnHeaderMenu"})),define("modules/clean/react/files_view/column_headers/dig_column_header",["require","exports","tslib","classnames","react","dig-components/controls","spectrum/table/index","modules/clean/react/files_view/column_headers/column_header_cell","modules/clean/react/files_view/column_headers/column_header_menu","modules/clean/react/files_view/column_headers/draggable_reorder","modules/clean/react/files_view/column_headers/resize_handle","modules/clean/react/files_view/constants","modules/clean/react/files_view/fixed_table_head","modules/clean/react/files_view/resizing/column_size_context","modules/clean/react/files_view/sticky_table_head","modules/clean/react/files_view/sort_types","modules/clean/react/files_view/view_type","modules/core/i18n"],(function(e,t,r,n,o,i,a,s,l,c,d,u,_,p,f,m,g,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColumnHeader=void 0,n=r.__importDefault(n),o=r.__importDefault(o);var S=function(e,t){switch(e){case g.ViewType.Grid:case g.ViewType.LargeGrid:return h.intl.formatMessage({id:"iWzO4p",defaultMessage:"Group by"});case g.ViewType.List:default:return t?h.intl.formatMessage({id:"t3Jo9w",defaultMessage:"Sort by"}):h.intl.formatMessage({id:"IUsgJf",defaultMessage:"Show"})}};t.ColumnHeader=function(e){var t=e.columnFlex,g=e.items,E=e.isCompactMode,v=e.isSelectMode,T=e.currentSort,w=e.selectAllCheckboxState,I=void 0===w?"unchecked":w,b=e.showSelectAllCheckbox,F=void 0===b||b,C=e.stickyOffsetHeight,O=e.stickyOffsetTop,R=e.columns,A=e.visibleColumns,y=e.viewType,D=e.isSearchMode,L=e.presentationOnly,M=e.variant,N=void 0===M?"fixed":M,P=e.onMenuOpen,U=e.onSelectAll,x=e.onDeselectAll,k=e.onReorder,V=e.onSort,W=e.onSelection,H=e.isMoreColumnsEnabled,B=e.disableResizing,G=o.default.useContext(p.ColumnResizingContext),q=G.resizeColumn,z=G.resizeColumnToDefault,j=G.columnSizes,K=G.columnResizingEnabled&&!B,Y=o.default.useState(!1),Q=Y[0],X=Y[1],J=o.default.useState(!1),Z=J[0],$=J[1],ee={onMouseEnter:function(){return $(!0)},onMouseLeave:function(){return $(!1)}},te=D?u.SEARCH_LIST_VIEW_SORT_ENABLED_COLUMNS:R,re=te.filter((function(e){return!e.isLocked})),ne=!v&&!Z&&!E,oe=function(e,t){if("ColumnSelection"===t.type&&(function(e){return"string"==typeof(null==e?void 0:e.popoverTriggerLabel)})(t.payload)){var r=A[e],n=t.payload;W(n,r,e),D?V(n.sortField,m.SortDirection.DESCENDING):H?A.includes(n)&&(null==T?void 0:T.sortField)===n.sortField&&V(A[0].sortField,m.SortDirection.ASCENDING):(null==T?void 0:T.sortField)===r.sortField&&(n.isSortOrderOptionDisabled?V(A[0].sortField,m.SortDirection.ASCENDING):V(n.sortField,T.sortDirection||m.SortDirection.ASCENDING))}else"ColumnOrderSelection"===t.type&&("right"===t.payload&&e<A.length-1?k(e+1,e):"left"===t.payload&&e>1&&k(e-1,e))},ie=A.map((function(e,t){var r=(function(e){if(!H)return l.AvailableMoves.NONE;var t=A[e];if(!t||t.isLocked)return l.AvailableMoves.NONE;var r=0!==e&&!A[e-1].isLocked,n=e!==A.length-1&&!A[e+1].isLocked;return r&&n?l.AvailableMoves.BOTH:r?l.AvailableMoves.LEFT:n?l.AvailableMoves.RIGHT:l.AvailableMoves.NONE})(t),n=H||!(e.isLocked||e.isSortDisabled);return o.default.createElement(s.ColumnHeaderCell,{key:e.popoverTriggerLabel,column:e,index:t,setSort:V,role:L?"presentation":"columnheader",sortDirection:(null==T?void 0:T.sortField)===e.sortField?T.sortDirection:void 0,canMove:r!==l.AvailableMoves.NONE,onIncreaseSize:function(){return q(e.sortField,j[e.sortField]+4)},onDecreaseSize:function(){return q(e.sortField,j[e.sortField]-4)}},n&&o.default.createElement(l.ColumnHeaderMenu,{columns:H?te:re,index:t,onMenuOpen:P,onSelection:oe,selectedColumns:A,title:S(y,!!D),allowUnchecking:H,availableMoves:r,isSearchMode:D}),K&&void 0!==q&&void 0!==z&&void 0!==T&&o.default.createElement(d.ResizeHandle,{onResize:function(t){X(!0),q(e.sortField,t)},onResizeToDefault:function(){return z(e.sortField)},onColumnResizeEnd:function(){return X(!1)},sortField:e.sortField,items:g}))})),ae=o.default.createElement(c.DraggableReorderProvider,{onReorder:k},o.default.createElement(a.TableHeadCell,{className:"files-view-column-header-table-cell brws-checkbox-cell",key:"checkbox-cell",role:L?"presentation":"columnheader",scope:"col"},o.default.createElement("div",{className:"brws-vertically-center"},F&&!ne?o.default.createElement(i.Checkbox,{className:n.default("brws-checkbox",{"brws-checkbox-checked":"checked"===I}),checked:"checked"===I,isIndeterminate:"mixed"===I,onChange:function(e){"unchecked"===I?U():x()},"aria-label":h.intl.formatMessage({id:"YzMs/g",defaultMessage:"Select all"})}):null)),ie);return"default"===N?o.default.createElement(a.TableHead,r.__assign({className:n.default("brws-column-header",{"header-column-resize":K,"column-header-is-resizing":Q})},ee,{"data-testid":"table-head"}),ae):"fixed"===N?o.default.createElement(_.FixedTableHead,r.__assign({offsetHeight:C},ee,{"data-testid":"fixed-table-head"}),ae):"sticky-native"===N?o.default.createElement(a.TableHead,r.__assign({className:n.default("brws-column-header brws-column-header--sticky",{"header-column-resize":K,"column-header-is-resizing":Q}),style:{top:O}},ee,{"data-testid":"sticky-native-table-head"}),ae):o.default.createElement(f.StickyTableHead,r.__assign({columnFlex:t,offsetHeight:C,offsetTop:O,className:n.default("brws-column-header",{"header-column-resize":K,"column-header-is-resizing":Q})},ee,{"data-testid":"sticky-table-head"}),ae)},t.ColumnHeader.displayName="ColumnHeader",t.ColumnHeader.displayName="ColumnHeader"})),define("modules/clean/react/files_view/column_headers/resize_handle",["require","exports","tslib","react","modules/clean/em_string","modules/clean/react/browse/models","modules/clean/react/files_view/util","modules/clean/react/files_view/sort_types","modules/clean/react/files_view/rows/cells/async_folder_size"],(function(e,t,r,n,o,i,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResizeHandle=t.SCROLLBAR_WIDTH=void 0,n=r.__importDefault(n);t.SCROLLBAR_WIDTH=16;var c=function(e){return 14*new o.Emstring(e).length};t.ResizeHandle=function(e){var r=e.items,o=e.onResize,d=e.onResizeToDefault,u=e.onColumnResizeEnd,_=e.sortField,p=n.default.useRef({type:"not_resizing"}),f=n.default.useState(),m=f[0],g=f[1];n.default.useRef(o).current=o;var h=n.default.useCallback((function(e){if("resizing"===p.current.type){var t=p.current,r=t.startingPageX,n=t.startingWidth,i=n-(r-e.pageX);i!==n&&o(i)}}),[]),S=n.default.useCallback((function(e){window.removeEventListener("mousemove",h),window.removeEventListener("mouseup",S),p.current={type:"not_resizing"},g(void 0),u()}),[]),E=function(e){e.preventDefault(),window.document.removeEventListener("click",E,!0)},v=function(){var e=0;null==r||r.forEach((function(t){if(t instanceof i.File)switch(_){case s.SortField.CATEGORY:e=Math.max(c(i.File.getCategoryDescription(t)),e);break;case s.SortField.EXTENSION:e=Math.max(c(i.File.getExtension(t)),e);break;case s.SortField.FILENAME:e=Math.max(c(a.getFilename(t)),e);break;case s.SortField.MODIFIED:case s.SortField.RELEVANCE:e=Math.max(c(t.is_dir?"--":t.ago),e);break;case s.SortField.SIZE:e=Math.max(c(t.is_dir?"--":t.size),e)}else if(t instanceof i.FileSharedWithMe)switch(_){case s.SortField.FILENAME:e=Math.max(c(a.getFilename(t)),e);break;case s.SortField.MODIFIED:case s.SortField.RELEVANCE:e=Math.max(c(t.agoFromLastActionByUserTs||t.ago),e);break;case s.SortField.SIZE:e=Math.max(c(t.is_cloud_doc&&l.isCloudDocProviderStored(t)?"--":t.size),e)}}));var t=30;return _===s.SortField.FILENAME&&(t=110),e>0?e+t:0};return n.default.createElement("div",{className:"resize-drag-handle",onMouseDown:function(e){e.preventDefault(),e.stopPropagation(),window.addEventListener("mousemove",h),window.addEventListener("mouseup",S);var r=window.innerHeight-e.currentTarget.getBoundingClientRect().top-4-t.SCROLLBAR_WIDTH;p.current={type:"resizing",startingWidth:e.currentTarget.parentElement.getBoundingClientRect().width,startingPageX:e.pageX},g(r),window.document.addEventListener("click",E,!0)},onDoubleClick:function(){if(_===s.SortField.SHARED_WITH)d();else{var e=v();e>0?o(e):d()}},"data-testid":"resize-handle"},void 0!==m&&n.default.createElement("div",{className:"resize-vertical-focus-line",style:{height:m+"px"}}))},t.ResizeHandle.displayName="ResizeHandle",t.ResizeHandle.displayName="ResizeHandle"})),define("modules/clean/react/files_view/column_headers/draggable_reorder",["require","exports","tslib","classnames","react"],(function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useDraggableReorder=t.DraggableReorderProvider=void 0,n=r.__importDefault(n);var i=(o=r.__importStar(o)).default.createContext({draggedIndex:null,setDraggedIndex:function(){},onReorder:function(){}});t.DraggableReorderProvider=function(e){var t=e.onReorder,r=e.children,n=o.useState(null),a=n[0],s=n[1];return o.default.createElement(i.Provider,{value:{draggedIndex:a,setDraggedIndex:s,onReorder:t}},r)},t.DraggableReorderProvider.displayName="DraggableReorderProvider",t.DraggableReorderProvider.displayName="DraggableReorderProvider",t.useDraggableReorder=function(e){var t=o.useContext(i),r=t.draggedIndex,a=t.setDraggedIndex,s=t.onReorder,l=o.useState(!1),c=l[0],d=l[1],u=o.useRef(null),_=r===e,p=null!==r&&!_;return{draggable:!0,onDragStart:o.useCallback((function(t){t.dataTransfer&&(t.dataTransfer.effectAllowed="move",t.dataTransfer.dropEffect="move"),a(e)}),[e]),onDragEnd:o.useCallback((function(e){e.preventDefault(),e.stopPropagation(),a(null)}),[]),onDragEnter:o.useCallback((function(e){p&&(e.preventDefault(),e.stopPropagation(),d(!0),u.current=e.target)}),[p]),onDragLeave:o.useCallback((function(e){e.target===u.current&&(e.preventDefault(),e.stopPropagation(),d(!1))}),[]),onDrop:o.useCallback((function(t){p&&null!==r&&(t.preventDefault(),t.stopPropagation(),a(null),d(!1),s(e,r))}),[e,p,r,s]),className:n.default("draggable-reorder",{"draggable-reorder--dragging":_,"draggable-reorder--dragged-over-from-right":c&&null!==r&&r-e>0,"draggable-reorder--dragged-over-from-left":c&&null!==r&&r-e<0})}}})),define("modules/clean/react/files_view/column_headers/tags_column_tooltip/component",["require","exports","tslib","react","react-intl","dig-components/buttons","dig-components/click_outside","dig-components/typography","dig-components/tooltips","modules/clean/react/files_view/resizing/column_size_context","modules/clean/react/files_view/sort_types","modules/clean/react/files_view/column_headers/tags_column_tooltip/tracker"],(function(e,t,r,n,o,i,a,s,l,c,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TagsColumnTooltip=void 0,n=r.__importDefault(n),t.TagsColumnTooltip=n.default.memo((function(e){var t=e.showTooltip,r=e.setShowTooltip,_=e.triggerRef,p=n.default.useState("bottom"),f=p[0],m=p[1],g=o.useIntl(),h=n.default.useContext(c.ColumnResizingContext).columnSizes,S=n.default.useRef(null),E=h[d.SortField.FILENAME];n.default.useEffect((function(){var e;null===(e=null==S?void 0:S.current)||void 0===e||e.update()}),[E]),n.default.useEffect((function(){u.fetchTagsColumnTooltipSeen().then((function(e){return r(!e)}))}),[r]);var v=function(){r(!1),m("bottom")};return n.default.createElement(a.ClickOutside,{isActive:t,onClickOutside:v},n.default.createElement(l.Tooltip.Control,{variant:"rich",open:t,ref:S,triggerRef:_,auto:!0,placement:f,onChangePlacement:function(e){return m(e)},onDisplayed:function(){u.setTagsColumnTooltipSeen()}},n.default.createElement(s.Title,{size:"standard",inverse:!0},g.formatMessage({id:"+NJwpB",defaultMessage:"Show tags here"})),n.default.createElement(s.Text,{tagName:"p",color:"standard",inverse:!0},g.formatMessage({id:"7uh+Vn",defaultMessage:"To see all these files’ tags at a glance, just click the arrow and choose “tags” from the list."})),n.default.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",marginTop:"var(--spacing__unit--2)"}},n.default.createElement(i.Button,{variant:"outline",inverse:!0,onClick:v,autoFocus:!0},g.formatMessage({id:"5LJHki",defaultMessage:"Got it"})))))})),t.TagsColumnTooltip.displayName="TagsColumnTooltip"})),define("modules/clean/react/files_view/column_headers/tags_column_tooltip/index",["require","exports","modules/clean/react/files_view/column_headers/tags_column_tooltip/component"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TagsColumnTooltip=void 0,Object.defineProperty(t,"TagsColumnTooltip",{enumerable:!0,get:function(){return r.TagsColumnTooltip}})})),define("modules/clean/react/files_view/column_headers/tags_column_tooltip/tracker",["require","exports","tslib","modules/clean/growth/user_action/tracker","api_v2/default_user_client","modules/clean/viewer"],(function(e,t,r,n,o,i){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),t.setTagsColumnTooltipSeen=t.fetchTagsColumnTooltipSeen=void 0,(function(e){e.TAGS_COLUMN_TOOLTIP_SEEN="tags_column_tooltip_seen"})(a||(a={}));var s=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.project="manual_tagging",t}return r.__extends(t,e),t})(n.GrowthUserActionTracker);t.fetchTagsColumnTooltipSeen=function(){var e;return r.__awaiter(this,void 0,Promise,(function(){var t,n,l,c;return r.__generator(this,(function(r){switch(r.label){case 0:return t=i.Viewer.get_viewer(),(n=null!==(e=t.work_user)&&void 0!==e?e:t.personal_user)?(l=new o.DefaultUserApiV2Client(n),c=new s(n.id),[4,l.ns("growth").rpc("performed_user_action",{project:c.project,action:a.TAGS_COLUMN_TOOLTIP_SEEN},{})]):[2,!0];case 1:return[2,r.sent().has_performed]}}))}))},t.setTagsColumnTooltipSeen=function(){var e;return r.__awaiter(this,void 0,Promise,(function(){var t,n;return r.__generator(this,(function(r){return t=i.Viewer.get_viewer(),(n=null!==(e=t.work_user)&&void 0!==e?e:t.personal_user)?[2,new s(n.id).track(a.TAGS_COLUMN_TOOLTIP_SEEN)]:[2]}))}))}})),define("modules/clean/react/files_view/resizing/column_size_context",["require","exports","tslib","react","lodash","modules/core/browser_detection","modules/clean/react/files_view/constants","modules/clean/react/files_view/sort_types","lodash"],(function(e,t,r,n,o,i,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColumnResizingProvider=t.localStorage=t.noStorage=t.ColumnResizingContext=void 0,n=r.__importDefault(n),l=r.__importStar(l);var c={columnResizingEnabled:!1,columnSizes:a.COLUMN_DEFAULT_WIDTHS,resizeColumn:function(e,t){},resizeColumnToDefault:function(e){}};function d(e,t){var r=a.COLUMN_MIN_WIDTHS[t],n=a.COLUMN_MAX_WIDTHS[t];return Math.min(Math.max(e,r),n)}function u(e){return l.mapValues(e,(function(e,t){return d(e,t)}))}t.ColumnResizingContext=n.default.createContext(c);var _=o.debounce((function(e,t){window.localStorage.setItem(e,JSON.stringify(t))}));t.noStorage={type:"no_storage"},t.localStorage={type:"local_storage",localStorageKey:"dbx_files_view_column_sizes"};var p=function(e){var t=n.default.useRef(e);return t.current=e,t};t.ColumnResizingProvider=function(e){var o=e.children,c=e.storageSetting,f=e.columnResizingEnabled,m=e.scrollContainerWidth,g=e.visibleColumns,h=n.default.useState((function(){switch(c.type){case"no_storage":return a.COLUMN_DEFAULT_WIDTHS;case"local_storage":return(function(e){try{var t=window.localStorage.getItem(e),r=JSON.parse(t);return l.mapValues(a.COLUMN_DEFAULT_WIDTHS,(function(e,t){var n=r[t];return"number"==typeof n?n:e}))}catch(e){return a.COLUMN_DEFAULT_WIDTHS}})(c.localStorageKey)}})),S=h[0],E=h[1],v=p(S),T=p(m),w=n.default.useRef("UNFROZEN"),I=n.default.useRef(i.safari);n.default.useEffect((function(){if(f&&m&&m>0){if(I.current)return void(I.current=!1);var e=b(S),t="UNFROZEN"===w.current||"OVERFLOW"===w.current&&m>e||"UNDERFLOW"===w.current&&m<e;e>0&&m!==e&&t&&F(s.SortField.FILENAME,m-(e-S[s.SortField.FILENAME]),"DYNAMIC")}}),[m]);var b=function(e){var t=0;return g.map((function(e){return e.sortField})).forEach((function(r){t+=e[r]})),t},F=n.default.useCallback((function(e,t,n){var o;if(void 0===n&&(n="MANUAL"),v.current[e]!==t){var i=r.__assign(r.__assign({},v.current),((o={})[e]=d(t,e),o));E(i),"local_storage"===c.type&&_(c.localStorageKey,i),"MANUAL"===n&&T.current?w.current=b(i)>T.current?"OVERFLOW":"UNDERFLOW":"DYNAMIC"===n&&(w.current="UNFROZEN")}}),[c,v,T]),C=n.default.useCallback((function(e){var t=a.COLUMN_DEFAULT_WIDTHS[e];F(e,t)}),[F]),O=n.default.useMemo((function(){return{columnSizes:u(S),resizeColumn:F,resizeColumnToDefault:C,columnResizingEnabled:f}}),[S,F,C,f]);return n.default.createElement(t.ColumnResizingContext.Provider,{value:O},o)},t.ColumnResizingProvider.displayName="ColumnResizingProvider",t.ColumnResizingProvider.displayName="ColumnResizingProvider"})),define("modules/clean/react/files_view/contexts/files_view_context",["require","exports","tslib","react","react-redux","modules/clean/react/files_view/contexts/callback_context","modules/clean/react/files_view/contexts/file_thumb_store","modules/clean/react/files_view/view_type","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/browse/data/selectors","modules/clean/react/files_view/contexts/experiments_context"],(function(e,t,r,n,o,i,a,s,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FilesViewContextProvider=void 0,n=r.__importStar(n);t.FilesViewContextProvider=function(e){var t=e.children,r=e.props,u=e.instanceId,_=r.items,p=r.path,f=o.useSelector((function(e){return function(t){return l.selectViewType(t,{instanceId:e})}})(u)),m=o.useSelector(c.selectBrowseExperimentsOptional)||{};return n.createElement(i.FilesViewCallbackContextProvider,{props:r},n.createElement(d.ExperimentsContext.Provider,{value:m},n.createElement(a.ThumbStoreProvider,{shouldPrewarm:f!==s.ViewType.Grid,items:_,path:p},t)))},t.FilesViewContextProvider.displayName="FilesViewContextProvider"})),define("modules/clean/react/files_view/controller",["require","exports","tslib","react-redux","react","modules/clean/react/files_view/data/store","modules/clean/react/files_view/files_view","modules/clean/react/files_view/data/action_creators","modules/clean/react/files_view/contexts/files_view_context","modules/clean/react/flows/types","modules/clean/react/files_view/legacy_types"],(function(e,t,r,n,o,i,a,s,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FilesViewController=t.FilesViewWithUpserter=t.splitProps=void 0,o=r.__importDefault(o),r.__exportStar(d,t);var u={arePostTTIModulesLoaded:!0,context:!0,createNewFolderState:!0,items:!0,selection:!0,user:!0,responsive:!0,clipboard:!0,currentSort:!0,disabledMultiselect:!0,dropTargetHighlightMode:!0,enableUnity:!0,expBizFoldersEmptyStateAdmin:!0,expBizFoldersEmptyStateUser:!0,fileRename:!0,filteredContactName:!0,renderFilenameSubtitleAsLink:!0,hideViewFileButton:!0,highDensity:!0,isOverFreeQuota:!0,isSearchMode:!0,loadingState:!0,sharingServiceInfo:!0,starredState:!0,teamFolders:!0,viewTypeScope:!0,viewTypes:!0,eligibleForFirstTaskSubtitle:!0,expVaultEnableViewOnlySharing:!0,isActionBarEnabled:!0,inlineActionBar:!0,expAutoPDFConversionBackend:!0,expFlowsAutoUnzipLambda:!0,expFlowsAutomatedFolderUI:!0,fileHasAutomatedRuleMap:c.FlowsMap({}),expManualTagging:"OFF",currentFolderInfo:!0,mediaFiltersVariant:"OFF",isRightClickEnabled:!0},_=function(e,t,r){t[r]=e[r]};t.splitProps=function(e){for(var t={},r={},n=0,o=Object.keys(e);n<o.length;n++){var i=o[n];if(u.hasOwnProperty(i)){var a=i;void 0!==e[a]&&_(e,r,a)}else _(e,t,i)}return{ownProps:t,upsertedProps:r}};var p=0,f=function(e){var i=e.id,c=e.isActive,d=void 0===c||c,u=n.useDispatch(),_=t.splitProps(e),f=_.ownProps,m=_.upsertedProps,g=o.default.useMemo((function(){return i||"files-view:"+p++}),[i]),h=g!==i;return u(s.upsertInstance(g,m)),o.default.useEffect((function(){return function(){h&&u(s.deleteInstance(g))}}),[h,u,g]),o.default.useEffect((function(){d&&i&&u(s.markActiveInstance(i))}),[d,i,u]),o.default.createElement(l.FilesViewContextProvider,{props:e,instanceId:g},o.default.createElement(a.FilesView,r.__assign({},f,{id:g})))};f.displayName="UpsertWrapper",t.FilesViewWithUpserter=n.connect()(f);var m=i.getStoreForFilesView();t.FilesViewController=function(e){return o.default.createElement(n.Provider,{store:m},o.default.createElement(t.FilesViewWithUpserter,r.__assign({},e)))},t.FilesViewController.displayName="FilesViewController"})),define("modules/clean/react/files_view/culled_table_body",["require","exports","tslib","spectrum/table/index","modules/clean/react/files_view/util","react"],(function(e,t,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.computeOffsetCache=t.scrollTo=t.CulledTableBodyWithScrollToRow=t.CulledTableBodyWithScrollContainer=void 0,i=r.__importDefault(i),t.CulledTableBodyWithScrollContainer=function(e){var t=e.scrollContainer,n=r.__rest(e,["scrollContainer"]),s=i.default.useMemo((function(){return(null==t?void 0:t.current)?o.createFakeWindow(t.current):null}),[null==t?void 0:t.current]);return t?t.current&&s?i.default.createElement(a,r.__assign({},n,{shouldUseWindowAsScrollContainer:!0,window:s})):null:i.default.createElement(a,r.__assign({},n))},t.CulledTableBodyWithScrollContainer.displayName="CulledTableBodyWithScrollContainer",t.CulledTableBodyWithScrollContainer.displayName="CulledTableBodyWithScrollContainer";var a=(function(e){function o(t){var r=e.call(this,t)||this;return r.updateOffsetCache(),r}return r.__extends(o,e),o.prototype.componentDidMount=function(){this.updateScroll(!0)},o.prototype.componentDidUpdate=function(e){e.listItemHeight!==this.props.listItemHeight&&this.updateOffsetCache(),e.scrollToRow!==this.props.scrollToRow&&this.updateScroll(void 0===e.scrollToRow||e.scrollToRow<0)},o.prototype.updateOffsetCache=function(e){var r=(void 0===e?this.props:e).listItemHeight;this.offsetCache=Array.isArray(r)?t.computeOffsetCache(r):void 0},o.prototype.updateScroll=function(e){var r=this.props,n=r.scrollToRow,o=r.listItemHeight,i=r.viewportTopOffset,a=void 0===i?0:i,s=r.scrollPositionOffset,l=void 0===s?0:s,c=r.window;if(void 0!==n&&n>=0){var d=(Array.isArray(o)?this.offsetCache[n]:(n+1)*o)+l,u=d-(Array.isArray(o)?o[n]:o);t.scrollTo([u,d],a,c,e)}},o.prototype.render=function(){var e=this.props,t=e.viewportTopOffset,o=(e.scrollToRow,r.__rest(e,["viewportTopOffset","scrollToRow"]));return i.default.createElement(n.CulledTableBody,r.__assign({viewportHeight:window.innerHeight-t},o))},o.defaultProps={viewportTopOffset:0},o.displayName="CulledTableBodyWithScrollToRow",o})(i.default.PureComponent);t.CulledTableBodyWithScrollToRow=a;t.scrollTo=function(e,t,r,n){var o=e[0],i=e[1];void 0===t&&(t=0),void 0===r&&(r=window);var a=r.innerHeight-t,s=(function(e){return void 0===e&&(e=window),"scrollingElement"in e.document&&e.document.scrollingElement?e.document.scrollingElement.scrollTop:e.document.documentElement.scrollTop})(r),l=s+a;o<s?r.scrollTo(0,o):i>l&&(n&&i-o<a/2?r.scrollTo(0,i-a/2):r.scrollTo(0,i-a))},t.computeOffsetCache=function(e){return e.reduce((function(e,t){return e.push(t+(e[e.length-1]||0)),e}),[])}})),define("modules/clean/react/files_view/data/action_creators",["require","exports","tslib","lodash","immutable","api_v2/user_client","modules/clean/react/files_view/constants","modules/clean/react/files_view/data/selectors/files_view_selectors","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/data/types","lodash","modules/clean/react/browse/action_logger","modules/clean/web_user_action_events","modules/clean/react/files_view/view_preferences"],(function(e,t,r,n,o,i,a,s,l,c,d,u,_,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadScopedSortOrders=t.setSort=t.loadPreviewThumbnails=t.batchLoadPreviewThumbnails=t.openKeyboardShortcutsModal=t.filterOutColumns=t.markActiveInstance=t.deleteInstance=t.upsertInstance=t.resetScroll=t.setFileRename=t.loadViewTypeColumns=t.setColumns=t.loadViewTypes=t.setViewType=void 0,s=r.__importStar(s),l=r.__importStar(l),d=r.__importStar(d),p=r.__importStar(p),t.setViewType=function(e){var t=e.user,r=e.viewType,n=e.viewTypeScope,o=void 0===n?a.VIEW_TYPE_GLOBAL_SCOPE:n,i=e.updateGlobalScope,s=void 0!==i&&i;return function(e){var n=[o];s&&o!==a.VIEW_TYPE_GLOBAL_SCOPE&&n.push(a.VIEW_TYPE_GLOBAL_SCOPE),e({type:c.ActionTypes.SET_VIEW_TYPE,payload:{viewType:r,viewScopes:n}}),p.setViewType(t.id,n,r)}};t.loadViewTypes=function(e){var t=e.user,r=e.defaultViewType;return function(e){var n=(function(e,t){var r,n=p.getViewTypes(e);return n||(t?((r={})[a.VIEW_TYPE_GLOBAL_SCOPE]=t,r):null)})(t.id,r);n&&e({type:c.ActionTypes.SET_VIEW_TYPES,payload:{viewTypes:n}})}},t.setColumns=function(e){var t=e.columns,r=e.user,n=e.viewTypeScope,o=void 0===n?a.VIEW_TYPE_GLOBAL_SCOPE:n,i=e.updateGlobalScope,s=void 0!==i&&i,l=e.numVisibleColumns;return function(e){var n={};t.forEach((function(e,t){n[t]=e.sortField}));var i=[o];s&&o!==a.VIEW_TYPE_GLOBAL_SCOPE&&i.push(a.VIEW_TYPE_GLOBAL_SCOPE),e({type:c.ActionTypes.SET_COLUMNS_INDEX,payload:{viewScopes:i,columnsIndex:n,numVisibleColumns:l}}),p.setColumnsIndex(r.id,i,n),void 0!==l&&p.setNumVisibleColumns(r.id,i,l)}},t.loadViewTypeColumns=function(e){var t=e.user,r=p.getScopedColumnsIndex(t.id),n=p.getScopedNumVisibleColumns(t.id);return{type:c.ActionTypes.SET_SCOPED_COLUMNS_INDEX,payload:{scopedColumnsIndex:r,scopedNumVisibleColumns:n}}},t.setFileRename=function(e){var t=e.file,r=e.renameState;return{type:c.ActionTypes.SET_FILE_RENAME,payload:{file:t,renameState:r}}},t.resetScroll=function(){return{type:c.ActionTypes.SET_SCROLL,payload:{scrollTop:0}}};t.upsertInstance=function(e,t){return function(r,i){var a,l;a=t,(!(l=s.selectInstances(i()).get(e))||Object.keys(a).some((function(e){var t=a[e],r=l[e];return!(!r&&!t)&&(o.Map.isMap(r)&&o.Map.isMap(t)?r.equals(t):!n.isEqual(t,r))})))&&r({type:c.ActionTypes.UPSERT_INSTANCE,payload:{id:e,instance:t}})}},t.deleteInstance=function(e){return{type:c.ActionTypes.DELETE_INSTANCE,payload:{id:e}}},t.markActiveInstance=function(e){return{type:c.ActionTypes.MARK_ACTIVE_INSTANCE,payload:{id:e}}},t.filterOutColumns=function(e){return{type:c.ActionTypes.FILTER_OUT_COLUMNS,payload:e}},t.openKeyboardShortcutsModal=function(t){return function(n,o){(function(t){r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(n){switch(n.label){case 0:return[4,new Promise((function(t,r){e(["modules/clean/react/files_view/keyboard_shortcuts_modal"],t,r)})).then(r.__importStar)];case 1:return(0,n.sent().showKeyboardShortcutsModal)(t),[2]}}))}))})(l.selectIsListView(o(),t))}};t.batchLoadPreviewThumbnails=function(e,t,n,o,a){return r.__awaiter(void 0,void 0,void 0,(function(){var d,p,f,m,g;return r.__generator(this,(function(r){switch(r.label){case 0:d=s.previewThumbnailsToLoad(t()),p=l.selectViewType(t(),{instanceId:a}),r.label=1;case 1:return r.trys.push([1,4,,5]),d.length>0?[4,(new i.UserApiV2Client).ns("previews").rpc("get_preview_data_batch",{files:d},{subjectUserId:n})]:[3,3];case 2:f=r.sent(),m=[],f.results.forEach((function(e){var t,r=null===(t=e.preview)||void 0===t?void 0:t.content,n=e.file.file_id;n&&r&&(r.hasOwnProperty("thumbnail_url_tmpl")?m.push({file_id:n,preview_url:r.thumbnail_url_tmpl}):r.hasOwnProperty("placeholder_image_url")&&m.push({file_id:n,preview_url:r.placeholder_image_url}))})),m.length>0&&(e((function(e){var t=e.preview_thumbnails;return{type:c.ActionTypes.PREVIEW_THUMBNAILS_LOADED,payload:{preview_thumbnails:t}}})({preview_thumbnails:m})),h={view_type:p,userId:n,num_files_requested:d.length,num_files_retrieved:m.length,elapsed_ms:Date.now()-o},u.logWebUserAction({user_id:h.userId,event_name:_.WebUserActionLogEvent.PREVIEW_THUMBNAIL_SUCCESS,extra:{view_type:h.view_type,num_files_requested:h.num_files_requested.toString(),num_files_retrieved:h.num_files_retrieved.toString(),elapsed_ms:h.elapsed_ms.toString()}})),r.label=3;case 3:return[3,5];case 4:return g=r.sent(),e((function(e){var t=e.files;return{type:c.ActionTypes.PREVIEW_THUMBNAILS_REMOVED,payload:{files:t}}})({files:d})),(function(e){u.logWebUserAction({user_id:e.userId,event_name:_.WebUserActionLogEvent.PREVIEW_THUMBNAIL_ERROR,extra:{view_type:e.view_type,error_summary:e.error_summary||"unknown"}})})({view_type:p,userId:n,error_summary:null==g?void 0:g.toString()}),[3,5];case 5:return[2]}var h}))}))};var f=d.debounce((function(e,r,n,o,i){t.batchLoadPreviewThumbnails(e,r,n,o,i)}),300);t.loadPreviewThumbnails=function(e,t,r){return function(n,o){var i=s.previewThumbnails(o()),a=e.filter((function(e){return e.file_id&&!i.hasOwnProperty(e.file_id)}));a.length>0&&(n((function(e){var t=e.files;return{type:c.ActionTypes.PREVIEW_THUMBNAILS_LOADING,payload:{files:t}}})({files:a})),f(n,o,t,Date.now(),r))}},t.setSort=function(e){var t=e.user,r=e.sort,n=e.viewScope,o=void 0===n?a.VIEW_TYPE_GLOBAL_SCOPE:n,i=e.updateGlobalScope,s=void 0!==i&&i;return function(e){var n=[o];s&&o!==a.VIEW_TYPE_GLOBAL_SCOPE&&n.push(a.VIEW_TYPE_GLOBAL_SCOPE),e({type:c.ActionTypes.SET_SORT,payload:{sort:r,viewScopes:n}}),p.setSort(t.id,n,r)}},t.loadScopedSortOrders=function(e){var t,n=e.user,o=e.defaultSort;return{type:c.ActionTypes.SET_SCOPED_SORTS,payload:{scopedSorts:r.__assign((t={},t[a.VIEW_TYPE_GLOBAL_SCOPE]=o,t),p.getScopedSorts(n.id))}}}})),define("modules/clean/react/files_view/data/reducer",["require","exports","tslib","immutable","modules/clean/react/files_view/constants","modules/clean/react/files_view/data/types","modules/clean/react/files_view/types","modules/clean/react/files_view/view_type","modules/clean/react/flows/types"],(function(e,t,r,n,o,i,a,s,l){"use strict";var c,d;Object.defineProperty(t,"__esModule",{value:!0}),t.filesViewReducer=t.defaultFilesViewInstance=t.defaultFilesViewState=void 0,n=r.__importStar(n),t.defaultFilesViewState={viewTypes:(c={},c[o.VIEW_TYPE_GLOBAL_SCOPE]=s.ViewType.List,c),scopedColumnsIndex:void 0,scopedSorts:void 0,viewTypeColumns:(d={},d[s.ViewType.List]=o.LIST_VIEW_COLUMNS,d[s.ViewType.CondensedList]=o.LIST_VIEW_COLUMNS,d[s.ViewType.Grid]=o.GRID_VIEW_COLUMNS,d[s.ViewType.LargeGrid]=o.GRID_VIEW_COLUMNS,d),fileRename:null,instances:n.Map(),previewThumbnails:{},activeInstance:void 0};t.defaultFilesViewInstance={dropTargetHighlightMode:a.DropTargetHighlightMode.NONE,enableUnity:!0,loadingState:a.LoadingState.LOADING_FIRST_PAGE,fileRename:null,renderFilenameSubtitleAsLink:!0,eligibleForFirstTaskSubtitle:!1,viewTypeScope:o.VIEW_TYPE_GLOBAL_SCOPE,hideViewFileButton:!1,fileHasAutomatedRuleMap:l.FlowsMap({})};t.filesViewReducer=function(e,n){switch(void 0===e&&(e=t.defaultFilesViewState),n.type){case i.ActionTypes.SET_VIEW_TYPE:return(function(e,t){for(var n=t.viewType,o=t.viewScopes,i=r.__assign({},e.viewTypes),a=0,s=o;a<s.length;a++){i[s[a]]=n}return r.__assign(r.__assign({},e),{viewTypes:i})})(e,n.payload);case i.ActionTypes.SET_VIEW_TYPES:return(function(e,t){var n=t.viewTypes;return r.__assign(r.__assign({},e),{viewTypes:r.__assign(r.__assign({},e.viewTypes),n)})})(e,n.payload);case i.ActionTypes.SET_FILE_RENAME:return(function(e,t){var n=t.payload,o=n.file,i=n.renameState;return i?r.__assign(r.__assign({},e),{fileRename:{file:o,state:i}}):r.__assign(r.__assign({},e),{fileRename:null})})(e,n);case i.ActionTypes.SET_COLUMNS_INDEX:return(function(e,t){for(var n=t.payload,o=n.columnsIndex,i=n.viewScopes,a=n.numVisibleColumns,s=r.__assign({},e.scopedColumnsIndex),l=r.__assign({},e.scopedNumVisibleColumns),c=0,d=i;c<d.length;c++){var u=d[c];s[u]=o,void 0!==a&&(l[u]=a)}return r.__assign(r.__assign({},e),{scopedColumnsIndex:s,scopedNumVisibleColumns:l})})(e,n);case i.ActionTypes.SET_SCOPED_COLUMNS_INDEX:return(function(e,t){var n=t.payload,o=n.scopedColumnsIndex,i=n.scopedNumVisibleColumns;return r.__assign(r.__assign({},e),{scopedColumnsIndex:o,scopedNumVisibleColumns:i})})(e,n);case i.ActionTypes.SET_SCOPED_SORTS:return(function(e,t){var n=t.payload.scopedSorts;return r.__assign(r.__assign({},e),{scopedSorts:n})})(e,n);case i.ActionTypes.SET_SORT:return(function(e,t){for(var n=t.payload,o=n.sort,i=n.viewScopes,a=r.__assign({},e.scopedSorts),s=0,l=i;s<l.length;s++){a[l[s]]=o}return r.__assign(r.__assign({},e),{scopedSorts:a})})(e,n);case i.ActionTypes.SET_SCROLL:return(function(e,t){return r.__assign(r.__assign({},e),{currentScroll:{scrollTop:t.scrollTop}})})(e,n.payload);case i.ActionTypes.UPSERT_INSTANCE:return(function(e,n){var o=n.payload,i=o.instance,a=o.id,s=e.instances.get(a);return r.__assign(r.__assign({},e),{activeInstance:a,instances:e.instances.set(a,r.__assign(r.__assign({},s||t.defaultFilesViewInstance),i))})})(e,n);case i.ActionTypes.DELETE_INSTANCE:return(function(e,t){var n=t.payload.id;return r.__assign(r.__assign({},e),{instances:e.instances.delete(n)})})(e,n);case i.ActionTypes.PREVIEW_THUMBNAILS_LOADING:return(function(e,t){var n=t.payload.files,o=r.__assign({},e.previewThumbnails);return n.forEach((function(e){var t;e.file_id&&!(null===(t=o[e.file_id])||void 0===t?void 0:t.isLoading)&&(o[e.file_id]={isLoading:!0,file_info:e})})),r.__assign(r.__assign({},e),{previewThumbnails:o})})(e,n);case i.ActionTypes.PREVIEW_THUMBNAILS_LOADED:return(function(e,t){var n=t.payload.preview_thumbnails,o=r.__assign({},e.previewThumbnails);return n.forEach((function(e){e.file_id&&(o[e.file_id]={isLoading:!1,preview_url:e.preview_url})})),r.__assign(r.__assign({},e),{previewThumbnails:o})})(e,n);case i.ActionTypes.PREVIEW_THUMBNAILS_REMOVED:return(function(e,t){var n=t.payload.files,o=r.__assign({},e.previewThumbnails);return n.forEach((function(e){e.file_id&&delete o[e.file_id]})),r.__assign(r.__assign({},e),{previewThumbnails:o})})(e,n);case i.ActionTypes.MARK_ACTIVE_INSTANCE:return(function(e,t){var n=t.payload.id;return e.activeInstance!==n?r.__assign(r.__assign({},e),{activeInstance:n}):e})(e,n);case i.ActionTypes.FILTER_OUT_COLUMNS:return(function(e,t){var n,i=o.LIST_VIEW_COLUMNS.filter((function(e){return-1===t.payload.indexOf(e.sortField)}));return r.__assign(r.__assign({},e),{viewTypeColumns:r.__assign(r.__assign({},e.viewTypeColumns),(n={},n[s.ViewType.List]=i,n[s.ViewType.CondensedList]=i,n))})})(e,n)}return e}})),define("modules/clean/react/files_view/data/selectors/files_view_selectors",["require","exports","modules/clean/react/files_view/data/reducer","modules/clean/redux/namespaces","modules/clean/redux/selectors"],(function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.previewThumbnailsToLoad=t.previewThumbnails=t.selectInstances=t.isActiveFilesView=t.currentScroll=t.fileRename=t.scopedNumVisibleColumns=t.scopedSorts=t.viewTypeColumns=t.scopedColumnsIndex=t.viewTypes=void 0;var i=function(e){return o.getStateAtNamespace(e,n.FILES_VIEW_NAMESPACE_KEY)||r.defaultFilesViewState};t.viewTypes=function(e){return i(e).viewTypes},t.scopedColumnsIndex=function(e){return i(e).scopedColumnsIndex},t.viewTypeColumns=function(e){return i(e).viewTypeColumns},t.scopedSorts=function(e){return i(e).scopedSorts},t.scopedNumVisibleColumns=function(e){return i(e).scopedNumVisibleColumns},t.fileRename=function(e){return i(e).fileRename},t.currentScroll=function(e){return i(e).currentScroll},t.isActiveFilesView=function(e,t){return i(e).activeInstance===t},t.selectInstances=function(e){return i(e).instances},t.previewThumbnails=function(e){return i(e).previewThumbnails},t.previewThumbnailsToLoad=function(e){var r=[],n=t.previewThumbnails(e);for(var o in n)!0===n[o].isLoading&&n[o].file_info&&r.push(n[o].file_info);return r}})),define("modules/clean/react/files_view/data/selectors/instance_selectors",["require","exports","reselect","modules/clean/react/browse/models","modules/clean/react/files_view/constants","modules/clean/react/files_view/data/selectors/files_view_selectors","modules/clean/react/files_view/data/store","modules/clean/react/files_view/file_grouper","modules/clean/react/files_view/view_type","modules/clean/react/files_view/util","modules/core/assert"],(function(e,t,r,n,o,i,a,s,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.selectExpManualTagging=t.selectExpFlowsAutomatedFolderUI=t.selectExpFlowsAutoUnzipLambda=t.selectExpAutoPDFConversionBackend=t.selectNumVisibleColumns=t.selectScopedSort=t.selectPreferredColumns=t.selectColumnsIndex=t.selectViewType=t.selectViewTypes=t.selectViewTypeScope=t.selectItemsForUnityListener=t.selectItemIds=t.selectSections=t.selectHasItemsSelected=t.selectNumItemsSelected=t.selectShouldShowFileNameLocation=t.selectShouldShowFileNameHighlights=t.selectCutItems=t.selectClipboard=t.selectIsMobileMode=t.selectIsCompactMode=t.selectInlineActionBar=t.selectIsActionBarEnabled=t.selectEligibleForFirstTaskSubtitle=t.selectRenderFilenameSubtitleAsLink=t.selectHighDensity=t.selectFileRename=t.selectResponsive=t.selectSelection=t.selectDisabledMultiselect=t.selectIsSearchMode=t.selectCurrentSort=t.selectIsListView=t.selectIsGridView=t.selectArePostTTIModulesLoaded=t.selectUser=t.selectContext=t.selectFileHasAutomatedRuleMap=t.selectCurrentFolderInfo=t.selectMainItems=t.selectDropTargetHighlightMode=t.selectInstance=void 0;var u=function(e,t){return i.selectInstances(e).get(t.instanceId)};t.selectInstance=function(e,t){var r=u(e,t);return d.assert(!!r,"[FilesView] Instance '"+t.instanceId+"' must be defined in redux store before mounting"),r};var _=function(e){return function(r,n){return e(t.selectInstance(r,n))}},p=function(e){return function(t,r){return e(u(t,r))}};t.selectDropTargetHighlightMode=_((function(e){return e.dropTargetHighlightMode})),t.selectMainItems=_((function(e){return e.items})),t.selectCurrentFolderInfo=_((function(e){return e.currentFolderInfo})),t.selectFileHasAutomatedRuleMap=_((function(e){return e.fileHasAutomatedRuleMap})),t.selectContext=_((function(e){return e.context})),t.selectUser=_((function(e){return e.user})),t.selectArePostTTIModulesLoaded=_((function(e){return e.arePostTTIModulesLoaded})),t.selectIsGridView=function(e,r){return[l.ViewType.Grid,l.ViewType.LargeGrid].includes(t.selectViewType(e,r))},t.selectIsListView=function(e,r){return[l.ViewType.List,l.ViewType.CondensedList].includes(t.selectViewType(e,r))},t.selectCurrentSort=_((function(e){return e.currentSort})),t.selectIsSearchMode=_((function(e){return e.isSearchMode})),t.selectDisabledMultiselect=_((function(e){return!!e.disabledMultiselect})),t.selectSelection=_((function(e){return e.selection})),t.selectResponsive=_((function(e){return e.responsive})),t.selectFileRename=_((function(e){return e.fileRename})),t.selectHighDensity=_((function(e){return e.highDensity})),t.selectRenderFilenameSubtitleAsLink=_((function(e){return e.renderFilenameSubtitleAsLink})),t.selectEligibleForFirstTaskSubtitle=_((function(e){return e.eligibleForFirstTaskSubtitle})),t.selectIsActionBarEnabled=_((function(e){return e.isActionBarEnabled})),t.selectInlineActionBar=_((function(e){return e.inlineActionBar})),t.selectIsCompactMode=function(e,r){return!t.selectResponsive(e,r).isMatchedLarge},t.selectIsMobileMode=function(e,r){var n=t.selectResponsive(e,r);return c.isMobileMode(n)},t.selectClipboard=_((function(e){return e.clipboard})),t.selectCutItems=function(e,r){var n=t.selectClipboard(e,r);return n&&"cut"===n.action?new Map(n.files.map((function(e){return[e.fq_path,e]}))):new Map},t.selectShouldShowFileNameHighlights=function(e,r){return t.selectIsSearchMode(e,r)},t.selectShouldShowFileNameLocation=function(e,r){return t.selectIsSearchMode(e,r)},t.selectNumItemsSelected=function(e,r){return t.selectSelection(e,r).selected.size},t.selectHasItemsSelected=function(e,r){return t.selectNumItemsSelected(e,r)>0},t.selectSections=r.createSelector(t.selectIsGridView,t.selectCurrentSort,t.selectMainItems,t.selectIsSearchMode,(function(e,t,r,n){return e&&t?s.getSections(r,t.sortField,t.sortDirection,n):s.EMPTY_SECTIONS})),t.selectItemIds=r.createSelector(t.selectMainItems,(function(e){return e.toArray().map((function(e){return e instanceof n.File?e.fq_path:e instanceof n.FileSharedWithMe?e.file_id:""}))})),t.selectItemsForUnityListener=r.createSelector(t.selectMainItems,t.selectCurrentFolderInfo,(function(e,t){return t?e.concat(t):e})),t.selectViewTypeScope=p((function(e){return(null==e?void 0:e.viewTypeScope)||o.VIEW_TYPE_GLOBAL_SCOPE})),t.selectViewTypes=p((function(e){return(null==e?void 0:e.viewTypes)||[]})),t.selectViewType=r.createSelector(i.viewTypes,t.selectViewTypes,t.selectViewTypeScope,(function(e,t,r){var n;return n=r in e?e[r]:r in o.defaultViewTypes?o.defaultViewTypes[r]:e[o.VIEW_TYPE_GLOBAL_SCOPE],t.includes(n)?n:l.ViewType.List})),t.selectColumnsIndex=r.createSelector(i.scopedColumnsIndex,t.selectViewTypeScope,t.selectIsSearchMode,(function(e,t,r){if(e&&!r)return t in e?e[t]:e[o.VIEW_TYPE_GLOBAL_SCOPE]||{}})),t.selectPreferredColumns=r.createSelector(t.selectColumnsIndex,t.selectViewType,i.viewTypeColumns,(function(e,t,r){if(e){for(var n=r[t],o=n[0],i=n.slice(1),a=Object.keys(e).reduce((function(t,r){var n=parseInt(r,10);return t[e[n]]=n,t}),{}),s=[],l={},c=0,d=i;c<d.length;c++){var u=a[(f=d[c]).sortField];void 0===u||0===u?s.push(f):l[u]=f}for(var _=[o],p=1;p<=i.length;p++){var f;(f=l[p]||s.shift())&&_.push(f)}return _}})),t.selectScopedSort=r.createSelector(i.scopedSorts,t.selectViewTypeScope,(function(e,t){if(e)return t in e?e[t]:e[o.VIEW_TYPE_GLOBAL_SCOPE]})),t.selectNumVisibleColumns=r.createSelector(i.scopedNumVisibleColumns,t.selectViewTypeScope,(function(e,t){if(e)return t in e?e[t]:e[o.VIEW_TYPE_GLOBAL_SCOPE]})),t.selectExpAutoPDFConversionBackend=p((function(e){return(null==e?void 0:e.expAutoPDFConversionBackend)||!1})),t.selectExpFlowsAutoUnzipLambda=p((function(e){return(null==e?void 0:e.expFlowsAutoUnzipLambda)||!1})),t.selectExpFlowsAutomatedFolderUI=p((function(e){return(null==e?void 0:e.expFlowsAutomatedFolderUI)||!1})),t.selectExpManualTagging=p((function(e){return(null==e?void 0:e.expManualTagging)||"OFF"})),a.getStoreForFilesView()})),define("modules/clean/react/files_view/data/selectors/item_selectors",["require","exports","modules/clean/react/browse/models","modules/clean/react/files_view/constants","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/view_type","modules/clean/react/files_view/util","modules/core/assert","modules/clean/react/flows/types","modules/clean/tagging/experiments"],(function(e,t,r,n,o,i,a,s,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.selectFlowsBadge=t.selectIsCutToClipboard=t.selectIconSize=t.selectShouldShowFirstTaskSubtitle=t.selectSnippetRows=t.selectRowHeight=t.selectShouldShowTags=t.selectShouldShowSnippets=t.selectFirstValidSnippet=t.selectSnippets=t.selectIsTooltipEnabled=t.selectShowCDMUserEducationEffects=t.selectShouldShowStar=t.selectIsNoAccessSharedFolder=t.selectShouldShowSubtitle=t.selectRenameState=t.selectUserEducationEffectName=t.selectShouldShowUserEducationEffects=t.selectIsCheckboxVisible=t.selectIsItemSelected=t.selectItemSelectionId=t.selectItemAssertFileOrFileSharedWithMe=t.selectItem=void 0,t.selectItem=function(e,t){var r=o.selectMainItems(e,t),n=r&&r.get(t.itemIndex);return s.assert(!!n,"Item undefined at index: "+t.itemIndex),n},t.selectItemAssertFileOrFileSharedWithMe=function(e,n){var o=t.selectItem(e,n);return s.assert(o instanceof r.File||o instanceof r.FileSharedWithMe,"item must be File or FileSharedWithMe at index: "+n.itemIndex),o},t.selectItemSelectionId=function(e,n){var o=t.selectItemAssertFileOrFileSharedWithMe(e,n);return o instanceof r.File?n.fileToId(o):o.file_id},t.selectIsItemSelected=function(e,r){return o.selectSelection(e,r).selected.has(t.selectItemSelectionId(e,r))},t.selectIsCheckboxVisible=function(e,t){return t.isHovered||o.selectHasItemsSelected(e,t)||o.selectIsCompactMode(e,t)},t.selectShouldShowUserEducationEffects=function(e,t){return 0===t.rowIndex||o.selectUser(e,t).is_cdm_member&&(2===t.rowIndex||1===t.rowIndex)},t.selectUserEducationEffectName=function(e,r){return t.selectShouldShowUserEducationEffects(e,r)?"FileNameLabel-"+r.rowIndex:void 0},t.selectRenameState=function(e,n){var i=o.selectFileRename(e,n),a=t.selectItem(e,n);if(i&&a instanceof r.File)return i.file.fq_path===a.fq_path?i.state:void 0},t.selectShouldShowSubtitle=function(e,r){return!t.selectRenameState(e,r)&&o.selectViewType(e,r)!==i.ViewType.CondensedList},t.selectIsNoAccessSharedFolder=function(e,n){var o=t.selectItem(e,n);return o instanceof r.File&&r.File.isNoAccessSharedFolder(o)},t.selectShouldShowStar=function(e,r){return o.selectArePostTTIModulesLoaded(e,r)&&!t.selectIsNoAccessSharedFolder(e,r)&&!o.selectContext(e,r).isInsideVaultFolder&&!o.selectIsMobileMode(e,r)},t.selectShowCDMUserEducationEffects=function(e,n){var o=t.selectItem(e,n);return o instanceof r.File&&r.File.isTeamMemberFolder(o)},t.selectIsTooltipEnabled=function(e,t){return o.selectArePostTTIModulesLoaded(e,t)},t.selectSnippets=function(e,n){var o=t.selectItem(e,n);if(o instanceof r.Paper||o instanceof r.File||o instanceof r.FileSharedWithMe)return o.snippets},t.selectFirstValidSnippet=function(e,r){var n=t.selectSnippets(e,r);return n&&n.find((function(e){var t=e.highlight_spans;return!!t&&t.length>0}))},t.selectShouldShowSnippets=function(e,r){return Boolean(!o.selectIsMobileMode(e,r)&&t.selectFirstValidSnippet(e,r))},t.selectShouldShowTags=function(e,n){var i=t.selectItem(e,n),a=o.selectExpManualTagging(e,n);return c.isTaggingEnabled(a)&&i instanceof r.File&&i.tags&&i.tags.length>0},t.selectRowHeight=function(e,r){var a=t.selectShouldShowSnippets(e,r),s=o.selectHighDensity(e,r),l=o.selectViewType(e,r),c=t.selectShouldShowTags(e,r);if(a){var d=t.selectSnippetRows(e,r);if(!d)return c?n.DEFAULT_ROW_HEIGHT_WITH_SNIPPETS+n.TAGS_HEIGHT:n.DEFAULT_ROW_HEIGHT_WITH_SNIPPETS;var u=n.ROW_VERTICAL_PADDING+n.ROW_TITLE_HEIGHT+n.ROW_SUBTITLE_HEIGHT+n.ROW_SNIPPET_VERTICAL_MARGIN+n.SNIPPET_HEIGHT_PER_ROW*d;return c?u+n.TAGS_HEIGHT:u}return l===i.ViewType.CondensedList?n.DEFAULT_ROW_HEIGHT_CONDENSED_LIST:s?c?n.DEFAULT_ROW_HEIGHT_DENSE+n.TAGS_HEIGHT:n.DEFAULT_ROW_HEIGHT_DENSE:c?n.DEFAULT_ROW_HEIGHT+n.TAGS_HEIGHT:n.DEFAULT_ROW_HEIGHT};t.selectSnippetRows=function(e,r){var o=t.selectFirstValidSnippet(e,r);if(!o||!o.highlight_spans)return 0;var i=r.containerWidth,a=r.numVisibleColumns,s=i?i*n.FILE_NAME_CELL_SEARCH_FLEX_BASIS[a]/100:void 0;if(!s)return 3;var l=o.highlight_spans.map((function(e){return e.highlight_str})).join().length,c=Math.max(s-n.MEDIA_CELL_ICON_WIDTH-n.SNIPPET_HORIZONTAL_PADDING,1),d=6*l;return Math.min(Math.ceil(d/c),3)},t.selectShouldShowFirstTaskSubtitle=function(e,t){return Boolean(o.selectEligibleForFirstTaskSubtitle(e,t)&&d(e,t))};var d=function(e,n){var i=o.selectContext(e,n),a=t.selectItem(e,n),s=o.selectUser(e,n);return a instanceof r.File&&(i.isInsideMyTeamFolderTree&&i.isCurrentlyInRoot&&a.fq_path===s.cdm_tmf_path)};t.selectIconSize=function(e,t){return o.selectViewType(e,t)===i.ViewType.CondensedList?32:void 0},t.selectIsCutToClipboard=function(e,r){var n=o.selectCutItems(e,r),i=t.selectItem(e,r);return a.isCutToClipboard(i,n)},t.selectFlowsBadge=function(e,n){var i=t.selectItemAssertFileOrFileSharedWithMe(e,n);if(i instanceof r.FileSharedWithMe)return l.FlowsRuleType.None;var a=o.selectFileHasAutomatedRuleMap(e,n),s=o.selectExpAutoPDFConversionBackend(e,n),c=o.selectExpFlowsAutoUnzipLambda(e,n),d=o.selectExpFlowsAutomatedFolderUI(e,n),u=a.get(i.fq_path);return u===l.FlowsRuleType.AutoPDF&&s||u===l.FlowsRuleType.AutoUnzip&&c||null!=u&&u!==l.FlowsRuleType.None&&d?u:l.FlowsRuleType.None}})),define("modules/clean/react/files_view/data/selectors/list_selectors",["require","exports","tslib","reselect","modules/clean/react/browse/models","modules/clean/react/files_view/constants","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/file_list_utils","modules/clean/react/files_view/view_type","modules/clean/react/files_view/util","modules/clean/tagging/experiments","modules/clean/media_filters/gating"],(function(e,t,r,n,o,i,a,s,l,c,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.estimateSnippetRowsNeeded=t.getFileRowHeight=t.shouldShowSnippets=t.getFirstValidSnippet=t.getFilesViewListRowItems=t.selectListItemBuffer=t.selectListItemHeights=t.selectListItems=void 0,t.selectListItems=function(e,n){var o=a.selectMainItems(e,n),i=!!a.selectDisabledMultiselect(e,n),s=a.selectViewType(e,n)===l.ViewType.CondensedList,c=a.selectIsActionBarEnabled(e,n);return t.getFilesViewListRowItems(r.__assign(r.__assign({},n),{isCheckboxDisabled:i,isCondensedListView:s,items:o,isActionBarEnabled:c}))},t.selectListItemHeights=n.createSelector(t.selectListItems,(function(e){return e.map((function(e){return e.height}))})),t.selectListItemBuffer=function(e,t){return a.selectViewType(e,t)===l.ViewType.CondensedList?20:void 0};var _=n.createSelectorCreator(n.defaultMemoize,(function(e,t){return Object.keys(e).length===Object.keys(t).length&&Object.keys(e).every((function(r){return t.hasOwnProperty(r)&&e[r]===t[r]}))}));t.getFilesViewListRowItems=_((function(e){return{activeDropTarget:e.activeDropTarget,arePostTTIModulesLoaded:e.arePostTTIModulesLoaded,canDisplayFolderSizes:e.canDisplayFolderSizes,context:e.context,createNewFolderState:e.createNewFolderState,dropTargetHighlightMode:e.dropTargetHighlightMode,fileRename:e.fileRename,focusedFileIndex:e.focusedFileIndex,isCheckboxDisabled:e.isCheckboxDisabled,isCompactMode:e.isCompactMode,isSearchMode:e.isSearchMode,isSelectMode:e.isSelectMode,items:e.items,selection:e.selection,sharingServiceInfo:e.sharingServiceInfo,starredState:e.starredState,user:e.user,visibleColumns:e.visibleColumns,responsive:e.responsive,containerWidth:e.containerWidth,highDensity:e.highDensity,isCondensedListView:e.isCondensedListView,fileToId:e.fileToId,renderSharedWithController:e.renderSharedWithController,expVaultEnableViewOnlySharing:e.expVaultEnableViewOnlySharing,isActionBarEnabled:e.isActionBarEnabled,expManualTagging:e.expManualTagging,mediaFiltersVariant:e.mediaFiltersVariant}}),(function(e){var n=e.activeDropTarget,a=e.context,l=e.createNewFolderState,u=e.dropTargetHighlightMode,_=e.items,p=e.fileRename,f=e.focusedFileIndex,m=e.selection,g=e.user,h=e.visibleColumns,S=e.responsive,E=e.containerWidth,v=e.highDensity,T=e.fileToId,w=e.isCondensedListView,I=e.isActionBarEnabled,b=e.mediaFiltersVariant,F=r.__rest(e,["activeDropTarget","context","createNewFolderState","dropTargetHighlightMode","items","fileRename","focusedFileIndex","selection","user","visibleColumns","responsive","containerWidth","highDensity","fileToId","isCondensedListView","isActionBarEnabled","mediaFiltersVariant"]),C=!!e.expVaultEnableViewOnlySharing,O=d.isTaggingEnabled(e.expManualTagging),R=w?i.DEFAULT_ROW_HEIGHT_CONDENSED_LIST:v?i.DEFAULT_ROW_HEIGHT_DENSE:i.DEFAULT_ROW_HEIGHT,A=w?32:void 0,y=_.toArray().map((function(e,l){if(e instanceof o.UserDefinedItem)return{type:"UserDefinedItemRow",props:{userDefinedItem:e},height:R};var d=E?E*i.FILE_NAME_CELL_SEARCH_FLEX_BASIS[h.length]/100:void 0,_=t.shouldShowSnippets({file:e,responsive:S}),y=t.estimateSnippetRowsNeeded({snippets:e.snippets,fileNameCellWidth:d}),D=t.getFileRowHeight({file:e,showSnippets:_,snippetRows:y,highDensity:v,isCondensedListView:w,showTags:O,mediaFiltersVariant:b});if(e instanceof o.Paper)return{type:"PaperRow",props:{isSearchMode:F.isSearchMode,paper:e,visibleColumns:h,arePostTTIModulesLoaded:F.arePostTTIModulesLoaded,showSnippets:_,snippetRows:y,height:D,showStar:F.arePostTTIModulesLoaded&&!c.isMobileMode(S)},height:D};var L="fq_path"in e?T(e):e.file_id,M=m.selected.has(L);if(e instanceof o.FileSharedWithMe)return{type:"FileSharedWithMeRow",props:{file:e,visibleColumns:h,showSnippets:_,snippetRows:y,height:D,isSelected:M,arePostTTIModulesLoaded:F.arePostTTIModulesLoaded,isSelectMode:F.isSelectMode,isFocused:l===f,iconSize:A},height:D};var N=s.canFileBeHighlightedDropTarget({file:e,dropTargetHighlightMode:u});return{type:"FileRow",key:"file:"+encodeURIComponent(e.file_id)+":"+encodeURIComponent(e.fq_path),itemIndex:l,props:r.__assign(r.__assign({},F),{file:e,isActionBarEnabled:I,isActiveDropTarget:N&&n===e,isAvailableDropTarget:N,isFocused:l===f,isSelected:M,isExtensionsMenuDisabled:!0,isSharingDisabled:s.isSharingDisabledForFile({context:a,file:e,user:g,expVaultEnableViewOnlySharing:C}),renameState:p&&p.file.fq_path===e.fq_path?p.state:void 0,visibleColumns:h,height:D,containerWidth:E,isCondensedListView:w,responsive:S}),height:D}}));return l&&"CREATE_FOLDER_INACTIVE"!==l&&y.unshift({type:"NewFolderRow",props:{createNewFolderState:l,isInsideMyTeamFolderTree:a.isInsideTeamFolderTree,iconSize:A},height:R}),y})),t.getFirstValidSnippet=function(e){return e.find((function(e){var t=e.highlight_spans;return!!t&&t.length>0}))},t.shouldShowSnippets=function(e){var r=e.file.snippets,n=e.responsive;return!!r&&!!t.getFirstValidSnippet(r)&&(n.isMatchedLarge||n.isMatchedMedium)},t.getFileRowHeight=function(e){var t=e.file,r=e.showSnippets,n=e.snippetRows,o=e.highDensity,a=e.isCondensedListView,s=e.showTags,l=e.mediaFiltersVariant,d=s&&c.isFile(t)&&t.tags&&t.tags.length>0?i.TAGS_HEIGHT:0,u=p(t,l);return t.snippets&&r?n?i.ROW_VERTICAL_PADDING+i.ROW_TITLE_HEIGHT+i.ROW_SUBTITLE_HEIGHT+i.ROW_SNIPPET_VERTICAL_MARGIN+i.SNIPPET_HEIGHT_PER_ROW*n+d+u:i.DEFAULT_ROW_HEIGHT_WITH_SNIPPETS+d+u:a?i.DEFAULT_ROW_HEIGHT_CONDENSED_LIST:o?i.DEFAULT_ROW_HEIGHT_DENSE+d+u:i.DEFAULT_ROW_HEIGHT+d+u};var p=function(e,t){var r,n,o,a,s=c.isFile(e)&&!!(null===(n=null===(r=e.media_data)||void 0===r?void 0:r.data)||void 0===n?void 0:n.date_taken),l=c.isFile(e)&&null!==(a=null===(o=e.media_data)||void 0===o?void 0:o.display_info.length)&&void 0!==a?a:0;if(u.isMediaMetadataSearchEnabled(t)){var d=Math.min(l,2)*i.MEDIA_INFO_ITEM_HEIGHT;return s?i.MEDIA_INFO_ITEM_HEIGHT+d:d}return u.isMediaFiltersEnabled(t)&&s?i.MEDIA_INFO_ITEM_HEIGHT:0};t.estimateSnippetRowsNeeded=function(e){var r=e.snippets,n=e.fileNameCellWidth;if(!r)return 0;var o=t.getFirstValidSnippet(r);if(!o||!o.highlight_spans)return 0;if(!n)return 3;var a=o.highlight_spans.map((function(e){return e.highlight_str})).join().length,s=Math.max(n-i.MEDIA_CELL_ICON_WIDTH-i.SNIPPET_HORIZONTAL_PADDING,1),l=6*a;return Math.min(Math.ceil(l/s),3)}})),define("modules/clean/react/files_view/data/store",["require","exports","modules/clean/react/files_view/data/reducer","modules/clean/redux/namespaces","modules/clean/redux/store"],(function(e,t,r,n,o){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.getStoreForFilesView=void 0,t.getStoreForFilesView=function(){var e;return i||(i=o.getStoreAndRegisterReducers(((e={})[n.FILES_VIEW_NAMESPACE_KEY]=r.filesViewReducer,e))),i}})),define("modules/clean/react/files_view/data/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActionTypes=void 0,(function(e){e.SET_VIEW_TYPE="FILES_VIEW/SET_VIEW_TYPE",e.SET_VIEW_TYPES="FILES_VIEW/SET_VIEW_TYPES",e.SET_VIEW_TYPE_SCOPE="FILES_VIEW/SET_VIEW_TYPE_SCOPE",e.SET_FILE_RENAME="FILES_VIEW/SET_FILE_RENAME",e.SET_COLUMNS_INDEX="FILES_VIEW/SET_COLUMNS_INDEX",e.SET_SCOPED_COLUMNS_INDEX="FILES_VIEW/SET_SCOPED_COLUMNS_INDEX",e.SET_SORT="FILES_VIEW/SET_SORT",e.SET_SCOPED_SORTS="FILES_VIEW/SET_SCOPED_SORTS",e.SET_SCROLL="FILES_VIEW/SET_SCROLL",e.UPDATE_INSTANCE="FILES_VIEW/UPDATE_INSTANCE",e.UPSERT_INSTANCE="FILES_VIEW/UPSERT_INSTANCE",e.DELETE_INSTANCE="FILES_VIEW/DELETE_INSTANCE",e.PREVIEW_THUMBNAILS_LOADING="FILES_VIEW/PREVIEW_THUMBNAILS_LOADING",e.PREVIEW_THUMBNAILS_LOADED="FILES_VIEW/PREVIEW_THUMBNAILS_LOADED",e.PREVIEW_THUMBNAILS_REMOVED="FILES_VIEW/PREVIEW_THUMBNAILS_REMOVED",e.MARK_ACTIVE_INSTANCE="FILES_VIEW/MARK_ACTIVE_INSTANCE",e.FILTER_OUT_COLUMNS="FILES_VIEW/FILTER_OUT_COLUMNS"})(t.ActionTypes||(t.ActionTypes={}))})),define("modules/clean/react/files_view/file_actions/api_v2",["require","exports","tslib","api_v2/user_client","modules/clean/filepath/filepath","modules/core/exception"],(function(e,t,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isPathLookupFailure=t.isFailure=t.createFolder=t.deleteFiles=t.copyFiles=t.moveFiles=t.renameFile=t.undo=t.getFilenameFromActionInfo=t.fileInfoIsFqPathBased=t.createUndefinedRpcResult=t.EXCLOG_TAG=void 0,o=r.__importStar(o);t.EXCLOG_TAG="file_actions_client_error",t.createUndefinedRpcResult=function(e){return{isError:!0,error:{".tag":"undefined_error"},error_summary:"undefined_error",jobId:e}};var a=function(e){i.reportException({err:e,severity:i.SEVERITY.NON_CRITICAL,force:!0,tags:[t.EXCLOG_TAG]})},s=function(e,r){i.reportStack("Unexpected response from relocation batch poll endpoint",{severity:i.SEVERITY.NON_CRITICAL,exc_extra:r,tags:[t.EXCLOG_TAG]})};function l(e){return Boolean("fq_path"in e?e:null)}function c(e){return l(e)?o.filename(e.fq_path):e.name}function d(e,n){return r.__awaiter(this,void 0,Promise,(function(){var o,i,l,c,d,_,p,f;return r.__generator(this,(function(r){switch(r.label){case 0:return r.trys.push([0,9,,10]),[4,e()];case 1:return"complete"!==(o=r.sent())[".tag"]?[3,2]:[2,{isError:!1,result:o}];case 2:i=void 0,r.label=3;case 3:return[4,new Promise((function(e){return setTimeout(e,1e3)}))];case 4:return r.sent(),[4,n(o.async_job_id)];case 5:i=r.sent(),r.label=6;case 6:if(i&&"in_progress"===i[".tag"])return[3,3];r.label=7;case 7:if("complete"===i[".tag"]){for(c=0,d=(l=i).entries;c<d.length;c++)if(_=d[c],p=u(_,o.async_job_id))return[2,p];return[2,{isError:!1,result:l,jobId:o.async_job_id}]}return s(0,{pollResult:i}),[2,t.createUndefinedRpcResult(o.async_job_id)];case 8:return[3,10];case 9:return(f=r.sent())&&f.error&&f.error[".tag"]?[2,{isError:!0,error:f.error,error_summary:f.error[".tag"]}]:(a(f),[2,t.createUndefinedRpcResult()]);case 10:return[2]}}))}))}function u(e,t){if("failure"===e[".tag"]&&"relocation_error"===e.failure[".tag"]&&"to"===e.failure.relocation_error[".tag"]&&"file_system_warnings"===e.failure.relocation_error.to[".tag"])return{isError:!0,error:e.failure.relocation_error,error_summary:"file_system_warnings",jobId:t}}function _(e){var r;if(null===(r=null==e?void 0:e.error)||void 0===r?void 0:r[".tag"]){var n={".tag":"failure",failure:{".tag":"relocation_error",relocation_error:e.error}},o=u(n,void 0);return void 0!==o?o:{isError:!1,result:{changeset_data:[],entries:[n]}}}return t.createUndefinedRpcResult()}function p(e,n){return r.__awaiter(this,void 0,Promise,(function(){var o,i,l;return r.__generator(this,(function(r){switch(r.label){case 0:return r.trys.push([0,10,,11]),[4,e()];case 1:return"complete"!==(o=r.sent())[".tag"]?[3,2]:[2,{isError:!1,result:o}];case 2:return"other"!==o[".tag"]?[3,3]:(s(0,{result:o}),[2,t.createUndefinedRpcResult()]);case 3:i=void 0,r.label=4;case 4:return[4,new Promise((function(e){return setTimeout(e,1e3)}))];case 5:return r.sent(),[4,n(o.async_job_id)];case 6:i=r.sent(),r.label=7;case 7:if(i&&"in_progress"===i[".tag"])return[3,4];r.label=8;case 8:return"complete"===i[".tag"]?[2,{isError:!1,result:i,jobId:o.async_job_id}]:(s(0,{pollResult:i}),[2,t.createUndefinedRpcResult(o.async_job_id)]);case 9:return[3,11];case 10:return(l=r.sent())&&l.error&&l.error[".tag"]?[2,{isError:!0,error:l.error,error_summary:l.summary}]:(a(l),[2,t.createUndefinedRpcResult()]);case 11:return[2]}}))}))}t.fileInfoIsFqPathBased=l,t.getFilenameFromActionInfo=c,t.undo=function(e,o){return r.__awaiter(this,void 0,Promise,(function(){var i,s;return r.__generator(this,(function(r){switch(r.label){case 0:i=new n.UserApiV2Client,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,i.ns("files").rpc("undo_batch",{entries:e},{subjectUserId:o.id})];case 2:return[2,{isError:!1,result:r.sent()}];case 3:return(s=r.sent())&&s.error&&s.error[".tag"]?[2,{isError:!0,error:s.error,error_summary:s.summary}]:(a(s),[2,t.createUndefinedRpcResult()]);case 4:return[2]}}))}))},t.renameFile=function(e,t,i,a){return r.__awaiter(this,void 0,Promise,(function(){var s,l,c,u,p,f;return r.__generator(this,(function(r){switch(r.label){case 0:if(s=o.parent_dir(e),l=o.normalize(s)+"/"+t,c=new n.UserApiV2Client,p=(u="boolean"==typeof a?{checkFSWs:a,synchronousSingleFileActions:!1}:a).checkFSWs,!u.synchronousSingleFileActions)return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,c.ns("files").rpc("move_v2",{from_path:e,to_path:l,autorename:!0,allow_ownership_transfer:!1,fsw_request:p?{".tag":"check"}:void 0},{subjectUserId:i})];case 2:return[2,{isError:!1,result:{changeset_data:(f=r.sent()).changeset_data,entries:[{".tag":"success",success:f.metadata}]}}];case 3:return[2,_(r.sent())];case 4:return[4,d((function(){return c.ns("files").rpc("move_batch_v2",{entries:[{from_path:e,to_path:l}],autorename:!0,allow_ownership_transfer:!1,fsw_request:p?{".tag":"check"}:void 0},{subjectUserId:i})}),(function(e){return c.ns("files").rpc("move_batch/check_v2",{async_job_id:e},{subjectUserId:i})}))];case 5:return[2,r.sent()]}}))}))},t.moveFiles=function(e,t,o,i,a){return r.__awaiter(this,void 0,Promise,(function(){var s,u,p,f,m,g,h;return r.__generator(this,(function(S){switch(S.label){case 0:if(s=new n.UserApiV2Client,p=(u="object"==typeof i?i:{allowOwnershipTransfer:i,checkFSWs:a,synchronousSingleFileActions:!1}).allowOwnershipTransfer,f=u.checkFSWs,m=u.synchronousSingleFileActions,g=function(e){var r=t+"/"+c(e);return l(e)?{from_path:e.fq_path,to_path:r}:{from_path:e.id,to_path:r}},!m||1!==e.length||!l(e[0])||e[0].is_dir)return[3,4];S.label=1;case 1:return S.trys.push([1,3,,4]),[4,s.ns("files").rpc("move_v2",r.__assign(r.__assign({},g(e[0])),{allow_ownership_transfer:!!p,fsw_request:f?{".tag":"check"}:void 0}),{subjectUserId:o})];case 2:return[2,{isError:!1,result:{changeset_data:(h=S.sent()).changeset_data,entries:[{".tag":"success",success:h.metadata}]}}];case 3:return[2,_(S.sent())];case 4:return[4,d((function(){return s.ns("files").rpc("move_batch_v2",{entries:e.map(g),autorename:!0,allow_ownership_transfer:!!p,fsw_request:f?{".tag":"check"}:void 0},{subjectUserId:o})}),(function(e){return s.ns("files").rpc("move_batch/check_v2",{async_job_id:e},{subjectUserId:o})}))];case 5:return[2,S.sent()]}}))}))},t.copyFiles=function(e,t,i,a){return r.__awaiter(this,void 0,Promise,(function(){var s,l,c,u;return r.__generator(this,(function(r){switch(r.label){case 0:if(s=new n.UserApiV2Client,c=(l="object"==typeof a?a:{checkFSWs:a,synchronousSingleFileActions:!1}).checkFSWs,!l.synchronousSingleFileActions||1!==e.length||e[0].is_dir)return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,s.ns("files").rpc("copy_v2",{from_path:e[0].fq_path,to_path:t+"/"+o.filename(e[0].fq_path),autorename:!0,fsw_request:c?{".tag":"check"}:void 0},{subjectUserId:i})];case 2:return[2,{isError:!1,result:{changeset_data:(u=r.sent()).changeset_data,entries:[{".tag":"success",success:u.metadata}]}}];case 3:return[2,_(r.sent())];case 4:return[4,d((function(){return s.ns("files").rpc("copy_batch_v2",{entries:e.map((function(e){return{from_path:e.fq_path,to_path:t+"/"+o.filename(e.fq_path)}})),autorename:!0,fsw_request:c?{".tag":"check"}:void 0},{subjectUserId:i})}),(function(e){return s.ns("files").rpc("copy_batch/check_v2",{async_job_id:e},{subjectUserId:i})}))];case 5:return[2,r.sent()]}}))}))},t.deleteFiles=function(e,o,i){var s;return r.__awaiter(this,void 0,Promise,(function(){var l,c,d;return r.__generator(this,(function(r){switch(r.label){case 0:if(l=new n.UserApiV2Client,1!==e.length||e[0].is_dir)return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,l.ns("files").rpc("delete_v2",{path:e[0].fq_path,fsw_request:i?{".tag":"check"}:void 0},{subjectUserId:o})];case 2:return[2,{isError:!1,result:{changeset_data:(c=r.sent()).changeset_data,entries:[{".tag":"success",metadata:c.metadata}]}}];case 3:return d=r.sent(),(null===(s=null==d?void 0:d.error)||void 0===s?void 0:s[".tag"])?[2,{isError:!1,result:{changeset_data:[],entries:[{".tag":"failure",failure:d.error}]}}]:(a(d),[2,t.createUndefinedRpcResult()]);case 4:return[4,p((function(){return l.ns("files").rpc("delete_batch",{entries:e.map((function(e){return{path:e.fq_path}})),fsw_request:i?{".tag":"check"}:void 0},{subjectUserId:o})}),(function(e){return l.ns("files").rpc("delete_batch/check",{async_job_id:e},{subjectUserId:o})}))];case 5:return[2,r.sent()]}}))}))},t.createFolder=function(e,i,s,l){return r.__awaiter(this,void 0,Promise,(function(){var c,d;return r.__generator(this,(function(r){switch(r.label){case 0:c=new n.UserApiV2Client,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,c.ns("files").rpc("create_folder_v2",{path:o.normalize(e)+"/"+i,autorename:!0,fsw_request:l?{".tag":"check"}:void 0},{subjectUserId:s.id})];case 2:return[2,{isError:!1,result:r.sent()}];case 3:return(d=r.sent())&&d.error&&d.error[".tag"]?[2,{isError:!0,error:d.error,error_summary:d.summary}]:(a(d),[2,t.createUndefinedRpcResult()]);case 4:return[2]}}))}))},t.isFailure=function(e){return"failure"===e[".tag"]},t.isPathLookupFailure=function(e){return"path_lookup"===e[".tag"]}})),define("modules/clean/react/files_view/file_actions/file_from_metadata",["require","exports","tslib","modules/clean/react/browse/models"],(function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.folderFromFolderMetadata=t.fileFromMetadata=void 0,t.fileFromMetadata=function(e,t){if("file"===t[".tag"]){var o=t,i=r.__assign(r.__assign({},e),{fq_path:o.path_display||e.fq_path,icon:o.icon+"_32",revision_id:o.rev,file_id:o.id});return new n.File(i)}return"folder"===t[".tag"]?new n.File(r.__assign(r.__assign({},e),{fq_path:t.path_display||e.fq_path})):e},t.folderFromFolderMetadata=function(e){return new n.File({file_id:e.id,fq_path:e.path_display||"",icon:e.icon,is_dir:!0})}})),define("modules/clean/react/files_view/file_actions/rollback",["require","exports","tslib","modules/clean/react/browse/api","modules/core/i18n"],(function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.rollback=void 0,n=r.__importStar(n),t.rollback=function(e){for(var t=e.changeset_data,r=e.userId,i=e.onSuccess,a={},s=0,l=t;s<l.length;s++){var c=l[s],d=c.ns_id,u=c.op_id,_=parseInt(u.slice(6),10);a.hasOwnProperty(d)?a[d].push(_):a[d]=[_]}n.rollbackChangeSets({changesets:a,onSuccess:i,userId:r,progressText:o.intl.formatMessage({id:"wKzr7W",defaultMessage:"Undoing…"})})}})),define("modules/clean/react/files_view/file_actions/snackbars",["require","exports","modules/core/i18n"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deleteCompleteError=t.deleteInProgress=t.deleteCompleteSuccess=t.deleteError=t.renameError=void 0,t.renameError=function(e,t){return"to"===e[".tag"]&&"malformed_path"===e.to[".tag"]?r.intl.formatMessage({id:"rBgywO",defaultMessage:"Name was invalid."}):"from_write"===e[".tag"]&&"team_folder"===e.from_write[".tag"]?r.intl.formatMessage({id:"zqiuDZ",defaultMessage:"Team folders can’t be renamed."}):"from_lookup"===e[".tag"]&&"not_found"===e.from_lookup[".tag"]?r.intl.formatMessage({id:"kdizeA",defaultMessage:"Couldn’t find the file."}):r.intl.formatMessage({id:"pUBm7w",defaultMessage:"Rename failed."})},t.deleteError=function(e,t){return r.intl.formatMessage({id:"pjyJun",defaultMessage:"{count, plural, one{Couldn’t delete {count} item.} other{Couldn’t delete {count} items.}}"},{count:e})},t.deleteCompleteSuccess=function(e,t){return t<e?r.intl.formatMessage({id:"QGz6Gm",defaultMessage:"{count, plural, one{Deleted {succesfully_deleted_files} out of {count} item.} other{Deleted {succesfully_deleted_files} out of {count} items.}}"},{count:e,succesfully_deleted_files:t}):r.intl.formatMessage({id:"THAbub",defaultMessage:"{count, plural, one{Deleted {count} item.} other{Deleted {count} items.}}"},{count:t})},t.deleteInProgress=function(e){return r.intl.formatMessage({id:"z7/sbf",defaultMessage:"{count, plural, one{Deleting {count} item...} other{Deleting {count} items...}}"},{count:e})},t.deleteCompleteError=function(e){if(1===e.length){var t=e[0].failure;if("too_many_files"===t[".tag"]||"too_many_write_operations"===t[".tag"])return r.intl.formatMessage({id:"ane1pD",defaultMessage:"There are too many files in one request. Please retry with fewer files."});if("path_lookup"===t[".tag"]&&"not_found"===t.path_lookup[".tag"])return r.intl.formatMessage({id:"9suezP",defaultMessage:"File does not exist."})}return r.intl.formatMessage({id:"pjyJun",defaultMessage:"{count, plural, one{Couldn’t delete {count} item.} other{Couldn’t delete {count} items.}}"},{count:e.length})}})),define("modules/clean/react/files_view/file_grouper",["require","exports","modules/core/i18n","modules/clean/datetime/datetime","modules/clean/react/browse/constants","modules/clean/react/files_view/sort_types","modules/clean/react/browse/models"],(function(e,t,r,n,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSections=t.EMPTY_SECTIONS=void 0;var s=r.intl.formatMessage({id:"RzhnRl",defaultMessage:"Extensionless"}),l=r.intl.formatMessage({id:"DcKHEo",defaultMessage:"Missing dates"}),c=r.intl.formatMessage({id:"GYhJ5f",defaultMessage:"Deleted content isn’t sorted by last modified"});t.EMPTY_SECTIONS={sectionLabels:[],sectionStartIndices:[]},t.getSections=function(e,t,d,u){void 0===u&&(u=!1);var _=[],p=[],f=null;if(t===i.SortField.CATEGORY)e.forEach((function(e,t){if(e){var r=(function(e){return e instanceof a.File?a.File.getCategoryDescription(e,!0):o.ExtensionCategories.DOCUMENT})(e);r!==f&&(_.push(r),p.push(t),f=r)}}));else if(t===i.SortField.EXTENSION)e.forEach((function(e,t){if(e){var r=(function(e){return e instanceof a.File?e.is_dir?o.FileTypeCapitalizedCategoryTranslations.FOLDER:a.File.getExtension(e).toUpperCase():s})(e);if(r!==f){var n=r;""===r&&(n=s),_.push(n),p.push(t),f=r}}}));else if(t===i.SortField.MODIFIED)if(d===i.SortDirection.DESCENDING){var m=n.getTimeBands(Date.now());e.forEach((function(e,t){if(e){var n;if(u&&e instanceof a.File&&e.isDeleted)n=c;else{var o=a.itemTimestampInMs(e);n=o>=m.today?r.intl.formatMessage({id:"JDRaFD",defaultMessage:"Today"}):o>=m.yesterday?r.intl.formatMessage({id:"2iSDDx",defaultMessage:"Yesterday"}):o>=m.thisWeek?r.intl.formatMessage({id:"e3KIPg",defaultMessage:"This week"}):o>=m.lastWeek?r.intl.formatMessage({id:"dsHtkw",defaultMessage:"Last week"}):o>=m.thisMonth?r.intl.formatMessage({id:"G0eFMx",defaultMessage:"This month"}):o>=m.lastMonth?r.intl.formatMessage({id:"nM5Fv4",defaultMessage:"Last month"}):o>=m.lastThreeMonths?r.intl.formatMessage({id:"U7dFRR",defaultMessage:"Three months ago"}):r.intl.formatMessage({id:"Y/NN0h",defaultMessage:"Older"})}n!==f&&(_.push(n),p.push(t),f=n)}}))}else e.forEach((function(e,t){var n;e&&((n=u&&e instanceof a.File&&e.isDeleted?c:a.itemTimestampInMs(e)?r.intl.formatDate(a.itemTimestampInMs(e),{year:"numeric",month:"long"}):l)!==f&&(_.push(n),p.push(t),f=n))}));return{sectionLabels:_,sectionStartIndices:p}}})),define("modules/clean/react/files_view/file_actions/file_media_actions",["require","exports","tslib","react","spectrum/media_table/index","modules/clean/react/extensions/split_share_button","modules/clean/react/files_view/overflow_menu","modules/clean/react/files_view/util","modules/clean/react/vault/lib/browse_utils","modules/clean/user_survey/user_survey"],(function(e,t,r,n,o,i,a,s,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileMediaActions=void 0;var d=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isActionDropdownOpen:!1},t.onSplitShareDropdownOpen=function(){t.onActionDropdownOpen()},t.onActionDropdownOpen=function(){t.setState({isActionDropdownOpen:!0})},t.onActionDropdownClose=function(){t.setState({isActionDropdownOpen:!1})},t.logSplitShareButton=function(e){c.UserSurvey.trackEvent("share_item","browse"),s.isFile(t.props.file)&&t.props.file.is_in_vault_folder&&l.logShareFromInsideVault(t.props.file.is_dir)},t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.arePostTTIModulesLoaded,r=e.canDisplayFolderSizes,s=e.file,l=e.getOverflowMenuActions,c=e.isCompactMode,d=e.isHovered,u=e.isSelectMode,_=e.isSharingDisabled,p=e.onPresentInZoom,f=e.shareButtonLabel,m=e.showShareButton,g=e.showBorders,h=e.user,S=e.viewportTopOffset,E=this.props.onShowShare||function(){};return u?null:n.default.createElement(o.MediaActions,null,!_&&!1!==m&&n.default.createElement(i.SplitShareButton,{shareButtonLabel:f,onShowShare:E,logShareButtonClick:this.logSplitShareButton,isVisible:d&&!c||this.state.isActionDropdownOpen,user:h,files:[s],onDropdownOpen:this.onSplitShareDropdownOpen,onDropdownClose:this.onActionDropdownClose,onPresentInZoom:p,variant:"opacity",shouldUsePortalPopover:!0}),t&&n.default.createElement(a.FilesViewOverflowMenu,{canDisplayFolderSizes:r,file:s,getOverflowMenuActions:l,showBorders:d||!!g,viewportTopOffset:S,ariaHidden:!0}))},t.displayName="FileMediaActions",t})((n=r.__importDefault(n)).default.PureComponent);t.FileMediaActions=d})),define("modules/clean/react/files_view/file_actions/file_media_actions_v2",["require","exports","tslib","classnames","react","react-redux","modules/clean/react/files_view/data/selectors/instance_selectors","modules/core/browser_detection"],(function(e,t,r,n,o,i,a,s){"use strict";function l(e){e.stopPropagation()}function c(e){var t,r=e.FilesViewInlineActionBar,i=e.file,a=e.highlighted,c=e.onHoverLocked,d=e.isMobile,u=n.default("brws-file-row-inline-action-bar",((t={})["brws-file-row-inline-action-bar--safari"]=s.safari,t));return r?o.default.createElement("div",{onClick:l,className:"brws-file-row-inline-action-bar--container"},o.default.createElement(r,{className:u,file:i,highlighted:a,onHoverLocked:c,isMobile:d})):null}Object.defineProperty(t,"__esModule",{value:!0}),t.FileMediaActionsV2=t.FileMediaActionsV2Element=void 0,n=r.__importDefault(n),o=r.__importDefault(o),s=r.__importStar(s),t.FileMediaActionsV2Element=c;t.FileMediaActionsV2=i.connect((function(e,t){return{FilesViewInlineActionBar:a.selectInlineActionBar(e,t)}}))(c)})),define("modules/clean/react/files_view/file_name/file_name_audio_description",["require","exports","tslib","react","modules/clean/filetypes","modules/clean/react/browse/models","modules/clean/react/files_view/util","modules/core/i18n"],(function(e,t,r,n,o,i,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileNameAudioDescription=void 0,n=r.__importDefault(n),t.FileNameAudioDescription=function(e){var t=e.file,r=e.isSelected,l=[];return a.isFile(t)&&t.isDeleted&&l.push(s.intl.formatMessage({id:"RBvabN",defaultMessage:"Deleted"})),r&&l.push(s.intl.formatMessage({id:"mpdvwi",defaultMessage:"Selected"})),a.isFile(t)&&t.is_dir&&(t.type===o.FileTypes.SHARED_FOLDER?i.File.isReadOnlySharedFolder(t)?l.push(s.intl.formatMessage({id:"513aYe",defaultMessage:"Read-only shared folder"})):l.push(s.intl.formatMessage({id:"r6q13e",defaultMessage:"Shared folder"})):t.type===o.FileTypes.TEAM_SHARED_FOLDER?i.File.isReadOnlySharedFolder(t)?l.push(s.intl.formatMessage({id:"dNfvWF",defaultMessage:"Read-only team shared folder"})):l.push(s.intl.formatMessage({id:"8zuxGM",defaultMessage:"Team shared folder"})):l.push(s.intl.formatMessage({id:"MLqiSW",defaultMessage:"Folder"}))),l.length>0?n.default.createElement("span",{className:"ax-visually-hidden"},""+l.join(" ")):null},t.FileNameAudioDescription.displayName="FileNameAudioDescription"})),define("modules/clean/react/files_view/file_name/file_name_cell",["require","exports","tslib","classnames","react","react-redux","spectrum/dimensions/index","modules/clean/react/browse/data/selectors","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/data/selectors/item_selectors","modules/clean/react/files_view/star","modules/clean/react/files_view/types","modules/clean/react/selectable_list","modules/clean/react/files_view/file_name/file_name_cell_contents","modules/clean/react/flows/components/badge_async","modules/clean/react/flows/types"],(function(e,t,r,n,o,i,a,s,l,c,d,u,_,p,f,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileNameCell=t.FileNameCellComponent=void 0,n=r.__importDefault(n),o=r.__importDefault(o),t.FileNameCellComponent=function(e){var t=e.mediaActions,r=e.fileNameCellWidth,i=e.draggable,a=e.shouldTruncateMiddleFilename,s=e.renameState,l=e.flowsBadge,c=e.showStar,h=e.file,S=e.user,E=e.isMobileMode,v=e.isSelected,T=e.showLocation,w=e.showSnippets,I=e.shouldShowSubtitle,b=e.snippetRows,F=e.onNameClick,C=e.showUserEducationEffects,O=e.showHighlights,R=e.hrefForFile,A=e.userEducationEffectName,y=e.isTooltipEnabled,D=e.showFirstTaskSubtitle,L=e.renderFilenameSubtitleAsLink,M=e.onRenameCancel,N=e.onRenameSubmit,P=e.isHovered,U=e.onLocationLinkClick,x=e.onSelect,k=e.onDragStart,V=e.expFlowsAutomatedFolderUI,W=e.showTags,H=e.preventSelectionOnDrag,B=e.mediaFiltersVariant,G=e.backupNewLocationHintEnabled,q=n.default("brws-file-name-cell-text","brws-vertically-center",{"brws-file-name-cell-text-rename":!!s}),z=n.default("brws-file-name-container",{"brws-file-name-container--action-ui-inline-star":!0}),j=function(e){var n;return a&&void 0!==(n=r||e)&&void 0!==t&&(n-=48),n},K=function(e){k&&(H||v||!x||x(_.SelectOptions.DEFAULT,u.FilesViewActionSource.ROW_SINGLE_CLICK),k(e))},Y=a&&void 0===r;return o.default.createElement(o.default.Fragment,null,o.default.createElement(g,{className:z,shouldWrap:Y},(function(e){return o.default.createElement("div",{className:z},o.default.createElement("div",{className:q,draggable:i,onDragStart:K},o.default.createElement(p.FileNameCellContents,{file:h,renameState:s,showLocation:T,showSnippets:w,shouldShowSubtitle:I,snippetRows:b,user:S,onNameClick:F,isSelected:v,showUserEducationEffects:C,showHighlights:O,hrefForFile:R,userEducationEffectName:A,isTooltipEnabled:y,showFirstTaskSubtitle:D,renderFilenameSubtitleAsLink:L,onRenameCancel:M,onRenameSubmit:N,isHovered:P,onLocationLinkClick:U,width:j(e),shouldShowTags:W,mediaFiltersVariant:B,backupNewLocationHintEnabled:G})),l!==m.FlowsRuleType.None&&o.default.createElement(f.AsyncBadgeComponent,{isFolderFocused:v,type:l,isInUnifiedModal:!!V}),!s&&c&&o.default.createElement(d.StarContainer,{item:h,user:S,className:"brws-file-name-cell-star",isReadOnly:E,tabIndex:v?0:-1,starButtonClassName:"brws-file-name-star-button",alwaysShowUnstarred:!0}))})),t)},t.FileNameCellComponent.displayName="FileNameCellComponent";var g=function(e){var t=e.children,r=e.className;return e.shouldWrap?o.default.createElement(a.Dimensions,{className:r},(function(e){var r=e.width;return t(r)})):t()};g.displayName="ConditionalDimensions";t.FileNameCell=i.connect((function(e,t){return{file:c.selectItemAssertFileOrFileSharedWithMe(e,t),flowsBadge:c.selectFlowsBadge(e,t),isSelectMode:l.selectHasItemsSelected(e,t),isSelected:c.selectIsItemSelected(e,t),expFlowsAutomatedFolderUI:l.selectExpFlowsAutomatedFolderUI(e,t),renameState:c.selectRenameState(e,t),renderFilenameSubtitleAsLink:l.selectRenderFilenameSubtitleAsLink(e,t),isMobileMode:l.selectIsMobileMode(e,t),showHighlights:l.selectShouldShowFileNameHighlights(e,t),showLocation:l.selectShouldShowFileNameLocation(e,t),showStar:c.selectShouldShowStar(e,t),showUserEducationEffects:c.selectShouldShowUserEducationEffects(e,t),userEducationEffectName:c.selectUserEducationEffectName(e,t),isTooltipEnabled:c.selectIsTooltipEnabled(e,t),user:l.selectUser(e,t),shouldTruncateMiddleFilename:l.selectArePostTTIModulesLoaded(e,t),showSnippets:c.selectShouldShowSnippets(e,t),snippetRows:c.selectSnippetRows(e,r.__assign(r.__assign({},t),{numVisibleColumns:t.visibleColumns.length})),showFirstTaskSubtitle:c.selectShouldShowFirstTaskSubtitle(e,t),shouldShowSubtitle:c.selectShouldShowSubtitle(e,t),backupNewLocationHintEnabled:s.backupNewLocationHintEnabled(e)}}))(t.FileNameCellComponent)})),define("modules/clean/react/files_view/file_name/file_name_cell_contents",["require","exports","tslib","react","spectrum/media_table/index","modules/clean/filepath/filepath","modules/clean/react/files_view/file_snippets","modules/clean/react/files_view/name_input","modules/clean/react/files_view/types","modules/clean/react/files_view/util","modules/clean/react/files_view/file_name/file_name_subtitle","modules/clean/react/files_view/file_name/file_name_title","modules/clean/react/files_view/file_name/file_name_audio_description","modules/core/i18n","modules/clean/tagging/logger","modules/clean/tagging/utils","modules/clean/tagging/components/tags_container","modules/clean/media_filters/gating","modules/clean/media_filters/media_search_snippet_loader","modules/clean/react/browse/data/helpers","dig-components/buttons","dig-components/tooltips","dig-components/icons","dig-components/icons/src","modules/core/browser"],(function(e,t,r,n,o,i,a,s,l,c,d,u,_,p,f,m,g,h,S,E,v,T,w,I,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileNameCellContents=void 0,n=r.__importDefault(n),i=r.__importStar(i),f=r.__importStar(f),m=r.__importStar(m),b=r.__importStar(b);var F=function(e){null==e||e.stopPropagation()};t.FileNameCellContents=function(t){var p,O=t.file,R=t.renameState,A=t.showLocation,y=t.showSnippets,D=t.shouldShowSubtitle,L=t.snippetRows,M=t.user,N=t.onNameClick,P=t.isSelected,U=t.showUserEducationEffects,x=t.showHighlights,k=t.hrefForFile,V=t.userEducationEffectName,W=t.isTooltipEnabled,H=t.showFirstTaskSubtitle,B=t.renderFilenameSubtitleAsLink,G=t.onRenameCancel,q=t.onRenameSubmit,z=t.isHovered,j=t.onLocationLinkClick,K=t.width,Y=t.shouldShowTags,Q=t.mediaFiltersVariant,X=t.backupNewLocationHintEnabled,J=C(),Z=(function(e,t){return function(r){var n=!c.shouldHandleClick(r);n||(r.preventDefault(),r.stopPropagation()),c.isFile(e)&&(null==t||t(e,n))}})(O,j);if(c.isFile(O)&&R===l.RenameState.PENDING_INPUT)return n.default.createElement(s.NameInput,{defaultValue:i.filename(O.fq_path),label:O.is_dir?J.renameDirStr:J.renameFileStr,onClick:F,onSubmit:function(e){c.isFile(O)&&(null==q||q(O,e))},onCancel:function(){c.isFile(O)&&(null==G||G(O))},ignoreFileExtension:O.is_dir});p=R===l.RenameState.SAVING_INPUT?n.default.createElement(n.default.Fragment,null,J.renamingStr):n.default.createElement(u.FileNameTitle,{file:O,user:M,containerWidth:K,isSelected:P,onNameClick:N,hrefForFile:k,showHighlights:x,isTooltipEnabled:W,showUserEducationEffects:U,userEducationEffectName:V});var $=null;H?$=n.default.createElement("span",{className:"first-task-content-subtitle"},J.filesMovedString):A&&($=n.default.createElement(d.FileSubtitle,{containerWidth:K,file:O,onClick:Z,renderAsLink:B,user:M,focusable:P}));var ee=K?{width:K}:void 0,te=h.isMediaFiltersEnabled(Q)&&c.isFile(O)&&O.media_data,re=y||Y&&c.isFile(O)||te;return n.default.createElement(n.default.Fragment,null,n.default.createElement(o.MediaCellText,{key:"title",highlight:z},n.default.createElement("div",{className:"brws-file-name-cell-title-container"},p,n.default.createElement(_.FileNameAudioDescription,{file:O,isSelected:P}),X&&E.isBackupFolder(O)&&n.default.createElement(T.Tooltip,{title:J.backupNewLocationTooltipStr,placement:"right"},n.default.createElement(v.Button,{className:"brws-file-name-cell-backup-new-location",variant:"transparent",size:"small",withIconLeft:n.default.createElement(w.UIIcon,{src:I.OpenLine,size:"small"}),onClick:function(t){new Promise((function(t,r){e(["modules/clean/sync_everything/constants"],t,r)})).then(r.__importStar).then((function(e){var t=e.getBackupUrl;return b.open_tab(t("browse_row"))})),t.stopPropagation()}},J.backupNewLocationButtonStr)))),D&&n.default.createElement(o.MediaCellText,{key:"subtitle",variant:"subtitle"},$),re&&n.default.createElement(o.MediaCellText,{key:"snippets_tags",variant:"subtitle",style:ee},n.default.createElement("div",{className:"brws-file-snippets-tags-container"},te&&c.isFile(O)&&n.default.createElement("span",{className:"brws-file-snippets-media-search",style:ee},n.default.createElement(S.AsyncMediaSearchSnippet,{mediaData:O.media_data,mediaFiltersVariant:Q})),y&&n.default.createElement(a.FileSnippets,{snippets:O.snippets,lineClamp:L}),Y&&c.isFile(O)&&O.tags&&O.tags.length>0&&n.default.createElement("span",{className:"brws-file-snippets",style:ee},n.default.createElement(g.TagsContainer,{tags:O.tags.map((function(e){return e.value})),highlightedIndexes:O.tags.map((function(e,t){return e.highlighted?t:void 0})).filter((function(e){return void 0!==e})),onTagClick:function(e,t){t&&(!c.shouldHandleClick(t)||(t.preventDefault(),t.stopPropagation()));c.isFile(O)&&(f.logTagClick(M,[O],"center_pane",e),m.redirectToSearchByTag(M,e.tag_text))},containerClassName:"brws-file-tags-container",chipClassName:"brws-file-tag",showMoreClassName:"brws-file-tags-show-more",chipSize:"xsmall",containerMaxRows:1,expandable:!1,showMoreWidth:100})))))},t.FileNameCellContents.displayName="FileNameCellContents";var C=function(){return{filesMovedString:p.intl.formatMessage({id:"WYezR2",defaultMessage:"Your existing files moved here."}),renameFileStr:p.intl.formatMessage({id:"44Ky+Q",defaultMessage:"Rename file"}),renameDirStr:p.intl.formatMessage({id:"YApL4x",defaultMessage:"Rename directory"}),renamingStr:p.intl.formatMessage({id:"KvygQC",defaultMessage:"Renaming…"}),backupNewLocationButtonStr:p.intl.formatMessage({id:"wX0e+1",defaultMessage:"New location"}),backupNewLocationTooltipStr:p.intl.formatMessage({id:"Pn0YTw",defaultMessage:"Backups have a new home"})}}})),define("modules/clean/react/files_view/file_name/file_name_subtitle",["require","exports","tslib","react","modules/clean/browse_interface","modules/clean/filepath/filepath","modules/clean/react/files_view/util","modules/core/i18n","modules/clean/react/files_view/file_name/truncation_helpers"],(function(e,t,r,n,o,i,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileSubtitle=void 0,n=r.__importDefault(n),i=r.__importStar(i);t.FileSubtitle=function(e){var t=e.file,r=e.renderAsLink,c=void 0===r||r,d=e.user,u=e.containerWidth,_=e.onClick,p=e.focusable,f={notAddedYetString:function(e){return s.intl.formatMessage({id:"hY0d5Z",defaultMessage:"not added yet, in {location}"},{location:e})},sharedWithYouString:s.intl.formatMessage({id:"FWJkxz",defaultMessage:"Shared with you"}),formattedLocationText:function(e){return s.intl.formatMessage({id:"yR1l4z",defaultMessage:"in {location}"},{location:e})}};if(!a.isFile(t))return n.default.createElement(n.default.Fragment,null,f.sharedWithYouString);var m=i.parent_dir(t.fq_path),g="/"===m?o.get_browse_root_name(d):m.slice(1);if(t.is_unmounted)return n.default.createElement(n.default.Fragment,null,f.notAddedYetString(g));var h=l.truncateTextInFilenameCell(f.formattedLocationText(g),12,6,u);if(!c||t.isDeleted)return n.default.createElement(n.default.Fragment,null,h);var S=o.browse_uri_for_fq_path(d,m);return n.default.createElement("a",{className:"brws-file-name-cell-location",href:S.toString(),onClick:_,tabIndex:p?0:-1},h)},t.FileSubtitle.displayName="FileSubtitle",t.FileSubtitle.displayName="FileSubtitle"})),define("modules/clean/react/files_view/file_name/file_name_title",["require","exports","tslib","react","modules/clean/filepath/filepath","modules/clean/react/browse/models","modules/clean/react/files_view/constants","modules/clean/react/files_view/util","modules/clean/react/title_bubble","modules/clean/user_education/react/user_education_effect","modules/clean/react/sticky_position","typescript/component_libraries/retrieval-components/src/highlighted-truncated-string/index","modules/clean/react/files_view/file_name/truncation_helpers"],(function(e,t,r,n,o,i,a,s,l,c,d,u,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileNameTitle=void 0,n=r.__importDefault(n),o=r.__importStar(o);var p=function(e){return e instanceof i.FileSharedWithMe};t.FileNameTitle=function(e){var t,r,i=e.file,f=e.user,m=e.hrefForFile,g=e.showHighlights,h=e.showUserEducationEffects,S=e.userEducationEffectName,E=e.isSelected,v=e.containerWidth,T=e.onNameClick,w=e.isTooltipEnabled,I=s.getFilename(i),b=n.default.useRef(null),F=n.default.useMemo((function(){return(function(e,t,r){if(!t||p(e)||!r.current)return!1;var n=r.current,i=o.filename(e.fq_path),a=n.offsetWidth<n.scrollWidth,s=n.textContent!==i;return a||s})(i,w,b)}),[i,w]);if(v)t=n.default.createElement(u.HighlightedTruncatedString,{text:I,className:"brws-file-name-element",fontSize:14,availableWidth:v,highlightSpans:_.getHighlightedSpansForHighlightedTruncatedString(I,i),cellBuffer:3});else{var C=_.truncateTextInFilenameCell(I,14,3,v);t=g&&(i.highlight_spans||s.isFile(i)&&i.filename_highlights)?_.getHighlightedSpan(C,i):n.default.createElement("span",null,C),t=n.default.createElement("div",{className:"brws-file-name-element",ref:b},t)}if(F){var O=I.length<=a.FILE_NAME_TOOLTIP_MAX_LINE_LENGTH?I:n.default.createElement("div",{className:"brws-file-name-cell-tooltip"},I);t=n.default.createElement(l.TitleBubble,{content:O,position:d.StickyPosition.BOTTOM,className:"list-label__title-bubble"},t)}return p(i)?r=i.href:i.is_unmounted||i.isDeleted||(r=null==m?void 0:m(f,i)),void 0!==r&&(t=n.default.createElement("a",{className:"brws-file-name-cell-filename",href:r,onClick:T,tabIndex:E?0:-1},t)),h&&(t=n.default.createElement(c.UserEducationEffect,{containerName:"FileNameLabel",name:S||"FileNameLabel",useSpan:!0},t)),t},t.FileNameTitle.displayName="FileNameTitle",t.FileNameTitle.displayName="FileNameTitle"})),define("modules/clean/react/files_view/file_name/truncation_helpers",["require","exports","tslib","react","modules/clean/em_string","modules/clean/filename_highlights","modules/clean/react/browse/models","modules/clean/react/files_view/util"],(function(e,t,r,n,o,i,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getHighlightedSpansForHighlightedTruncatedString=t.getHighlightedSpan=t.truncateTextInFilenameCell=void 0,n=r.__importDefault(n);t.truncateTextInFilenameCell=function(e,t,r,n){if(n&&n>32){var i=(n-32)/t,a=Math.max(r,i-r);return o.Emstring.em_snippet(e,Math.floor(a),.5)}return e},t.getHighlightedSpan=function(e,t){var r,o,a=s.getFilename(t),l=(function(e,t){for(var r=0;r<e.length&&e.charAt(r)===t.charAt(r);)++r;return r===e.length||"…"!==e.charAt(r)?[e]:[e.substring(0,r),e.substring(r+1)]})(e,a);return 1===l.length?s.isFile(t)&&!t.highlight_spans?i.highlightMatchReact(e,t.filename_highlights):i.highlightReactFromHighlightSpans(e,t.highlight_spans):(s.isFile(t)&&!t.highlight_spans?(r=i.highlightMatchReact(a,t.filename_highlights,0,l[0].length),o=i.highlightMatchReact(a,t.filename_highlights,a.lastIndexOf(l[1]))):(r=i.highlightReactFromHighlightSpans(a,t.highlight_spans,0,l[0].length),o=i.highlightReactFromHighlightSpans(a,t.highlight_spans,a.lastIndexOf(l[1]))),n.default.createElement("span",null,r,"…",o))},t.getHighlightedSpansForHighlightedTruncatedString=function(e,t){if(s.isFile(t)||(function(e){return e instanceof a.FileSharedWithMe})(t))return t.highlight_spans?t.highlight_spans.map((function(e){return{string:e.highlight_str,isHighlighted:e.is_highlighted}})):s.isFile(t)&&t.filename_highlights?i.highlightMatchSections(e,t.filename_highlights).map((function(e){return{string:e.text,isHighlighted:e.isHighlighted}})):void 0}})),define("modules/clean/react/files_view/rows/file_row",["require","exports","tslib","classnames","modules/clean/react/files_view/file_actions/file_media_actions_v2","react","spectrum/media_table/index","modules/clean/media_filters/gating","modules/clean/filepath/filepath","modules/clean/react/browse/models","modules/clean/react/files_view/file_actions/file_media_actions","modules/clean/react/files_view/file_name/file_name_cell","modules/clean/react/files_view/rows/cells/file_row_checkbox","modules/clean/react/files_view/rows/row","modules/clean/react/files_view/thumbnail_media_cell","modules/clean/react/files_view/types","modules/clean/react/files_view/sort_types","modules/clean/react/files_view/util","modules/core/browser","modules/core/exception","modules/clean/react/files_view/rows/cells/modified_cell","modules/clean/react/files_view/rows/cells/async_folder_size","modules/clean/react/files_view/rows/cells/tags_cell","modules/clean/tagging/experiments","modules/constants/folder_explorer"],(function(e,t,r,n,o,i,a,s,l,c,d,u,_,p,f,m,g,h,S,E,v,T,w,I,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileRow=void 0,n=r.__importDefault(n),i=r.__importDefault(i),l=r.__importStar(l),S=r.__importStar(S),E=r.__importStar(E);var F=function(){return i.default.createElement("span",{"aria-hidden":!0},"--")},C=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isHoverLocked:!1,rowIsDragging:!1},t.handleOpenFileClick=function(e){return t.handleOpenNewTabOrNavigate(e,m.FilesViewActionSource.ROW_PREVIEW_ICON)},t.handleTitleClick=function(e){return t.handleOpenNewTabOrNavigate(e,m.FilesViewActionSource.ROW_TITLE)},t.handleOpenNewTabOrNavigate=function(e,r){if(0===e.button){var n=h.hasModifierKey(e);if(n&&"A"===e.currentTarget.tagName)return void e.stopPropagation();e.preventDefault(),e.stopPropagation(),t.onNavigateToItem({openInNewTab:n,actionSource:r})}},t.onSelect=function(e,r){t.props.onSelect&&t.props.onSelect(t.props.fileToId(t.props.file),e,r)},t.onDeselect=function(e,r){t.props.onDeselect&&t.props.onDeselect(t.props.fileToId(t.props.file),e,r)},t.onNavigateToItem=function(e){var r=e.openInNewTab,n=e.actionSource;if(r){var o=t.props,i=o.file,a=o.user,s=o.hrefForFile;S.open_tab(s(a,i))}else t.props.onNavigateToFileOrFolder(t.props.file,{actionSource:n})},t.onDragEnter=function(e){var r=t.props,n=r.file,o=r.isSelected,i=r.isActiveDropTarget;t.props.onDragEnter(e,n,!!o,!!i)},t.onDragStart=function(e){t.setState({rowIsDragging:!0});var r=t.props,n=r.file,o=r.isSelected,i=r.onDragStart;i&&(o?i(e):i(e,[n]))},t.onDragEnd=function(e){t.setState({rowIsDragging:!1});var r=t.props.onDragEnd;r&&r(e)},t.onShowShare=function(){t.props.onShowShare(t.props.file,"BROWSE_FILE_ROW")},t.onPresentInZoom=function(){t.props.onPresentInZoom&&t.props.onPresentInZoom(t.props.file)},t.handleHoverLocked=function(e){var r=e.isOpen;t.setState({isHoverLocked:r})},t.getAriaLabelForColumn=function(e,t){var r;switch(e.sortField){case g.SortField.FILENAME:return e.label+" "+l.filename(t.fq_path);case g.SortField.MODIFIED:return e.label+" "+t.ago;case g.SortField.CATEGORY:return e.label+" "+c.File.getCategoryDescription(t);case g.SortField.EXTENSION:return e.label+" "+c.File.getExtension(t);case g.SortField.SIZE:return e.label+" "+t.size;case g.SortField.TAGS:return e.label+" "+t.tags?null===(r=t.tags)||void 0===r?void 0:r.map((function(e){return e.value})).join(", "):"";case g.SortField.SHARED_WITH:default:return}},t.renderMediaActions=function(e,r){var n=t.props,a=n.instanceId,s=n.arePostTTIModulesLoaded,l=n.canDisplayFolderSizes,c=n.file,u=n.getOverflowMenuActions,_=n.isCompactMode,p=n.responsive,f=n.isSelectMode,m=n.isSelected,g=n.isSharingDisabled,h=n.renameState,S=n.shareButtonLabel,E=n.showShareButton,v=n.user,T=n.viewportTopOffset,w=n.isActionBarEnabled,I=!p.isMatchedLarge&&!p.isMatchedMedium;return!(I&&(h||f))?w?e||I?i.default.createElement(o.FileMediaActionsV2,{instanceId:a,file:c,highlighted:m,onHoverLocked:t.handleHoverLocked,isMobile:I}):void 0:i.default.createElement(d.FileMediaActions,{arePostTTIModulesLoaded:s,canDisplayFolderSizes:l,file:c,getOverflowMenuActions:u,isCompactMode:!!_,isHovered:e,isSelectMode:!!f,isSharingDisabled:!!g,onOpenFileClick:t.handleOpenFileClick,onPresentInZoom:t.onPresentInZoom,onShowShare:t.onShowShare,shareButtonLabel:S,showShareButton:E,showBorders:r,user:v,viewportTopOffset:T}):void 0},t}return r.__extends(t,e),t.prototype.renderCell=function(e){var t,r,n,o,l,d,_=e.isHovered,p=e.sortField,m=e.renderCell,h=this.props,S=h.instanceId,b=h.itemIndex,C=h.rowIndex,O=h.fileToId,R=h.visibleColumns,A=h.containerWidth,y=h.height,D=h.file,L=h.hrefForFile,M=h.isSearchMode,N=h.isSelectMode,P=h.onLocationLinkClick,U=h.onRenameCancel,x=h.onRenameSubmit,k=h.filteredContactName,V=h.showCDMUserEducationEffects,W=h.iconSize,H=h.isCondensedListView,B=h.columnSizes,G=h.renderSharedWithController,q=h.isSelected,z=h.expManualTagging,j=h.user,K=h.preventSelectionOnDrag,Y=h.mediaFiltersVariant;if(m)return m({file:D});var Q=null==B?void 0:B[p];switch(p){case g.SortField.FILENAME:return i.default.createElement(f.ThumbnailMediaCell,{key:"fileName",file:D,height:y,width:Q,showCDMUserEducationEffects:V,iconSize:W},i.default.createElement(u.FileNameCell,{instanceId:S,itemIndex:b,rowIndex:C,isHovered:_,fileToId:O,visibleColumns:R,containerWidth:A,onLocationLinkClick:P,onRenameCancel:U,onRenameSubmit:x,hrefForFile:L,onNameClick:this.handleTitleClick,onSelect:this.onSelect,onDragStart:this.onDragStart,draggable:!N,showTags:M&&I.isTaggingEnabled(z),mediaFiltersVariant:M?Y:"OFF",preventSelectionOnDrag:K}));case g.SortField.RELEVANCE:case g.SortField.MODIFIED:return i.default.createElement(v.ModifiedCell,{key:"modified",file:D,filteredContactName:k,isSearchMode:Boolean(M),shouldBubbleSubtitle:H,width:Q});case g.SortField.SHARED_WITH:case g.SortField.CATEGORY:case g.SortField.EXTENSION:case g.SortField.SIZE:case g.SortField.TAGS:case g.SortField.LOCKED_FILES:var X=void 0===Q?{}:{width:Q,minWidth:Q,maxWidth:Q},J=(t={},t[g.SortField.SHARED_WITH]=G(D,q?0:void 0),t[g.SortField.CATEGORY]=null,t[g.SortField.EXTENSION]=null,t[g.SortField.SIZE]=null,t[g.SortField.LOCKED_FILES]=null,t[g.SortField.TAGS]=i.default.createElement(w.TagsCell,{file:D,user:j}),t)[p],Z=(r={},r[g.SortField.SHARED_WITH]=void 0,r[g.SortField.CATEGORY]=c.File.getCategoryDescription(D),r[g.SortField.EXTENSION]=c.File.getExtension(D),r[g.SortField.SIZE]=i.default.createElement(T.SizeCellTitle,{file:D}),r[g.SortField.LOCKED_FILES]=void 0,r[g.SortField.TAGS]=void 0,r)[p],$=(n={},n[g.SortField.SHARED_WITH]="sharedWith",n[g.SortField.CATEGORY]="category",n[g.SortField.EXTENSION]="extension",n[g.SortField.SIZE]="size",n[g.SortField.LOCKED_FILES]="locked_files",n[g.SortField.TAGS]="tags",n)[p],ee=(o={},o[g.SortField.SHARED_WITH]="brws-file-shared-with-cell",o[g.SortField.CATEGORY]="brws-file-category-cell",o[g.SortField.EXTENSION]="brws-file-extension-cell",o[g.SortField.SIZE]="brws-file-size-cell",o[g.SortField.LOCKED_FILES]="brws-file-size-cell",o[g.SortField.TAGS]="brws-file-tags-cell",o)[p],te=void 0;if(p===g.SortField.SIZE&&M&&s.isMediaFiltersEnabled(Y)){var re=null===(l=D.media_data)||void 0===l?void 0:l.data.image_width,ne=null===(d=D.media_data)||void 0===d?void 0:d.data.image_height;te=re&&ne?re+"x"+ne+" px":"​"}return i.default.createElement(a.MediaCell,{className:ee,subtitle:te,title:Z,style:X,key:$},J);default:return E.reportException({err:new Error("renderCell function for "+p+"is not implemented"),severity:E.SEVERITY.NONCRITICAL,tags:["js:browse"]}),i.default.createElement(F,null)}},t.prototype.render=function(){var e=this,t=this.props,r=t.file,o=t.fileToId,s=t.instanceId,l=t.isActiveDropTarget,d=t.isSearchMode,u=t.isSelectMode,f=t.isSelected,m=t.itemIndex,g=t.onDeselect,h=t.onSelect,S=t.renameState,E=t.rowIndex,v=t.topOffset,T=t.visibleColumns,w=t.isCutToClipboard,I=t.isFocused,F=t.isRightClickEnabled,C=this.state.isHoverLocked,O="";T.forEach((function(t){var n=e.getAriaLabelForColumn(t,r);n&&(O+=n+", ")}));var R=b.FE_RELOCATION&&this.state.rowIsDragging&&!f,A=n.default({"brws-file-row":!0,"brws-file-row-no-access":c.File.isNoAccessSharedFolder(r)||R,"brws-file-row-hover-forced":C,"brws-file-row-cut":w,"brws-file-row-dragging":R}),y=!(S||d||c.File.isTeamMemberFolder(r)||c.File.isReadOnlySharedFolder(r)||c.File.isNoAccessSharedFolder(r)||!f);return i.default.createElement(p.FilesViewRow,{className:A,isActiveDropTarget:l,isSelected:f,isDeleted:r.isDeleted,isDraggable:y,topOffset:v,rowIndex:E,isSelectMode:u,filename:String(r.fq_path.split("/").slice(-1)),ariaLabel:O,onSelect:this.onSelect,onDeselect:this.onDeselect,onNavigateToItem:this.onNavigateToItem,onDragEnter:this.onDragEnter,onDragStart:this.onDragStart,onDragEnd:this.onDragEnd,isRightClickEnabled:F},(function(t){var r=t.isHovered,n=t.isKeyboardFocused;return r=r||C,i.default.createElement(i.default.Fragment,null,i.default.createElement(a.MediaCell,{key:"checkboxCell",className:"brws-checkbox-cell"},i.default.createElement(_.FileRowCheckbox,{instanceId:s,itemIndex:m,rowIndex:E,isHovered:r,isFocused:!!I,fileToId:o,onSelect:h,onDeselect:g})),T.map((function(t,n){return e.renderCell({isHovered:r&&!R,sortField:t.sortField,renderCell:t.renderCell})})),e.renderMediaActions(r,n))}))},t.defaultProps={topOffset:0,controlsFocusable:!1,fileToId:function(e){return e.fq_path}},t.displayName="FileRow",t})(i.default.Component);t.FileRow=C})),define("modules/clean/react/files_view/rows/cells/modified_cell",["require","exports","tslib","react","dig-components/tooltips","spectrum/media_table/index","modules/core/i18n"],(function(e,t,r,n,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ModifiedCell=void 0,n=r.__importDefault(n),t.ModifiedCell=function(e){var t=e.file,r=e.mediaActions,s=e.filteredContactName,l=e.isSearchMode,c=e.shouldBubbleSubtitle,d=e.width,u=s&&t.agoFromLastActionByUserTs,_=t.is_dir&&!l?void 0:u?t.agoFromLastActionByUserTs:t.ago,p=u?s:t.last_modified_name||void 0,f=p?a.intl.formatMessage({id:"ACVnV9",defaultMessage:"by {modified_by}"},{modified_by:p}):t.is_dir?void 0:a.intl.formatMessage({id:"5794tP",defaultMessage:"by you"}),m=_||n.default.createElement("span",{"aria-hidden":!0},"--"),g=void 0===d?{}:{width:d,minWidth:d,maxWidth:d},h=c&&f?n.default.createElement(o.Tooltip,{title:f},n.default.createElement("span",null,m)):m;return n.default.createElement(i.MediaCell,{className:"brws-file-modified-at-cell",subtitle:c?void 0:f,title:h,style:g},r)},t.ModifiedCell.displayName="ModifiedCell",t.ModifiedCell.displayName="ModifiedCell"})),define("modules/clean/react/files_view/rows/cells/async_folder_size",["require","exports","tslib","react","modules/clean/cloud_docs/constants","modules/clean/react/files_view/util","modules/clean/filepath/filepath"],(function(e,t,r,n,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SizeCellTitle=t.isCloudDocProviderStored=void 0,n=r.__importDefault(n),a=r.__importStar(a);var s=function(){return n.default.createElement("span",{"aria-hidden":!0},"--")};function l(e){switch(i.isFile(e)?a.split_filename(e.fq_path).ext:e.ext.slice(1)){case o.PaperFileTypes.PAPER:case o.PaperFileTypes.PAPER_TEMPLATE:return!0;default:return!1}}t.isCloudDocProviderStored=l;var c=n.default.lazy((function(){return r.__awaiter(void 0,void 0,void 0,(function(){var t;return r.__generator(this,(function(n){switch(n.label){case 0:return t={},[4,new Promise((function(t,r){e(["modules/clean/react/files_view/rows/cells/folder_size"],t,r)})).then(r.__importStar)];case 1:return[2,(t.default=n.sent().FolderSizeCell,t)]}}))}))}));t.SizeCellTitle=function(e){var t=e.file;return t.is_dir?n.default.createElement(n.default.Suspense,{fallback:n.default.createElement(s,null)},n.default.createElement(c,{file:t},n.default.createElement(s,null))):t.is_cloud_doc&&l(t)?n.default.createElement(s,null):n.default.createElement("span",null,t.size)}})),define("modules/clean/react/files_view/rows/cells/tags_cell",["require","exports","tslib","react","modules/clean/react/files_view/util","modules/clean/tagging/logger","modules/clean/tagging/utils","modules/clean/tagging/components/tags_container","modules/clean/tagging/utils"],(function(e,t,r,n,o,i,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TagsCell=void 0,n=r.__importDefault(n),i=r.__importStar(i),a=r.__importStar(a),t.TagsCell=function(e){var t=e.file,r=e.user,c=t.tags&&t.tags.map((function(e){return e.value.tag_text}))||[];if(0===c.length)return null;return n.default.createElement(s.TagsContainer,{tags:l.textTagsToUserGeneratedTags(c),onTagClick:function(e,n){o.isFile(t)&&(n&&(n.preventDefault(),n.stopPropagation()),i.logTagClick(r,[t],"browse_tag_col",e),a.redirectToSearchByTag(r,e.tag_text))},containerClassName:"brws-col-tags-container",chipClassName:"brws-tag-chip",chipSize:"xsmall",showMoreClassName:"brws-tag-chip",expandable:!1})}})),define("modules/clean/react/files_view/rows/cells/file_row_checkbox",["require","exports","tslib","react","classnames","react-redux","dig-components/controls","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/data/selectors/item_selectors","modules/clean/react/files_view/types","modules/clean/react/selectable_list","modules/clean/user_education/react/user_education_effect","modules/core/i18n"],(function(e,t,r,n,o,i,a,s,l,c,d,u,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileRowCheckbox=t.FileRowCheckboxComponent=void 0,n=r.__importDefault(n),o=r.__importDefault(o);t.FileRowCheckboxComponent=function(e){var t=e.isSelected,r=e.isDisabled,i=e.shouldShowUserEducationEffects,s=e.isCheckboxVisible,l=e.onSelect,p=e.onDeselect,f=e.selectionId,m=e.isFocused,g={selectItem:_.intl.formatMessage({id:"MkD8+F",defaultMessage:"Select item"})},h=n.default.useRef(null),S=function(){var e,t;null===(t=null===(e=h.current)||void 0===e?void 0:e.querySelector("input"))||void 0===t||t.focus()};n.default.useEffect((function(){m&&S()}),[m]),n.default.useEffect((function(){t&&m&&S()}),[t,m]);var E=function(e){l&&p&&!r&&(e.stopPropagation(),t?p(f,e.shiftKey,c.FilesViewActionSource.SINGLE_CHECKBOX):l(f,e.shiftKey?d.SelectOptions.EXTEND:d.SelectOptions.DEFAULT,c.FilesViewActionSource.SINGLE_CHECKBOX))},v=null;return s&&(v=n.default.createElement(a.Checkbox,{disabled:r,checked:t,onClick:E,"aria-label":g.selectItem,tabIndex:t?0:-1,readOnly:!0})),i&&(v=n.default.createElement(u.UserEducationEffect,{containerName:"FileItemRow",name:"FirstFileSelectCheckbox",useSpan:!0},v||n.default.createElement("div",{style:{width:20,height:20}}))),n.default.createElement("div",{className:o.default("brws-vertically-center","brws-file-row-checkbox-target",{"brws-file-row-checkbox-background":s}),onClick:E,"aria-controls":"brws-sidebar-view",ref:h},v)},t.FileRowCheckboxComponent.displayName="FileRowCheckboxComponent",t.FileRowCheckboxComponent.displayName="FileRowCheckboxComponent";t.FileRowCheckbox=i.connect((function(e,t){return{isCheckboxDisabled:s.selectDisabledMultiselect(e,t),isCheckboxVisible:l.selectIsCheckboxVisible(e,t),isSelected:l.selectIsItemSelected(e,t),shouldShowUserEducationEffects:l.selectShouldShowUserEducationEffects(e,t),isDisabled:s.selectDisabledMultiselect(e,t),selectionId:l.selectItemSelectionId(e,t)}}))(t.FileRowCheckboxComponent)})),define("modules/clean/react/files_view/rows/file_shared_with_me_row",["require","exports","tslib","classnames","react","react-dom","dig-components/controls","spectrum/media_table/index","spectrum/util/raf_throttle","modules/clean/react/files_view/file_name/file_name_cell","modules/clean/react/files_view/rows/cells/async_folder_size","modules/clean/react/files_view/rows/row","modules/clean/react/files_view/thumbnail_media_cell","modules/clean/react/files_view/types","modules/clean/react/files_view/sort_types","modules/clean/react/files_view/util","modules/clean/react/selectable_list","modules/clean/user_education/react/user_education_effect","modules/core/browser","modules/core/exception","modules/core/i18n","modules/clean/react/flows/types"],(function(e,t,r,n,o,i,a,s,l,c,d,u,_,p,f,m,g,h,S,E,v,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileSharedWithMeRow=void 0,n=r.__importDefault(n),o=r.__importDefault(o),i=r.__importStar(i),S=r.__importStar(S),E=r.__importStar(E);var w=function(){return o.default.createElement("span",{"aria-hidden":!0},"--")},I=function(e){return void 0===e?{}:{width:e,minWidth:e,maxWidth:e}},b=function(e){var t=e.file;return t.is_cloud_doc&&d.isCloudDocProviderStored(t)?o.default.createElement(w,null):o.default.createElement("span",null,t.size)},F=(function(e){function t(t){var r=e.call(this,t)||this;return r.setRef=function(e){r.brwsFilenameContainerDiv=e},r.checkboxRef=null,r.handleWindowResize=function(){r.throttledWindowResize.request()},r.handleResize=function(){if(r.brwsFilenameContainerDiv){var e=r.state.brwsFilenameContainerDivWidth,t=r.brwsFilenameContainerDiv.getBoundingClientRect().width;t&&t!==e&&r.setState({brwsFilenameContainerDivWidth:t})}},r.handleTitleClick=function(e){return r.handleOpenNewTabOrNavigate(e,p.FilesViewActionSource.ROW_TITLE)},r.handleOpenNewTabOrNavigate=function(e,t){0===e.button&&(e.preventDefault(),e.stopPropagation(),r.onNavigateToItem({openInNewTab:m.hasModifierKey(e),actionSource:t}))},r.onSelect=function(e,t){r.props.onSelect&&r.props.onSelect(r.props.file.file_id,e,t)},r.onDeselect=function(e,t){r.props.onDeselect&&r.props.onDeselect(r.props.file.file_id,e,t)},r.onNavigateToItem=function(e){var t=e.openInNewTab,n=e.actionSource;t?S.open_tab(r.props.file.href):r.props.onOpenFileSharedWithMe(r.props.file,{actionSource:n})},r.getCheckboxNode=function(){return r.checkboxRef&&i.findDOMNode(r.checkboxRef)},r.isCheckboxNode=function(e){var t=r.getCheckboxNode();return!!t&&t.contains(e)},r.handleCheckboxChange=function(e){},r.handleCheckboxClick=function(e){e.stopPropagation();var t=r.props,n=t.onSelect,o=t.onDeselect,i=t.file;n&&o&&(e.currentTarget.checked?n(i.file_id,e.shiftKey?g.SelectOptions.EXTEND:g.SelectOptions.DEFAULT,p.FilesViewActionSource.SINGLE_CHECKBOX):o(i.file_id,e.shiftKey,p.FilesViewActionSource.SINGLE_CHECKBOX))},r.setCheckboxRef=function(e){r.checkboxRef=e},r.handleCheckboxTouchTargetClick=function(e){if(r.shouldHandleClick(e)){if(!r.props.isCheckboxDisabled&&r.props.onDeselect&&r.props.onSelect){e.preventDefault();var t=r.props.file.file_id;r.props.isSelected?r.props.onDeselect(t,e.shiftKey,p.FilesViewActionSource.SINGLE_CHECKBOX):r.props.onSelect(t,e.shiftKey?g.SelectOptions.EXTEND:g.SelectOptions.DEFAULT,p.FilesViewActionSource.SINGLE_CHECKBOX)}}else e.preventDefault()},r.renderCheckbox=function(e){var t=r.props,i=t.isCompactMode,s=t.isSelectMode,l=t.isSelected,c=t.showUserEducationEffects,d=null;return d=!(e||l||s||i)?null:o.default.createElement(a.Checkbox,{disabled:r.props.isCheckboxDisabled,checked:!!l,className:n.default("brws-checkbox",{"brws-checkbox-checked":l}),onChange:r.handleCheckboxChange,onClick:r.handleCheckboxClick,ref:r.setCheckboxRef,"aria-label":v.intl.formatMessage({id:"sJRsRx",defaultMessage:"Select item"}),tabIndex:l?0:-1}),c&&(d=o.default.createElement(h.UserEducationEffect,{containerName:"FileSharedWithMeRow",name:"FirstFileSelectCheckbox",useSpan:!0},d||o.default.createElement("div",{style:{width:20,height:20}}))),d},r.state={brwsFilenameContainerDivWidth:void 0},r.throttledWindowResize=new l.RafThrottle((function(){return r.handleResize()})),r}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.handleResize(),window.addEventListener("resize",this.handleWindowResize)},t.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.handleWindowResize)},t.prototype.componentDidUpdate=function(e){var t=this;(this.props.isFocused&&!e.isFocused||this.props.isFocused&&this.props.isSelected&&!e.isSelected)&&this.checkboxRef&&Promise.resolve().then((function(){var e=t.getCheckboxNode();e&&e.focus()}))},t.prototype.renderModifiedCell=function(e,t,r,n){var i=r&&e.agoFromLastActionByUserTs,a=i?e.agoFromLastActionByUserTs:e.ago,l=i?r:e.last_modified_name||void 0,c=l?v.intl.formatMessage({id:"ACVnV9",defaultMessage:"by {modified_by}"},{modified_by:l}):v.intl.formatMessage({id:"5794tP",defaultMessage:"by you"});return o.default.createElement(s.MediaCell,{className:"brws-file-modified-at-cell",key:"modifiedAt",subtitle:c,title:a||o.default.createElement(w,null),style:I(n)},t)},t.prototype.renderCell=function(e){var t=e.isHovered,i=(e.isKeyboardFocused,e.sortField),a=(e.isLastCell,this.props),l=a.arePostTTIModulesLoaded,d=a.file,u=a.isSelectMode,p=a.isSelected,m=a.responsive,g=a.user,h=a.showSnippets,S=a.snippetRows,v=a.height,F=a.filteredContactName,C=a.iconSize,O=a.columnSizes,R=null==O?void 0:O[i];switch(i){case f.SortField.FILENAME:var A={file:d,isHovered:t,isSelectMode:!!u,isSelected:!!p,isMobileMode:!m.isMatchedLarge&&!m.isMatchedMedium,user:g,mediaActions:void 0,flowsBadge:T.FlowsRuleType.None,shouldTruncateMiddleFilename:l,showHighlights:!0,showLocation:!0,showStar:!1,showSnippets:!!h,snippetRows:S,onNameClick:this.handleTitleClick,renameState:void 0,renderFilenameSubtitleAsLink:!1,showUserEducationEffects:!1,userEducationEffectName:"",isTooltipEnabled:!1,showFirstTaskSubtitle:!1,shouldShowSubtitle:!0,draggable:!1,expFlowsAutomatedFolderUI:!1,backupNewLocationHintEnabled:!1},y=this.state.brwsFilenameContainerDivWidth;return o.default.createElement("div",{className:n.default("brws-file-name-container",{"brws-file-name-container-resizing-enabled":void 0!==R}),ref:this.setRef},o.default.createElement(_.ThumbnailMediaCell,{file:d,height:v,iconSize:C,width:R},o.default.createElement(c.FileNameCellComponent,r.__assign({},A,{fileNameCellWidth:y?y-64:void 0}))));case f.SortField.RELEVANCE:case f.SortField.MODIFIED:return this.renderModifiedCell(d,void 0,F,R);case f.SortField.SIZE:return o.default.createElement(s.MediaCell,{className:"brws-file-size-cell",key:"size",title:o.default.createElement(b,{file:d}),style:I(R)},void 0);default:case f.SortField.CATEGORY:case f.SortField.EXTENSION:case f.SortField.SHARED_WITH:case f.SortField.TAGS:return E.reportException({err:new Error("FileSharedWithMe.renderCell is not implemented for "+i),severity:E.SEVERITY.NONCRITICAL,tags:["js:search"]}),o.default.createElement(s.MediaCell,{key:i,title:o.default.createElement(w,null),style:I(R)})}},t.prototype.shouldHandleClick=function(e){return!e.defaultPrevented&&!this.isCheckboxNode(e.target)},t.prototype.render=function(){var e=this,t=this.props,n=t.rowIndex,i=t.topOffset,a=t.isSelected,l=t.isSelectMode,c=t.visibleColumns;return o.default.createElement(u.FilesViewRow,{className:"brws-filesharedwithme-row",isSelected:a,topOffset:i,rowIndex:n,isSelectMode:l,onSelect:this.onSelect,onDeselect:this.onDeselect,onNavigateToItem:this.onNavigateToItem},(function(t){var n=t.isHovered,i=t.isKeyboardFocused;return r.__spreadArrays([o.default.createElement(s.MediaCell,{key:"checkboxCell",className:"brws-checkbox-cell"},o.default.createElement("div",{className:"brws-vertically-center brws-file-row-checkbox-target",onClick:e.handleCheckboxTouchTargetClick},e.renderCheckbox(n)))],c.map((function(t,r){return e.renderCell({isHovered:n,isKeyboardFocused:i,sortField:t.sortField,isLastCell:r===c.length-1})})))}))},t.displayName="FileSharedWithMeRow",t})(o.default.PureComponent);t.FileSharedWithMeRow=F})),define("modules/clean/react/files_view/file_snippets",["require","exports","tslib","react","modules/clean/filename_highlights","modules/clean/react/files_view/constants","modules/clean/react/files_view/data/selectors/list_selectors"],(function(e,t,r,n,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileSnippet=t.FileSnippets=void 0,n=r.__importDefault(n),o=r.__importStar(o);var s=(function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(o,e),o.prototype.render=function(){var e=this.props,r=e.snippets,o=e.lineClamp,s={maxHeight:i.SNIPPET_HEIGHT_PER_ROW*o,WebkitLineClamp:o},l=a.getFirstValidSnippet(r);return l?n.default.createElement("span",{className:"brws-file-snippets",style:s},n.default.createElement(t.FileSnippet,{snippet:l})):null},o.defaultProps={lineClamp:3},o.displayName="FileSnippets",o})(n.default.PureComponent);t.FileSnippets=s,t.FileSnippet=function(e){var t=e.snippet;return o.highlightReactFromAllHighlightSpans(t.highlight_spans||[])},t.FileSnippet.displayName="FileSnippet"})),define("modules/clean/react/files_view/files_view",["require","exports","tslib","classnames","lodash","immutable","react","react-dom","react-redux","spectrum/media_table_skeleton/index","spectrum/table/index","modules/clean/react/browse/action_logger","modules/clean/react/browse/models","modules/clean/react/files_view/column_manager","modules/clean/react/files_view/constants","modules/clean/react/files_view/data/action_creators","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/column_headers/dig_column_header","modules/clean/react/files_view/drag_drop/drag_and_drop","modules/clean/react/files_view/drag_drop/internal_drag_status","modules/clean/react/files_view/file_list_empty_folder_table","modules/clean/react/files_view/files_view_logging","modules/clean/react/files_view/list","modules/clean/react/files_view/scroll_updater","modules/clean/react/files_view/tile_grid","modules/clean/react/files_view/types","modules/clean/react/files_view/view_type","modules/clean/react/selectable_list","modules/clean/sharing/access_level","modules/clean/web_user_action_events","modules/core/browser_detection","modules/core/i18n","modules/core/notify","modules/clean/react/files_view/drag_drop/drag_to_select","modules/clean/react/files_view/data/selectors/files_view_selectors","modules/clean/react/files_view/unity_listener","modules/constants/folder_explorer","modules/clean/filepath/filepath"],(function(e,t,r,n,o,i,a,s,l,c,d,u,_,p,f,m,g,h,S,E,v,T,w,I,b,F,C,O,R,A,y,D,L,M,N,P,U,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FilesView=t.FilesViewComponent=t.getShouldShowSelectAllCheckbox=void 0,n=r.__importDefault(n),o=r.__importStar(o),i=r.__importStar(i),a=r.__importDefault(a),s=r.__importStar(s),x=r.__importStar(x);var k=a.default.lazy((function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t,r){e(["typescript/component_libraries/files_components/src/file-drag/index"],t,r)})).then(r.__importStar)];case 1:return[2,{default:t.sent().InternalFileDrag}]}}))}))})),V=[R.NameSpaceAccess.ACCESS_NO_ACCESS,R.NameSpaceAccess.ACCESS_READER,R.NameSpaceAccess.ACCESS_READER_NO_COMMENT],W={keyboard:F.FilesViewActionSource.KEYBOARD,drag_to_select:F.FilesViewActionSource.DRAG_TO_SELECT},H=[];function B(e){return e.some(G)}function G(e){return e instanceof _.File||e instanceof _.FileSharedWithMe}t.getShouldShowSelectAllCheckbox=B;var q=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.internalDragStatusRef=a.default.createRef(),t.state={dropTarget:null,tilesPerRow:1,draggedFiles:null},t.handleCopyToClipboard=function(){var e=t.props,r=e.selectedFiles,n=e.onSetClipboard;r.size&&n({files:r.toArray(),action:"copy"})},t.handleCutToClipboard=function(){var e=t.props,r=e.selectedFiles,n=e.onSetClipboard,o=r.filter((function(e){return!e.read_only}));o.size&&n({files:o.toArray(),action:"cut"})},t.handleNewFolderSubmit=function(e){""===e?(t.props.onNewFolderCancel(),t.handleNewFolderCancel({source:F.NameInputActionSource.SUBMIT})):t.props.onNewFolderSubmit(e)},t.handleNewFolderCancel=function(e){e.source!==F.NameInputActionSource.ESC&&L.Notify.error(D.intl.formatMessage({id:"9xXIAi",defaultMessage:"Please provide a name for the new folder."})),t.props.onNewFolderCancel()},t.handleSetFileUploaderPath=function(e){var r=e?e.path:t.props.path,n=t.props.context.isCurrentPathWriteable();e&&e.hasOwnProperty("hasPermissionToUploadToFolder")&&(n=!!e.hasPermissionToUploadToFolder);var o=!!(null==e?void 0:e.isMovingIntoVault);t.props.setFileUploaderPath({path:r,hasPermissionToUploadToFolder:n,isMovingIntoVault:o,targetSurface:"files_view"})},t.handleDragStart=function(e,n){var i;void 0===n&&(n=[]);var a=t.props,l=a.path,c=a.selectedFiles,d=a.user,u=a.preventSelectionOnDrag,p=o.keyBy(n,"fq_path");0!==n.length&&u||(p=r.__assign(r.__assign({},p),c.toJS()));var f=o.values(p);if(f.some((function(e){return _.File.isTeamSharedFolder(e)})))L.Notify.error(D.intl.formatMessage({id:"1cIg3V",defaultMessage:"Team folders can’t be moved."}));else if(f.some((function(e){return _.File.isTeamMemberFolder(e)})))L.Notify.error(D.intl.formatMessage({id:"ZxTpZJ",defaultMessage:"Your member folder can’t be moved."}));else{var m=e.dataTransfer;if(m){if(t.setState({draggedFiles:f}),m.setDragImage&&(null===(i=t.internalDragStatusRef)||void 0===i?void 0:i.current)){var g=s.findDOMNode(t.internalDragStatusRef.current);g&&m.setDragImage(g,-10,-10)}var h={userId:d.id,fromPath:l,fileInfos:f.map((function(e){return{target_ns:e.target_ns,file_id:e.file_id,is_dir:e.is_dir,fq_path:e.fq_path}}))};m.setData(y.INTERNAL_FILE_DATA_TRANSFER_TYPE,JSON.stringify(h)),m.effectAllowed="copyMove",t.props.onDragStart&&t.props.onDragStart(e,f)}}},t.handleDragEnter=function(e,r,n,o){var i=t.state.draggedFiles,a=null==i?void 0:i.some((function(e){return e.fq_path===r.fq_path}));S.onFileDragEnterItem(r,!!t.props.isDraggingExternalFiles,!!t.props.isDraggingInternalFiles,!!a,o,t.props.context,t.handleSetDropTarget,t.handleSetFileUploaderPath)},t.handleDragEnd=function(e){t.setState({draggedFiles:null}),t.props.onDragEnd&&t.props.onDragEnd(e)},t.handleSetDropTarget=function(e){t.setState({dropTarget:e}),t.props.updateDropTarget&&t.props.updateDropTarget(e)},t.handleSelectionChange=function(e,r){var n=r?r in O.SelectableListActionSource?W[r]:r:void 0;t.props.onSelectionChange(e,n)},t.onAllCheckboxDeselectAll=function(){var e=t.props,r=e.selection;(0,e.onSelectionChange)(r.set("selected",i.OrderedSet()),F.FilesViewActionSource.ALL_CHECKBOX)},t.onAllCheckboxSelectAll=function(){var e=t.props,r=e.items,n=e.selection;(0,e.onSelectionChange)(n.set("selected",i.OrderedSet(r.filter(G).map((function(e){return"fq_path"in e?t.props.fileToId(e):e.file_id})))),F.FilesViewActionSource.ALL_CHECKBOX)},t._handleGetOverflowMenuActions=function(e,r){var n=t.props;return(0,n.getOverflowMenuActions)(e,r,n.responsive)},t.handleTTI=function(){t.props.onComponentTTI("FilesViewController")},t.getIsCurrentPathWriteable=function(){return t.props.context.isCurrentPathWriteable()},t.onTilesPerRowChange=function(e){t.setState({tilesPerRow:e})},t.onDeselectAll=function(){t.props.isSearchMode&&t.props.onFocusSearchBar()},t.logRightClick=function(e){var r=t.props,n=r.selectedFiles,o=r.user,i=r.viewType,a=n?n.count((function(e){return e.is_dir})):0,s=n?n.count()-a:0;u.logRightClickItems({uid:o.id,viewType:i,action_surface:A.ActionSurfaceLogValue.CENTER_PANE,numFilesSelected:s,numFoldersSelected:a})},t.InternalFileDragHelper=function(){var e=t.state.draggedFiles||H,r=e.length,n="",o=!1,i="";return r>0&&(n=x.filename(e[0].fq_path),o=e[0].is_dir,i=e[0].icon),a.default.createElement(a.default.Suspense,{fallback:null},a.default.createElement(k,{ref:t.internalDragStatusRef,numberOfFiles:r,firstFileName:n,isFolder:o,icon:i}))},t}return r.__extends(t,e),t.prototype.shouldComponentUpdate=function(e){return e.loadingState!==this.props.loadingState||e.loadingState!==F.LoadingState.LOADING_FIRST_PAGE||(n=e.context,o=this.props.context,!!(n&&o&&n.currentFQPath!==o.currentFQPath||(t=e.items,r=this.props.items,t!==r)));var t,r,n,o},t.prototype.renderEmptyFolderView=function(){var e=this.props,t=e.context,r=e.customEmptyFolderView,n=e.onFocusSearchBar,o=e.onPasteFromClipboard,i=e.onNavigateToParentFolder,s=e.isDraggingExternalFiles,l=e.isColumnResizingEnabled,c=e.scrollContainerWidth;if(r){var d=r({isDraggingExternalFiles:!!s,handleTTI:this.handleTTI,isColumnResizingEnabled:l,width:c});if(d)return d}var u=t.isInsideSharedFolder,_=t.currentSharedFolderPermissionRole,p=u&&V.includes(_)?void 0:D.intl.formatMessage({id:"jXqkXG",defaultMessage:"Drag and drop files onto this window to upload."});return a.default.createElement(v.EmptyFolderTable,{title:D.intl.formatMessage({id:"YLBqRL",defaultMessage:"This folder is empty"}),subtitle:p,onTTI:this.handleTTI,onFocusSearchBar:n,onPasteFromClipboard:o,onNavigateToParentFolder:i,onOpenKeyboardShortcutModal:this.props.openKeyboardShortcutsModal})},t.prototype.getSelectAllCheckboxCheckedVariant=function(){var e=this.props,t=e.selectedFiles,r=e.items,n="unchecked";return t.size===r.filter(G).size?n="checked":t.size&&(n="mixed"),n},t.prototype.isCreateFolderUIActive=function(){var e=this.props.createNewFolderState;return e&&"CREATE_FOLDER_INACTIVE"!==e},t.prototype.shouldShowEmptyFolderView=function(){return this.props.loadingState===F.LoadingState.LOADED&&!this.props.items.size&&!this.isCreateFolderUIActive()},t.prototype.render=function(){var e=this,t=this.props,o=t.id,i=t.onDelete,s=t.onShowRename,l=t.onRenameSubmit,u=t.onRenameCancel,_=t.onSwitchViewType,m=t.onPasteFromClipboard,g=t.onColumnsChanged,S=t.onCanDisplayFolderSizesChanged,v=t.onFocusSearchBar,R=t.currentSort,y=t.createNewFolderState,D=t.context,L=t.columns,N=t.dropTargetHighlightMode,x=t.fileRename,k=t.getIsFileJumping,V=t.onAddFileJumpKeyCode,W=t.onResetFileJump,G=t.hideViewFileButton,q=t.items,z=t.itemIds,j=t.isCompactMode,K=t.isSearchMode,Y=t.isDraggingExternalFiles,Q=t.isDraggingInternalFiles,X=t.isQueryingFolderSizes,J=t.isFileViewerShown,Z=t.loadingState,$=t.onSortChange,ee=t.path,te=t.responsive,re=t.selectedFiles,ne=t.selection,oe=t.renderSharedWithController,ie=t.onShowShare,ae=t.onPresentInZoom,se=t.totalNumFiles,le=t.user,ce=t.viewType,de=t.viewTypeColumns,ue=t.onLocationLinkClick,_e=t.onNavigateToFileOrFolder,pe=t.onNavigateToParentFolder,fe=t.onOpenFileSharedWithMe,me=t.onOpenPaper,ge=t.arePostTTIModulesLoaded,he=t.scrollContainer,Se=t.sharingServiceInfo,Ee=t.stickyOffsetTop,ve=t.disabledMultiselect,Te=t.isStickyColumnHeader,we=t.onRangeInView,Ie=t.highDensity,be=t.filteredContactName,Fe=t.sections,Ce=t.preferredColumns,Oe=t.isDragToSelectEnabled,Re=t.cutItems,Ae=t.numVisibleColumns,ye=t.isListView,De=t.isActive,Le=t.enableUnity,Me=t.inlineActionBar,Ne=t.scrollContainerWidth,Pe=t.columnResizeStorageSetting,Ue=t.isColumnResizingEnabled,xe=t.expManualTagging,ke=t.useSkinnyCheckboxes,Ve=t.mediaFiltersVariant,We=t.isRightClickEnabled,He=te.isMatchedLarge,Be=te.isMatchedMedium,Ge=this.state,qe=Ge.dropTarget,ze=Ge.tilesPerRow;if(Z===F.LoadingState.LOADING_FIRST_PAGE)return ge?a.default.createElement(c.MediaTableSkeleton,{numRows:15}):null;var je=!!re.size,Ke=!!Ue;if(this.shouldShowEmptyFolderView())return a.default.createElement("div",{className:"brws-files-view"},this.renderEmptyFolderView(),Le&&a.default.createElement(P.UnityListener,{items:this.props.unityItems,userId:le.id}));var Ye=He?f.DEFAULT_COLUMN_HEADER_HEIGHT:f.COMPACT_COLUMN_HEADER_HEIGHT,Qe=Ye+Ee,Xe=this.props.scrollPositionOffset||0;return a.default.createElement("div",{className:n.default("brws-files-view","brws-files-view--"+ce.toLowerCase(),{"brws-files-view-condensed-list":ce===C.ViewType.CondensedList}),onContextMenu:this.logRightClick},a.default.createElement(p.ColumnManager,{columns:L,viewTypeColumns:de,currentSort:R,onCanDisplayFolderSizesChanged:S,onColumnsChanged:g,isMatchedLarge:He,isMatchedMedium:Be,isSearchMode:K,viewType:ce,responsiveContainer:K,preferredColumns:Ce,isMoreColumnsEnabled:Ke,numVisibleColumns:Ae,scrollContainerWidth:Ne,columnResizeStorageSetting:Pe},(function(t){var c=t.visibleColumns,p=t.handleSelection,g=t.canDisplayFolderSizes,S=t.containerWidth,E=t.handleReorder,I=(K?f.LIST_VIEW_SEARCH_MODE_COLUMN_FLEX:f.LIST_VIEW_COLUMN_FLEX)[c.length];ke&&I&&(I[0]=f.CHECKBOX_CELL_FLEX_RIGHT_RAIL);var F={columnFlex:I,currentSort:R,isCompactMode:j,isSelectMode:je,onDeselectAll:e.onAllCheckboxDeselectAll,onSelectAll:e.onAllCheckboxSelectAll,onSelection:function(e,t,r){var n,o;e.popoverTriggerLabel!==t.popoverTriggerLabel&&T.logEvent({user:le,action:A.WebUserActionLogEvent.SWITCH_COLUMN_TYPE,extra:{column_position:(r+1).toString(),selected_column_header:null!==(n=e.loggingLabel)&&void 0!==n?n:e.popoverTriggerLabel,open_from_column_header:null!==(o=e.loggingLabel)&&void 0!==o?o:t.popoverTriggerLabel,action_type:c.includes(e)?"deselected":"selected"}}),p(e,t)},onSort:$,onMenuOpen:function(e,t){T.logEvent({user:le,action:A.WebUserActionLogEvent.SELECT_COLUMN_MENU,extra:{column_position:(e+1).toString(),column_header:t}})},onReorder:E,onSwitchViewType:_,selectAllCheckboxState:e.getSelectAllCheckboxCheckedVariant(),showSelectAllCheckbox:B(e.props.items),stickyOffsetHeight:Ye,stickyOffsetTop:Ee,columns:L,visibleColumns:c,viewType:ce,isSearchMode:K,presentationOnly:ye,isMoreColumnsEnabled:ye&&Ke,items:q};return ye?a.default.createElement(O.SelectableList,{itemIds:z,keyScope:O.SELECTABLE_LIST_KEY_SCOPE,onSelectionChange:e.handleSelectionChange,selection:ne,tilesPerRow:ze,onDeselectAll:e.onDeselectAll,isActive:De},(function(t){var _=t.focusedFileId,p=t.handleDeselect,f=t.handleFocusFile,E=t.handleSelect,T=t.isSelectableListEvent,b=t.updateSelection;return a.default.createElement(M.DragToSelectController,{handleSelect:E,handleDeselect:p,updateSelection:b,selection:ne,isDragToSelectEnabled:Oe},(function(t){var b=t.registerSelectableItem;return a.default.createElement(d.Table,{"aria-rowcount":se,className:n.default("brws-files-view-list",{"brws-files-view-list-high-density":Ie}),columnFlex:I},a.default.createElement(h.ColumnHeader,r.__assign({},F,{variant:he?"sticky-native":Te?"sticky":"fixed"})),a.default.createElement(w.FilesViewList,{onTTI:e.handleTTI,registerListItem:b,instanceId:o,onDelete:i,onShowRename:s,activeDropTarget:qe,context:D,createNewFolderState:y,dropTargetHighlightMode:N,fileRename:x,focusedFileIndex:_?z.indexOf(_):void 0,getOverflowMenuActions:e._handleGetOverflowMenuActions,getIsCurrentPathWriteable:e.getIsCurrentPathWriteable,getIsFileJumping:k,onAddFileJumpKeyCode:V,onResetFileJump:W,isCompactMode:j,hideViewFileButton:!!G,isDraggingExternalFiles:Y,isDraggingInternalFiles:Q,isFileViewerShown:J,isSearchMode:K,isSelectMode:je,isSelectableListEvent:T,arePostTTIModulesLoaded:ge,keyScope:O.SELECTABLE_LIST_KEY_SCOPE,onCopyToClipboard:e.handleCopyToClipboard,onCutToClipboard:e.handleCutToClipboard,onDragStart:e.handleDragStart,onDragEnter:e.handleDragEnter,onDragEnd:e.handleDragEnd,onDeselectFile:p,onFocusFile:f,onFocusSearchBar:v,onOpenKeyboardShortcutModal:e.props.openKeyboardShortcutsModal,onLocationLinkClick:ue,onNavigateToFileOrFolder:_e,onNavigateToParentFolder:pe,onNewFolderCancel:e.handleNewFolderCancel,onNewFolderSubmit:e.handleNewFolderSubmit,onOpenFileSharedWithMe:fe,onOpenPaper:me,onPasteFromClipboard:m,onRenameCancel:u,onRenameSubmit:l,onSelectFile:E,onSetDropTarget:e.handleSetDropTarget,onSetFileUploaderPath:e.handleSetFileUploaderPath,responsive:te,scrollPositionOffset:Xe,selectedFiles:re,selection:ne,renderSharedWithController:oe,hrefForFile:e.props.hrefForFile,onShowShare:ie,onPresentInZoom:ae,user:le,viewportTopOffset:Qe,visibleColumns:c,canDisplayFolderSizes:g,scrollContainer:he,shareButtonLabel:e.props.shareButtonLabel,sharingServiceInfo:Se,showShareButton:e.props.showShareButton,starredState:e.props.starredState,onRangeInView:we,containerWidth:S,highDensity:Ie,filteredContactName:be,fileToId:e.props.fileToId,eligibleForFirstTaskSubtitle:e.props.eligibleForFirstTaskSubtitle,expVaultEnableViewOnlySharing:e.props.expVaultEnableViewOnlySharing,isFirstTaskEmptyState:e.props.isFirstTaskEmptyState,expAutoPDFConversionBackend:e.props.expAutoPDFConversionBackend,expFlowsAutoUnzipLambda:e.props.expFlowsAutoUnzipLambda,expManualTagging:xe,preventSelectionOnDrag:e.props.preventSelectionOnDrag,mediaFiltersVariant:Ve,isRightClickEnabled:We}))}))})):a.default.createElement(O.SelectableList,{itemIds:z,keyScope:O.SELECTABLE_TILE_GRID_KEY_SCOPE,onSelectionChange:e.handleSelectionChange,selection:ne,tilesPerRow:ze,sectionStartIndices:Fe.sectionStartIndices,isActive:De},(function(t){var n=t.handleDeselect,o=t.handleDeselectAll,c=t.handleFocusFile,_=t.handleSelect,p=t.handleSelectAll,g=t.updateSelection,S=t.focusedFileId;return a.default.createElement(M.DragToSelectController,{handleSelect:_,handleDeselect:n,updateSelection:g,selection:ne,isDragToSelectEnabled:Oe},(function(t){var g=t.registerSelectableItem;return a.default.createElement(a.default.Fragment,null,a.default.createElement(d.Table,{columnFlex:ke?f.GRID_VIEW_COLUMN_FLEX_RIGHT_RAIL:f.GRID_VIEW_COLUMN_FLEX,role:"presentation",style:he?{position:"sticky",top:Ee,zIndex:1}:void 0},a.default.createElement(h.ColumnHeader,r.__assign({},F,{variant:he?"default":Te?"sticky":"fixed",disableResizing:!0}))),a.default.createElement(b.FilesViewTileGrid,{onDelete:i,disabledMultiselect:ve||!1,onShowRename:s,activeDropTarget:qe,arePostTTIModulesLoaded:ge,createNewFolderState:y,context:D,deselectAll:o,dropTargetHighlightMode:N,fileRename:x,getOverflowMenuActions:e._handleGetOverflowMenuActions,getIsCurrentPathWriteable:e.getIsCurrentPathWriteable,getIsFileJumping:k,onAddFileJumpKeyCode:V,onResetFileJump:W,onTTI:e.handleTTI,items:q,isCreateFolderUIActive:e.isCreateFolderUIActive(),isDraggingExternalFiles:Y,isDraggingInternalFiles:Q,isQueryingFolderSizes:X,isSearchMode:K,onCopyToClipboard:e.handleCopyToClipboard,onCutToClipboard:e.handleCutToClipboard,onDeselectFile:n,onDragEnter:e.handleDragEnter,onDragStart:e.handleDragStart,onDragEnd:e.handleDragEnd,onFocusFile:c,onFocusSearchBar:v,onNewFolderCancel:e.handleNewFolderCancel,onNewFolderSubmit:e.handleNewFolderSubmit,onNavigateToFileOrFolder:_e,onOpenFileSharedWithMe:fe,onOpenPaper:me,onOpenKeyboardShortcutModal:e.props.openKeyboardShortcutsModal,onPasteFromClipboard:m,onRangeInView:we,onRenameCancel:u,onRenameSubmit:l,onSelectFile:_,onSetDropTarget:e.handleSetDropTarget,onSortChange:$,onTilesPerRowChange:e.onTilesPerRowChange,path:ee,sections:Fe,selectAll:p,selectedFiles:re,selection:ne,onSetFileUploaderPath:e.handleSetFileUploaderPath,tilesPerRow:ze,totalNumItems:se,user:le,viewportTopOffset:Qe,viewType:ce,starredState:e.props.starredState,hrefForFile:e.props.hrefForFile,focusedFileIndex:S?z.indexOf(S):void 0,scrollContainer:he,scrollPositionOffset:Xe,registerSelectableTile:g,cutItems:Re,isActive:De,inlineActions:Me,preventSelectionOnDrag:e.props.preventSelectionOnDrag}))}))}))})),a.default.createElement(I.ScrollUpdater,{scrollContainer:he,path:ee}),U.FE_RELOCATION?this.InternalFileDragHelper():a.default.createElement(E.InternalDragStatus,{className:"offscreen-drag-icon",files:this.state.draggedFiles||H,ref:this.internalDragStatusRef}),Le&&a.default.createElement(P.UnityListener,{items:this.props.unityItems,userId:le.id}))},t.defaultProps={fileToId:function(e){return e.fq_path}},t.displayName="FilesViewComponent",t})(a.default.Component);t.FilesViewComponent=q;t.FilesView=l.connect((function(e,t){var n=t.id;return r.__assign(r.__assign({},g.selectInstance(e,{instanceId:n})),{itemIds:g.selectItemIds(e,{instanceId:n}),sections:g.selectSections(e,{instanceId:n}),responsive:g.selectResponsive(e,{instanceId:n}),isCompactMode:g.selectIsCompactMode(e,{instanceId:n}),viewType:g.selectViewType(e,{instanceId:n}),preferredColumns:g.selectPreferredColumns(e,{instanceId:n}),cutItems:g.selectCutItems(e,{instanceId:n}),numVisibleColumns:g.selectNumVisibleColumns(e,{instanceId:n}),isListView:g.selectIsListView(e,{instanceId:n}),isActive:N.isActiveFilesView(e,n),unityItems:g.selectItemsForUnityListener(e,{instanceId:n})})}),(function(e,t){var r=t.id;return{openKeyboardShortcutsModal:function(){return e(m.openKeyboardShortcutsModal({instanceId:r}))}}}))(q)})),define("modules/clean/react/files_view/files_view_logging",["require","exports","tslib","modules/clean/react/browse/logger_util"],(function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logEvent=t.logEventWithNumberOfFiles=void 0,t.logEventWithNumberOfFiles=function(t){var o=t.isSearchMode,i=t.file,a=t.extra,s=t.action,l=t.action_source,c=t.action_surface,d=t.user;if(o){var u=new Promise((function(t,r){e(["modules/clean/search/single_page/logger"],t,r)})).then(r.__importStar),_=new Promise((function(t,r){e(["modules/clean/search/single_page/data/selectors/index"],t,r)})).then(r.__importStar),p=new Promise((function(t,r){e(["modules/clean/search/single_page/data/store"],t,r)})).then(r.__importStar);Promise.all([u,_,p]).then((function(e){var t=e[0],o=e[1],d=e[2].getStoreForSearch().getState(),u=o.selectedFiles(d),_=n.countFilesAndFolders(u),p=_.num_files_selected,f=_.num_folders_selected,m=r.__assign(r.__assign({},a),{num_files_selected:p.toString(),num_folders_selected:f.toString()});t.logResultAction(s,o.resultsList(d),i,c,l,m)}))}else{var f=new Promise((function(t,r){e(["modules/clean/react/browse/action_logger"],t,r)})).then(r.__importStar),m=new Promise((function(t,r){e(["modules/clean/react/browse/data/store"],t,r)})).then(r.__importStar),g=new Promise((function(t,r){e(["modules/clean/react/browse/data/selectors"],t,r)})).then(r.__importStar);Promise.all([f,m,g]).then((function(e){var t=e[0].logBrowseAction,r=e[1].getStoreForBrowse,o=e[2].selectedFiles(r().getState()),u=n.countFilesAndFolders(o),_=u.num_files_selected,p=u.num_folders_selected;t({uid:d.id,action:s,result:i,num_files_selected:_,num_folders_selected:p,action_surface:c,action_source:l,extra:a})}))}},t.logEvent=function(t){var n=t.user,o=t.action,i=t.extra;return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t,r){e(["modules/clean/react/browse/action_logger"],t,r)})).then(r.__importStar)];case 1:return t.sent().logWebUserAction({user_id:n.id,event_name:o,extra:i}),[2]}}))}))}})),define("modules/clean/react/files_view/fixed_table_head",["require","exports","tslib","spectrum/vertically_fixed/index","spectrum/table/index","react"],(function(e,t,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FixedTableHead=void 0,i=r.__importDefault(i),t.FixedTableHead=function(e){var t=e.children,a=e.offsetHeight,s=e.style,l=void 0===s?{}:s,c=r.__rest(e,["children","offsetHeight","style"]),d=void 0===a?l:r.__assign({flexBasis:a},l);return i.default.createElement("thead",r.__assign({className:"mc-table-head mc-table-head-fixed brws-column-header",style:d},c),i.default.createElement(n.VerticallyFixed,{tag:function(e){var n=e.style;return i.default.createElement(o.TableRow,{className:"mc-table-head-row mc-table-head-row-fixed",style:r.__assign({height:a},n),role:"presentation"},t)}}))}})),define("modules/clean/react/files_view/drag_drop/internal_drag_status",["require","exports","tslib","classnames","react","react-dom","dig-components/badges","modules/clean/react/icon/file_folder_icon"],(function(e,t,r,n,o,i,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InternalDragStatus=void 0,n=r.__importDefault(n),o=r.__importDefault(o),i=r.__importStar(i),t.InternalDragStatus=o.default.forwardRef((function(e,t){var r=e.className,l=e.files,c=n.default("active",r);return i.createPortal(o.default.createElement("div",{id:"drag-status",ref:t,className:c,"aria-hidden":"true"},o.default.createElement("div",{id:"drag-selection-status"},l.slice(0,4).map((function(e,t){return e.thumbnail_url_tmpl?o.default.createElement("img",{key:t,src:e.thumbnail_url_tmpl,className:"icon icon"+t,alt:""}):o.default.createElement(s.FileOrFolderIcon,{key:t,file:e,className:"icon icon"+t})})),o.default.createElement(a.NotificationBadge,{className:"drag-status__badge"},l.length))),document.body,"drag-status")})),t.InternalDragStatus.displayName="InternalDragStatus"})),define("modules/clean/react/files_view/legacy_types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})})),define("modules/clean/react/files_view/list",["require","exports","tslib","react","react-redux","modules/clean/react/browse/models","modules/clean/react/files_view/resizing/column_size_context","modules/clean/react/files_view/culled_table_body","modules/clean/react/files_view/data/selectors/list_selectors","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/drag_drop/drag_and_drop","modules/clean/react/files_view/rows/file_shared_with_me_row","modules/clean/react/files_view/keyboard_shortcuts","modules/clean/react/files_view/rows/new_folder_row","modules/clean/react/files_view/rows/paper_row","modules/clean/react/files_view/rows/row_container","modules/clean/react/files_view/types","modules/clean/react/files_view/view_type","modules/clean/react/files_view/rows/user_defined_item_row","modules/clean/react/files_view/data/selectors/files_view_selectors"],(function(e,t,r,n,o,i,a,s,l,c,d,u,_,p,f,m,g,h,S,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FilesViewList=t.FilesViewListComponent=t.isGlobalEvent=void 0,n=r.__importDefault(n);var v=function(){};t.isGlobalEvent=function(e){switch(e.key){case"ArrowLeft":case"ArrowUp":case"ArrowRight":case"ArrowDown":return!(e.target instanceof Element&&["menuitem","treeitem"].includes(e.target.getAttribute("role")||""));default:return!0}};var T=(function(e){function o(){var t=null!==e&&e.apply(this,arguments)||this;return t.getIsListEvent=function(e){return t.props.isSelectableListEvent()&&(!(e.target instanceof Element)||"BUTTON"!==e.target.tagName)},t.getSelectedFiles=function(){return t.props.selectedFiles},t.getActiveDropTarget=function(){return t.props.activeDropTarget},t.getIsDraggingInternalFiles=function(){return!!t.props.isDraggingInternalFiles},t.getIsDraggingExternalFiles=function(){return!!t.props.isDraggingExternalFiles},t.renderRow=function(e,o,s){var l,c,d,_;if("NewFolderRow"===e.type)return n.default.createElement(p.NewFolderRow,{createNewFolderState:e.props.createNewFolderState,isInsideMyTeamFolderTree:e.props.isInsideMyTeamFolderTree,onCancel:t.props.onNewFolderCancel,onSubmit:t.props.onNewFolderSubmit,rowIndex:o,topOffset:s,iconSize:e.props.iconSize});if("PaperRow"===e.type)return n.default.createElement(a.ColumnResizingContext.Consumer,null,(function(r){var i=r.columnSizes,a=r.columnResizingEnabled;return n.default.createElement(f.PaperRow,{paper:e.props.paper,rowIndex:o,topOffset:s,user:t.props.user,visibleColumns:e.props.visibleColumns,onOpenPaper:t.props.onOpenPaper,arePostTTIModulesLoaded:e.props.arePostTTIModulesLoaded,showSnippets:e.props.showSnippets,snippetRows:e.props.snippetRows,height:e.props.height,showStar:e.props.showStar,columnSizes:a?i:void 0})}));if("UserDefinedItemRow"===e.type)return n.default.createElement(S.UserDefinedItemRow,{userDefinedItem:e.props.userDefinedItem,rowIndex:o,topOffset:s});var g=t.props.selection,h=e.props.file instanceof i.File?g.selected.last()===t.props.fileToId(e.props.file):g.selected.last()===e.props.file.file_id;if("FileSharedWithMeRow"===e.type)return null===(c=(l=t.props).registerListItem)||void 0===c||c.call(l,e.props.file.file_id,{top:s,height:e.props.height,left:0}),n.default.createElement(a.ColumnResizingContext.Consumer,null,(function(r){var i=r.columnSizes,a=r.columnResizingEnabled;return n.default.createElement(u.FileSharedWithMeRow,{arePostTTIModulesLoaded:t.props.arePostTTIModulesLoaded,file:e.props.file,visibleColumns:t.props.visibleColumns,isCompactMode:e.props.isCompactMode,getOverflowMenuActions:t.props.getOverflowMenuActions,onOpenFileSharedWithMe:t.props.onOpenFileSharedWithMe,rowIndex:o,controlsFocusable:h,topOffset:s,user:t.props.user,responsive:t.props.responsive,showSnippets:e.props.showSnippets,snippetRows:e.props.snippetRows,height:e.props.height,isSelectMode:e.props.isSelectMode,isSelected:e.props.isSelected,onSelect:t.props.onSelectFile,onDeselect:t.props.onDeselectFile,isFocused:e.props.isFocused,filteredContactName:t.props.filteredContactName,iconSize:e.props.iconSize,columnSizes:a?i:void 0})}));null===(_=(d=t.props).registerListItem)||void 0===_||_.call(d,t.props.fileToId(e.props.file),{top:s,height:e.props.height,left:0});var E={key:e.key,instanceId:t.props.instanceId,itemIndex:e.itemIndex,containerWidth:e.props.containerWidth,file:e.props.file,sharingServiceInfo:e.props.sharingServiceInfo,getOverflowMenuActions:t.props.getOverflowMenuActions,hideViewFileButton:t.props.hideViewFileButton,isActiveDropTarget:e.props.isActiveDropTarget,isAvailableDropTarget:e.props.isAvailableDropTarget,isCompactMode:e.props.isCompactMode,responsive:e.props.responsive,isExtensionsMenuDisabled:e.props.isExtensionsMenuDisabled,isFocused:e.props.isFocused,isSearchMode:e.props.isSearchMode,isSelectMode:e.props.isSelectMode,isSelected:e.props.isSelected,isSharingDisabled:e.props.isSharingDisabled,onDeselect:t.props.onDeselectFile,onDragStart:t.props.onDragStart,onDragEnter:t.props.onDragEnter,onDragEnd:t.props.onDragEnd,onLocationLinkClick:t.props.onLocationLinkClick,onNavigateToFileOrFolder:t.props.onNavigateToFileOrFolder,onRenameCancel:t.props.onRenameCancel,onRenameSubmit:t.props.onRenameSubmit,onSelect:t.props.onSelectFile,renameState:e.props.renameState,rowIndex:o,controlsFocusable:h,topOffset:s,user:t.props.user,visibleColumns:t.props.visibleColumns,canDisplayFolderSizes:t.props.canDisplayFolderSizes,renderSharedWithController:t.props.renderSharedWithController,hrefForFile:t.props.hrefForFile,onShowShare:t.props.onShowShare,onPresentInZoom:t.props.onPresentInZoom,shareButtonLabel:t.props.shareButtonLabel,showShareButton:t.props.showShareButton,filteredContactName:t.props.filteredContactName,fileToId:t.props.fileToId,isFirstTaskEmptyState:t.props.isFirstTaskEmptyState,isCondensedListView:e.props.isCondensedListView,isActionBarEnabled:e.props.isActionBarEnabled,expManualTagging:t.props.expManualTagging,preventSelectionOnDrag:t.props.preventSelectionOnDrag,mediaFiltersVariant:t.props.mediaFiltersVariant,isRightClickEnabled:t.props.isRightClickEnabled};return n.default.createElement(m.RowContainer,r.__assign({},E))},t}return r.__extends(o,e),o.prototype.componentDidMount=function(){this.props.onTTI(),this.setupKeyboardShortcuts(),this.setupExternalDragHandler()},o.prototype.componentWillUnmount=function(){this.cleanupKeyboardShortcuts(),d.cleanupExternalDragHandler(this.props.keyScope)},o.prototype.componentDidUpdate=function(e){e.isActive!==this.props.isActive&&(this.props.isActive?this.setupKeyboardShortcuts():this.cleanupKeyboardShortcuts())},o.prototype.cleanupKeyboardShortcuts=function(){_.resetFilesViewKeyboardShortcuts(this.props.keyScope),_.resetFileJumpKeyboardShortcuts(this.props.keyScope)},o.prototype.setupKeyboardShortcuts=function(){var e=this,t=this.props,r=t.user,n=t.onDelete,o=t.onShowRename,i=t.getIsFileJumping,a=t.onAddFileJumpKeyCode,s=t.onResetFileJump,l=t.keyScope,c=t.onCopyToClipboard,d=t.onCutToClipboard,u=t.onNavigateToParentFolder,p=t.onPasteFromClipboard;_.setupFileJumpKeyboardShortcuts({scope:l,getIsFileJumping:i,onAddFileJumpKeyCode:a,onResetFileJump:s}),_.setupFilesViewKeyboardShortcuts({user:r,viewType:h.ViewType.List,getIsGlobalEvent:this.getIsGlobalEvent(),getIsItemEvent:this.getIsListEvent,getSelectedFiles:this.getSelectedFiles,isCurrentPathWriteable:this.props.getIsCurrentPathWriteable,selectAllAction:v,deselectAllAction:v,onCopyToClipboard:c,onCutToClipboard:d,onDelete:n,onFocusSearchBar:this.props.onFocusSearchBar,onNavigateToFileOrFolder:function(t){return e.props.onNavigateToFileOrFolder(t,{actionSource:g.FilesViewActionSource.KEYBOARD})},onNavigateToParentFolder:u,onPasteFromClipboard:p,onShowRename:o,scope:l,onShowHelpMenu:function(){return e.props.onOpenKeyboardShortcutModal()}})},o.prototype.setupExternalDragHandler=function(){d.setupExternalDragHandler(this.props.keyScope,this.getIsDraggingInternalFiles,this.getIsDraggingExternalFiles,this.props.onSetFileUploaderPath,".brws-file-row",this.getActiveDropTarget,this.props.onSetDropTarget)},o.prototype.getIsGlobalEvent=function(){return t.isGlobalEvent},o.prototype.render=function(){var e=this.props,t=e.scrollPositionOffset,r=e.viewportTopOffset,o=e.focusedFileIndex,i=e.onRangeInView,a=e.scrollContainer,l=e.listItems,c=e.heights,d=e.itemBuffer;return n.default.createElement(s.CulledTableBodyWithScrollContainer,{items:l,listItemHeight:c,renderRow:this.renderRow,scrollPositionOffset:t,scrollToRow:o,shouldUseWindowAsScrollContainer:!0,viewportTopOffset:r,onRangeInView:i,scrollContainer:a,itemBuffer:d,id:"files-view-table-container"})},o.defaultProps={isFileViewerShown:function(){return!1}},o.displayName="FilesViewListComponent",o})(n.default.Component);t.FilesViewListComponent=T;t.FilesViewList=o.connect((function(e,t){return{listItems:l.selectListItems(e,t),heights:l.selectListItemHeights(e,t),itemBuffer:l.selectListItemBuffer(e,t),isActive:E.isActiveFilesView(e,t.instanceId),isCheckboxDisabled:c.selectDisabledMultiselect(e,t),cutItems:c.selectCutItems(e,t)}}))(T)})),define("modules/clean/react/files_view/rows/new_folder_row",["require","exports","tslib","spectrum/media_table/index","spectrum/table/index","react","spectrum/icon_content/index","modules/clean/react/files_view/name_input","modules/core/i18n"],(function(e,t,r,n,o,i,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NewFolderIcon=t.NewFolderRow=void 0,i=r.__importDefault(i),t.NewFolderRow=function(e){var r,a=e.createNewFolderState,c=e.isInsideMyTeamFolderTree,d=void 0!==c&&c,u=e.onCancel,_=e.onSubmit,p=e.rowIndex,f=e.topOffset,m=e.iconSize;r="SAVING_INPUT"===a?i.default.createElement("p",{className:"brws-new-folder-row-status",role:"status","aria-live":"polite"},l.intl.formatMessage({id:"p58M12",defaultMessage:"Creating new folder…"})):i.default.createElement(s.NameInput,{defaultValue:"",label:l.intl.formatMessage({id:"ss4CO0",defaultMessage:"Folder name"}),onSubmit:_,onCancel:u});var g=i.default.createElement(t.NewFolderIcon,{isInsideMyTeamFolderTree:d,iconSize:m});return i.default.createElement(n.CulledMediaRow,{"aria-rowindex":void 0!==p?p+1:void 0,className:"brws-new-folder-row",topOffset:f},i.default.createElement(o.TableCell,{className:"brws-checkbox-cell"}),i.default.createElement(n.MediaCell,{icon:g},i.default.createElement("div",{className:"brws-new-folder-row-content brws-vertically-center"},r)),i.default.createElement(o.TableCell,null),i.default.createElement(o.TableCell,null))},t.NewFolderIcon=function(e){var t=e.isInsideMyTeamFolderTree,n=e.iconSize,o=e.className||"",s=n?{width:n,height:n}:{};return i.default.createElement(a.IconContent,r.__assign({className:o,name:t?"folder_team-small":"folder-small"},s))}})),define("modules/clean/react/files_view/rows/paper_row",["require","exports","tslib","react","classnames","typescript/component_libraries/retrieval-components/src/highlighted-truncated-string/index","spectrum/media_table/index","spectrum/util/raf_throttle","modules/clean/emoji_utils","modules/clean/filename_highlights","modules/clean/paper_formatting_utils","modules/clean/react/files_view/file_snippets","modules/clean/react/files_view/star","modules/clean/react/files_view/sort_types","modules/clean/react/files_view/util","modules/core/browser","modules/core/i18n","modules/clean/react/files_view/rows/row"],(function(e,t,r,n,o,i,a,s,l,c,d,u,_,p,f,m,g,h){"use strict";function S(){}Object.defineProperty(t,"__esModule",{value:!0}),t.PaperRow=void 0,n=r.__importDefault(n),o=r.__importDefault(o),l=r.__importStar(l),d=r.__importStar(d),m=r.__importStar(m);var E=function(e){return void 0===e?{}:{width:e,minWidth:e,maxWidth:e}},v=(function(e){function t(t){var r=e.call(this,t)||this;return r.setRef=function(e){r.brwsFilenameContainerDiv=e},r.handleWindowResize=function(){r.throttledWindowResize.request()},r.handleResize=function(){if(r.brwsFilenameContainerDiv){var e=r.state.brwsFilenameContainerDivWidth,t=r.brwsFilenameContainerDiv.getBoundingClientRect().width;t&&t!==e&&r.setState({brwsFilenameContainerDivWidth:t})}},r.handleOpenNewTabOrNavigate=function(e){0===e.button&&(e.preventDefault(),e.stopPropagation(),r.handleNavigate({openInNewTab:f.hasModifierKey(e)}))},r.handleNavigate=function(e){var t=e.openInNewTab,n=r.props,o=n.paper,i=n.onOpenPaper;t?m.open_tab(o.url):i(o)},r.throttledWindowResize=new s.RafThrottle((function(){return r.handleResize()})),r.state=r.calcState(t),r}return r.__extends(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){if(this.props.paper.title!==e.paper.title||this.props.paper.highlight_spans!==e.paper.highlight_spans){var t=this.calcState(e);this.setState(t)}},t.prototype.componentDidMount=function(){this.handleResize(),window.addEventListener("resize",this.handleWindowResize)},t.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.handleWindowResize)},t.prototype.componentDidUpdate=function(e){var t,r;(null===(t=e.columnSizes)||void 0===t?void 0:t[p.SortField.FILENAME])!==(null===(r=this.props.columnSizes)||void 0===r?void 0:r[p.SortField.FILENAME])&&this.handleResize()},t.prototype.calcState=function(e){return{titleParts:d.getPaperDocTitleParts(e.paper,"brws-file-name-cell-icon","brws-file-name-cell-icon-emoji")}},t.prototype.getHighlightedSpansForHighlightedTruncatedString=function(e){var t=e.title,n=e.highlight_spans,o=e.title_highlights,i=n&&n.length>0,a=l.getFirstEmojiFromTitle(t);if(i){if(a){var s={highlight_str:n[0].highlight_str.substr(a.length),is_highlighted:n[0].is_highlighted};n=r.__spreadArrays([s],n.slice(1))}return n.map((function(e){return{string:e.highlight_str,isHighlighted:e.is_highlighted}}))}if(o){if(a){t=t.substr(a.length);var d=a.length/2;o=o.slice().map((function(e){return{pos:e.pos-d,len:e.string.length,string:e.string}}))}return c.highlightMatchSections(t,o).map((function(e){return{string:e.text,isHighlighted:e.isHighlighted}}))}},t.prototype.renderTitleElement=function(e){var t=this.props,r=t.paper,o=t.showHighlights,a=this.state.titleParts,s=a.title,l=a.highlightedTitle;if(e){var c=n.default.createElement(i.HighlightedTruncatedString,{text:s,className:"brws-file-name-element",fontSize:14,highlightSpans:this.getHighlightedSpansForHighlightedTruncatedString(r),cellBuffer:3,availableWidth:e});return n.default.createElement("a",{className:"brws-paper-doc-name-cell-title",href:r.url,onClick:this.handleOpenNewTabOrNavigate},o?c:n.default.createElement("span",null,s))}return n.default.createElement("a",{className:"brws-paper-doc-name-cell-title",href:r.url,onClick:this.handleOpenNewTabOrNavigate},o?l:n.default.createElement("span",null,s))},t.prototype.renderPaperCellContent=function(e,t){var r=this.props,o=r.paper,i=r.user,s=r.showSnippets,l=r.snippetRows,c=r.showStar;return n.default.createElement(n.default.Fragment,null,n.default.createElement("div",{className:"brws-paper-doc-name-cell-content brws-vertically-center"},n.default.createElement("div",{className:"brws-paper-doc-name-cell-title-container"},n.default.createElement(a.MediaCellText,{highlight:e,className:"brws-paper-doc-cell-name"},this.renderTitleElement(t))),n.default.createElement(a.MediaCellText,{variant:"subtitle"},g.intl.formatMessage({id:"mvOTrD",defaultMessage:"in Paper"})),s&&n.default.createElement(a.MediaCellText,{key:"snippets",variant:"subtitle"},n.default.createElement("div",{className:"brws-file-snippets-tags-container"},n.default.createElement(u.FileSnippets,{snippets:o.snippets,lineClamp:l})))),c&&n.default.createElement(_.StarContainer,{item:o,user:i,key:"paperStar",className:"brws-file-name-cell-star",starButtonClassName:"brws-file-name-star-button",alwaysShowUnstarred:!0}))},t.prototype.renderDocName=function(e,t){var i=this.props.height,s={highlight:e,icon:this.state.titleParts.icon,style:r.__assign({minHeight:i-1},E(t))},l=o.default("brws-file-name-container",{"brws-file-name-container--action-ui-inline-star":!0}),c=this.state.brwsFilenameContainerDivWidth;return n.default.createElement(a.MediaCell,r.__assign({key:"docName"},s),n.default.createElement("div",{className:l,ref:this.setRef},this.renderPaperCellContent(e,c)))},t.prototype.renderDocInfo=function(e){var t=this.props.paper,r=t.last_modified_date||"",o=t.last_editor_name?g.intl.formatMessage({id:"ACVnV9",defaultMessage:"by {modified_by}"},{modified_by:t.last_editor_name}):g.intl.formatMessage({id:"5794tP",defaultMessage:"by you"});return n.default.createElement(a.MediaCell,{key:"docInfo",subtitle:o,title:r,style:E(e)})},t.prototype.renderCell=function(e){var t,r=e.isHovered,o=e.sortField,i=null===(t=this.props.columnSizes)||void 0===t?void 0:t[o];switch(o){case p.SortField.FILENAME:return this.renderDocName(r,i);case p.SortField.RELEVANCE:case p.SortField.MODIFIED:return this.renderDocInfo(i);default:return n.default.createElement(a.MediaCell,{key:o,title:n.default.createElement("span",{"aria-hidden":!0},"--"),style:E(i)})}},t.prototype.render=function(){var e=this,t=this.props,o=t.rowIndex,i=t.topOffset,s=t.visibleColumns,l=t.paper;return n.default.createElement(h.FilesViewRow,{className:"brws-paper-row",topOffset:i,rowIndex:o,filename:l.title,ariaLabel:l.title,onSelect:S,onDeselect:S,onNavigateToItem:this.handleNavigate},(function(t){var o=t.isHovered;return r.__spreadArrays([n.default.createElement(a.MediaCell,{key:"checkboxCell",className:"brws-checkbox-cell"})],s.map((function(t){return e.renderCell({isHovered:o,sortField:t.sortField})})))}))},t.defaultProps={showHighlights:!0},t.displayName="PaperRow",t})(n.default.PureComponent);t.PaperRow=v})),define("modules/clean/react/files_view/rows/row",["require","exports","tslib","classnames","react","spectrum/media_table/index","modules/clean/react/files_view/double_click","modules/clean/react/files_view/types","modules/clean/react/files_view/util","modules/clean/react/selectable_list"],(function(e,t,r,n,o,i,a,s,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FilesViewRow=void 0,n=r.__importDefault(n),o=r.__importDefault(o);var d=function(e){var t=e.className,r=e.isSelected,d=e.isDeleted,u=e.isDraggable,_=e.isActiveDropTarget,p=e.rowIndex,f=e.ariaLabel,m=e.filename,g=e.children,h=e.onDragEnter,S=e.isSelectMode,E=e.onDragStart,v=e.onDragEnd,T=e.onNavigateToItem,w=e.onSelect,I=e.onDeselect,b=e.topOffset,F=void 0===b?0:b,C=e.isRightClickEnabled,O=function(e){C&&(e.defaultPrevented||(e.preventDefault(),e.shiftKey?w(c.SelectOptions.EXTEND,s.FilesViewActionSource.ROW_SINGLE_CLICK):e.ctrlKey||e.metaKey?w(c.SelectOptions.DEFAULT,s.FilesViewActionSource.ROW_SINGLE_CLICK):r||w(c.SelectOptions.ONLY,s.FilesViewActionSource.ROW_SINGLE_CLICK)))},R=function(e,t){0===e.button&&(e.preventDefault(),e.stopPropagation(),T({openInNewTab:Boolean(l.hasModifierKey(e)),actionSource:t}))};return o.default.createElement(a.WithDoubleClick,{onClick:function(e){e.defaultPrevented||(e.preventDefault(),e.shiftKey?w(c.SelectOptions.EXTEND,s.FilesViewActionSource.ROW_SINGLE_CLICK):e.ctrlKey||e.metaKey?r?I(!1,s.FilesViewActionSource.ROW_SINGLE_CLICK):w(c.SelectOptions.DEFAULT,s.FilesViewActionSource.ROW_SINGLE_CLICK):w(c.SelectOptions.ONLY,s.FilesViewActionSource.ROW_SINGLE_CLICK))},onDoubleClick:function(e){e.defaultPrevented||R(e,s.FilesViewActionSource.ROW_DOUBLE_CLICK)}},(function(e){var a=e.onClick;return o.default.createElement(i.CulledMediaRow,{className:n.default(t,{"brws-file-row-selected":r,"brws-file-row-deleted":d,"brws-file-row-dragover":_,"brws-row-click-selection-method":!0}),variant:(_?"dragover":r&&"selected")||"default",onClick:a,onContextMenu:O,draggable:u,topOffset:F,onDragEnter:h,onDragStart:r?E:void 0,onDragEnd:v,"aria-rowindex":(p||0)+1,"aria-controls":"brws-sidebar-view","aria-label":f,"data-filename":m,tabIndex:S?-1:0===p?0:-1},g)}))};d.displayName="FilesViewRowUnmemoed",t.FilesViewRow=o.default.memo(d),t.FilesViewRow.displayName="FilesViewRow"})),define("modules/clean/react/files_view/rows/row_container",["require","exports","tslib","react","react-redux","modules/clean/react/files_view/resizing/column_size_context","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/data/selectors/item_selectors","modules/clean/react/files_view/rows/file_row"],(function(e,t,r,n,o,i,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RowContainer=t.RowContainerWithoutRedux=void 0,n=r.__importDefault(n),t.RowContainerWithoutRedux=n.default.memo((function(e){return n.default.createElement(i.ColumnResizingContext.Consumer,null,(function(t){var o=t.columnSizes,i=t.columnResizingEnabled;return n.default.createElement(l.FileRow,r.__assign({},e,{columnSizes:i?o:void 0}))}))})),t.RowContainerWithoutRedux.displayName="RowContainerWithoutRedux";t.RowContainer=o.connect((function(e,t){return{arePostTTIModulesLoaded:a.selectArePostTTIModulesLoaded(e,t),context:a.selectContext(e,t),isCheckboxDisabled:a.selectDisabledMultiselect(e,t),responsive:a.selectResponsive(e,t),showCDMUserEducationEffects:s.selectShowCDMUserEducationEffects(e,t),height:s.selectRowHeight(e,r.__assign(r.__assign({},t),{numVisibleColumns:t.visibleColumns.length})),iconSize:s.selectIconSize(e,t),isCutToClipboard:s.selectIsCutToClipboard(e,t)}}))(t.RowContainerWithoutRedux)})),define("modules/clean/react/files_view/scroll_updater",["require","exports","tslib","react-redux","react","modules/clean/react/files_view/data/selectors/files_view_selectors"],(function(e,t,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScrollUpdater=void 0,o=r.__importDefault(o),i=r.__importStar(i);var a=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.updateScroll()},t.prototype.componentDidUpdate=function(e){var t=e.currentScroll,r=e.path;t!==this.props.currentScroll?this.updateScroll():r!==this.props.path&&this.scrollTo(0)},t.prototype.updateScroll=function(){var e=this.props.currentScroll;if(e){var t=e.scrollTop;this.scrollTo(t)}},t.prototype.scrollTo=function(e){var t=this.props.scrollContainer;t&&t.current?t.current.scrollTop=e:window.scrollTo(0,e)},t.prototype.render=function(){return null},t.displayName="ScrollUpdaterComponent",t})(o.default.Component);t.ScrollUpdater=n.connect((function(e){return{currentScroll:i.currentScroll(e)}}))(a)})),define("modules/clean/react/files_view/sticky_table_head",["require","exports","tslib","spectrum/dimensions/index","spectrum/table/index","react","modules/clean/react/sticky/sticky","modules/clean/react/sticky/container"],(function(e,t,r,n,o,i,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StickyTableHead=void 0,i=r.__importDefault(i),t.StickyTableHead=function(e){var t=e.children,l=e.columnFlex,c=(e.offsetHeight,e.offsetTop),d=r.__rest(e,["children","columnFlex","offsetHeight","offsetTop"]),u=i.default.createElement(n.Dimensions,{tagName:"tr"},(function(e){var n=e.width;return i.default.createElement("td",{className:"brws-sticky-table-cell"},i.default.createElement(s.StickyContainer,{offsetTop:c},i.default.createElement(a.Sticky,null,i.default.createElement(o.Table,{columnFlex:l,style:{width:n}},i.default.createElement(o.TableHead,r.__assign({},d),t)))))}));return i.default.createElement("thead",{className:"brws-sticky-table-head"},u)}})),define("modules/clean/react/files_view/thumbnail_media_cell",["require","exports","tslib","react","spectrum/media_table/index","modules/clean/react/files_view/file_thumbnail"],(function(e,t,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ThumbnailMediaCell=void 0,n=r.__importDefault(n),t.ThumbnailMediaCell=function(e){var t=e.height,a=e.width,s=e.children,l=r.__rest(e,["height","width","children"]),c=void 0===a?{}:{width:a,minWidth:a,maxWidth:a};return n.default.createElement(o.MediaCell,{icon:n.default.createElement(i.FileThumbnail,r.__assign({},l)),style:r.__assign({minHeight:t-1},c),children:s})},t.ThumbnailMediaCell.displayName="ThumbnailMediaCell",t.ThumbnailMediaCell.displayName="ThumbnailMediaCell"})),define("modules/clean/react/files_view/unity_listener",["require","exports","tslib","react","modules/clean/web_timing_logger","modules/core/cancelable_promise","modules/clean/react/browse/models"],(function(e,t,r,n,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnityListener=void 0,n=r.__importDefault(n),o=r.__importStar(o);t.UnityListener=function(t){var s=t.items,l=t.userId,c=n.default.useState(void 0),d=c[0],u=c[1];return n.default.useEffect((function(){var t=i.makeCancelable(r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,o.waitForTTI()];case 1:return t.sent(),[4,new Promise((function(t,r){e(["modules/clean/unity_browse_interface"],t,r)})).then(r.__importStar)];case 2:return[2,t.sent().unityBrowseInterface]}}))})).then((function(e){return u(e)})));return function(){return t.cancel()}}),[]),n.default.useEffect((function(){null==d||d.browse_visible_change_callback(s.toArray().filter((function(e){return e instanceof a.File})),l,0,s.size-1)}),[d,s,l]),null},t.UnityListener.displayName="UnityListener"})),define("modules/clean/react/files_view/rows/user_defined_item_row",["require","exports","tslib","react"],(function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserDefinedItemRow=void 0,n=r.__importDefault(n),t.UserDefinedItemRow=n.default.memo((function(e){var t=e.rowIndex,r=e.topOffset;return e.userDefinedItem.renderUserDefinedItemRow({rowIndex:t,topOffset:r})})),t.UserDefinedItemRow.displayName="UserDefinedItemRow"})),define("modules/clean/react/files_view/view_preferences",["require","exports","tslib","modules/core/persistence/storage"],(function(e,t,r,n){"use strict";function o(e){return r.__assign({},n.UserLocalStorage.get(e,t.VIEW_PREFERENCES_STORAGE_KEY))}function i(e,i,a){for(var s=o(e),l=r.__assign(r.__assign({},a),{last_updated_ts:Date.now()}),c=0,d=i;c<d.length;c++){var u=d[c];s[u]=r.__assign(r.__assign({},s[u]),l)}for(;Object.keys(s).length>t.VIEW_PREFERENCES_STORAGE_LIMIT;){var _=Object.keys(s).reduce((function(e,t){return!e||s[t].last_updated_ts<s[e].last_updated_ts?t:e}));delete s[_]}n.UserLocalStorage.set(e,t.VIEW_PREFERENCES_STORAGE_KEY,s)}function a(e,t){var r={},n=o(e);return Object.keys(n).forEach((function(e){var o=n[e][t];void 0!==o&&(r[e]=o)})),r}Object.defineProperty(t,"__esModule",{value:!0}),t.setNumVisibleColumns=t.getScopedNumVisibleColumns=t.setSort=t.getScopedSorts=t.setColumnsIndex=t.getScopedColumnsIndex=t.setViewType=t.getViewTypes=t.getPreferences=t.VIEW_PREFERENCES_STORAGE_LIMIT=t.VIEW_PREFERENCES_STORAGE_KEY=void 0,t.VIEW_PREFERENCES_STORAGE_KEY="files_view_preferences",t.VIEW_PREFERENCES_STORAGE_LIMIT=500,t.getPreferences=o,t.getViewTypes=function(e){var t=o(e);if(!t||0===Object.keys(t).length)return null;var r={};return Object.keys(t).forEach((function(e){var n=t[e].file_view_mode;n&&(r[e]=n)})),r},t.setViewType=function(e,t,r){i(e,t,{file_view_mode:r})},t.getScopedColumnsIndex=function(e){return a(e,"columns_index")},t.setColumnsIndex=function(e,t,r){i(e,t,{columns_index:r})},t.getScopedSorts=function(e){return a(e,"sort_state")},t.setSort=function(e,t,r){i(e,t,{sort_state:r})},t.getScopedNumVisibleColumns=function(e){return a(e,"num_visible_columns")},t.setNumVisibleColumns=function(e,t,r){i(e,t,{num_visible_columns:r})}})),define("modules/clean/react/folder_dialog/async",["require","exports","tslib","react","modules/clean/react/components/modal_controller","modules/clean/css"],(function(e,t,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.prewarmFolderDialog=t.showFolderDialog=void 0,n=r.__importDefault(n),t.showFolderDialog=function(t){new Promise((function(t,r){e(["modules/clean/react/folder_dialog/folder_dialog"],t,r)})).then(r.__importStar).then((function(e){var i=e.FolderDialog;o.mountModal(n.default.createElement(i,r.__assign({},t)))}))},t.prewarmFolderDialog=function(){new Promise((function(t,r){e(["modules/clean/react/folder_dialog/folder_dialog"],t,r)})).then(r.__importStar).then((function(){i.require_css("/static/css/react/folder_picker-vflqf-mgm.css")}))}})),define("modules/clean/react/growth/personalization/collection_folder/collection_folder",["require","exports","tslib","react","modules/clean/react/components/css","modules/clean/react/image","modules/clean/static_urls","dig-components/typography","dig-components/buttons","modules/clean/react/growth/personalization/collection_folder/constants","modules/clean/react/growth/personalization/collection_folder/actions","modules/clean/paper/template_library/constants","modules/clean/dropbox_form","modules/clean/react/growth/personalization/collection_folder/logger","modules/clean/growth/smb_funnel/smb_funnel_logger","modules/clean/react/admin/teams/onboarding/web/constants"],(function(e,t,r,n,o,i,a,s,l,c,d,u,_,p,f,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CollectionFolder=t.CollectionFolderView=void 0,n=r.__importDefault(n),d=r.__importStar(d),p=r.__importStar(p);var g=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getActionCallback=function(e,t,r,n,o,i){switch(n){case c.ActionCallbackType.CREATE_GOOGLE_SHEETS:return function(){return d.createGoogleSheets(e,t.currentFQPath)};case c.ActionCallbackType.DOWNLOAD:return function(){return d.downloadDesktop(e)};case c.ActionCallbackType.OPEN_SHARE_MODAL:return function(){return d.asyncOpenShareFolderSetting(e,t,i)};case c.ActionCallbackType.UPLOAD:return function(){return d.uploadFile(r)};case c.ActionCallbackType.REDIRECT:return function(){return d.redirectToLink(o)};default:return function(){}}},t.logOnActionClicked=function(e,t,r){p.userClickedCollectionsFolderAction(e,t),r?r():f.SMBFunnelLogger.log(m.AMPMetrics.ACTIVATION_COLLECTIONS_ACTION_PAPER,{collectionFolderType:String(e),templateName:t})},t.getActionButton=function(e){var r=t.props,o=r.user,i=r.context,a=r.handleUploadButtonClick;if(e.actionCallbackType===c.ActionCallbackType.CREATE_PAPER_TEMPLATE)return n.default.createElement(_.DropboxForm,{method:"post",action:u.REDIRECT_URL+"?slugId="+e.paperTemplateSlugId,target:"_blank"},n.default.createElement(l.Button,{type:"submit",variant:"outline",onClick:function(){return t.logOnActionClicked(i.collectionFolderType,e.loggingTitle)}},e.buttonText));var s=t.getActionCallback(o,i,a,e.actionCallbackType,e.redirectLink,e.shareModalSettingsTab);return n.default.createElement(l.Button,{type:"button",variant:"outline",onClick:function(){return t.logOnActionClicked(i.collectionFolderType,e.loggingTitle,s)}},e.buttonText)},t}return r.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props,r=t.context,o=t.role,l=c.collectionPanelConfig(o,r.collectionFolderType);if(void 0===l)return null;p.userViewCollectionsFolder(r.collectionFolderType,o,l.actions);var d=l.actions.map((function(t,r){return n.default.createElement("div",{className:"collection-action-item",key:r},n.default.createElement(i.Image,{alt:c.imageAltString,src:a.static_url(t.imageUrl),srcHiRes:a.static_url(t.imageHiResUrl)}),n.default.createElement("div",{className:"collection-action-item__rc"},n.default.createElement("div",{className:"collection-action-item__rc__title"},n.default.createElement(s.Title,{size:"small",isBold:!0},t.title)),n.default.createElement("div",{className:"collection-action-item__rc__desc"},n.default.createElement(s.Text,null,t.desc)),n.default.createElement("div",{className:"collection-action-item__rc__button"},e.getActionButton(t))))}));return n.default.createElement("div",{className:"collection-panel"},n.default.createElement("div",{className:"collection-overview-title"},n.default.createElement(s.Title,{size:"small",isBold:!0},c.overviewTitle)),n.default.createElement("div",{className:"collection-overview-desc"},n.default.createElement("div",{className:"collection-overview-desc__text"},n.default.createElement(s.Text,null,l.overviewDesc))),n.default.createElement("div",{className:"collection-action-title"},n.default.createElement("div",{className:"collection-action-title__text"},n.default.createElement(s.Title,{size:"small",isBold:!0},l.actionsTitle))),n.default.createElement("div",{className:"collection-action-panel"},d))},t.displayName="CollectionFolderView",t})(n.default.PureComponent);t.CollectionFolderView=g,t.CollectionFolder=o.requireCssWithComponent(g,["/static/css/dig-components/index.web-vflfsfj-g.css","/static/css/growth/experiments/collection_folder-vflpSIfgG.css"])})),define("modules/clean/react/growth/personalization/collection_folder/constants",["require","exports","modules/core/i18n","modules/clean/filetypes"],(function(e,t,r,n){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0}),t.overviewTitle=t.collectionPanelConfig=t.imageAltString=t.ActionCallbackType=t.WATERMARK_LINK=t.PAPER_TEMPLATES_LINK=t.FILE_REQUEST_LINK=void 0,t.FILE_REQUEST_LINK="/requests",t.PAPER_TEMPLATES_LINK="/paper/templates",t.WATERMARK_LINK="/features/share/watermark",(function(e){e.DOWNLOAD="download",e.CREATE_GOOGLE_SHEETS="create_google_sheets",e.CREATE_PAPER_TEMPLATE="create_paper_template",e.OPEN_SHARE_MODAL="open_share_modal",e.UPLOAD="upload",e.REDIRECT="redirect"})(o=t.ActionCallbackType||(t.ActionCallbackType={})),t.imageAltString=r.intl.formatMessage({id:"G0BGYo",defaultMessage:"Image loading"});var i={imageUrl:"/static/images/growth/personalization/collections_exp/Get_Smart_Sync_on_desktop-vfllGWHCs.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Get_Smart_Sync_on_desktop@2x-vflXfvyBS.png",title:r.intl.formatMessage({id:"cBBY+o",defaultMessage:"Get Smart Sync on desktop"}),loggingTitle:"smart_sync",desc:r.intl.formatMessage({id:"4PtkZL",defaultMessage:"Store all your computer files in the cloud to save computer space and keep everything backed up."}),buttonText:r.intl.formatMessage({id:"8cyvqx",defaultMessage:"Open the desktop app"}),actionCallbackType:o.DOWNLOAD},a={imageUrl:"/static/images/growth/personalization/collections_exp/Lock_files_when_you_edit_them-vflNkx0x7.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Lock_files_when_you_edit_them@2x-vflEgd1S9.png",title:r.intl.formatMessage({id:"XVzKiX",defaultMessage:"Lock files when you edit them"}),loggingTitle:"lock_files",desc:r.intl.formatMessage({id:"LhuHW+",defaultMessage:"In the desktop app, right click a file in any shared folder to keep others from editing it at the same time."}),buttonText:r.intl.formatMessage({id:"8m53T6",defaultMessage:"Upload file and try"}),actionCallbackType:o.UPLOAD},s={imageUrl:"/static/images/growth/personalization/collections_exp/Work_off_Google_Sheets-vflnZKx1s.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Work_off_Google_Sheets@2x-vflY3NFJm.png",title:r.intl.formatMessage({id:"ZWTwJC",defaultMessage:"Work off Google Sheets"}),loggingTitle:"google_sheet",desc:r.intl.formatMessage({id:"HdzKjx",defaultMessage:"Create and use Google files from within Dropbox to have all your spreadsheets stored in one place."}),buttonText:r.intl.formatMessage({id:"vlzkco",defaultMessage:"Create Google Sheet"}),actionCallbackType:o.CREATE_GOOGLE_SHEETS},l={imageUrl:"/static/images/growth/personalization/collections_exp/Decide_who_can_edit_folders-vfl3MUfmT.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Decide_who_can_edit_folders@2x-vflzQOJeG.png",title:r.intl.formatMessage({id:"vhvaO9",defaultMessage:"Decide who can edit folders"}),loggingTitle:"folder_settings",desc:r.intl.formatMessage({id:"jSmn2k",defaultMessage:"Give specific people permission to edit or view-only access for individual folders."}),buttonText:r.intl.formatMessage({id:"+pTjXN",defaultMessage:"Open folder settings"}),actionCallbackType:o.OPEN_SHARE_MODAL,shareModalSettingsTab:"folder_settings"},c={imageUrl:"/static/images/growth/personalization/collections_exp/Have_total_control_of_shared_links-vflyAyrmd.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Have_total_control_of_shared_links@2x-vflfnAKvn.png",title:r.intl.formatMessage({id:"6oKVMW",defaultMessage:"Have total control of shared links"}),loggingTitle:"link_settings",desc:r.intl.formatMessage({id:"z4ud8c",defaultMessage:"Set passwords, disable downloads, and set expirations dates on anything you share with a link."}),buttonText:r.intl.formatMessage({id:"Q9UABZ",defaultMessage:"Open link settings"}),actionCallbackType:o.OPEN_SHARE_MODAL,shareModalSettingsTab:"view_link_settings"},d={imageUrl:"/static/images/growth/personalization/collections_exp/Watermark_your_PDFs_and_photos-vflkjxZpk.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Watermark_your_PDFs_and_photos@2x-vfl4utj4c.png",title:r.intl.formatMessage({id:"0ZcoHO",defaultMessage:"Watermark your PDFs and photos"}),loggingTitle:"watermark",desc:r.intl.formatMessage({id:"UYiZrN",defaultMessage:"When you preview a file in Dropbox, you can watermark it with your logos or text."}),buttonText:r.intl.formatMessage({id:"gk12sS",defaultMessage:"Learn more"}),actionCallbackType:o.REDIRECT,redirectLink:t.WATERMARK_LINK},u={imageUrl:"/static/images/growth/personalization/collections_exp/Comment_and_annotate_on_files-vfl-sZwtU.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Comment_and_annotate_on_files@2x-vflg-KF4w.png",title:r.intl.formatMessage({id:"6uwoJY",defaultMessage:"Comment and annotate on files"}),loggingTitle:"comment_files",desc:r.intl.formatMessage({id:"xqj2eW",defaultMessage:"Mention teammates on specific areas of files for targeted feedback."}),buttonText:r.intl.formatMessage({id:"8m53T6",defaultMessage:"Upload file and try"}),actionCallbackType:o.UPLOAD},_={imageUrl:"/static/images/growth/personalization/collections_exp/Request_files_from_others-vflvy4CGu.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Request_files_from_others@2x-vflms8zVt.png",title:r.intl.formatMessage({id:"bgGX06",defaultMessage:"Request files from others"}),loggingTitle:"request_files",desc:r.intl.formatMessage({id:"BqqQJn",defaultMessage:"Collect and receive large files from anyone-right in your Dropbox account."}),buttonText:r.intl.formatMessage({id:"34LFfx",defaultMessage:"Try file request"}),actionCallbackType:o.REDIRECT,redirectLink:t.FILE_REQUEST_LINK},p={imageUrl:"/static/images/growth/personalization/collections_exp/Brainstorming-vflzwizf3.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Brainstorming@2x-vfljrvaTs.png",title:r.intl.formatMessage({id:"mIVTjA",defaultMessage:"Brainstorming"}),loggingTitle:"brainstorming",desc:r.intl.formatMessage({id:"8yBNxI",defaultMessage:"Collect inspiration, exchange ideas in real-time, and get feedback."}),buttonText:r.intl.formatMessage({id:"KLVfpZ",defaultMessage:"Create doc"}),actionCallbackType:o.CREATE_PAPER_TEMPLATE,paperTemplateSlugId:"brainstorm"},f={imageUrl:"/static/images/growth/personalization/collections_exp/Brand_guidelines-vfl73kagH.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Brand_guidelines@2x-vflWEdsrX.png",title:r.intl.formatMessage({id:"qpwvDp",defaultMessage:"Brand guidelines"}),loggingTitle:"brand_guidelines",desc:r.intl.formatMessage({id:"PhOzXb",defaultMessage:"Craft guidelines that help everyone create written and visual materials."}),buttonText:r.intl.formatMessage({id:"KLVfpZ",defaultMessage:"Create doc"}),actionCallbackType:o.CREATE_PAPER_TEMPLATE,paperTemplateSlugId:"brand-guidelines"},m={imageUrl:"/static/images/growth/personalization/collections_exp/Creative_brief-vflzoR7nu.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Creative_brief@2x-vflfJwHyd.png",title:r.intl.formatMessage({id:"4HhApp",defaultMessage:"Creative brief"}),loggingTitle:"creative_brief",desc:r.intl.formatMessage({id:"+2jNKl",defaultMessage:"Capture project information, share deliverables, and collect targeted feedback in a single doc."}),buttonText:r.intl.formatMessage({id:"KLVfpZ",defaultMessage:"Create doc"}),actionCallbackType:o.CREATE_PAPER_TEMPLATE,paperTemplateSlugId:"creative-brief"},g={imageUrl:"/static/images/growth/personalization/collections_exp/Hiring_doc-vfl7-KGxC.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Hiring_doc@2x-vfltl18DZ.png",title:r.intl.formatMessage({id:"Ob69jI",defaultMessage:"Hiring doc"}),loggingTitle:"hiring_doc",desc:r.intl.formatMessage({id:"/MXP6f",defaultMessage:"Consolidate candidate data, manage interview schedules, and co-edit interview questions."}),buttonText:r.intl.formatMessage({id:"KLVfpZ",defaultMessage:"Create doc"}),actionCallbackType:o.CREATE_PAPER_TEMPLATE,paperTemplateSlugId:"hiring-doc"},h={imageUrl:"/static/images/growth/personalization/collections_exp/Launch_plan-vflUr4YEg.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Launch_plan@2x-vflBHVqHw.png",title:r.intl.formatMessage({id:"eJBiUX",defaultMessage:"Launch plan"}),loggingTitle:"launch_plan",desc:r.intl.formatMessage({id:"Dnp+hz",defaultMessage:"Coordinate teams by setting milestones, assigning to-dos, and managing approvals."}),buttonText:r.intl.formatMessage({id:"KLVfpZ",defaultMessage:"Create doc"}),actionCallbackType:o.CREATE_PAPER_TEMPLATE,paperTemplateSlugId:"launch-plan"},S={imageUrl:"/static/images/growth/personalization/collections_exp/More_templates-vflPM9mUx.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/More_templates@2x-vflu1bMcB.png",title:r.intl.formatMessage({id:"o6Oqk/",defaultMessage:"More templates"}),loggingTitle:"more_templates",desc:"",buttonText:r.intl.formatMessage({id:"SJ7MeI",defaultMessage:"See all templates"}),actionCallbackType:o.REDIRECT,redirectLink:t.PAPER_TEMPLATES_LINK},E={imageUrl:"/static/images/growth/personalization/collections_exp/New_hire_onboarding-vflhJapds.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/New_hire_onboarding@2x-vfl6PxFtO.png",title:r.intl.formatMessage({id:"ZTukLA",defaultMessage:"New hire onboarding"}),loggingTitle:"new_hire_onboarding",desc:r.intl.formatMessage({id:"eHWzWM",defaultMessage:"Centralize information to help new employees get started during their first few days."}),buttonText:r.intl.formatMessage({id:"KLVfpZ",defaultMessage:"Create doc"}),actionCallbackType:o.CREATE_PAPER_TEMPLATE,paperTemplateSlugId:"new-hire-onboarding"},v={imageUrl:"/static/images/growth/personalization/collections_exp/Project_plan-vfleFZaG-.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Project_plan@2x-vfl7tdW9j.png",title:r.intl.formatMessage({id:"WAEQqE",defaultMessage:"Project plan"}),loggingTitle:"project_plan",desc:r.intl.formatMessage({id:"7kQoXu",defaultMessage:"Organize and track work from start to finish. Help your team stay updated on who's doing what."}),buttonText:r.intl.formatMessage({id:"KLVfpZ",defaultMessage:"Create doc"}),actionCallbackType:o.CREATE_PAPER_TEMPLATE,paperTemplateSlugId:"project-plan"},T={accounting:[v,{imageUrl:"/static/images/growth/personalization/collections_exp/Team_checklist-vflYtWkbF.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Team_checklist@2x-vfl-cPX_9.png",title:r.intl.formatMessage({id:"FAZpqt",defaultMessage:"Team checklist"}),loggingTitle:"team_checklist",desc:r.intl.formatMessage({id:"k9LVWK",defaultMessage:"Manage team to-dos with task assignments, due dates, and reminder notifications."}),buttonText:r.intl.formatMessage({id:"KLVfpZ",defaultMessage:"Create doc"}),actionCallbackType:o.CREATE_PAPER_TEMPLATE,paperTemplateSlugId:"team-checklist"},S],human_resources:[E,g,S],self_employed:[v,p,S],marketing:[h,f,S],art:[m,{imageUrl:"/static/images/growth/personalization/collections_exp/Video_production_plan-vfltPey9e.png",imageHiResUrl:"/static/images/growth/personalization/collections_exp/Video_production_plan@2x-vflnUV7G8.png",title:r.intl.formatMessage({id:"qLearS",defaultMessage:"Video production plan"}),loggingTitle:"video_production_plan",desc:r.intl.formatMessage({id:"w4SaFl",defaultMessage:"Stay organized and on track from pre- to post-production. Add scripts, music, video, timelines, and budgets."}),buttonText:r.intl.formatMessage({id:"KLVfpZ",defaultMessage:"Create doc"}),actionCallbackType:o.CREATE_PAPER_TEMPLATE,paperTemplateSlugId:"video-production-plan"},S]};t.collectionPanelConfig=function(e,t){switch(t){case n.CollectionFolderType.SHARING:return{overviewDesc:r.intl.formatMessage({id:"8i5CD2",defaultMessage:"We've got ways to make sure files stay protected—however you decide to share them."}),actionsTitle:r.intl.formatMessage({id:"0Pf729",defaultMessage:"Things to try"}),actions:[l,c,d]};case n.CollectionFolderType.SPREADSHEET:return{overviewDesc:r.intl.formatMessage({id:"rKBrhz",defaultMessage:"If you work on files with other people, here’s how to prevent unwanted changes."}),actionsTitle:r.intl.formatMessage({id:"0Pf729",defaultMessage:"Things to try"}),actions:[i,a,s]};case n.CollectionFolderType.PAPER:return{overviewDesc:r.intl.formatMessage({id:"deyLLm",defaultMessage:"Here are some Dropbox Paper templates we think would be most helpful for your role."}),actionsTitle:r.intl.formatMessage({id:"JI9VaJ",defaultMessage:"Try these templates"}),actions:T[e]};case n.CollectionFolderType.FEEDBACK:return{overviewDesc:r.intl.formatMessage({id:"rwgI/k",defaultMessage:"Whether you prefer comments, requesting docs, or private feedback—these tools can help."}),actionsTitle:r.intl.formatMessage({id:"0Pf729",defaultMessage:"Things to try"}),actions:[_,c,u]};default:return}},t.overviewTitle=r.intl.formatMessage({id:"Dvwua+",defaultMessage:"Overview"})})),define("modules/clean/react/growth/personalization/util",["require","exports"],(function(e,t){"use strict";var r,n,o,i;function a(e){return(null==e?void 0:e.firstPath)||r.NONE}function s(e,t){var o=null==t?void 0:t.desktopCtaType;return o?a(t)===r.DOWNLOAD_APP.valueOf()?l(e,t)?o:n.ShowWithText:o:null}function l(e,t){return!!(null==t?void 0:t.enableDownloadAppPanel)&&e<=1}Object.defineProperty(t,"__esModule",{value:!0}),t.shouldShowSplitTmfTsdEmptyState=t.shouldFirstPathHaveDropTargetIcon=t.enableCreateFolderCta=t.enableCollectionsQuickActions=t.enableDownloadAppPanel=t.enableDesktopCta=t.enableInvitePanel=t.enableHideSelectionPreviewPane=t.enableHideRightsideActions=t.enableHideFolderOverview=t.getSuggestedFoldersType=t.getDesktopCtaType=t.getRole=t.getFirstPath=t.shouldLogFullFunnelVideoSnackbarExposure=t.shouldEnableFullFunnelVideoSnackbar=t.OnboardingInterest=t.SlimMode=t.emptyStateType=t.CollectionsQuickActionsRoleGroup=t.DropTargetBgColorType=t.SuggestedFoldersType=t.DesktopCtaType=t.FirstPathId=void 0,(function(e){e.INVITE_MEMBER="invite",e.UPLOAD_FOLDERS="upload",e.SUGGESTED_FOLDERS="folder",e.DOWNLOAD_APP="download",e.EXPLORE="explore",e.COLLECTIONS="collections",e.SUGGESTED_FOLDERS_ITERATION="suggested_folders_iteration",e.SPLIT_TMF_TSD="split_tmf_tsd",e.NONE=""})(r=t.FirstPathId||(t.FirstPathId={})),(function(e){e[e.ShowWithoutText=1]="ShowWithoutText",e[e.ShowWithText=2]="ShowWithText",e[e.ShowWithTextAsPrimary=3]="ShowWithTextAsPrimary"})(n=t.DesktopCtaType||(t.DesktopCtaType={})),(function(e){e[e.None=0]="None",e[e.SuggestedFoldersAsBar=1]="SuggestedFoldersAsBar",e[e.SuggestedFolders=2]="SuggestedFolders",e[e.SuggestedFoldersWithDismissAll=3]="SuggestedFoldersWithDismissAll"})(o=t.SuggestedFoldersType||(t.SuggestedFoldersType={})),(function(e){e[e.Blue=1]="Blue"})(t.DropTargetBgColorType||(t.DropTargetBgColorType={})),(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.ADMIN_SUPPORT=1]="ADMIN_SUPPORT",e[e.ACCOUNTING_FINANCE=2]="ACCOUNTING_FINANCE",e[e.LEGAL=3]="LEGAL",e[e.IT_INFOSEC=4]="IT_INFOSEC",e[e.ART_DESIGN_CREATIVE=5]="ART_DESIGN_CREATIVE",e[e.MARKETING=6]="MARKETING",e[e.SELF_EMPLOYED_FREELANCE=7]="SELF_EMPLOYED_FREELANCE",e[e.HR=8]="HR"})(t.CollectionsQuickActionsRoleGroup||(t.CollectionsQuickActionsRoleGroup={})),(function(e){e.DROP_TARGET_VIEW="drop_target_view",e.INVITE_VIEW="invite_view",e.SUGGESTED_FOLDERS_VIEW="suggested_folders_view",e.SUGGESTED_FOLDERS_TOGGLE_VIEW="suggested_folders_toggle_view",e.DOWNLOAD_APP_VIEW="download_app_view"})(t.emptyStateType||(t.emptyStateType={})),(function(e){e[e.None=0]="None",e[e.Slim=1]="Slim",e[e.SplitTmfTsdSlim=2]="SplitTmfTsdSlim"})(t.SlimMode||(t.SlimMode={})),(function(e){e[e.UNSET=0]="UNSET",e[e.VIDEO_SHARE=1]="VIDEO_SHARE"})(i=t.OnboardingInterest||(t.OnboardingInterest={})),t.shouldEnableFullFunnelVideoSnackbar=function(e){return"V2"===(null==e?void 0:e.variant)&&(null==e?void 0:e.onboarding_interest)===i.VIDEO_SHARE},t.shouldLogFullFunnelVideoSnackbarExposure=function(e){return void 0!==(null==e?void 0:e.variant)&&["CONTROL","V2"].includes(e.variant)&&(null==e?void 0:e.onboarding_interest)===i.VIDEO_SHARE},t.getFirstPath=a,t.getRole=function(e){return(null==e?void 0:e.role)||""},t.getDesktopCtaType=s,t.getSuggestedFoldersType=function(e){return(null==e?void 0:e.suggestedFoldersType)||o.None},t.enableHideFolderOverview=function(e,t){var r;return!!(null===(r=null==t?void 0:t.hiddenState)||void 0===r?void 0:r.hideFolderOverview)&&e<=4},t.enableHideRightsideActions=function(e){var t;return!!(null===(t=null==e?void 0:e.hiddenState)||void 0===t?void 0:t.hideRightsideActions)},t.enableHideSelectionPreviewPane=function(e,t,n){if(void 0===n)return!1;var o=t<=1;return n.firstPath===r.SPLIT_TMF_TSD.valueOf()?o||e<=1:o},t.enableInvitePanel=function(e){return!!(null==e?void 0:e.enableInvitePanel)},t.enableDesktopCta=function(e,t,n){if(!s(t,n))return!1;var o=a(n);return o===r.UPLOAD_FOLDERS.valueOf()||o===r.SUGGESTED_FOLDERS.valueOf()?t>1:o!==r.INVITE_MEMBER.valueOf()||(e>1||t>1)},t.enableDownloadAppPanel=l,t.enableCollectionsQuickActions=function(e){return!!(null==e?void 0:e.enableCollectionsQuickActions)},t.enableCreateFolderCta=function(e,t){if(void 0===t)return e;var n=t.firstPath;return-1!==[r.SPLIT_TMF_TSD.valueOf()].indexOf(n)&&e},t.shouldFirstPathHaveDropTargetIcon=function(e){return void 0!==e&&-1!==[r.COLLECTIONS.valueOf(),r.SUGGESTED_FOLDERS_ITERATION.valueOf(),r.SPLIT_TMF_TSD.valueOf()].indexOf(e)},t.shouldShowSplitTmfTsdEmptyState=function(e,t,r,n){return e&&t&&"/Team Files"===r&&0===n}})),define("modules/clean/react/hooks/usePrevious",["require","exports","react"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.usePrevious=void 0,t.usePrevious=function(e){var t=r.useRef();return r.useEffect((function(){t.current=e}),[e]),t.current}})),define("modules/clean/react/new_file_menu/new_file_icon",["require","exports","tslib","react","spectrum/icon_partners/index","modules/clean/static_urls"],(function(e,t,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NewFileIcon=void 0,n=r.__importDefault(n);var a={dropbox_form:i.static_url("/static/images/dropbox_form-vfl1f-v2W.svg")};t.NewFileIcon=function(e){var t=e.iconName,r=e.displayName,i=a[t];return i?n.default.createElement("img",{alt:r,src:i,width:"24px",height:"24px"}):n.default.createElement(o.IconPartners,{name:t,width:"24px",height:"24px"})},t.NewFileIcon.displayName="NewFileIcon"})),define("modules/clean/react/new_file_menu/new_file_menu",["require","exports","tslib","classnames","react","dig-components/buttons","dig-components/typography","dig-components/menu","modules/clean/cloud_docs/constants","modules/clean/cloud_docs/create_api","modules/clean/react/browse/action_logger","modules/clean/react/components/css","modules/clean/web_user_action_events","modules/constants/page_load","modules/clean/react/new_file_menu/new_file_icon","modules/clean/react/new_file_menu/new_file_util"],(function(e,t,r,n,o,i,a,s,l,c,d,u,_,p,f,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NewFileMenu=t.NewFileTypeRow=t.handleNewFileSelection=void 0,n=r.__importDefault(n),o=r.__importDefault(o),p=r.__importStar(p),t.handleNewFileSelection=function(e){e.handleClick()};var g=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return o.default.createElement(s.Menu.ActionItem,{key:this.props.item.displayName,value:this.props.item,className:this.props.item.className,withLeftAccessory:o.default.createElement(f.NewFileIcon,{displayName:this.props.item.displayName,iconName:this.props.item.iconName})},o.default.createElement(a.Text,null,this.props.item.displayName))},t.displayName="NewFileTypeRow",t})(o.default.Component);t.NewFileTypeRow=g;var h=(function(e){function a(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleCreateNewFile=function(e){return function(){var r=t.props,n=r.selection_mode,o=r.empty_folder,i=function(r){c.showAsyncFolderDialog({user:t.props.user,source:t.props.source,documentType:e,selection_mode:n,empty_folder:o,handleClickNewFolder:t.props.handleClickNewFolder?t.props.handleClickNewFolder(t.props.user,i):void 0,initialPath:r})};d.logFileCreateClick({uid:t.props.user.id,source:t.props.source,action:m.newFileTypeToLogEvent(e),depth_folder_selected:t.props.path?c.getDepthFromPath(t.props.path):void 0,selection_mode:n,empty_folder:o}),t.props.path?c.createNewFile({user:t.props.user,path:t.props.path,documentType:e,source:t.props.source,selection_mode:n,empty_folder:o}):i()}},t.logTriggerClick=function(){var e=t.props,r=e.empty_folder,n=e.selection_mode,o=e.path,i=e.user,a=e.source;d.logFileCreateClick({uid:i.id,source:a,action:_.WebUserActionLogEvent.FILE_CREATE_OPEN_MENU,depth_folder_selected:o?c.getDepthFromPath(o):void 0,selection_mode:n,empty_folder:r})},t}return r.__extends(a,e),a.prototype.getNewFileTypeSections=function(){var e=[],t=[];this.props.showPaper&&(t.push({displayName:m.NewPaperDocLabel,iconName:"dropbox_paper",className:"action-create-file-paper-doc",handleClick:this.handleCreateNewFile(l.PaperNewFileTypes.PAPER)}),t.push({displayName:m.NewPaperTemplateLabel,iconName:"dropbox_paper_template",className:"action-create-file-paper-template",handleClick:this.handleCreateNewFile(l.PaperNewFileTypes.PAPER_TEMPLATE)})),this.props.showBinder&&t.push({displayName:m.NewPaperBinderDocLabel,iconName:"dropbox_paper_binder",className:"action-create-file-paper-binder",handleClick:this.handleCreateNewFile(l.PaperNewFileTypes.PAPER_BINDER)}),t.push({displayName:m.NewSimplePointerLabel,iconName:"shortcut",className:"action-create-simple-pointer",handleClick:this.handleCreateNewFile(l.PointerFileTypes.SIMPLE_POINTER)}),t.length>0&&e.push(t);var r=[];if(r.push({displayName:m.NewMicrosoftWordDocLabel,iconName:"microsoft_docx",className:"action-create-file-word",handleClick:this.handleCreateNewFile(l.MicrosoftFileTypes.WORD)}),r.push({displayName:m.NewMicrosoftExcelWorkbookLabel,iconName:"microsoft_xlsx",className:"action-create-file-excel",handleClick:this.handleCreateNewFile(l.MicrosoftFileTypes.EXCEL)}),r.push({displayName:m.NewMicrosoftPowerPointPresentationLabel,iconName:"microsoft_pptx",className:"action-create-file-powerpoint",handleClick:this.handleCreateNewFile(l.MicrosoftFileTypes.POWERPOINT)}),e.push(r),this.props.showGdd){var n=[];n.push({displayName:m.NewGoogleDocsLabel,iconName:"google_gdoc",className:"action-create-file-google-doc",handleClick:this.handleCreateNewFile(l.GoogleFileTypes.GOOGLE_DSS_DOC)}),n.push({displayName:m.NewGoogleSheetsLabel,iconName:"google_gsheet",className:"action-create-file-google-sheet",handleClick:this.handleCreateNewFile(l.GoogleFileTypes.GOOGLE_DSS_SHEET)}),n.push({displayName:m.NewGoogleSlidesLabel,iconName:"google_gslides",className:"action-create-file-google-slides",handleClick:this.handleCreateNewFile(l.GoogleFileTypes.GOOGLE_DSS_SLIDES)}),e.push(n)}return e},a.prototype.renderTrigger=function(e){var t=0===p.USER_LOCALE.indexOf("en")||this.props.forceLongLabel?m.LongNewFileCreateLabel:m.ShortNewFileCreateLabel,a=r.__assign(r.__assign({},e),{disabled:this.props.disabled,className:n.default("primary-action-menu__button","action-create-file"),variant:this.props.enableSecondary?"opacity":"primary"});return o.default.createElement(i.Button,r.__assign({key:m.LongNewFileCreateLabel,withDropdownIcon:!0},a),t)},a.prototype.renderSection=function(e,t){return o.default.createElement(s.Menu.Segment,{key:t},e.map((function(e){return o.default.createElement(g,{item:e,key:e.displayName})})))},a.prototype.render=function(){var e=this,n=this.getNewFileTypeSections();return o.default.createElement(s.Menu.Wrapper,{onToggle:this.logTriggerClick,onSelection:t.handleNewFileSelection},(function(t){var i=t.getContentProps,a=t.getTriggerProps;return o.default.createElement(o.default.Fragment,null,e.renderTrigger(a()),o.default.createElement(s.Menu.Content,r.__assign({},i()),n.map(e.renderSection)))}))},a.defaultProps={},a.displayName="NewFileMenu",a})(o.default.Component),S=u.requireCssWithComponent(h,["/static/css/dig-components/index.web-vflfsfj-g.css","/static/css/cloud_docs/create_pointer_modal-vflATc8Dt.css"]);t.NewFileMenu=S})),define("modules/clean/react/new_file_menu/new_file_util",["require","exports","modules/clean/cloud_docs/constants","modules/clean/web_user_action_events","modules/core/i18n"],(function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.newFileTypeToLogEvent=t.NewSimplePointerLabel=t.NewPaperBinderDocLabel=t.NewPaperTemplateLabel=t.NewPaperDocLabel=t.NewMicrosoftWordDocLabel=t.NewMicrosoftPowerPointPresentationLabel=t.NewMicrosoftExcelWorkbookLabel=t.NewGoogleSlidesLabel=t.NewGoogleSheetsLabel=t.NewGoogleDocsLabel=t.ShortNewFileCreateLabel=t.LongNewFileCreateLabel=void 0,t.LongNewFileCreateLabel=o.intl.formatMessage({id:"8/w9ir",defaultMessage:"Create new file"}),t.ShortNewFileCreateLabel=o.intl.formatMessage({id:"o96TiK",defaultMessage:"Create"}),t.NewGoogleDocsLabel=o.intl.formatMessage({id:"+HsOFj",defaultMessage:"Google Docs"}),t.NewGoogleSheetsLabel=o.intl.formatMessage({id:"cpuRML",defaultMessage:"Google Sheets"}),t.NewGoogleSlidesLabel=o.intl.formatMessage({id:"PcJCVL",defaultMessage:"Google Slides"}),t.NewMicrosoftExcelWorkbookLabel=o.intl.formatMessage({id:"0rYKaW",defaultMessage:"Excel Workbook"}),t.NewMicrosoftPowerPointPresentationLabel=o.intl.formatMessage({id:"e9uLbL",defaultMessage:"PowerPoint Presentation"}),t.NewMicrosoftWordDocLabel=o.intl.formatMessage({id:"yY5byF",defaultMessage:"Word Document"}),t.NewPaperDocLabel=o.intl.formatMessage({id:"neBk7u",defaultMessage:"Dropbox Paper"}),t.NewPaperTemplateLabel=o.intl.formatMessage({id:"Rvv7NR",defaultMessage:"Dropbox Paper Template"}),t.NewPaperBinderDocLabel=o.intl.formatMessage({id:"sbO30Y",defaultMessage:"Dropbox Binder (Beta)"}),t.NewSimplePointerLabel=o.intl.formatMessage({id:"4gEt6j",defaultMessage:"Shortcut"}),t.newFileTypeToLogEvent=function(e){switch(e){case r.MicrosoftFileTypes.WORD:return n.WebUserActionLogEvent.FILE_CREATE_WORD;case r.MicrosoftFileTypes.EXCEL:return n.WebUserActionLogEvent.FILE_CREATE_EXCEL;case r.MicrosoftFileTypes.POWERPOINT:return n.WebUserActionLogEvent.FILE_CREATE_POWERPOINT;case r.GoogleFileTypes.GOOGLE_DSS_DOC:return n.WebUserActionLogEvent.FILE_CREATE_GOOGLE_DOC;case r.GoogleFileTypes.GOOGLE_DSS_SHEET:return n.WebUserActionLogEvent.FILE_CREATE_GOOGLE_SHEET;case r.GoogleFileTypes.GOOGLE_DSS_SLIDES:return n.WebUserActionLogEvent.FILE_CREATE_GOOGLE_SLIDES;case r.PaperNewFileTypes.PAPER:return n.WebUserActionLogEvent.FILE_CREATE_PAPER;case r.PaperNewFileTypes.PAPER_TEMPLATE:return n.WebUserActionLogEvent.FILE_CREATE_PAPER_TEMPLATE;case r.PaperNewFileTypes.PAPER_BINDER:return n.WebUserActionLogEvent.FILE_CREATE_BINDER;case r.PointerFileTypes.SIMPLE_POINTER:return n.WebUserActionLogEvent.FILE_CREATE_SIMPLE_POINTER}}})),define("modules/clean/react/path_breadcrumbs",["require","exports","tslib","classnames","react","dig-components/buttons","dig-components/icons","dig-components/icons/src","dig-components/menu","dig-components/typography","spectrum/icon_content/index","modules/clean/em_string","modules/clean/filepath/filepath","modules/clean/react/icon/icon_helper","modules/clean/react/title_bubble","modules/clean/user_education/react/user_education_effect","modules/clean/web_timing_logger","modules/core/i18n","modules/clean/react/sticky_position","modules/clean/react/flows/components/badge_async","modules/clean/pnm/utils"],(function(e,t,r,n,o,i,a,s,l,c,d,u,_,p,f,m,g,h,S,E,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BreadcrumbMenuItem=t.BreadcrumbSegment=t.PathBreadcrumbs=t.PathBreadcrumbsSize=t.generateBreadcrumbData=void 0,n=r.__importDefault(n),o=r.__importDefault(o),s=r.__importStar(s),_=r.__importStar(_);var T;function w(e,t,r){return void 0===r&&(r=20),r-(t?2.625:new u.Emstring(e).length)}function I(e,t,r,n,o,i){void 0===o&&(o=20);for(var a=null!=i?i:"",s=e.substring(a.length).split("/").filter(Boolean),l=[{path:a,icon:"folder_dropbox-small",folderName:t,alt:r}],c=p.spectrumFolderIcon({size:p.SpectrumIconSize.Small}),d=0;d<s.length;d++)e=a+"/"+s.slice(0,d+1).join("/"),l.push({path:e,folderName:v.getDisplayedFilename(_.filename(e)),icon:c,alt:h.intl.formatMessage({id:"MLqiSW",defaultMessage:"Folder"})});if(l.length<3)return{dropdownCrumbs:[],inlineCrumbs:l,root:l[0]};var f=w(l[0]&&l[0].folderName||"",!1,o),m=l.map((function(e){return new u.Emstring(e.folderName||"").length})),g=1,S=m[l.length-1];for(d=l.length-2;d>=1&&(S+=1.64,!((S+=m[d])>f));d--)g+=1;l.length===g+1&&(g+=1),1===g&&n===T.SMALL&&g++;var E=l.length-g;return{dropdownCrumbs:l.slice(0,E),inlineCrumbs:l.slice(E),root:l[0]}}t.generateBreadcrumbData=I,(function(e){e.LARGE="LARGE",e.SMALL="SMALL"})(T=t.PathBreadcrumbsSize||(t.PathBreadcrumbsSize={}));var b=(function(e){function t(t){var r=e.call(this,t)||this;r._breadcrumbContainerElement=null,r._flowsBadgeElement=null,r.resizeListener=function(){var e=r.getBreadcrumbsContainerSpan();if(e){var t=e.getBoundingClientRect().width;if(r.props.mobileWebInvites&&(t-=20),r.props.flowsFolderRule){var n=r.getFlowsBadgeSpan();t-=n?n.getBoundingClientRect().width+16:0}var o=Math.max(0,r.getMaxWidthInEm(t));o!==r.state.maxWidthInEm&&o>0&&r.setState({maxWidthInEm:o})}},r.handleTitleClick=function(e){return function(t){var n=e.path;if(0===t.button){if(t.altKey||t.ctrlKey||t.metaKey||t.shiftKey)return void t.stopPropagation();t.preventDefault(),t.stopPropagation(),r.props.setUrl({path:n})}}};var n=r.getBreadcrumbsContainerSpan();return r.state={maxWidthInEm:n?r.getMaxWidthInEm(n.getBoundingClientRect().width):20},r}return r.__extends(t,e),t.prototype.getBreadcrumbsContainerSpan=function(){if(!this._breadcrumbContainerElement){var e=document.getElementsByClassName("maestro-app-content");e&&1===e.length&&(this._breadcrumbContainerElement=e[0])}return this._breadcrumbContainerElement},t.prototype.getFlowsBadgeSpan=function(){var e=document.querySelector(".flows-badge");return!this._flowsBadgeElement&&e&&(this._flowsBadgeElement=e),this._flowsBadgeElement},t.prototype.getMaxWidthInEm=function(e){return(e-100)/22},t.prototype.componentDidMount=function(){var e=this;window.addEventListener("resize",this.resizeListener),g.waitForTTI().then((function(){return e.resizeListener()}))},t.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.resizeListener)},t.prototype.componentDidUpdate=function(e){e.mobileWebInvites!==this.props.mobileWebInvites&&this.resizeListener()},t.prototype.render=function(){var e=this,t=this.props.path,i=this.props,a=i.firstBreadcrumbName,s=i.firstBreadcrumbAlt,l=i.firstBreadcrumbPath,d=i.shouldHighlightDropTargets,u=i.setFileUploaderPath,p=i.getUrlForPath,f=i.setUrl,g=i.size,S=i.enableDragging,v=i.flowsFolderRule,b=i.expFlowsAutomatedFolderUI,C=this.state.maxWidthInEm?this.state.maxWidthInEm:20,R=I(t,a,s,g,C,l),A=R.dropdownCrumbs,y=R.inlineCrumbs,D=R.root,L=w(D&&D.folderName||"",A.length>0,C),M=n.default({"brws-path-breadcrumbs":!0,"brws-path-breadcrumbs--small":this.props.size===T.SMALL});if(y.length>1||A.length>0)return o.default.createElement("span",{className:M},o.default.createElement("h1",{className:"ax-visually-hidden"},_.filename(t)),o.default.createElement("nav",{className:"page-header-text u-l-fl",id:"path-breadcrumbs","aria-label":h.intl.formatMessage({id:"SzftTr",defaultMessage:"Folder hierarchy"}),role:"navigation"},A.length>0&&o.default.createElement(O,{crumbs:A,currentPath:t,shouldHighlightDropTargets:d,setFileUploaderPath:u,setUrl:f,enableDragging:!!S,onTitleClick:this.handleTitleClick,getUrlForPath:p}),y.map((function(n,i){return o.default.createElement(F,r.__assign({},n,{key:encodeURI(n.path),isOnlyCrumb:0===i&&1===y.length&&0===A.length,index:i,isLastCrumb:i===y.length-1,maxWidth:L,currentPath:t,shouldHighlightDropTargets:d,setFileUploaderPath:u,getUrlForPath:p,setUrl:f,size:g,enableDragging:!!S,onTitleClick:e.handleTitleClick(n)}))}))),!!v&&o.default.createElement(E.AsyncBadgeComponent,{type:v,isInUnifiedModal:!!b,isFolderFocused:!0}));var N=g===T.SMALL?c.Text:c.Title,P=g===T.SMALL?"small":"standard";return o.default.createElement(m.UserEducationEffect,{containerName:"PathBreadcrumbs",name:"HomeTitle",useSpan:!0},o.default.createElement(N,{size:P,className:"page-header-text"},a))},t.defaultProps={path:"/",shouldHighlightDropTargets:!1,setFileUploaderPath:function(){},size:T.LARGE,enableDragging:!1},t.displayName="PathBreadcrumbs",t})(o.default.PureComponent);t.PathBreadcrumbs=b;var F=(function(e){function t(t){var r=e.call(this,t)||this;return r.handleDragEnter=function(e){e.preventDefault(),e.target!==r.lastEnteredElement&&r.props.enableDragging&&(r.lastEnteredElement=e.target,r.dragEnterCount+=1,r.setState({isDraggedOver:!0}),r.props.isLastCrumb||r.props.setFileUploaderPath({path:r.props.path,targetSurface:"breadcrumb"}))},r.handleDragLeave=function(e){e.preventDefault(),r.props.enableDragging&&(r.lastEnteredElement=null,r.dragEnterCount-=1,r.dragEnterCount<1&&(r.dragEnterCount=0,r.state.isDraggedOver&&(r.props.setFileUploaderPath({path:r.props.currentPath}),r.setState({isDraggedOver:!1}))))},r.handleDrop=function(){r.setState({isDraggedOver:!1})},r.handleDragOver=function(e){e.preventDefault(),e.stopPropagation()},r.handleMouseEnter=function(){r.props.enableDragging||r.setState({isDraggedOver:!0})},r.handleMouseLeave=function(){r.state.isDraggedOver&&r.setState({isDraggedOver:!1})},r.handleMouseUp=function(){r.state.isDraggedOver&&r.setState({isDraggedOver:!1})},r.eventHandlers={onDragEnter:r.handleDragEnter,onDragLeave:r.handleDragLeave,onDrop:r.handleDrop,onDragOver:r.handleDragOver,onMouseEnter:r.handleMouseEnter,onMouseLeave:r.handleMouseLeave,onMouseUp:r.handleMouseUp},r.state={isDraggedOver:!1},r}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.dragEnterCount=0,this.lastEnteredElement=null},t.prototype.render=function(){var e,t=this.props,i=t.getUrlForPath,l=t.path,d=t.index,_=t.isOnlyCrumb,p=t.maxWidth,g=t.isLastCrumb,h=t.shouldHighlightDropTargets,E=t.size,v=_?this.props.folderName:u.Emstring.em_snippet(this.props.folderName,p),w={"breadcrumb-segment":!0,"breadcrumb-text-dragged-over":!g&&h&&this.state.isDraggedOver},I=E===T.SMALL?c.Text:c.Title,b=E===T.SMALL?"small":"standard";return e=g?o.default.createElement(I,r.__assign({size:b,"aria-current":"page"},this.eventHandlers,{"data-testid":"breadcrumb-segment"}),v):o.default.createElement("span",r.__assign({className:"breadcrumb-segment__wrapper"},this.eventHandlers),o.default.createElement(m.UserEducationEffect,{containerName:"BreadcrumbSegment",name:"link-"+d,useSpan:!0},o.default.createElement(I,{size:b,color:"faint"},o.default.createElement("a",{href:i(l).toString(),onClick:this.props.onTitleClick,className:n.default(w),"data-testid":"breadcrumb-segment"},v),o.default.createElement(a.UIIcon,{src:s.ChevronRightLine,size:"small",className:"breadcrumb__spacer"})))),this.props.folderName!==v?o.default.createElement(f.TitleBubble,{content:this.props.folderName,position:S.StickyPosition.BOTTOM,className:"list-label__title-bubble"},e):e},t.defaultProps={isOnlyCrumb:!1,shouldHighlightDropTargets:!1,disableDragging:!1},t.displayName="BreadcrumbSegment",t})(o.default.Component);t.BreadcrumbSegment=F;var C=(function(e){function t(t){var r=e.call(this,t)||this;return r.handleDragEnter=function(e){e.preventDefault(),e.target!==r.lastEnteredElement&&r.props.enableDragging&&(r.lastEnteredElement=e.target,r.dragEnterCount+=1,r.setState({isDraggedOver:!0}),r.props.setFileUploaderPath({path:r.props.path,targetSurface:"breadcrumb"}))},r.handleDragLeave=function(e){e.preventDefault(),r.props.enableDragging&&(r.lastEnteredElement=null,r.dragEnterCount-=1,r.dragEnterCount<1&&(r.dragEnterCount=0,r.state.isDraggedOver&&(r.props.setFileUploaderPath({path:r.props.currentPath}),r.setState({isDraggedOver:!1}))))},r.handleDrop=function(e){r.setState({isDraggedOver:!1}),r.dragEnterCount=0,r.props.onClose()},r.handleDragOver=function(e){e.preventDefault(),e.stopPropagation()},r.handleMouseEnter=function(){r.props.enableDragging&&r.setState({isDraggedOver:!0})},r.handleMouseLeave=function(){r.state.isDraggedOver&&(r.setState({isDraggedOver:!1}),r.props.onClose())},r.handleMouseUp=function(){r.state.isDraggedOver&&r.setState({isDraggedOver:!1}),r.props.enableDragging&&!r.props.isLastCrumb&&r.props.onClose()},r.state={isDraggedOver:!1},r}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.dragEnterCount=0,this.lastEnteredElement=null},t.prototype.render=function(){var e=this.props,t=e.icon,r=e.alt,i=e.folderName,a={"breadcrumb-text-dragged-over":this.state.isDraggedOver};return o.default.createElement(l.Menu.LinkItem,{href:this.props.href,onClick:this.props.onCrumbClick,className:n.default(a),withLeftAccessory:o.default.createElement(d.IconContent,{name:t,"aria-label":r,role:"img",className:"breadcrumb-menu-item-icon"}),onDragEnter:this.handleDragEnter,onDragLeave:this.handleDragLeave,onDrop:this.handleDrop,onDragOver:this.handleDragOver,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onMouseUp:this.handleMouseUp},u.Emstring.em_snippet(i,20))},t.defaultProps={isHighlightedDropTarget:!1,onClose:function(){},alt:"",disableDragging:!1},t.displayName="BreadcrumbMenuItem",t})(o.default.Component);t.BreadcrumbMenuItem=C;var O=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={menuVisible:!1},t.handleDragOver=function(e){return function(r){t.props.enableDragging&&(r.preventDefault(),e({autoFocus:!1}),t.setState({menuVisible:!0}))}},t.handleInnerDragEnter=function(e){e.preventDefault(),t.dragEnterCount++},t.handleDragLeave=function(e){return function(r){r.preventDefault(),t.dragEnterCount--,t.dragEnterCount<1&&(t.dragEnterCount=0,t.state.menuVisible&&(t.setState({menuVisible:!1}),e({autoFocus:!1})))}},t.handleMouseEnter=function(e){return function(r){t.props.enableDragging&&(r.preventDefault(),t.setState({menuVisible:!0}),e({autoFocus:!1}))}},t.handleCrumbSelected=function(e){t.props.setUrl({path:e})},t.handlePopoverToggle=function(e){var r=e.isOpen;t.setState({menuVisible:r})},t.handleClose=function(){t.dragEnterCount=0,t.handlePopoverToggle({isOpen:!1})},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.dragEnterCount=0},t.prototype.render=function(){var e=this,t=r.__spreadArrays(this.props.crumbs).reverse(),n=this.props,u=n.currentPath,_=n.shouldHighlightDropTargets,p=n.setFileUploaderPath,f=n.enableDragging,m=n.onTitleClick,g=h.intl.formatMessage({id:"JY5LSc",defaultMessage:"Show parent folders (descending)"});return o.default.createElement(o.default.Fragment,null,o.default.createElement(l.Menu.Wrapper,{onSelection:this.handleCrumbSelected,shouldPropagateClickOutsideMouseEvents:!0,className:"breadcrumb-menu-wrapper"},(function(n){var a=n.getContentProps,s=n.getTriggerProps,c=n.openMenu,h=n.closeMenu;return o.default.createElement(o.default.Fragment,null,o.default.createElement(i.IconButton,r.__assign({variant:"transparent",onDragOver:e.handleDragOver(c),onMouseEnter:e.handleMouseEnter(c)},s()),o.default.createElement(d.IconContent,{name:"folder_dropdown-small","aria-label":g,role:"img",className:"breadcrumb-menu-icon"})),o.default.createElement(l.Menu.Content,r.__assign({},a(),{onDragEnter:e.handleInnerDragEnter,onDragLeave:e.handleDragLeave(h)}),o.default.createElement(l.Menu.Segment,null,t.map((function(t){return o.default.createElement(C,{key:encodeURI(t.path),path:t.path,icon:t.icon,alt:t.alt,folderName:t.folderName,currentPath:u,isHighlightedDropTarget:_,setFileUploaderPath:p,onClose:e.handleClose,enableDragging:f,onCrumbClick:m(t),href:e.props.getUrlForPath(t.path).toString()})})))))})),o.default.createElement(c.Text,{color:"faint",className:"breadcrumb-menu-icon-parent"},o.default.createElement(a.UIIcon,{src:s.ChevronRightLine,className:"breadcrumb__spacer",size:"small"})))},t.defaultProps={shouldHighlightDropTargets:!1},t.displayName="BreadcrumbMenu",t})(o.default.Component)})),define("modules/clean/react/share_download/api",["require","exports","tslib","modules/clean/deprecated_ajax/ajax_as_promised"],(function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetchDownloadUrl=t.testDownload=t.TooLargeError=t.DownloadError=void 0,n=r.__importStar(n);var o=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t})((function(e){this.message=e}));t.DownloadError=o;var i=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t})(o);t.TooLargeError=i,t.testDownload=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var a;return r.__generator(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,n.SilentBackgroundRequest({url:e,data:{rlkey:t}})];case 1:return a=r.sent(),[3,3];case 2:throw r.sent(),new o;case 3:if("OK"!==a)throw 0===a.indexOf("err:")?new i:new o;return[2]}}))}))},t.fetchDownloadUrl=function(e,t){return n.SilentBackgroundRequest({url:"/sharing/fetch_user_content_link",data:{url:e,rlkey:t}})}})),define("modules/clean/redux/tests/store",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mockExtraArguments=void 0,t.mockExtraArguments=function(){return{}}})),define("modules/clean/react/upload_kit/lib/processors",["require","exports","tslib","modules/clean/react/upload_kit/lib/types","modules/clean/react/upload_kit/utils/makers","modules/clean/react/upload_kit/utils/path","modules/clean/react/upload_kit/utils/file","modules/clean/filepath/filepath","modules/core/uri"],(function(e,t,r,n,o,i,a,s,l){"use strict";function c(e){return r.__awaiter(this,void 0,Promise,(function(){return r.__generator(this,(function(t){return[2,e.map((function(e){var t=e[0],r=e[1];return o.makeFileUploadItem(t,n.isWebkitFile(t)&&""!==t.webkitRelativePath?t.webkitRelativePath:t.name,r)}))]}))}))}function d(e,t,r){return Promise.resolve([o.makeFileUploadItem(e,t,r)])}function u(e,t){return r.__awaiter(this,void 0,Promise,(function(){var n,s,l=this;return r.__generator(this,(function(c){switch(c.label){case 0:return[4,Promise.all(e.map((function(e){return r.__awaiter(l,void 0,void 0,(function(){var n;return r.__generator(this,(function(r){switch(r.label){case 0:return(null==e?void 0:e.isFile)?[4,a.getFile(e)]:[3,2];case 1:return n=r.sent(),[2,[o.makeFileUploadItem(n,i.getDestPath(e),t)]];case 2:return(null==e?void 0:e.isDirectory)?[4,_(e)]:[3,4];case 3:return[2,u(r.sent(),t)];case 4:return[2,null]}}))}))})))];case 1:return n=c.sent(),s=[],n.forEach((function(e){e&&s.push.apply(s,e)})),[2,s]}}))}))}function _(e){return r.__awaiter(this,void 0,Promise,(function(){function t(e){return r.__awaiter(this,void 0,Promise,(function(){var n=this;return r.__generator(this,(function(o){return[2,new Promise((function(o,i){return e.readEntries((function(i){return r.__awaiter(n,void 0,void 0,(function(){var n,a;return r.__generator(this,(function(s){switch(s.label){case 0:return i.length>0?(n=o,a=[i],[4,t(e)]):[3,2];case 1:return n.apply(void 0,[r.__spreadArrays.apply(void 0,a.concat([s.sent()]))]),[3,3];case 2:o(i),s.label=3;case 3:return[2]}}))}))}),(function(e){return i(e)}))}))]}))}))}return r.__generator(this,(function(r){return[2,t(e.createReader())]}))}))}function p(e){var t={};return e.map((function(e){return s.parent_dir(e.destPath)})).forEach((function(e){""!==e&&"/"!==e&&(t[e]=e)})),Object.keys(t).map((function(e){return o.makeDirectoryUploadItem(e)}))}function f(e){var t={};return e.forEach((function(e){s.parent_dirs(e.destPath).forEach((function(e){""!==e&&"/"!==e&&(t[e]=e)}))})),Object.keys(t).map((function(e){return o.makeDirectoryUploadItem(e)}))}Object.defineProperty(t,"__esModule",{value:!0}),t.processFilesWithRenamingRecursive=t.processFilesWithRenaming=t.resolveDuplicates=t.collectDirectoriesRecursive=t.collectDirectories=t.readDirectory=t.preprocessFileSystemEntries=t.preprocessDataTransfer=t.preprocessDropboxFiles=t.preprocessBlob=t.preprocessFiles=void 0,t.preprocessFiles=c,t.preprocessBlob=d,t.preprocessDropboxFiles=function(e){return r.__awaiter(this,void 0,Promise,(function(){return r.__generator(this,(function(t){return[2,e.map((function(e){var t=e[0],r=e[1];return o.makeChooserUploadItem(t,r)}))]}))}))},t.preprocessDataTransfer=function(e,t){return r.__awaiter(this,void 0,Promise,(function(){var n,o,i,s,_;return r.__generator(this,(function(r){return n=e.files,o=e.items,(i=e.types)&&i.length>0&&-1===i.indexOf("Files")?(s=a.getDataTransferUrl(e),_=l.URI.parse(s).getAuthority(),[2,d(a.makeLinkBlob(s),"#"+_+".url",t)]):o&&o.length>0&&o[0]&&o[0].webkitGetAsEntry?[2,u(Array.from(o).map((function(e){return e.webkitGetAsEntry()})),t)]:n&&n.length>0?[2,c(Array.from(n).map((function(e){return[e,t||{}]})))]:[2,Promise.resolve([])]}))}))},t.preprocessFileSystemEntries=u,t.readDirectory=_,t.collectDirectories=p,t.collectDirectoriesRecursive=f,t.resolveDuplicates=function(e,t){void 0===t&&(t=[]);var r=new Set,n=new Set,o=[];return t&&t.forEach((function(e){n.add(e.id),r.add(i.getNameAtRoot(e.destPath).toLowerCase())})),e.forEach((function(e){if(!n.has(e.id)){var t,a=-1!==e.destPath.indexOf("/"),l=1,c=i.getNameAtRoot(e.destPath),d=s.split_filename(c);if(r.has(c.toLowerCase()))do{t=d.name+" ("+l+")",c=d.ext?t+"."+d.ext:t,l++}while(r.has(c.toLowerCase()));if(a){var u=e.destPath.split("/");u[0]=c,e.destPath=u.join("/")}else e.destPath=c;n.add(e.id),r.add(e.destPath.toLowerCase()),o.push(e)}})),o},t.processFilesWithRenaming=function(e,r,n){return Promise.resolve(t.resolveDuplicates(e,n)).then((function(e){return{errors:r,items:e.concat(p(e))}}))},t.processFilesWithRenamingRecursive=function(e,r,n){return Promise.resolve(t.resolveDuplicates(e,n)).then((function(e){return{errors:r,items:e.concat(f(e))}}))}})),define("modules/clean/react/upload_kit/lib/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UploadErrorType=t.UploadStatus=t.FileSource=t.isChooserFile=t.isWebkitFile=void 0,t.isWebkitFile=function(e){return"webkitRelativePath"in e},t.isChooserFile=function(e){return"bytes"in e},(function(e){e.Dropbox="dropbox",e.Computer="computer",e.Server="server"})(t.FileSource||(t.FileSource={})),(function(e){e.Staged="staged",e.Queued="queued",e.Uploading="uploading",e.Success="success",e.Error="error",e.Cancelling="cancelling"})(t.UploadStatus||(t.UploadStatus={})),(function(e){e.CloudDoc="cloud_doc",e.EmptyFile="empty_file",e.IgnoredFile="ignored_file",e.OverMaxFileSize="over_max_file_size",e.PointerFile="pointer_file",e.TemporaryFile="temporary_file",e.InvalidChar="invalid_char",e.NotFound="not_found",e.NoPermission="no_permission",e.Restricted="restricted",e.InvalidArgs="invalid_args",e.Unknown="unknown"})(t.UploadErrorType||(t.UploadErrorType={}))})),define("modules/clean/react/upload_kit/lib/upload_block",["require","exports","modules/clean/csrf","modules/core/uri"],(function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uploadBlock=void 0,t.uploadBlock=function(e,t,o,i){var a=new n.URI({scheme:"https",authority:"dl-web.dropbox.com",path:"/put_block_returning_token",query:{owner_id:e.toString(),_subject_uid:e.toString(),t:r.readCsrfToken()||"",reported_block_size:i.size.toString(),num_blocks:Math.ceil(o/i.size).toString(),ns_id_for_routing:t.toString()}});return new Promise((function(e,t){var r=new XMLHttpRequest;return r.withCredentials=!0,r.onreadystatechange=function(){if(r.readyState===XMLHttpRequest.DONE)if(200===r.status){var n=JSON.parse(r.responseText);n.token?e(n.token):t("Server token empty or undefined error.")}else t("Server error "+r.status)},r.open("POST",a.toString(),!0),r.setRequestHeader("Content-Type","application/octet-stream"),r.send(i),r}))}})),define("modules/clean/react/upload_kit/uploader/async_controller",["require","exports","tslib"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AsyncUploadController=void 0;var n=(function(){function t(e){var t=e.onLoaded,n=r.__rest(e,["onLoaded"]);this.onLoaded=t,this.controllerProps=n}return t.prototype.get=function(){var t=this;return this.promise||(this.promise=new Promise((function(n){return r.__awaiter(t,void 0,void 0,(function(){var t,o;return r.__generator(this,(function(i){switch(i.label){case 0:return[4,new Promise((function(t,r){e(["modules/clean/react/upload_kit/uploader/controller"],t,r)})).then(r.__importStar)];case 1:return t=i.sent().UploadController,o=new t(this.controllerProps),this.onLoaded(o),n(o),[2]}}))}))}))),this.promise},t})();t.AsyncUploadController=n})),define("modules/clean/react/upload_kit/uploader/context",["require","exports","tslib","react","modules/clean/react/components/helpers","modules/clean/react/upload_kit/uploader/async_controller","modules/clean/react/upload_kit/lib/processors"],(function(e,t,r,n,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.withUploadConsumer=t.UploadConsumer=t.withCustomUploadProvider=t.UploadProvider=void 0;var s=(n=r.__importDefault(n)).default.createContext({}),l=0;var c=(function(e){function t(t){var o,s,c,d=e.call(this,t)||this;return d.fileField=n.default.createRef(),d.folderField=n.default.createRef(),d.chooseHandled=new Set,d.state={uploadItems:[],isUploading:!1},d.setInitialUploadedItems=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.__awaiter(d,void 0,void 0,(function(){var t;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,this.asyncController.get()];case 1:return[2,(t=r.sent()).setInitialUploadedItems.apply(t,e)]}}))}))},d.cancelUploadItem=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.__awaiter(d,void 0,void 0,(function(){var t;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,this.asyncController.get()];case 1:return[2,(t=r.sent()).cancelUploadItem.apply(t,e)]}}))}))},d.chooseFiles=function(){return r.__awaiter(d,void 0,void 0,(function(){var e;return r.__generator(this,(function(t){return e=this.fileField?this.fileField.current:null,[2,this.chooseLocalFiles(e)]}))}))},d.chooseFolder=function(){return r.__awaiter(d,void 0,void 0,(function(){var e;return r.__generator(this,(function(t){return e=this.folderField?this.folderField.current:null,[2,this.chooseLocalFiles(e)]}))}))},d.chooseLocalFiles=(o=function(e){return void 0===e&&(e=null),d.asyncController.get(),new Promise((function(t,n){if(e){e.dataset.uploadKitId||(e.dataset.uploadKitId=String(l++));var o=e.dataset.uploadKitId,i=function(){return r.__awaiter(d,void 0,void 0,(function(){var a,s;return r.__generator(this,(function(r){switch(r.label){case 0:if(this.chooseHandled.delete(o),e.removeEventListener("change",i),!e.files)return[3,6];r.label=1;case 1:return r.trys.push([1,4,,5]),[4,this.asyncController.get()];case 2:return[4,r.sent().addFiles(Array.from(e.files))];case 3:return a=r.sent(),t(a),[3,5];case 4:return s=r.sent(),n(s),[3,5];case 5:return[3,7];case 6:n(),r.label=7;case 7:return[2]}}))}))};d.chooseHandled.has(o)||(d.chooseHandled.add(o),e.addEventListener("change",i)),e.value="",e.click()}else n()}))},void 0===s&&(s=100),function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return c||(c=o.apply(void 0,e),setTimeout((function(){c=void 0}),s)),c}),d.chooseDropboxFiles=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.__awaiter(d,void 0,void 0,(function(){var t;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,this.asyncController.get()];case 1:return[2,(t=r.sent()).chooseDropboxFiles.apply(t,e)]}}))}))},d.handleDrop=function(e,t){return r.__awaiter(d,void 0,void 0,(function(){var n,o;return r.__generator(this,(function(r){switch(r.label){case 0:return e?[4,Promise.all([a.preprocessDataTransfer(e,{parentPath:t}),this.asyncController.get()])]:[2,Promise.reject()];case 1:return n=r.sent(),o=n[0],[2,n[1].addUploadItems(o)]}}))}))},d.makeDirectory=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.__awaiter(d,void 0,void 0,(function(){var t;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,this.asyncController.get()];case 1:return[2,(t=r.sent()).makeDirectory.apply(t,e)]}}))}))},d.moveUploadItem=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.__awaiter(d,void 0,void 0,(function(){var t;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,this.asyncController.get()];case 1:return[2,(t=r.sent()).moveUploadItem.apply(t,e)]}}))}))},d.removeUploadItem=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.__awaiter(d,void 0,void 0,(function(){var t;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,this.asyncController.get()];case 1:return[2,(t=r.sent()).removeUploadItem.apply(t,e)]}}))}))},d.renameUploadItem=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.__awaiter(d,void 0,void 0,(function(){var t;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,this.asyncController.get()];case 1:return[2,(t=r.sent()).renameUploadItem.apply(t,e)]}}))}))},d.startUploading=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.__awaiter(d,void 0,void 0,(function(){var t;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,this.asyncController.get()];case 1:return[2,(t=r.sent()).startUploading.apply(t,e)]}}))}))},d.stopUploading=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.__awaiter(d,void 0,void 0,(function(){var t;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,this.asyncController.get()];case 1:return[2,(t=r.sent()).stopUploading.apply(t,e)]}}))}))},d.asyncController=new i.AsyncUploadController(r.__assign(r.__assign({},t),{onLoaded:function(e){d.subscription=function(e){d.setState(e)},e.subscribe(d.subscription)}})),d}return r.__extends(t,e),t.prototype.componentWillUnmount=function(){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(e){switch(e.label){case 0:return this.subscription?[4,this.asyncController.get()]:[3,2];case 1:e.sent().unsubscribe(this.subscription),e.label=2;case 2:return[2]}}))}))},t.prototype.render=function(){var e=this.props,t=e.children,o=e.fileExtensions,i=e.selectMultiple,a=r.__assign(r.__assign({},this.state),{setInitialUploadedItems:this.setInitialUploadedItems,cancelUploadItem:this.cancelUploadItem,chooseFiles:this.chooseFiles,chooseFolder:this.chooseFolder,chooseDropboxFiles:this.chooseDropboxFiles,handleDrop:this.handleDrop,makeDirectory:this.makeDirectory,moveUploadItem:this.moveUploadItem,removeUploadItem:this.removeUploadItem,renameUploadItem:this.renameUploadItem,startUploading:this.startUploading,stopUploading:this.stopUploading});return n.default.createElement(s.Provider,{value:a},t,n.default.createElement("input",{type:"file",ref:this.fileField,id:"uploader-file-field",style:{display:"none"},multiple:!!i,accept:o?o.join(","):void 0}),n.default.createElement("input",r.__assign({type:"file",ref:this.folderField,id:"uploader-folder-field",style:{display:"none"}},{webkitdirectory:""})))},t.displayName="UploadProvider",t})(n.default.PureComponent);t.UploadProvider=c,t.withCustomUploadProvider=function(e,t){var i=function(o){return n.default.createElement(t,r.__assign({},o),n.default.createElement(e,r.__assign({},o)))};return i.displayName="withCustomUploadProvider("+o.getDisplayName(e)+", "+o.getDisplayName(t)+")",i},t.UploadConsumer=s.Consumer,t.withUploadConsumer=function(e){var i=function(o){return n.default.createElement(t.UploadConsumer,null,(function(t){return n.default.createElement(e,r.__assign({},o,t))}))};return i.displayName="WithUploadConsumer("+o.getDisplayName(e)+")",i}})),define("modules/clean/react/upload_kit/utils/file",["require","exports","tslib","modules/clean/react/upload_kit/lib/types"],(function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeLinkBlob=t.getDataTransferUrl=t.getSize=t.getFile=void 0,t.getFile=function(e){return r.__awaiter(void 0,void 0,Promise,(function(){return r.__generator(this,(function(t){return[2,new Promise((function(t){return e.file((function(e){return t(e)}))}))]}))}))},t.getSize=function(e){return e?n.isChooserFile(e)?e.bytes:e.size:0},t.getDataTransferUrl=function(e){return(e.getData("Url")||e.getData("text/x-moz-url")||e.getData("text/uri-list")||"").split("\n")[0]},t.makeLinkBlob=function(e){return new Blob(["[InternetShortcut]\r\nURL="+e+"\r\n"],{type:"text/plain"})}})),define("modules/clean/react/upload_kit/utils/makers",["require","exports","tslib","modules/clean/react/upload_kit/lib/types","modules/clean/uuid/uuid"],(function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeChooserUploadItem=t.makeDirectoryUploadItem=t.makeFileUploadItem=void 0,t.makeFileUploadItem=function(e,t,i){return r.__assign(r.__assign({},i),{bytes:e.size,bytesUploaded:0,destPath:t,file:e,id:o.UUID.v4(),isDir:!1,source:n.FileSource.Computer,status:n.UploadStatus.Staged})},t.makeDirectoryUploadItem=function(e){return{bytes:0,bytesUploaded:0,destPath:e,id:o.UUID.v4(),isDir:!0,source:n.FileSource.Computer,status:n.UploadStatus.Staged}},t.makeChooserUploadItem=function(e,t){return r.__assign(r.__assign({},t),{bytes:e.bytes,bytesUploaded:0,destPath:e.name,file:e,id:e.id,isDir:e.isDir,source:n.FileSource.Dropbox,status:n.UploadStatus.Staged})}})),define("modules/clean/react/upload_kit/utils/path",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNameAtRoot=t.getRootDir=t.getDestPath=t.reparentFilename=t.renameFilename=void 0,t.renameFilename=function(e,t){var r=e.split("/");return r[r.length-1]=t,r.join("/")},t.reparentFilename=function(e,t){return t+"/"+e.split("/").pop()},t.getDestPath=function(e){return e.fullPath?e.fullPath.startsWith("/")?e.fullPath.substring(1):e.fullPath:e.name},t.getRootDir=function(e){return-1===e.indexOf("/")?"/":e.split("/")[0]},t.getNameAtRoot=function(e){return e.split("/")[0]}})),define("modules/clean/search/api",["require","exports","tslib","modules/clean/analytics","api_v2/user_client","modules/clean/react/browse/models","modules/clean/search/api_helpers","modules/clean/search/constants","modules/clean/search/search_helpers","modules/clean/search/types","api_v2/error"],(function(e,t,r,n,o,i,a,s,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.searchApiClient=t.SearchApiClient=void 0,s=r.__importStar(s),l=r.__importStar(l);var u=(function(){function e(){this._activeRequest=null}return e.prototype.abortPreviousLoading=function(){null!=this._activeRequest&&this._activeRequest.abort()},e.prototype.loadResults=function(e){var t=e.user,r=e.path,n=e.query,o=e.start,i=e.maxResults,s=e.searchSessionId,c=e.nsId,d=e.fileNameOnly,u=e.loadDeleted,_=e.showPaperResults,p=e.isDropdown,f=e.isAdminConsole,m=e.webTimer,g=e.onSuccess,h=e.onError,S=a.getCurrentTimezoneOffset(),E={query:n,search_token:l.getSearchCsrfToken(),fq_path:r,ns_id:c,filename_only:!!d,max_results:i,deleted:!!u,start:o,show_paper_results:!!_,is_dropdown:!!p,is_admin_console:!!f,show_unmounted_results:!0,timezone_offset:S,include_browse_context:!0,include_shared_docs:!0,include_snippets:!0};this._fetchResults({requestData:E,nextOffset:o,user:t,searchSessionId:s,onSuccess:g,onError:h,webTimer:m})},e.prototype._getSearchType=function(e){return e.is_image_content_search?"image_search":e.is_dropdown?"dropdown":e.deleted?"full_page_deleted":"full_page"},e.prototype.loadPartialResults=function(e){var t=this,r=this._prepareSearchApiRequestData(e);t._fetchResults({requestData:r,nextOffset:e.start,user:e.user,searchSessionId:e.searchSessionId,onSuccess:e.onSuccess,onError:e.onError,webTimer:e.webTimer,skipLogging:e.skipLogging})},e.prototype._fetchResults=function(e){var t=this,r=e.requestData,s=e.nextOffset,c=e.user,u=e.searchSessionId,_=e.onSuccess,f=e.onError,m=e.webTimer,g=e.skipLogging;if(null!=this._activeRequest&&this._activeRequest.abort(),this._activeRequestController&&(this._activeRequestController.abort(),this._activeRequestController=null),!p(r)){var h=l.fileCategoryStringToLogValue(r.file_categories),S={path_scoped:"/"!==r.fq_path,search_type:this._getSearchType(r),query_string:r.query,start:s,search_session_id:u,timezone_offset:r.timezone_offset,file_type_filters:h,user_filter_account_id:r.user_filter_account_id};g||n.SearchClientActivityLogger.log("query_started",c.id,S);var E=void 0;void 0!==window.AbortController&&(E=new AbortController,this._activeRequestController=E);var v=new o.UserApiV2Client,T=function(e){var n=e.result,o=e.headers;t._activeRequestController=null;var l,c=o["x-dropbox-request-id"];n.spell_correction&&(l={query:n.spell_correction.query,score:0,isCorrected:n.spell_correction.is_corrected,requestId:c});var d={results:a.extractSearchV2ResultsList(n.matches,s,c),hasMore:n.has_more,cursor:n.cursor,spellCorrection:l};_({context:new i.BrowseContext({blockHash:n.root_block_hash}),searchResults:d,deleted:!!r.deleted,requestId:c}),m&&m.end(c||void 0)},w=function(e){if(void 0===E||!E.signal.aborted){var t="",r="";(d.isApiError(e)||d.isBadRequestError(e)||d.isAuthError(e)||d.isAppError(e)||d.isServerError(e)||d.isRateLimitError(e))&&(t=e.toString(),e.headers&&(r=e.headers["x-dropbox-request-id"])),"function"==typeof f&&f(t,r)}m&&m.abort()};if(r.cursor)v.ns("files").rpcWithResponseHeaders("search/continue_v2",{cursor:r.cursor},{subjectUserId:c.id,signal:null==E?void 0:E.signal}).then(T).catch(w);else{var I=a.convertRequestDataToV2(r);v.ns("files").rpcWithResponseHeaders("search_v2",I,{subjectUserId:c.id,signal:null==E?void 0:E.signal}).then(T).catch(w)}}},e.prototype.loadPopularFiltersResults=function(e){var t=this,r=this._prepareSearchApiRequestData(e);t._fetchPopularFiltersResults({requestData:r,user:e.user,onSuccess:e.onSuccess,onError:e.onError,webTimer:e.webTimer})},e.prototype._fetchPopularFiltersResults=function(e){var t=this,r=e.requestData,n=e.user,i=e.onSuccess,s=e.onError,l=e.webTimer;if(this._popularFiltersActiveRequestController&&(this._popularFiltersActiveRequestController.abort(),this._popularFiltersActiveRequestController=null),!p(r)){var c=void 0;void 0!==window.AbortController&&(c=new AbortController,this._popularFiltersActiveRequestController=c);var u=new o.UserApiV2Client,_=a.convertRequestDataToV2(r);u.ns("files").rpcWithResponseHeaders("popular_filters_search_aggregations",_,{subjectUserId:n.id,signal:null==c?void 0:c.signal}).then((function(e){var r=e.result,n=e.headers;t._popularFiltersActiveRequestController=null;var o=n["x-dropbox-request-id"];i({popularFiltersResult:r,requestId:o}),l&&l.end(o||void 0)})).catch((function(e){if(void 0===c||!c.signal.aborted){var t="",r="";(d.isApiError(e)||d.isBadRequestError(e)||d.isAuthError(e)||d.isAppError(e)||d.isServerError(e)||d.isRateLimitError(e))&&(t=e.toString(),e.headers&&(r=e.headers["x-dropbox-request-id"])),"function"==typeof s&&s(t,r)}l&&l.abort()}))}},e.prototype._prepareSearchApiRequestData=function(e){var t=_(e.isPaperEnabled,!0),n=_(e.searchTags,!1),o=_(e.dateTaken,c.DateTaken.Any),i=_(e.selectedDimensions,[]),a=_(e.media_filters_enabled,!1),d=_(e.media_metadata_search_enable,!1),u=_(e.queries_for_fields,[]),p=_(e.searchDocClassification,!1),f=e.fileCategories;e.searchType===s.SearchType.IMAGE&&(f=void 0);var m=f&&!l.allCategoriesChecked(f,t)?l.fileCategoriesToString(f):"",g=e.sortOrder?l.sortFieldToOrderBy(e.sortOrder.sortField):"",h=e.sortOrder?l.sortDirectionToReverseOrder(e.sortOrder.sortDirection):"";return r.__assign(r.__assign({query:e.query,fq_path:e.path,cursor:e.cursor,max_results:e.maxResults,show_paper_results:e.searchType!==s.SearchType.IMAGE,include_browse_context:e.includeBrowseContext,search_session_id:e.searchSessionId},m&&{file_categories:m}),{is_image_content_search:e.searchType===s.SearchType.IMAGE,order_by:g,reverse_order:h,include_shared_docs:!0,include_snippets:e.searchType===s.SearchType.ALL,user_filter_account_id:e.filteredAccountId,search_tags:n,selected_dimensions:i,date_taken:o,media_filters_enabled:a,media_metadata_search_enable:d,queries_for_fields:u,search_doc_classification:p})},e})();function _(e,t){return void 0===e?t:e}function p(e){return a.skipNonValidSearchArgs(e.query,e.user_filter_account_id,!!e.media_filters_enabled&&e.media_filters_enabled,e.date_taken?e.date_taken:c.DateTaken.Any,e.selected_dimensions?e.selected_dimensions:[],(function(e){var t;if(!(null===(t=e.queries_for_fields)||void 0===t?void 0:t.length))return;var r=e.queries_for_fields[0],n=r.raw_query,o=r.fields;if(!(null==o?void 0:o.length))return;var i=o[0]===c.SearchFields.FileName?"names":o[0]===c.SearchFields.ImageMetadata?"metadata":void 0;if(!i)return;return{query:n,type:i}})(e))}t.SearchApiClient=u,t.searchApiClient=new u})),define("modules/clean/search/single_page/data/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActionTypes=void 0,(function(e){e.SET_VARIANT="SEARCH/SET_VARIANT",e.SET_USER="SEARCH/SET_USER",e.SET_EXPERIMENTS="SEARCH/SET_EXPERIMENTS",e.SET_PATH="SEARCH/SET_PATH",e.SET_QUERY="SEARCH/SET_QUERY",e.SET_FILE_CATEGORIES="SEARCH/SET_FILE_CATEGORIES",e.SET_RESULTS="SEARCH/SET_RESULTS",e.CLEAR_RESULTS="SEARCH/CLEAR_RESULTS",e.APPEND_RESULTS="SEARCH/APPEND_RESULTS",e.SET_LOADING_STATE="SEARCH/SET_LOADING_STATE",e.SET_SESSION_ID="SEARCH/SET_SESSION_ID",e.SET_REQUEST_ID="SEARCH/SET_REQUEST_ID",e.SET_SELECTION="SEARCH/SET_SELECTION",e.SET_PREVIEW_FILE_ID="SEARCH/SET_PREVIEW_FILE",e.SET_PREVIEW_COMMENTS_THREAD_ID="SEARCH/SET_PREVIEW_COMMENTS_THREAD_ID",e.SET_SORT_ORDER="SEARCH/SET_SORT_ORDER",e.ADD_TTI_COMPONENT="SEARCH/ADD_TTI_COMPONENT",e.CLEAR_TTI_COMPONENTS="SEARCH/CLEAR_TTI_COMPONENTS",e.SET_SEARCH_TYPE="SEARCH/SET_SEARCH_TYPE",e.SET_IMAGE_SUGGESTION="SEARCH/SET_IMAGE_SUGGESTION",e.UPDATE_FILE_IN_RESULTS="SEARCH/UPDATE_FILE_IN_RESULTS",e.UPDATE_RESULTS="SEARCH/UPDATE_RESULTS",e.REMOVE_RESULTS="SEARCH/REMOVE_RESULTS",e.RENAME_FILE="SEARCH/RENAME_FILE",e.DELETE_FILES="SEARCH/DELETE_FILES",e.PURGE_FILES="SEARCH/PURGE_FILES",e.RESTORE_FILES="SEARCH/RESTORE_FILES",e.SET_QUERY_HISTORY="SEARCH/SET_QUERY_HISTORY",e.SET_HIGHLIGHTED_ROW="SEARCH/SET_HIGHLIGHTED_ROW",e.UPDATE_QUERY_SUGGESTIONS_CACHE="SEARCH/UPDATE_QUERY_SUGGESTIONS_CACHE",e.SET_LAST_QUERY_WITH_QUERY_SUGGESTIONS_LOADED="SEARCH/SET_LAST_QUERY_WITH_QUERY_SUGGESTIONS_LOADED",e.SET_FILTERED_ACCOUNT_ID="SEARCH/SET_FILTERED_ACCOUNT_ID",e.UPDATE_PEOPLE_SUGGESTIONS_CACHE="SEARCH/UPDATE_PEOPLE_SUGGESTIONS_CACHE",e.SET_LAST_QUERY_WITH_PEOPLE_SUGGESTIONS_LOADED="SEARCH/SET_LAST_QUERY_WITH_PEOPLE_SUGGESTIONS_LOADED",e.SET_DWELL_TIME="SEARCH/SET_DWELL_TIME",e.SET_QUERY_START_TIME="SEARCH/SET_QUERY_START_TIME",e.SET_IS_CREATING_SHARED_LINK="SEARCH/SET_IS_CREATING_SHARED_LINK",e.UPDATE_TAGS_SUGGESTIONS_CACHE="SEARCH/UPDATE_TAGS_SUGGESTIONS_CACHE",e.SET_LAST_QUERY_WITH_TAGS_SUGGESTIONS_LOADED="SEARCH/SET_LAST_QUERY_WITH_TAGS_SUGGESTIONS_LOADED",e.UPDATE_POPULAR_FILTERS_CACHE="SEARCH/UPDATE_POPULAR_FILTERS_CACHE",e.SET_LAST_QUERY_WITH_POPULAR_FILTERS_LOADED="SEARCH/SET_LAST_QUERY_WITH_POPULAR_FILTERS_LOADED",e.SET_FILTERED_SEARCH_SUGGESTION="SEARCH/SET_FILTERED_SEARCH_SUGGESTION",e.SET_DATE_TAKEN="SEARCH/SET_DATE_TAKEN_VALUE",e.SET_SELECTED_DIMENSIONS="SEARCH/SET_SELECTED_DIMENSIONS",e.SET_MEDIA_DATA="SEARCH/SET_MEDIA_DATA"})(t.ActionTypes||(t.ActionTypes={}))})),define("modules/clean/react/growth/teams_web_actions_logger_events",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultPermissionsWebUploadsEvents=t.SplitTmfTsdLoggerEvents=t.TeamSpaceTsdAccessVisibilityEvents=t.TeamSpaceEmptyZoneCTALoggerEvents=t.CollectionsFolderActionsLoggerEvents=t.CollectionsQuickActionsLoggerEvents=t.TeamSpaceEmptyZoneLoggerEvents=t.SuggestedFoldersLoggerEvents=t.DownloadAppZoneLoggerEvents=t.OpenInDesktopCtaLoggerEvents=t.InviteFacepileLoggerEvents=t.EmptyStateDropTargetLoggerEvents=t.TeamJoinerLoggerEvents=t.RightsizingLoggerEvents=t.TeamInstallLoggerEvents=t.OnboardingLoggerEvents=void 0,(function(e){e.ESSENTIAL_SETUP_STEPS="essential_setup_steps",e.INSTALL_PAGE_ESCAPE="install_page_escape",e.DOCSEND_ONBOARD_PAGE_ESCAPE="docsend_onboard_page_escape",e.OPEN_DESKTOP_BANNER="open_desktop_banner",e.OPEN_DESKTOP_CLICK="open_desktop_click",e.RESEND_VERIFICATION_EMAIL="resend_verification_email",e.STEP_RENDER="setup_render",e.SUBMIT_TEAM_INFO="submit_team_info",e.TRANSITION_OPEN_GMAIL="transition_open_gmail",e.TRANSITION_OPEN_OUTLOOK="transition_open_outlook",e.TRIGGER_CLIENT_CHECK="trigger_client_check",e.TRIGGER_CLIENT_RESULT="trigger_client_result",e.TRIGGER_DOWNLOAD="trigger_download",e.TRIGGER_DOWNLOAD_AGAIN="trigger_download_again",e.TRIGGER_MAGIC_PAIRING="trigger_magic_pairing",e.UJ_CLINK_DOWNLOAD="uj_clink_download",e.ROLE_OPTION_SELECTED="role_option_selected",e.VIEW_SUGGESTIONS_LOADING_SCREEN="view_suggestions_loading_screen",e.COLLABORATION_TYPE_SELECTED="collaboration_type_selected",e.SETUP_SKIP_ADD_MEMBERS="setup_skip_add_members",e.SETUP_INVITE_MEMBERS_IMPORT="setup_invite_members_import",e.SETUP_INVITE_MEMBERS_COPY_LINK="setup_invite_members_copy_link",e.SETUP_INVITE_MEMBERS_ADD_EMAIL="setup_invite_members_add_email",e.SETUP_INVITE_MEMBERS_ADD_MORE_CLICKED="setup_invite_members_add_more_clicked",e.SETUP_ADD_MEMBERS="setup_add_members",e.SETUP_ADD_MEMBERS_SUBMITTED="setup_add_members_submitted",e.SETUP_ADD_MEMBERS_FAILED="setup_add_members_failed",e.SHARE_INVITE_CLICK="share_invite_click",e.SHARE_INVITE_SHEET_ACTION="share_invite_sheet_action",e.SHARE_INVITE_SHEET_DISMISS="share_invite_sheet_dismiss",e.SHARE_INVITE_COPIED="share_invite_copied",e.INVITE_PAGE_ESCAPE="invite_page_escape",e.MW_APP_STORE_REDIRECT="mw_app_store_redirect",e.MW_CLINK_FLOW_REDIRECT="mw_clink_flow_redirect",e.INSTALL_APP_PAGE_ESCAPE="install_app_page_escape",e.INSTALL_PAGE_REDIRECT="install_page_redirect",e.MOBILE_ICON_CLICK="mobile_icon_click",e.SEND_MOBILE_APP_LINK="send_mobile_app_link",e.MW_STEP_NOT_RENDER="mw_step_not_render",e.REC_FOLDER_LOADED="rec_folder_loaded",e.REC_FOLDER_LOAD_FAILED="rec_folder_load_failed",e.SETUP_ADD_MEMBERS_REC_LOADED="setup_add_members_rec_loaded",e.SETUP_ADD_MEMBERS_REC_LOAD_FAILED="setup_add_members_rec_load_failed",e.REC_FOLDER_CHECK="rec_folder_check",e.REC_FOLDER_UNCHECK="rec_folder_uncheck",e.REC_FOLDER_CLK_NEXT="rec_folder_clk_next",e.CONF_FOLDER_CLK_MOVE="conf_folder_clk_move",e.CONF_FOLDER_MOVE_SUCCEEDED="conf_folder_move_succeeded",e.CONF_FOLDER_MOVE_PARTIAL="conf_folder_move_partial_fail",e.CONF_FOLDER_MOVE_FAILED="conf_folder_move_failed",e.CONF_FOLDER_MOVE_INDIVIDUAL_ERROR="conf_folder_move_individual_error",e.CONF_FOLDER_MOVE_INTERRUPTED="conf_folder_move_interrupted",e.SETUP_CONFIRM_MOVE_FOLDERS_IMPRESSION="setup_confirm_move_folders_impression",e.SETUP_RESULTS_MOVE_FOLDERS_IMPRESSION="setup_results_move_folders_impression",e.SETUP_SELECT_FOLDERS_IMPRESSION="setup_select_folders_impression",e.SETUP_MOVE_FOLDERS_KEEP_PERSONAL="setup_move_folders_keep_personal",e.SETUP_ADD_MEMBERS_UNCHECK="setup_add_members_uncheck",e.SETUP_ADD_MEMBERS_CHECK="setup_add_members_check",e.SETUP_ADD_MEMBERS_MORE_RECOS="setup_add_members_more_recos",e.SCROLL_EVENT="scroll_event",e.ACCESS_FOLDER_CHECK="access_folder_check",e.ACCESS_FOLDER_UNCHECK="access_folder_uncheck",e.FLOW_STEPS_DOES_NOT_MATCH="flow_steps_does_not_match",e.FLOW_STEPS_DOES_NOT_MATCH_V2="flow_steps_does_not_match_v2",e.FLOW_STEPS_DOES_NOT_MATCH_V3="flow_steps_does_not_match_v3",e.FLOW_CONT_URL_DOES_NOT_MATCH="flow_cont_url_does_not_match"})(t.OnboardingLoggerEvents||(t.OnboardingLoggerEvents={})),(function(e){e.UJ_CLINK_DOWNLOAD_AGAIN="uj_clink_download_again",e.UJ_CLINK_SKIP_AFTER_DOWNLOAD="uj_clink_skip_after_download",e.SETUP_RENDER="setup_render",e.UJ_CLINK_DOWNLOAD_MOBILE_REROUTE="uj_clink_download_mobile_reroute",e.UJ_CLINK_DOWNLOAD="uj_clink_download",e.UJ_CLINK_SKIP="uj_clink_skip",e.OPEN_DESKTOP_CLICK="open_desktop_click"})(t.TeamInstallLoggerEvents||(t.TeamInstallLoggerEvents={})),(function(e){e.CLICK_MULTIPLE="rightsizing_clk_filter_screen_multiple",e.CLICK_YOU="rightsizing_clk_filter_screen_you",e.VIEW="rightsizing_view_filter_screen"})(t.RightsizingLoggerEvents||(t.RightsizingLoggerEvents={})),(function(e){e.CLK_YES_TO_CREATE="clk_yes_to_create",e.CLK_NO_TO_COMBINE="clk_no_to_combine",e.CLK_CREATE_JOINER="clk_create_joiner",e.CLK_CREATE_NEW="clk_create_new",e.CLK_COMBINE="clk_combine",e.SETUP_RENDER="setup_render",e.MERGE_ACCOUNTS="joiner_merge_accounts",e.CREATE_NEW_PERSONAL="joiner_create_new_personal",e.SIGNUP="joiner_signup",e.SIGNIN="joiner_signin"})(t.TeamJoinerLoggerEvents||(t.TeamJoinerLoggerEvents={})),(function(e){e.VIEW_CONTENT_EMPTY_STATE="view_content_empty_state",e.CLICK_BROWSE_UPLOAD_CTA="click_browse_upload_cta"})(t.EmptyStateDropTargetLoggerEvents||(t.EmptyStateDropTargetLoggerEvents={})),(function(e){e.VIEW_INVITE_EMPTY_STATE="view_invite_empty_state",e.INVITE_MEMBERS_PRIMARY_CTA_CLK="invite_members_primary_cta_clk"})(t.InviteFacepileLoggerEvents||(t.InviteFacepileLoggerEvents={})),(function(e){e.DESKTOP_ICON_TOOLTIP="desktop_icon_tooltip",e.DESKTOP_ICON_CLICK="desktop_icon_click",e.DESKTOP_ICON_CLICK_RESULT="desktop_icon_click_result",e.DESKTOP_ICON_TOOLTIP_DISMISS="desktop_icon_tooltip_dismiss"})(t.OpenInDesktopCtaLoggerEvents||(t.OpenInDesktopCtaLoggerEvents={})),(function(e){e.VIEW_MOBILE_EMPTY_STATE="view_mobile_empty_state",e.DISMISS_MOBILE_EMPTY_STATE="dismiss_mobile_empty_state",e.SEND_MOBILE_LINK_CLK="send_mobile_link_clk",e.SEND_MOBILE_LINK_SUCCESS="send_mobile_link_success",e.SEND_MOBILE_LINK_FAIL="send_mobile_link_fail"})(t.DownloadAppZoneLoggerEvents||(t.DownloadAppZoneLoggerEvents={})),(function(e){e.MOUNT_SUGGESTED_FOLDERS="mount_suggested_folders",e.VIEW_SUGGESTED_FOLDERS="view_suggested_folders",e.SUGGESTED_FOLDER_ADD_CLICKED="suggested_folder_add_clicked",e.SUGGESTED_FOLDERS_HIDE_CLICKED="suggested_folders_hide_clicked",e.SUGGESTED_FOLDER_CREATED="suggested_folder_created",e.SUGGESTED_FOLDER_FAILED="suggested_folder_failed",e.SUGGESTED_FOLDER_ACCESS_VIEW="suggested_folder_access_view",e.SUGGESTED_FOLDER_ACCESS_CHANGE="suggested_folder_access_change",e.VIEW_SUGGESTED_FOLDERS_MINIMIZED="view_suggested_folders_minimized",e.VIEW_SUGGESTED_FOLDERS_OPEN="view_suggested_folders_open"})(t.SuggestedFoldersLoggerEvents||(t.SuggestedFoldersLoggerEvents={})),(function(e){e.VIEW_EXPLORE_CONTENT_STATE="view_explore_content_state",e.VIEW_EXPLORE_EMPTY_STATE="view_explore_empty_state"})(t.TeamSpaceEmptyZoneLoggerEvents||(t.TeamSpaceEmptyZoneLoggerEvents={})),(function(e){e.VIEW_ROLE_SUGGESTIONS="view_role_suggestions",e.VIEW_ROLE_SUGGESTIONS_MINIMIZED="view_role_suggestions_hidden",e.SHOW_SUGGESTIONS_CLICKED="role_suggestions_clk_view",e.HIDE_SUGGESTIONS_CLICKED="role_suggestions_clk_hide",e.CLICKED_SUGGESTION="role_suggestions_clk_cta",e.DISMISSED_SUGGESTION="role_suggestions_clk_dismiss",e.DISMISS_ALL_SUGGESTED_FOLDERS="suggested_folder_dismiss_all"})(t.CollectionsQuickActionsLoggerEvents||(t.CollectionsQuickActionsLoggerEvents={})),(function(e){e.SUGGESTIONS_PAGE_IMPRESSION="suggestions_page_impression",e.SUGGESTIONS_PAGE_CLICK_CTA="suggestions_page_clk_cta"})(t.CollectionsFolderActionsLoggerEvents||(t.CollectionsFolderActionsLoggerEvents={})),(function(e){e.UPLOAD_FILES_CLICKED="upload_files_clk",e.CREATE_FOLDER_CLICKED="create_folder_clk"})(t.TeamSpaceEmptyZoneCTALoggerEvents||(t.TeamSpaceEmptyZoneCTALoggerEvents={})),(function(e){e.CREATE_FOLDER_MODAL_OPEN="tsd_create_folder_modal_open",e.CREATE_FOLDER_CLICK="tsd_create_folder_click",e.PERMISSIONS_AT_UPLOAD_MODAL_OPEN="tsd_upload_folder_modal_open",e.PERMISSIONS_AT_UPLOAD_CLICK="tsd_upload_folder_click"})(t.TeamSpaceTsdAccessVisibilityEvents||(t.TeamSpaceTsdAccessVisibilityEvents={})),(function(e){e.NAVIGATION_SPLIT_TMF_TSD="navigation_split_tmf_tsd"})(t.SplitTmfTsdLoggerEvents||(t.SplitTmfTsdLoggerEvents={})),(function(e){e.ACCOUNT_PREF_DEFAULT_PERMISSION_TOGGLE="account_pref_default_permission_toggle",e.DEFAULT_PERMISSION_MODAL_IMPRESSION="default_permission_modal_impression",e.DEFAULT_PERMISSION_MODAL_ACCEPT="default_permission_modal_accept",e.DEFAULT_PERMISSION_MODAL_DISMISS="default_permission_modal_dismiss",e.DEFAULT_PERMISSION_MODAL_ACCOUNT_PREF_CTA="default_permission_modal_account_pref_cta"})(t.DefaultPermissionsWebUploadsEvents||(t.DefaultPermissionsWebUploadsEvents={}))})),define("modules/clean/react/file_uploader/web_upload_action_logger",["require","exports","tslib","modules/clean/deprecated_ajax/ajax_jquery"],(function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebUploadActionLogClass=t.WebUploadActionLog=t.MAX_ERRORS=void 0,n=r.__importStar(n),t.MAX_ERRORS=3;var o=(function(){function e(){this.errorCount=0,this.lastError=Date.now(),this.shouldReport=!0}return e.prototype.log=function(e,o,i){var a=this;return i=r.__assign(r.__assign(r.__assign({},i),i.extra),{extra:void 0}),this.shouldReport&&(this.errorCount<t.MAX_ERRORS||Date.now()-this.lastError>6e5)?new Promise((function(r,s){n.SilentBackgroundRequest({url:"/log/web_upload_action",data:{_subject_uid:e,event_type:o,extra_params:JSON.stringify(i)},error:function(e){429===e.status?a.errorCount=t.MAX_ERRORS:a.errorCount++,a.lastError=Date.now(),s(e)},success:function(e){try{var t=JSON.parse(e);t&&!t.continue_sending&&(a.shouldReport=!1),a.errorCount=0,r(e)}catch(e){throw a.errorCount++,a.lastError=Date.now(),s(e),e}}})})):Promise.resolve({})},e})();t.WebUploadActionLog=new o,t.WebUploadActionLogClass=o})),define("modules/core/custom_protocol",["require","exports","tslib","modules/core/browser_detection"],(function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.canLaunchUri=t.launchUriForMicrosoftBrowsers=t.launchUriByIframe=t.launchUri=void 0;var o=(n=r.__importStar(n)).chrome?1e3:2e3;function i(e){var t=document.createElement("iframe");t.src=e,t.setAttribute("style","display: none;"),document.body.appendChild(t)}function a(e,t,r){var n=window.navigator;n&&n.msLaunchUri?n.msLaunchUri(e,t,r):r()}t.launchUri=function(e){var t=null;return new Promise((function(r,s){function l(){window.removeEventListener("blur",l),null!==t&&clearTimeout(t),r()}window.addEventListener("blur",l),t=setTimeout((function(){window.removeEventListener("blur",l),s()}),o),n.chromium()?window.location.assign(e):n.mozilla||n.safari?i(e):(n.msie||n.edge)&&a(e,r,s)}))},t.launchUriByIframe=i,t.launchUriForMicrosoftBrowsers=a,t.canLaunchUri=function(){return n.msie?n.windowsInfo.win8OrHigher:!!(n.mozilla||n.safari||n.chrome)}})),define("modules/clean/react/vault/constants",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ENCRYPTED_DOWNLOAD_ARGS_QUERY_PARAM_KEY=t.ENCRYPTED_OWNER_QUERY_PARAM_KEY=t.VAULT_OWNER_DISPLAY_NAME_QUERY_PARAM_KEY=t.VAULT_OWNER_FNAME_QUERY_PARAM_KEY=t.DEFAULT_APPS_PATH=t.SECURITY_CHECKUP_RELATIVE_URL=t.VAULT_STYLESHEETS=t.VAULT_NAME=t.VAULT_HASH_MODAL_KEY=t.VAULT_HASH_TAB_KEY=t.VAULT_URL=void 0,t.VAULT_URL="/vault",t.VAULT_HASH_TAB_KEY="tab",t.VAULT_HASH_MODAL_KEY="modal",t.VAULT_NAME="Vault",t.VAULT_STYLESHEETS=["/static/css/spectrum/index.web-vfliw9181.css","/static/css/dig-components/index.web-vflfsfj-g.css","/static/js/vault/index.web-vflDlO13I.css","/static/css/vault/vault-vflbqmnaC.css"],t.SECURITY_CHECKUP_RELATIVE_URL="/security_checkup",t.DEFAULT_APPS_PATH="/account/default_apps",t.VAULT_OWNER_FNAME_QUERY_PARAM_KEY="vo_fn",t.VAULT_OWNER_DISPLAY_NAME_QUERY_PARAM_KEY="vo_dn",t.ENCRYPTED_OWNER_QUERY_PARAM_KEY="vo",t.ENCRYPTED_DOWNLOAD_ARGS_QUERY_PARAM_KEY="enc"})),define("modules/clean/react/vault/lib/browse_utils",["require","exports","tslib","modules/clean/filepath/filepath","modules/clean/react/vault/constants"],(function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getVaultFqPath=t.isInsideVault=t.logShareFromInsideVault=void 0,n=r.__importStar(n),t.logShareFromInsideVault=function(t){return r.__awaiter(this,void 0,void 0,(function(){var n,o,i,a,s;return r.__generator(this,(function(l){switch(l.label){case 0:return[4,new Promise((function(t,r){e(["modules/clean/react/vault/lib/api"],t,r)})).then(r.__importStar)];case 1:return n=l.sent().logProductAnalyticsEvent,[4,new Promise((function(t,r){e(["vault/common/logging-types"],t,r)})).then(r.__importStar)];case 2:return o=l.sent(),i=o.AnalyticsEventAction,a=o.AnalyticsEventObject,s=o.AnalyticsEventActionSurface,n({eventAction:i.SELECT,eventObject:t?a.SHARE_FOLDER:a.SHARE_FILE,actionSurface:s.VAULT_HOME}),[2]}}))}))},t.isInsideVault=function(e){var t=e.split("/");return("/"===e[0]?t[1]:t[0])===o.VAULT_NAME},t.getVaultFqPath=function(){return n.normalize(o.VAULT_NAME)}})),define("typescript/libraries/comments2/src/components/folder_overview_utils/index",["require","exports","typescript/libraries/comments2/src/components/folder_overview_utils/description_utils"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isEmptyDescription=void 0,Object.defineProperty(t,"isEmptyDescription",{enumerable:!0,get:function(){return r.isEmptyDescription}})})),define("typescript/libraries/comments2/src/components/folder_overview_utils/description_utils",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isEmptyDescription=void 0,t.isEmptyDescription=function(e){return!e||(0===e.blocks.length||!(e.blocks.length>1)&&("unstyled"===e.blocks[0].type&&0===e.blocks.map((function(e){return e.text})).join("\n").replace(/%u200B/g,"").trim().length))}})),define("typescript/component_libraries/retrieval-components/src/collapsable-section/index",["require","exports","tslib","react","classnames","spectrum/button/index"],(function(e,t,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CollapsableSection=void 0,n=r.__importDefault(n),o=r.__importDefault(o),t.CollapsableSection=function(e){var t=e.title,r=e.isOpen,a=e.onHeaderClick,s=e.children,l=e.top,c=e.strings,d=e.containerClassName;return n.default.createElement("div",{className:o.default({"rc-collapsable-section":!0,"rc-collapsable-section--closed":!r}),style:{top:l}},n.default.createElement("div",{className:"rc-collapsable-section__header"},n.default.createElement("h2",{className:"rc-collapsable-section__header-tag"},n.default.createElement("span",null,t),n.default.createElement(i.Button,{onClick:a,className:"rc-collapsable-section__toggle",variant:"styleless"},r?c.buttonClose:c.buttonOpen))),n.default.createElement("div",{className:d,style:{display:r?void 0:"none"}},s))}})),define("dropbox/proto/hql_events/browse/web_browse",["require","exports","tslib","protobufjs/minimal","dropbox/proto/hql_events/extensions"],(function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.hql_events=void 0;var o,i=(n=r.__importStar(n)).Reader,a=n.Writer,s=(n.util,n.roots.default||(n.roots.default={}));t.default=s,t.hql_events=s.hql_events=((o=s.hql_events||{}).WebBrowseSelectRow=(function(e){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.actionSource="",e.prototype.hqlMetadata=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.actionSource&&Object.hasOwnProperty.call(e,"actionSource")&&t.uint32(10).string(e.actionSource),null!=e.hqlMetadata&&Object.hasOwnProperty.call(e,"hqlMetadata")&&s.hql_events.HQLMetadata.encode(e.hqlMetadata,t.uint32(18).fork()).ldelim(),t},e.decode=function(e,t){e instanceof i||(e=i.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.hql_events.WebBrowseSelectRow;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:n.actionSource=e.string();break;case 2:n.hqlMetadata=s.hql_events.HQLMetadata.decode(e,e.uint32());break;default:e.skipType(7&o)}}return n},e.getTypeUrl=function(){return"type.googleapis.com/hql_events.WebBrowseSelectRow"},e})(o.WebBrowseSelectRow||{}),o)})),define("modules/clean/react/upload_kit/scheduler/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UploadScheduler=void 0;var r=function(e){};t.UploadScheduler=r}));var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&__createBinding(t,e,r);return __setModuleDefault(t,e),t};define("modules/clean/react/browse/fss_experiment_carousel_util",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.asyncShowFssExpr=void 0,t.asyncShowFssExpr=function(t,r,n,o){new Promise((function(t,r){e(["modules/clean/react/browse/fss_experiment_carousel"],t,r)})).then(__importStar).then((function(e){e.showFssExpr(t,r,n,o)}))}})),define("modules/clean/react/flows/components/badge_async",["require","exports","tslib","react"],(function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AsyncBadgeComponent=void 0;var o=(n=r.__importStar(n)).lazy,i=n.Suspense,a=o((function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t,r){e(["modules/clean/react/flows/components/badge"],t,r)})).then(r.__importStar)];case 1:return[2,{default:t.sent().FlowsFolderBadge}]}}))}))}));t.AsyncBadgeComponent=function(e){var t=e.type,r=e.isInUnifiedModal,o=e.isFolderFocused;return n.createElement(i,{fallback:n.createElement("div",null)},n.createElement(a,{type:t,isInUnifiedModal:r,isFolderFocused:o}))},t.AsyncBadgeComponent.displayName="AsyncBadgeComponent"})),define("modules/clean/media_filters/gating",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isPopularFiltersSearchEnabled=t.isMediaMetadataSearchEnabled=t.isMediaFiltersEnabled=t.isMediaInformationEnabled=void 0,t.isMediaInformationEnabled=function(e){return!!e&&["V1","V2","V3","V4"].includes(e)},t.isMediaFiltersEnabled=function(e){return!!e&&["V2","V3","V4"].includes(e)},t.isMediaMetadataSearchEnabled=function(e){return!!e&&["V3","V4"].includes(e)},t.isPopularFiltersSearchEnabled=function(e){return!!e&&["V4"].includes(e)}})),define("modules/clean/media_filters/media_search_snippet_loader",["require","exports","tslib","modules/clean/react/async/loadable","react","modules/clean/web_timing_logger"],(function(e,t,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AsyncMediaSearchSnippet=void 0,o=r.__importDefault(o);var a=n.Loadable({loader:function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,i.waitForTTI()];case 1:return t.sent(),[4,new Promise((function(t,r){e(["modules/clean/media_filters/media_search_snippet"],t,r)})).then(r.__importStar)];case 2:return[2,t.sent().MediaSearchSnippet]}}))}))}});t.AsyncMediaSearchSnippet=function(e){return o.default.createElement(a,r.__assign({},e))},t.AsyncMediaSearchSnippet.displayName="AsyncMediaSearchSnippet"}));
//# sourceMappingURL=pkg-browse.min.js-vfl4cprv9.map
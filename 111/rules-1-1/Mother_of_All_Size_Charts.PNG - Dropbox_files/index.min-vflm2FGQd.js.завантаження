define(["require","exports","tslib","react","classnames","typescript/libraries/comments2/src/components/annotation_rectangle_creation_layer/resize_handles","typescript/libraries/comments2/src/components/annotation_rectangle_creation_layer/utilities","typescript/libraries/comments2/src/components/raf_style/index","typescript/libraries/comments2/src/components/annotation_rectangle/index"],(function(e,t,n,r,a,o,i,s,c){"use strict";function l(e){return{transform:"translate("+e.x+"px, "+e.y+"px)",width:e.width,height:e.height}}Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationRectangleCreationLayer=void 0,r=n.__importStar(r),a=n.__importDefault(a);var u=function(e){return e.preventDefault()},p=(function(e){function t(t){var a=e.call(this,t)||this;a.state={clickThreshold:1,internalPlacement:null},a.ref=null,a.rectangleRef=null,a.onDeltaStart=function(e,t,r){if(void 0===r&&(r=!1),i.pertainsToLeftClick(e)){a.disableDragSelect();var o=e.clientX,s=e.clientY,c=a.rectangleRef,l={x:o,y:s},u=r?n.__assign(n.__assign({},l),{width:0,height:0}):c&&i.clientRectToRectangle(c.getBoundingClientRect());u&&(a.attachListeners(),a.props.onRectChangeStart(r),a.setState({resizeDragMeta:{originPoint:l,deltaMovement:t,originRect:u}}))}},a.onDeltaChange=function(e){var t=a.state,n=t.resizeDragMeta,r=t.clickThreshold;if(n&&a.rectCanChange(e)){var o=e.clientX,s=e.clientY,c=n.originPoint,l=n.deltaMovement,u=n.originRect,p=i.calculateDelta(c,{x:o,y:s});1===r?(a.setState({clickThreshold:2}),a.props.onRectChange(i.applyDelta(u,p,l),"drag"===l,!0)):a.props.onRectChange(i.applyDelta(u,p,l),"drag"===l)}},a.onDeltaEnd=function(){1===a.state.clickThreshold&&a.props.clearPlacement(),document.removeEventListener("selectstart",u),a.removeListeners(),a.props.onRectChangeEnd(),a.setState({resizeDragMeta:void 0,clickThreshold:0})},a.onRectangleMouseDown=function(e){e.currentTarget===e.target&&a.onDeltaStart(e,o.DragInitiator)},a.setRef=function(e){a.ref=e},a.setRectangleRef=function(e){a.rectangleRef=e},a.onLayerMouseDown=function(e){var t=e.target,n=i.isOnText(e)||i.isOnLink(e),r=a.rectangleRef&&a.rectangleRef.contains(t);n||r||(a.setState({clickThreshold:1}),a.onDeltaStart(e,"bottomRight",!0))};a.resizer=["top","left","right","bottom","topLeft","topRight","bottomLeft","bottomRight"].map((function(e){return r.createElement("div",{style:o.resizeStyles[e],key:e,className:o.resizeClasses[e],onMouseDown:function(t){return a.onDeltaStart(t,e)}})}));return a.resizerV2=["top","left","right","bottom","topLeft","topRight","bottomLeft","bottomRight"].map((function(e){return r.createElement("div",{style:o.resizeStylesV2[e],key:e,className:o.resizeClassesV2[e],onMouseDown:function(t){return a.onDeltaStart(t,e)}})})),a}return n.__extends(t,e),Object.defineProperty(t.prototype,"className",{get:function(){return a.default({"sc-annotation-rectangle-creation-layer":!0,"sc-annotation-rectangle-creation-layer__is-creating":!!this.state.resizeDragMeta})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"annotationClassName",{get:function(){var e=this.props.useV2Design;return a.default("sc-annotation-rectangle-creation-draft",{"sc-annotation-rectangle-creation-draft-v1":!e,"sc-annotation-rectangle-creation-draft-v2":e})},enumerable:!1,configurable:!0}),t.prototype.attachListeners=function(){document.addEventListener("mousemove",this.onDeltaChange,!0),document.addEventListener("mouseup",this.onDeltaEnd)},t.prototype.removeListeners=function(){document.removeEventListener("mousemove",this.onDeltaChange),document.removeEventListener("mouseup",this.onDeltaEnd)},t.prototype.disableDragSelect=function(){document.addEventListener("selectstart",u)},t.prototype.rectCanChange=function(e){var t=this.state,n=t.resizeDragMeta;return 1!==t.clickThreshold||n&&i.hasExceededThreshold(n.originPoint,e)},t.prototype.maybeRenderAnnotationDraft=function(){var e=this,t=this.props,n=t.useV2Design,a=t.placement;return a?r.createElement(s.RafStyle,{style:a},(function(t){return t?r.createElement(r.Fragment,null,r.createElement("div",{ref:e.setRectangleRef,style:l(t),className:e.annotationClassName,onMouseDown:e.onRectangleMouseDown},n?e.resizerV2:e.resizer),n&&r.createElement(c.AnnotationCutoutOverlay,{placement:t})):null})):null},t.prototype.render=function(){var e=this.className,t=this.setRef,n=this.onLayerMouseDown;return r.createElement("div",{ref:t,className:e,onMouseDown:n},this.props.children,this.maybeRenderAnnotationDraft())},t})(r.PureComponent);t.AnnotationRectangleCreationLayer=p}));
//# sourceMappingURL=index.min.js-vfltxViBX.map
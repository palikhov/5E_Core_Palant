define(["require","exports","lodash","typescript/component_libraries/files_components/src/blades/comments/data/uuid","typescript/component_libraries/files_components/src/blades/comments/data/actions","typescript/libraries/comments2/src/mentions/index","api_v2/redux/comments2","typescript/component_libraries/files_components/src/blades/comments/data/transform","typescript/libraries/comments2/src/components/utils/thread_utils","typescript/libraries/comments2/src/transforms/index","typescript/component_libraries/flows/src/components/approval-forms/index"],(function(e,o,r,t,n,i,a,d,l,s,m){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.READ_ONLY_SETTINGS=o.ENABLED_SETTINGS=o.getCommentsActionsAdapter=void 0,o.getCommentsActionsAdapter=function(e){var o=e.dispatch,c=e.getAccount,u=e.getFileId,v=e.getSharedLinkInfo,h=e.getCommentsBladeId,p=e.onEditorFocused,f=e.showAuthModal,A=e.approvalIOClient,C=e.onClickAnnotation,T=function(e,r){var t,i,a=c();if(a){var l=(null===(i=v())||void 0===i?void 0:i.url)||u();o(n.addAndCommitComment(d.accountToCommentStreamUser(a),l,e,r)),o(m.setApprovalForm(((t={})[l]={},t)))}else{if(!f)throw new Error("showAuthModal or stream is not defined");f()}};return{onThreadCreated:function(e,r){var n,i=c();if(i)o(a.addCommentAction({arg:{stream:d.createStreamFromFileOrSharedLink(u(),null===(n=v())||void 0===n?void 0:n.url),comment:s.iCommentContentToUserSubmittedComment({content:e,annotation:r}),source:{".tag":"editor"}}},{tempThreadId:t.v4(),content:e,annotation:r,author:d.accountToCommentStreamUser(i),fileViewerId:h()}));else{if(!f)throw new Error("showAuthModal or stream is not defined");f()}},onThreadActivated:function(e){var r;o(n.activateThread({fileId:u(),sharedLinkURL:null===(r=v())||void 0===r?void 0:r.url,fileViewerId:h(),threadId:e.id,isThirdParty:e.isThirdParty}))},onAllThreadsDeactivated:function(){o(n.deactivateAllThreads({fileViewerId:h()})),o(n.focusThread(h(),null))},onThreadMouseEnter:function(e){o(n.hoverThread(h(),e))},onThreadMouseLeave:function(){o(n.hoverThread(h(),null))},onThreadFocus:function(e){o(n.focusThread(h(),e))},onThreadBlur:function(){o(n.focusThread(h(),null))},onThreadRepliedTo:function(e,r){var t,n=c();if(n)o(a.addCommentAction({arg:{stream:d.createStreamFromFileOrSharedLink(u(),null===(t=v())||void 0===t?void 0:t.url),thread_id:e,comment:s.iCommentContentToUserSubmittedComment({content:r})}},{content:r,author:d.accountToCommentStreamUser(n),fileViewerId:h()}));else{if(!f)throw new Error("showAuthModal or stream is not defined");f()}},onThreadMarkedAsRead:function(e){var r;o(a.markThreadReadAction({arg:{id:e,stream:d.createStreamFromFileOrSharedLink(u(),null===(r=v())||void 0===r?void 0:r.url)}}))},onThreadMarkedAsUnread:function(e){var r;o(a.markThreadUnreadAction({arg:{id:e,stream:d.createStreamFromFileOrSharedLink(u(),null===(r=v())||void 0===r?void 0:r.url)}}))},onThreadResolved:function(e){var r;if(c())o(a.resolveThreadAction({arg:{id:e,stream:d.createStreamFromFileOrSharedLink(u(),null===(r=v())||void 0===r?void 0:r.url)}}));else{if(!f)throw new Error("showAuthModal or stream is not defined");f()}},onThreadUnresolved:function(e){var r;if(c())o(a.unresolveThreadAction({arg:{id:e,stream:d.createStreamFromFileOrSharedLink(u(),null===(r=v())||void 0===r?void 0:r.url)}}));else{if(!f)throw new Error("showAuthModal or stream is not defined");f()}},onCommentEdited:function(e,r,t){var n;o(a.editCommentAction({arg:{id:e,stream:d.createStreamFromFileOrSharedLink(u(),null===(n=v())||void 0===n?void 0:n.url),comment:s.iCommentContentToUserSubmittedComment({content:r})}},{threadId:t,content:r}))},onEnableComments:function(){var e;o(a.enableCommentingAction({arg:{stream:d.createStreamFromFileOrSharedLink(u(),null===(e=v())||void 0===e?void 0:e.url)}}))},onDisableComments:function(){var e;o(a.disableCommentingAction({arg:{stream:d.createStreamFromFileOrSharedLink(u(),null===(e=v())||void 0===e?void 0:e.url)}}))},onCommentDeleted:function(e,r){var t;o(a.deleteCommentAction({arg:{id:e,stream:d.createStreamFromFileOrSharedLink(u(),null===(t=v())||void 0===t?void 0:t.url)}},{threadId:r}))},onMentionsQueryUpdated:function(e){o(i.searchContacts(e))},onCommentDraftCancel:function(){o(n.cancelAnnotating(h()))},onEditorFocused:function(){o(n.editorDidFocus(h())),null==p||p()},onClickAnnotation:function(e){null==C||C(e)},onSubscribe:function(){var e;o(a.subscribeAction({arg:{stream:d.createStreamFromFileOrSharedLink(u(),null===(e=v())||void 0===e?void 0:e.url)}}))},onUnsubscribe:function(){var e;o(a.unsubscribeAction({arg:{stream:d.createStreamFromFileOrSharedLink(u(),null===(e=v())||void 0===e?void 0:e.url)}}))},onClickOlderInfo:r.noop,onEditorStateChange:r.noop,onApproverRespond:function(e){var r,t,n=(null===(t=v())||void 0===t?void 0:t.url)||u();null==A||A.getLogger().logRespondClick(u(),e),o(m.setApprovalForm(((r={})[n]={activeForm:"respond",threadId:e},r)))},onEditApproval:function(e,r){var t,n,i,a=(null===(i=v())||void 0===i?void 0:i.url)||u();"approver"==r.approvalMetadata.actor?(null==A||A.getLogger().logEditApprovalResponseClick(u(),e,r.commentId),o(m.setApprovalForm(((t={})[a]={activeForm:"response_edit",threadId:e,editArgs:r},t)))):"requester"==r.approvalMetadata.actor&&(null==A||A.getLogger().logEditApprovalRequestClick(u(),e,r.commentId),o(m.setApprovalForm(((n={})[a]={activeForm:"request_edit",threadId:e,editArgs:r},n))))},onDeleteApprovalComment:function(e,r,t){var i;if(A){var a=c();if(a){var l=(null===(i=v())||void 0===i?void 0:i.url)||u();A.showApprovalDeleteCommentModal(u(),e,t,(function(){o(n.deleteAndCommitComment(d.accountToCommentStreamUser(a),l,r,e))}))}else{if(!f)throw new Error("showAuthModal or stream is not defined");f()}}},onAddApprovalSuccess:function(e,o){T(e,o)},onEditApprovalSuccess:function(e,r,t){var i,a,l=c();if(l){var s=(null===(a=v())||void 0===a?void 0:a.url)||u();o(n.editAndCommitComment(d.accountToCommentStreamUser(l),s,r,e,t)),o(m.setApprovalForm(((i={})[s]={},i)))}else{if(!f)throw new Error("showAuthModal or stream is not defined");f()}},onResubmitApprovalFocus:function(e){var r,t,n=(null===(t=v())||void 0===t?void 0:t.url)||u();null==A||A.getLogger().logResubmitRequestClick(u(),e),o(m.setApprovalForm(((r={})[n]={activeForm:"request_resubmit",threadId:e},r)))},onResubmitApprovalBlur:function(){var e,r,t=(null===(r=v())||void 0===r?void 0:r.url)||u();o(m.setApprovalForm(((e={})[t]={},e)))},onResubmitApprovalRequest:function(e,o){if(A){var r=u();A.resubmitApprovalRequest(r,e,o.text).then((function(t){A.getLogger().logResubmitRequestSuccess(r,e,o.text.length,t.comment_id),T(o,e)}))}},onRemoveApprovalThread:function(e){var r;if(A){var t=c();if(t){var i=(null===(r=v())||void 0===r?void 0:r.url)||u();A.showApprovalDeleteThreadModal(u(),e,(function(){o(n.deleteAndCommitThread(d.accountToCommentStreamUser(t),i,e))}))}else{if(!f)throw new Error("showAuthModal or stream is not defined");f()}}},onCommentActivated:function(e,r){var t,i=l.findCommentThread(r,e);i&&o(n.activateThread({fileId:u(),sharedLinkURL:null===(t=v())||void 0===t?void 0:t.url,fileViewerId:h(),threadId:i.thread.id,isThirdParty:i.thread.isThirdParty}))}}},o.ENABLED_SETTINGS={canComment:!0,canModifyThreads:!0,canShowEditor:!0,canShowEditorMeatball:!1},o.READ_ONLY_SETTINGS={canComment:!1,canModifyThreads:!1,canShowEditor:!1,canShowEditorMeatball:!1}}));
//# sourceMappingURL=adapter.amd.min.js-vflRD5pve.map
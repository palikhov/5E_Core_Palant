define(["require","exports","tslib","prop-types","react","modules/clean/history","modules/clean/cloud_docs/types","modules/clean/react/file_viewer/file_viewer","modules/clean/react/file_viewer/sdk_file_viewer/async_file_viewer","modules/clean/open_in_app/actions","modules/clean/sharing/async_share_modal_util","modules/clean/viewer","modules/clean/react/file_viewer/data/store","modules/clean/web_timing_logger","modules/clean/react/extensions/data/store","modules/clean/integrations/zoom_share_dialog/async_modal","modules/constants/file_viewer","modules/core/browser","modules/clean/react/file_viewer/sdk_file_viewer/utils","modules/clean/react/file_viewer/utils","file-viewer/core/config","modules/clean/auth/login_or_register/types","modules/constants/python","modules/clean/react/action_bar/file_actions/portable/save_as_copy/save_as_copy","modules/clean/file_store/utils","modules/clean/react/action_bar/file_actions/portable/save_as_copy/snackbars","modules/clean/react/file_viewer/sdk_file_viewer/action_plugins/utils"],(function(e,i,r,t,o,a,n,s,l,d,p,c,u,_,h,f,w,m,v,g,y,S,I,E,P,C,b){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.FileViewerContainer=void 0,t=r.__importDefault(t),o=r.__importDefault(o),a=r.__importDefault(a),m=r.__importStar(m);var V=(function(i){function V(e){var r=i.call(this,e)||this;r.closeViewer=function(){var e=r.props,i=e.onCloseUrl,t=e.redirectOnClose;if(i)if(t)m.redirect(i);else{var o=a.default.deconstruct_url(i),n=o.path,s=o.qargs;a.default.push_state(n,s)}};var t=c.Viewer.get_viewer(),o=e.userId?t.get_user_by_id(e.userId):t.work_user||t.personal_user;r.state={user:o,isCapture:!1},_.log_js_modules_application_code_start();var n=e.file,s=u.getStoreForFileViewer();return u.hydrateFileViewerNamespace(s,{file:n},o),o&&h.initializeStore(o,[n]),r}return r.__extends(V,i),V.prototype.componentDidMount=function(){var i=this,t=this.props,o=t.shareEmail,a=t.shareModalVariant,s=t.file,l=t.shareToken,c=new URLSearchParams(m.get_uri()).get("capture");if(new URLSearchParams(window.location.search).has("copy_to_dropbox")&&s&&this.state.user&&l){var u=new URL(window.location.href);E.portableSaveAsCopy({fileName:P.getFilename(s),user:this.state.user,shareToken:l},{onNetworkRequest:function(){return C.saveCopySnackBarInProgress(b.PREVIEWS_SNACKBAR_ID)}}),u.searchParams.delete("copy_to_dropbox"),window.history.replaceState(u.href,"",u.href)}if(c&&this.setState({isCapture:!0}),o||a&&a!==n.ShareModalVariant.closed&&this.state.user?new Promise((function(i,r){e(["modules/clean/react/browse/models"],i,r)})).then(r.__importStar).then((function(e){var r=e.File,t=o?o.split(","):[];p.asyncShowPrefilledShareModal({user:i.state.user,sharePrefillEmails:t,content:new r(i.props.file)})})):this.props.authModalKind!==S.LoginOrRegisterKind.IMMEDIATE||this.state.user||this.state.isCapture?this.props.presentInZoom&&this.state.user&&f.asyncShowModal(this.state.user.id,s.file_id,"file-viewer-modal-overlay","desktop"):g.showAuthModal({mode:y.AuthMode.REGISTER,kind:y.LoginOrRegisterKind.IMMEDIATE,encryptionOptions:this.props.encryptionOptions}),this.props.openImmediatelyInApp){var _=this.props.file;d.openImmediately(_.open_in_app_data)}},V.prototype.isInbandExperimentEnabled=function(){return w.INBAND_FVSDK_LINKS},V.prototype.render=function(){var e=this.props,i=e.file,t=e.fileViewerProps,a=e.onCloseUrl,n=e.isEmbedded,d=e.brandingInfo,p=e.encryptionOptions,c=e.openInHelloSign,u=e.openInHelloSignSrc,_=e.sharedLinkInfo,h=e.shareToken,f=e.sharePermission,w=e.LoggedOutUXGoogleVariant,m=e.authModalKind,y=this.state.user,S=void 0!==y&&t.fileViewOrigin===I.FileViewOriginType.SHARE_PAGE&&!n,E=t.fileViewOrigin===I.FileViewOriginType.SHARED_LINK_PAGE&&!n,P=t.fileViewOrigin===I.FileViewOriginType.PAPER&&n,C=t.fileViewOrigin===I.FileViewOriginType.BROWSE,b=S&&this.isInbandExperimentEnabled(),V=E&&g.isPreviewPageRevampEnabled(),D=C&&g.isPreviewPageRevampEnabled(),O=P&&g.isPaperEmbedEnabled(),A=b||V||D||O?S||E||P?o.default.createElement(l.AsyncFileViewer,{closeFile:this.props.onCloseUrl?this.closeViewer:void 0,file:i,previewContentOnly:t.hidePageChrome,showCloudDocPreview:t.showCloudDocPreview,sharedLinkInfo:_,sharePermission:f,shareToken:h,brandingInfo:d,user:y,encryptionOptions:p,previewSurface:S?v.SDKPreviewSurface.INBAND_SHARE:P?v.SDKPreviewSurface.SHARED_LINK_EMBED:v.SDKPreviewSurface.SHARED_LINK,canShowFileFlippers:!1,hideOpenInAppInterstitial:!!t.appDownloadInterstitialDismissed,authModalKind:m}):o.default.createElement(l.AsyncFileViewer,{closeFile:this.props.onCloseUrl?this.closeViewer:void 0,file:i,previewContentOnly:t.hidePageChrome,showCloudDocPreview:t.showCloudDocPreview,user:y,brandingInfo:d,encryptionOptions:p,previewSurface:v.SDKPreviewSurface.STANDALONE_PREVIEW,canShowFileFlippers:!1,hideOpenInAppInterstitial:!!t.appDownloadInterstitialDismissed,authModalKind:m}):o.default.createElement(s.FileViewer,r.__assign({},t,{fileCount:1,fileIndex:0,titleBarCloseUrl:a,sharedLinkInfo:_,brandingInfo:d,openInHelloSign:c,openInHelloSignSrc:u,shareToken:h,sharePermission:f,user:y,transparentBackground:!1,LoggedOutUXGoogleVariant:w,encryptionOptions:p,authModalKind:m,isCapture:this.state.isCapture}));return n?o.default.createElement("div",{className:"embedded"},A):A},V.prototype.getChildContext=function(){return{authModalKind:this.props.authModalKind}},V.childContextTypes={authModalKind:t.default.oneOf(["download","immediate",null])},V.displayName="FileViewerContainer",V})(o.default.Component);i.FileViewerContainer=V}));
//# sourceMappingURL=container.min.js-vflr4f_Kg.map
define("dropbox/proto/ccpa_data/ccpa_data",["require","exports","tslib","protobufjs/minimal"],(function(e,t,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ccpa_data=void 0;var i,r=(n=o.__importStar(n)).Reader,a=n.Writer,s=(n.util,n.roots.default||(n.roots.default={}));t.default=s,t.ccpa_data=s.ccpa_data=((i=s.ccpa_data||{}).CCPALogContext=(function(e){function e(e){if(e)for(var t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.userAgent="",e.prototype.sessionId="",e.prototype.anonIp="",e.prototype.localeUserSelected="",e.prototype.localeBrowserHeader="",e.prototype.country="",e.prototype.uaBrowserName="",e.prototype.uaBrowserVersion="",e.prototype.uaOsName="",e.prototype.uaOsVersion="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.userAgent&&Object.hasOwnProperty.call(e,"userAgent")&&t.uint32(10).string(e.userAgent),null!=e.sessionId&&Object.hasOwnProperty.call(e,"sessionId")&&t.uint32(18).string(e.sessionId),null!=e.anonIp&&Object.hasOwnProperty.call(e,"anonIp")&&t.uint32(26).string(e.anonIp),null!=e.localeUserSelected&&Object.hasOwnProperty.call(e,"localeUserSelected")&&t.uint32(34).string(e.localeUserSelected),null!=e.localeBrowserHeader&&Object.hasOwnProperty.call(e,"localeBrowserHeader")&&t.uint32(42).string(e.localeBrowserHeader),null!=e.country&&Object.hasOwnProperty.call(e,"country")&&t.uint32(50).string(e.country),null!=e.uaBrowserName&&Object.hasOwnProperty.call(e,"uaBrowserName")&&t.uint32(58).string(e.uaBrowserName),null!=e.uaBrowserVersion&&Object.hasOwnProperty.call(e,"uaBrowserVersion")&&t.uint32(66).string(e.uaBrowserVersion),null!=e.uaOsName&&Object.hasOwnProperty.call(e,"uaOsName")&&t.uint32(74).string(e.uaOsName),null!=e.uaOsVersion&&Object.hasOwnProperty.call(e,"uaOsVersion")&&t.uint32(82).string(e.uaOsVersion),t},e.decode=function(e,t){e instanceof r||(e=r.create(e));for(var o=void 0===t?e.len:e.pos+t,n=new s.ccpa_data.CCPALogContext;e.pos<o;){var i=e.uint32();switch(i>>>3){case 1:n.userAgent=e.string();break;case 2:n.sessionId=e.string();break;case 3:n.anonIp=e.string();break;case 4:n.localeUserSelected=e.string();break;case 5:n.localeBrowserHeader=e.string();break;case 6:n.country=e.string();break;case 7:n.uaBrowserName=e.string();break;case 8:n.uaBrowserVersion=e.string();break;case 9:n.uaOsName=e.string();break;case 10:n.uaOsVersion=e.string();break;default:e.skipType(7&i)}}return n},e.getTypeUrl=function(){return"type.googleapis.com/ccpa_data.CCPALogContext"},e})(i.CCPALogContext||{}),i)})),define("dropbox/proto/js_init_data/privacy_consent/privacy_consent",["require","exports","tslib","protobufjs/minimal","dropbox/proto/ccpa_data/ccpa_data","dropbox/proto/js_init_data/web_timing_logger/web_timing_logger"],(function(e,t,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.privacy_consent=void 0;var i,r,a,s=(n=o.__importStar(n)).Reader,c=n.Writer,l=n.util,u=n.roots.default||(n.roots.default={});t.default=u,t.privacy_consent=u.privacy_consent=((i=u.privacy_consent||{}).PrivacyConsentInitData=(function(e){function e(e){if(e)for(var t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.iframeOrigin="",e.prototype.countryCode="",e.prototype.isCcpaEnabled=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=c.create()),null!=e.iframeOrigin&&Object.hasOwnProperty.call(e,"iframeOrigin")&&t.uint32(10).string(e.iframeOrigin),null!=e.countryCode&&Object.hasOwnProperty.call(e,"countryCode")&&t.uint32(18).string(e.countryCode),null!=e.isCcpaEnabled&&Object.hasOwnProperty.call(e,"isCcpaEnabled")&&t.uint32(24).bool(e.isCcpaEnabled),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var o=void 0===t?e.len:e.pos+t,n=new u.privacy_consent.PrivacyConsentInitData;e.pos<o;){var i=e.uint32();switch(i>>>3){case 1:n.iframeOrigin=e.string();break;case 2:n.countryCode=e.string();break;case 3:n.isCcpaEnabled=e.bool();break;default:e.skipType(7&i)}}return n},e.getTypeUrl=function(){return"type.googleapis.com/privacy_consent.PrivacyConsentInitData"},e})(i.PrivacyConsentInitData||{}),i.UserDNSInitState=(r={},(a=Object.create(r))[r[0]="UNKNOWN"]=0,a[r[1]="LOGGED_OUT_NOT_ENROLLED"]=1,a[r[2]="LOGGED_OUT_EMAIL_PENDING"]=2,a[r[3]="LOGGED_OUT_ENROLLED"]=3,a[r[7]="LOGGED_OUT_GPC_ENABLED"]=7,a[r[4]="LOGGED_IN_NOT_ENROLLED"]=4,a[r[5]="LOGGED_IN_EMAIL_PENDING"]=5,a[r[6]="LOGGED_IN_ENROLLED"]=6,a),i.CCPAIFrameInitData=(function(e){function e(e){if(this.userEmails=[],this.verifiedEmails=[],this.unverifiedEmails=[],this.localizedTextOverrides={},e)for(var t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.consentIframeOrigin="",e.prototype.dnsState=0,e.prototype.userEmails=l.emptyArray,e.prototype.verifiedEmails=l.emptyArray,e.prototype.unverifiedEmails=l.emptyArray,e.prototype.loggingContext=null,e.prototype.ccpaToken="",e.prototype.isGpcEnabled=!1,e.prototype.localizedTextOverrides=l.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=c.create()),null!=e.consentIframeOrigin&&Object.hasOwnProperty.call(e,"consentIframeOrigin")&&t.uint32(10).string(e.consentIframeOrigin),null!=e.dnsState&&Object.hasOwnProperty.call(e,"dnsState")&&t.uint32(16).int32(e.dnsState),null!=e.userEmails&&e.userEmails.length)for(var o=0;o<e.userEmails.length;++o)t.uint32(26).string(e.userEmails[o]);if(null!=e.verifiedEmails&&e.verifiedEmails.length)for(o=0;o<e.verifiedEmails.length;++o)t.uint32(34).string(e.verifiedEmails[o]);if(null!=e.unverifiedEmails&&e.unverifiedEmails.length)for(o=0;o<e.unverifiedEmails.length;++o)t.uint32(42).string(e.unverifiedEmails[o]);if(null!=e.loggingContext&&Object.hasOwnProperty.call(e,"loggingContext")&&u.ccpa_data.CCPALogContext.encode(e.loggingContext,t.uint32(50).fork()).ldelim(),null!=e.ccpaToken&&Object.hasOwnProperty.call(e,"ccpaToken")&&t.uint32(58).string(e.ccpaToken),null!=e.isGpcEnabled&&Object.hasOwnProperty.call(e,"isGpcEnabled")&&t.uint32(64).bool(e.isGpcEnabled),null!=e.localizedTextOverrides&&Object.hasOwnProperty.call(e,"localizedTextOverrides")){var n=Object.keys(e.localizedTextOverrides);for(o=0;o<n.length;++o)t.uint32(74).fork().uint32(10).string(n[o]).uint32(18).string(e.localizedTextOverrides[n[o]]).ldelim()}return t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var o,n,i=void 0===t?e.len:e.pos+t,r=new u.privacy_consent.CCPAIFrameInitData;e.pos<i;){var a=e.uint32();switch(a>>>3){case 1:r.consentIframeOrigin=e.string();break;case 2:r.dnsState=e.int32();break;case 3:r.userEmails&&r.userEmails.length||(r.userEmails=[]),r.userEmails.push(e.string());break;case 4:r.verifiedEmails&&r.verifiedEmails.length||(r.verifiedEmails=[]),r.verifiedEmails.push(e.string());break;case 5:r.unverifiedEmails&&r.unverifiedEmails.length||(r.unverifiedEmails=[]),r.unverifiedEmails.push(e.string());break;case 6:r.loggingContext=u.ccpa_data.CCPALogContext.decode(e,e.uint32());break;case 7:r.ccpaToken=e.string();break;case 8:r.isGpcEnabled=e.bool();break;case 9:r.localizedTextOverrides===l.emptyObject&&(r.localizedTextOverrides={});var c=e.uint32()+e.pos;for(o="",n="";e.pos<c;){var p=e.uint32();switch(p>>>3){case 1:o=e.string();break;case 2:n=e.string();break;default:e.skipType(7&p)}}r.localizedTextOverrides[o]=n;break;default:e.skipType(7&a)}}return r},e.getTypeUrl=function(){return"type.googleapis.com/privacy_consent.CCPAIFrameInitData"},e})(i.CCPAIFrameInitData||{}),i.CCPADNSVerificationInitData=(function(e){function e(e){if(e)for(var t=Object.keys(e),o=0;o<t.length;++o)null!=e[t[o]]&&(this[t[o]]=e[t[o]])}return e.prototype.confirmationStatus=0,e.prototype.userEmailToken="",e.prototype.countryCode="",e.prototype.locale="",e.prototype.hasError=!1,e.prototype.webTimingLoggerServerContext=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=c.create()),null!=e.confirmationStatus&&Object.hasOwnProperty.call(e,"confirmationStatus")&&t.uint32(8).int32(e.confirmationStatus),null!=e.userEmailToken&&Object.hasOwnProperty.call(e,"userEmailToken")&&t.uint32(18).string(e.userEmailToken),null!=e.countryCode&&Object.hasOwnProperty.call(e,"countryCode")&&t.uint32(26).string(e.countryCode),null!=e.locale&&Object.hasOwnProperty.call(e,"locale")&&t.uint32(34).string(e.locale),null!=e.hasError&&Object.hasOwnProperty.call(e,"hasError")&&t.uint32(40).bool(e.hasError),null!=e.webTimingLoggerServerContext&&Object.hasOwnProperty.call(e,"webTimingLoggerServerContext")&&u.web_timing_logger.WebTimingLoggerServerContext.encode(e.webTimingLoggerServerContext,t.uint32(50).fork()).ldelim(),t},e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var o=void 0===t?e.len:e.pos+t,n=new u.privacy_consent.CCPADNSVerificationInitData;e.pos<o;){var i=e.uint32();switch(i>>>3){case 1:n.confirmationStatus=e.int32();break;case 2:n.userEmailToken=e.string();break;case 3:n.countryCode=e.string();break;case 4:n.locale=e.string();break;case 5:n.hasError=e.bool();break;case 6:n.webTimingLoggerServerContext=u.web_timing_logger.WebTimingLoggerServerContext.decode(e,e.uint32());break;default:e.skipType(7&i)}}return n},e.getTypeUrl=function(){return"type.googleapis.com/privacy_consent.CCPADNSVerificationInitData"},e.DNSVerificationStatus=(function(){var e={},t=Object.create(e);return t[e[0]="UNKNOWN"]=0,t[e[1]="CONFIRMED"]=1,t[e[2]="CANCELED"]=2,t[e[3]="PENDING"]=3,t})(),e})(i.CCPADNSVerificationInitData||{}),i)})),define("modules/clean/privacy_consent",["require","exports","tslib","proto_utils/unpack","modules/clean/web_timing_logger","dropbox/proto/js_init_data/privacy_consent/privacy_consent","modules/core/browser","modules/clean/active_user","modules/clean/privacy_consent/chat_client","modules/clean/privacy_consent/i18n","modules/clean/privacy_consent/log","modules/clean/privacy_consent/marketing_tracker","modules/clean/privacy_consent/privacy_consent_platform"],(function(e,t,o,n,i,r,a,s,c,l,u,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.moduleInit=t.initialize_module=t.PrivacyConsentPlatform=void 0,a=o.__importStar(a);var f=new c.ChatClientInjectorImpl(5e3),C=function(){var e=window.location.pathname.split("/").filter((function(e){return e}))[0];return-1!==["scl","preview","work","home","starred","recents","personal","shared","h","s"].indexOf(e)},g=function(){return document.getElementById("locale-container")||document.querySelector(".warp-locale-selector-plank, .warp-dwg-locale-selector-plank")},v=function(e){var t=g();if(t){t.style.removeProperty("margin-bottom");var o=parseInt(window.getComputedStyle(t).marginBottom,10)||0;t.style.marginBottom=e+o+"px"}f.setCookieBannerInfo(!0,e)},_=function(){var e=g();e&&e.style.removeProperty("margin-bottom"),f.setCookieBannerInfo(!1,0)};function m(e){t.PrivacyConsentPlatform.config||t.PrivacyConsentPlatform.init(e,{onBannerVisible:v,onBannerNotVisible:_,disableBanner:void 0!==s.getActiveUserId()&&C(),consentChangedCallback:function(){window.location.reload(!0)},priorConsentCallback:function(){window.location.reload(!0)},injectFloatingButton:!(["/transfer","/transfer/manage"].includes(window.location.pathname)||C()),injectToFooter:!0})}t.PrivacyConsentPlatform=new d.PrivacyConsentPlatformSingleton({intlText:l.IntlTextDefault,log:new u.PrivacyConsentLogImpl,updateConsentCategories:p.updateConsentCategories,redirect:a.redirect,ttiTimeout:5e3,waitForTTI:i.waitForTTI}),t.initialize_module=m,t.moduleInit=function(e){m(n.unpackProto(e,r.privacy_consent.PrivacyConsentInitData))}}));var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[o]}})}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&__createBinding(t,e,o);return __setModuleDefault(t,e),t};define("modules/clean/privacy_consent/chat_client",["require","exports","modules/clean/web_timing_logger"],(function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChatClientInjectorImpl=void 0;var n=(function(){function t(e){if(t.instance)return t.instance;t.instance=this,this.ttiTimeout=e}return t.prototype.loadChatModule=function(){return this.chatLoadPromise?this.chatLoadPromise:(this.chatLoadPromise=o.waitForTTI({timeoutMS:this.ttiTimeout}).then((function(){return new Promise((function(t,o){e(["modules/clean/chat/chat_client"],t,o)})).then(__importStar)})),this.chatLoadPromise)},t.prototype.setCookieBannerInfo=function(e,t){this.loadChatModule().then((function(o){var n=o.ChatClientSingleton;n.isSetup()&&n.setCookieBannerInfo(e,t)}))},t})();t.ChatClientInjectorImpl=n})),define("modules/clean/privacy_consent/i18n",["require","exports","modules/core/i18n"],(function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IntlTextDefault=void 0,t.IntlTextDefault={manageCookies:o.intl.formatMessage({id:"yF4LPz",defaultMessage:"Manage cookies"}),cookiesAndCCPA:o.intl.formatMessage({id:"oOyPyq",defaultMessage:"Cookies & CCPA Preferences"}),cookiePolicy:o.intl.formatMessage({id:"t0O/69",defaultMessage:"Cookie policy"}),consentIframeTitle:o.intl.formatMessage({id:"ulDVPi",defaultMessage:"Dropbox Consent"})}})),define("modules/clean/privacy_consent/log",["require","exports","tslib","modules/clean/privacy_consent/stats","modules/clean/ux_analytics/lazy_ux_analytics","modules/clean/ux_analytics/dispatch_custom_event","modules/core/exception"],(function(e,t,o,n,i,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PrivacyConsentLogImpl=void 0,r=o.__importStar(r);var s=(function(){function e(){}return e.prototype.logIframeLoad=function(e,t){var o=(new Date).valueOf()-e.valueOf();c("privacyConsentIframeLoaded",{total_time:o.toString(),iframe_uri:t}),n.PrivacyConsentStats.logDuration(n.PrivacyConsentAmpMetrics.CROWNPEAK_LOAD_LATENCY,{},o),n.PrivacyConsentStats.logCounter(n.PrivacyConsentAmpMetrics.EVENTS,{eventName:n.PrivacyConsentEvent.SETUP_REENTRY_START})},e.prototype.logPrivacyConsentResult=function(e){var t=e?n.PrivacyConsentEvent.SETUP_REENTRY_SUCCESS:n.PrivacyConsentEvent.SETUP_REENTRY_FAILURE;n.PrivacyConsentStats.logCounter(n.PrivacyConsentAmpMetrics.EVENTS,{event_name:t}),e||a.reportException({err:new Error("Privacy consent module is not visible on page "+window.location.pathname),severity:a.SEVERITY.NONCRITICAL,tags:["privacy_consent"]})},e.prototype.logPrivacyConsentScriptLoaded=function(e){c("privacyConsentScriptLoaded",{script_id:e.scriptId,script_url:e.scriptUrl})},e.prototype.logPrivacyConsentScriptLoadError=function(e){c("privacyConsentScriptLoadError",{script_id:e.scriptId,script_url:e.scriptUrl}),a.reportException({err:new Error("Privacy consent module is running into load error"),severity:a.SEVERITY.NONCRITICAL,tags:["privacy_consent"]})},e.prototype.logCCPAIframeLoad=function(e){n.PrivacyConsentStats.logCounter(n.PrivacyConsentAmpMetrics.EVENTS,{event_name:n.CCPAEvent.IFRAME_LOAD_SUCCESS}),n.PrivacyConsentStats.logDuration(n.PrivacyConsentAmpMetrics.CCPA_IFRAME_LOAD_LATENCY,{},e)},e.prototype.logCCPAIframeError=function(e){var t=Date.now()-e.start_time;n.PrivacyConsentStats.logCounter(n.PrivacyConsentAmpMetrics.EVENTS,{event_name:n.CCPAEvent.IFRAME_LOAD_ERROR}),n.PrivacyConsentStats.logDuration(n.PrivacyConsentAmpMetrics.CCPA_IFRAME_LOAD_LATENCY,{},t),a.reportException({err:new Error("CCPA iframe failed to load"),severity:a.SEVERITY.CRITICAL,tags:["privacy_consent","ccpa_iframe"]})},e.prototype.logInvalidCookieCategoryException=function(e){a.reportException({err:new Error("Invalid cookie category id"),severity:a.SEVERITY.NONCRITICAL,tags:["privacy_consent"],exc_extra:{cookie_id:e}})},e.prototype.logCookieParseException=function(e,t){a.reportException({err:new Error("Cookie "+e+" could not be parsed"),severity:a.SEVERITY.NONCRITICAL,tags:["privacy_consent"],exc_extra:{cookie_str:t}})},e})();t.PrivacyConsentLogImpl=s;var c=function(e,t){var o={detail:{eventType:e,extra:t}};i.runAfterUxaListening((function(){r.dispatchCustomEvent("privacy_consent_custom_event",o)}))}})),define("modules/clean/privacy_consent/marketing_tracker",["require","exports","modules/clean/marketing_tracker"],(function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateConsentCategories=void 0,t.updateConsentCategories=function(e){o.MarketingTracker.tryPushEvent("updateConsentCategories",o.EventTypeEnum.Link,{consent_categories:e.join(",")})}})),define("modules/clean/privacy_consent/privacy_consent_platform",["require","exports","modules/clean/privacy_consent/privacy_consent_cookies","modules/clean/privacy_consent/consent_iframe_wrapper"],(function(e,t,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PrivacyConsentPlatformSingleton=void 0;var i=(function(){function e(t){if(this.manageCookiesSet=!1,this.manageCookiesInjected=!1,this.floatingButtonVisible=!1,this.bannerVisible=!1,this.isInIframe=!1,this.gpcSignal=!1,this.isFooterLoading=!1,e.instance)return e.instance;e.instance=this,this.log=t.log,this.updateConsentCategories=t.updateConsentCategories,this.intlText=t.intlText,this.ttiTimeout=t.ttiTimeout,this.waitForTTI=t.waitForTTI,this.redirect=t.redirect,this.isInIframe=window.self!=window.top}return e.prototype.init=function(e,t){var i,r,a=this;this.config=e;var s={};if((null===(i=null==t?void 0:t.thirdPartyConfig)||void 0===i?void 0:i.cookieDomain)&&(s.cookieDomain=t.thirdPartyConfig.cookieDomain),this.cookieStore=new o.ConsentCookieStore(s,this.log),this.updateTealiumDataLayer(),!(!e.iframeOrigin||(null===(r=this.consentIframeWrapper)||void 0===r?void 0:r.iframeExists())||document.getElementById("consent-iframe")||this.isInIframe)){var c=!(null==t||!t.disableBanner)&&(null==t?void 0:t.disableBanner);this.onBannerVisibleCallback=null==t?void 0:t.onBannerVisible,this.consentChangedCallback=null==t?void 0:t.consentChangedCallback,this.priorConsentCallback=null==t?void 0:t.priorConsentCallback,this.consentDeclinedCallback=null==t?void 0:t.consentDeclinedCallback,this.disableFloatingButton=!!t&&!t.injectFloatingButton,this.injectToFooter=!t||t.injectToFooter;var l=new URLSearchParams(window.location.search);this.consentIframeWrapper=new n.ConsentIframeWrapper({log:this.log,waitForTTI:this.waitForTTI,ttiTimeout:this.ttiTimeout,iframeOrigin:"https://"+e.iframeOrigin,iframeTitle:this.intlText.consentIframeTitle,clientInfo:l.get("client_info")||"",disableBanner:c,isCcpaEnabled:this.config.isCcpaEnabled,isGpcEnabled:this.isGPCEnabled(),hideGdpr:this.getHideGDPR(l.get("hide_gdpr")),ccpaToken:this.getCCPAToken(l.get("ccpa_token")),urlHash:window.location.hash,onBannerVisible:function(e){return a.onBannerVisible(e)},onBannerNotVisible:null==t?void 0:t.onBannerNotVisible,onIframeLoad:function(){return a.onIframeLoad()},setupSettingsReEntry:function(){return a.setupSettingsReEntry()},onPriorConsent:function(e){return a.onPriorConsent(e)},onConsentChanged:function(e){return a.onConsentChanged(e)},onConsentDeclined:function(e){return a.onConsentDeclined(e)},onDNSEnabled:function(e,t){return a.onDNSEnabled(e,t)},onDNSDisabled:function(){return a.onDNSDisabled()},onGPCEnabled:function(){return a.onGPCEnabled()},redirect:function(e){return a.redirect(e)}}),this.gpcSignal=this.isGPCEnabled(),this.consentIframeWrapper.createIframe()}},e.prototype.getHideGDPR=function(e){return("true"===e||"false"===e)&&"true"===e},e.prototype.getCCPAToken=function(e){var t,n;if(null!==e){var i=new Date;i.setDate(i.getDate()+1),null===(t=this.cookieStore)||void 0===t||t.bakeCCPATokenCookie({ccpaToken:e,expireDate:i.toISOString()});var r=window.location.search.replace(/&?ccpa_token=[^&^#]+/,""),a=""+window.location.pathname+r+window.location.hash;return window.history.replaceState({},"",a),e}var s=null===(n=this.cookieStore)||void 0===n?void 0:n.getCurrentCookieObj(o.CCPA_TOKEN_COOKIE_NAME);return s&&s.ccpaToken?s.ccpaToken:""},e.prototype.onIframeLoad=function(){this.setupSettingsReEntry(),this.logPrivacyConsentResult()},e.prototype.onFooterLoaded=function(){var e=this;this.waitForTTI({timeoutMS:this.ttiTimeout}).then((function(){var t;e.setupSettingsReEntry();var o=null===(t=e.consentIframeWrapper)||void 0===t?void 0:t.getBannerHeight();void 0!==o&&void 0!==e.onBannerVisible&&e.onBannerVisible(o)}))},e.prototype.setupSettingsReEntry=function(){!this.config||this.manageCookiesSet||this.manageCookiesInjected||(this.injectToFooter&&(this.setManageCookies(),this.injectManageCookies()),this.maybeUseFloatingButton())},e.prototype.setManageCookies=function(){var e=this;if(!this.manageCookiesSet&&!this.manageCookiesInjected){var t=this.findManageCookies();t&&(t.setAttribute("href","#manage-cookies"),t.onclick=function(t){return e.onClickManageCookies(t)},this.manageCookiesSet=!0)}},e.prototype.openOptionsDialog=function(){var e;null===(e=this.consentIframeWrapper)||void 0===e||e.openOptionsDialog()},e.prototype.isGPCEnabled=function(){return this.config.isCcpaEnabled&&navigator.globalPrivacyControl},e.prototype.onGPCEnabled=function(){var e,t=new Date;t.setMonth(t.getMonth()+12),null===(e=this.cookieStore)||void 0===e||e.bakeDNSCookie({optInToDNS:!0,expireDate:t.toISOString()})},e.prototype.maybeUseFloatingButton=function(){var e,t;this.disableFloatingButton||null===(e=this.consentIframeWrapper)||void 0===e||!e.iframeExists()||this.manageCookiesSet||this.manageCookiesInjected||this.isFooterLoading||(null===(t=this.consentIframeWrapper)||void 0===t||t.sendShowFloatingButton(this.config.isCcpaEnabled?this.intlText.cookiesAndCCPA:void 0),this.floatingButtonVisible=!0)},e.prototype.updateTealiumDataLayer=function(){this.updateConsentCategories&&this.cookieStore&&this.updateConsentCategories(this.cookieStore.getAllowedCategories())},e.prototype.onPriorConsent=function(e){var t,o,n,i,r,a,s=(null===(t=this.cookieStore)||void 0===t?void 0:t.mapCookies(e))||{},c=null===(o=this.cookieStore)||void 0===o?void 0:o.havePreferencesChanged(s);(!(null===(n=this.cookieStore)||void 0===n?void 0:n.hasUserInteracted())&&!this.gpcSignal||c)&&(null===(i=this.cookieStore)||void 0===i||i.bakeShadowCookie(null===(r=this.cookieStore)||void 0===r?void 0:r.createShadowCookieValue(null===(a=this.cookieStore)||void 0===a?void 0:a.mapCookies(e),!0)),this.priorConsentCallback&&this.priorConsentCallback(s))},e.prototype.onConsentChanged=function(e){var t,o,n,i,r=(null===(t=this.cookieStore)||void 0===t?void 0:t.mapCookies(e))||{},a=null===(o=this.cookieStore)||void 0===o?void 0:o.havePreferencesChanged(r);null===(n=this.cookieStore)||void 0===n||n.bakeShadowCookie(null===(i=this.cookieStore)||void 0===i?void 0:i.createShadowCookieValue(r,!0)),a&&this.consentChangedCallback&&this.consentChangedCallback(r)},e.prototype.onConsentDeclined=function(e){var t,o,n,i=(null===(t=this.cookieStore)||void 0===t?void 0:t.mapCookies(e))||{};null===(o=this.cookieStore)||void 0===o||o.bakeShadowCookie(null===(n=this.cookieStore)||void 0===n?void 0:n.createShadowCookieValue(i,!0)),this.consentDeclinedCallback&&this.consentDeclinedCallback(i)},e.prototype.onDNSEnabled=function(e,t){var o;null!=t&&""!==t&&null!=e&&(null===(o=this.cookieStore)||void 0===o||o.bakeDNSCookie({optInToDNS:e,expireDate:t}))},e.prototype.onDNSDisabled=function(){var e;null===(e=this.cookieStore)||void 0===e||e.clearDNSCookie()},e.prototype.onClickManageCookies=function(e){var t;e.preventDefault(),null===(t=this.consentIframeWrapper)||void 0===t||t.openOptionsDialog()},e.prototype.onBannerVisible=function(e){var t,o,n,i;(null===(t=this.cookieStore)||void 0===t?void 0:t.hasUserInteracted())||null===(o=this.cookieStore)||void 0===o||o.bakeShadowCookie(null===(n=this.cookieStore)||void 0===n?void 0:n.createShadowCookieValue(null===(i=this.cookieStore)||void 0===i?void 0:i.mapCookies({}),!1)),this.onBannerVisibleCallback&&this.onBannerVisibleCallback(e)},e.prototype.findManageCookies=function(){return document.querySelector('a[href*="#manage-cookies"]')||null},e.prototype.findCookiePolicy=function(e){return(null==e?void 0:e.querySelector('a[href*="/terms/cookies"],a[href*="/accounts-billing/security/cookies"]'))||null},e.prototype.getLinkWrapper=function(e){return e.closest("li")},e.prototype.createManageCookies=function(e){var t=this,o=this.getLinkWrapper(e);if(o){var n=o.cloneNode(),i=document.createElement("a");return i.textContent=this.config.isCcpaEnabled?this.intlText.cookiesAndCCPA:this.intlText.manageCookies,i.setAttribute("class",e.className),i.setAttribute("href","#manage-cookies"),i.onclick=function(e){return t.onClickManageCookies(e)},n.appendChild(i),n}return null},e.prototype.findFooter=function(){var e=["pre-footer","matrix__footer","footer-cta","footer-secondary-cta","cta-footer"],t=["div","section","footer"],o=Array.from(document.querySelectorAll(["footer",'[id="footer"]','[class="footer"]','[class^="footer "]','[class*=" footer "]','[class$=" footer"]','[id*="-footer"]','[id^="footer-"]','[id*="_footer"]','[id^="footer_"]','[class*="-footer"]','[class^="footer-"]','[class*="_footer"]','[class^="footer_"]'].join(","))).filter((function(o){return t.includes(o.tagName.toLowerCase())&&!e.some((function(e){return o.classList.contains(e)}))}));return o.length?o[0]:null},e.prototype.injectManageCookies=function(){if(!this.manageCookiesSet&&!this.manageCookiesInjected){var e=this.findFooter(),t=e?this.findCookiePolicy(e):null;if(!this.manageCookiesSet&&t){var o=this.createManageCookies(t),n=this.getLinkWrapper(t);o&&n&&(n.insertAdjacentElement("afterend",o),this.renameCookiePolicyLink(t),this.manageCookiesInjected=!0)}}},e.prototype.renameCookiePolicyLink=function(e){e.textContent=this.intlText.cookiePolicy},e.prototype.logPrivacyConsentResult=function(){var e,t=this.manageCookiesSet||this.manageCookiesInjected||this.floatingButtonVisible||this.bannerVisible;null===(e=this.log)||void 0===e||e.logPrivacyConsentResult(t)},e})();t.PrivacyConsentPlatformSingleton=i})),define("modules/clean/privacy_consent/stats",["require","exports","modules/clean/metrics/index","apex-metrics/index","modules/core/exception"],(function(e,t,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PrivacyConsentStats=t.PrivacyConsentStatsSingleton=t.PrivacyConsentAmpMetrics=t.PrivacyConsentEvent=t.CCPAEvent=void 0;(function(e){e.DNS_OPT_IN="dns_opt_in_submitted",e.DNS_OPT_OUT="dns_opt_out_submitted",e.IFRAME_LOAD_SUCCESS="ccpa_iframe_load_success",e.IFRAME_LOAD_ERROR="ccpa_iframe_load_error",e.LOGGED_IN_OPT_OUT_DNS_ERROR="ccpa_logged_in_opt_out_dns_error",e.LOGGED_IN_OPT_IN_DNS_ERROR="ccpa_logged_in_opt_in_dns_error",e.LOGGED_IN_RESEND_EMAIL_ERROR="ccpa_logged_in_resend_email_error",e.LOGGED_OUT_OPT_OUT_DNS_ERROR="ccpa_logged_out_opt_out_dns_error",e.LOGGED_OUT_OPT_IN_DNS_ERROR="ccpa_logged_out_opt_in_dns_error",e.LOGGED_OUT_RESEND_EMAIL_ERROR="ccpa_logged_out_resend_email_error",e.EMAIL_VERIFICATION_PAGE_VISIT="ccpa_email_verification_page_visited",e.EMAIL_VERIFICATION_PAGE_ERROR="ccpa_email_verification_page_error",e.EMAIL_VERIFICATION_CONFIRM_CLICKED="ccpa_email_confirm_clicked",e.EMAIL_VERIFICATION_CANCEL_CLICKED="ccpa_email_cancel_clicked"})(t.CCPAEvent||(t.CCPAEvent={})),(function(e){e.SETUP_REENTRY_SUCCESS="setup_reentry_success",e.SETUP_REENTRY_FAILURE="setup_reentry_failure",e.SETUP_REENTRY_START="setup_reentry_start"})(t.PrivacyConsentEvent||(t.PrivacyConsentEvent={})),(function(e){e.CCPA_IFRAME_LOAD_LATENCY="ccpa_iframe_load_latency",e.CROWNPEAK_LOAD_LATENCY="crownpeak_load_latency",e.EVENTS="events"})(t.PrivacyConsentAmpMetrics||(t.PrivacyConsentAmpMetrics={}));var r=(function(){function e(){this.metricsReporter=o.getMetricsReporter()}return e.prototype.createCounter=function(e,t){return void 0===t&&(t={}),this.metricsReporter.createCounter({ns:"privacy_consent",name:e},t)},e.prototype.createStats=function(e,t){return void 0===t&&(t={}),this.metricsReporter.createStats({ns:"privacy_consent",name:e},t)},e.prototype.logCounter=function(e,t){void 0===t&&(t={});try{var o=this.createCounter(e,t);o.increment(),o.record()}catch(t){i.reportStack("PrivacyConsentAmpLogError: Failed to log AMP metric for event: "+e+".",{severity:i.SEVERITY.NONCRITICAL,tags:["privacy_consent"],silent:!0})}},e.prototype.logDuration=function(e,t,o){void 0===t&&(t={});try{this.createStats(e,t).recordDuration(o,n.TimeUnit.MILLISECONDS)}catch(t){i.reportStack("PrivacyConsentAmpLogError: Failed to log AMP metric for event: "+e+".",{severity:i.SEVERITY.NONCRITICAL,tags:["privacy_consent"],silent:!0})}},e.prototype.logStats=function(e,t,o){void 0===t&&(t={});try{this.createStats(e,t).record(o)}catch(t){i.reportStack("PrivacyConsentAmpLogError: Failed to log AMP metric for event: "+e+".",{severity:i.SEVERITY.NONCRITICAL,tags:["privacy_consent"],silent:!0})}},e})();t.PrivacyConsentStatsSingleton=r,t.PrivacyConsentStats=new r}));
//# sourceMappingURL=pkg-privacy-consent.min.js-vfl5SLX6Q.map
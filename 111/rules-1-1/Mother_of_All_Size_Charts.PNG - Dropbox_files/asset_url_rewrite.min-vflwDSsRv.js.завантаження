define(["require","exports","tslib"],(function(e,t,r){"use strict";function n(e){return function(t){return void 0===t||""==t?"":e(new URL(t))}}function a(e){return e?e.split(/,\s?/g).map((function(e){var t=e.split(/\s+/g);return[t[0],t[1]]})):[]}function s(e){var t=n(e),s=(function(e){var t=null==e?function(e){return e.toString()}:function(t){return e(t)};return function(e){var r=new URL(e);return r.searchParams.append("sheet","SHEET_PLACEHOLDER"),r.searchParams.append("tile","TILE_PLACEHOLDER"),t(r)}})(e),i=(function(e){return function(t){if(!t)return"";var r=new URL(t);return r.pathname=r.pathname.replace("/p/html/","/p/html_desktop/"),e(r)}})(e);return function(e){var n;if(!e.preview||!e.preview.content)return e;var u=e.preview;if(!u.content)return e;switch(u.content[".tag"]){case"image":return r.__assign(r.__assign({},e),{preview:r.__assign(r.__assign({},u),{preview_url:t(u.preview_url),content:r.__assign(r.__assign({},u.content),{full_size_src:t(u.content.full_size_src),default_src:t(u.content.default_src),src_set:a(u.content.src_set).map((function(e){var r=e[0],n=e[1];return t(r)+" "+n})).join(","),thumbnail_url_tmpl:null!==(n=t(u.content.thumbnail_url_tmpl))&&void 0!==n?n:""})})});case"excel":var l=s(u.content.tile_url_tmpl);return r.__assign(r.__assign({},e),{preview:r.__assign(r.__assign({},u),{content:r.__assign(r.__assign({},u.content),{tile_url_tmpl:l})})});case"html":var _=i(u.preview_url);return r.__assign(r.__assign({},e),{preview:r.__assign(r.__assign({},u),{preview_url:_})})}return e}}Object.defineProperty(t,"__esModule",{value:!0}),t.assetUrlRewrite=void 0;t.assetUrlRewrite=function(e){var t=null!=e?e:function(e){return e.toString()},i=(function(e){var t=s(e);return function(e){var n=e.results.map(t);return r.__assign(r.__assign({},e),{results:n})}})(t),u=n(t);return function(e){return function(e){return function(t){return"@@apiv2_redux/previews/get_preview_data_batch_result"===t.type?t.payload.result&&(t.payload.result=i(t.payload.result)):"@@previews/fetchPageDataWithMetadataResult"===t.type?t.payload.data&&Array.isArray(t.payload.data.pages)&&t.payload.data.pages.forEach((function(e){e.thumbnailUrl=u(e.thumbnailUrl),e.imgUrls["1x"]=u(e.imgUrls["1x"]),e.imgUrls["4x"]=u(e.imgUrls["4x"]),e.imgUrls.srcset=a(e.imgUrls.srcset).map((function(e){var t=e[0],r=e[1];return u(t)+" "+r})).join(",")})):"@@previews/fetchUnifiedPreviewAsset"===t.type&&t.payload.assetUrl&&(t.payload.assetUrl=u(t.payload.assetUrl)),e(t)}}}}}));
//# sourceMappingURL=asset_url_rewrite.min.js-vfl7HGwYT.map
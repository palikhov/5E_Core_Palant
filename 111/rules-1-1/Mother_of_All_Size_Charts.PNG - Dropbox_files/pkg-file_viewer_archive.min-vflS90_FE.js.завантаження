define("modules/clean/react/previews/archive/api",["require","exports","tslib","lodash","modules/clean/react/previews/archive/constants","api_v2/user_client","api_v2/noauth_client","modules/clean/filepath/filepath","modules/core/exception"],(function(e,t,r,n,o,i,a,s,l){"use strict";function c(e){return{name:e.name,size:void 0!==e.size?parseInt(e.size,10):void 0,isDir:e.isDir,children:e.children?(t=e.children,n.keyBy(n.values(t.map(c)),"name")):{}};var t}function d(e){var t=s.file_extension(e);if(!o.COMPRESSED_EXTENSIONS.includes(t))return!1;var r=s.filename_without_extension(e),n=s.file_extension(r);return!o.COMPRESSED_CONTAINER_EXTENSIONS.includes(n)}function u(e){return{isDir:!0,isEncrypted:!1,children:[{isDir:!1,isEncrypted:!1,name:s.filename_without_extension(e)}],name:"/",size:"0"}}Object.defineProperty(t,"__esModule",{value:!0}),t.fetchArchiveFiles=t.fetchRootArchiveEntry=t.generateRootArchiveEntry=t.shouldMockRootArchiveEntry=void 0,n=r.__importStar(n),o=r.__importStar(o),s=r.__importStar(s),l=r.__importStar(l),t.shouldMockRootArchiveEntry=d,t.generateRootArchiveEntry=u,t.fetchRootArchiveEntry=function(e){return new Promise((function(t,r){var n=function(e){var r;t({rootEntry:c(r=e),isPasswordProtected:!!r.isEncrypted})};if(d(e.filename)){var o=u(e.filename);n(o)}else{var i=new XMLHttpRequest;i.open("GET",e.url),i.withCredentials=!0,i.onreadystatechange=function(){if(i.readyState===XMLHttpRequest.DONE)if(200===i.status){var e=i.response,t=JSON.parse(e);n(t)}else{l.reportException({err:new Error("Failed to retrieve entry tree"),tags:["archivePreviews"],severity:l.SEVERITY.NONCRITICAL}),r("Failed to retrieve entry tree")}},i.send()}}))},t.fetchArchiveFiles=function(e){var t=e.rootFile,r=e.subpathInfos,o=e.user,s=e.sharedLinkUrl,l={root_file_info:{ns_id:t.ns_id,sj_id:t.sjid,url:s},subpaths:r.map((function(e){return e.subpath})),subpath_sizes:r.some((function(e){return void 0===e.size}))?void 0:r.map((function(e){return e.size}))};return(o?(new i.UserApiV2Client).ns("previews").rpc("get_archive_files",l,{subjectUserId:o.id}):(new a.NoAuthApiV2Client).ns("previews").rpc("logged_out/get_archive_files",l,{})).then((function(e){return t=e.archive_files,n.keyBy(t,"subpath");var t}))}})),define("modules/clean/react/previews/archive/app",["require","exports","tslib","react","modules/clean/previews/util","modules/clean/loggers/file_preview_logger","modules/clean/react/file_viewer/logging","modules/clean/file_store/utils","modules/clean/react/file_viewer/file_preview_event_emitter","modules/clean/react/file_viewer/constants","modules/clean/file_store/utils","modules/clean/react/file_viewer/location_utils","modules/clean/react/previews/archive/archive_entry_watcher","modules/clean/react/previews/archive/keyboard_binding_connector","modules/clean/react/previews/archive/utils","modules/clean/react/previews/archive/view","modules/clean/web_timing_logger","modules/clean/redux/constants","modules/clean/file_store/utils"],(function(e,t,r,n,o,i,a,s,l,c,d,u,p,f,m,h,_,g,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.App=void 0,n=r.__importDefault(n),s=r.__importStar(s),_=r.__importStar(_);var y=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.logger=null,t.onFetchSuccess=function(){if(t.markWebTiming(),t.logFilePreviewTimeline(c.EventType.FilePreviewDownloadSucceeded),t.logFilePreviewTimeline(c.EventType.FilePreviewRenderSucceeded),t.props.entry){var e=m.scanEntryContents(t.props.entry);t.logArchivePreviewEvent(c.EventType.ArchivePreviewContentsScanned,e)}t.props.setRenderStatusSuccess()},t.onFetchFailure=function(){t.logFilePreviewTimeline(c.EventType.FilePreviewDownloadFailed),t.props.onError&&t.props.onError()},t.handleEntryRowClick=function(e,r){e.preventDefault();var n=t.props.fileSubpath;if(r){var o=u.addToFileSubpath(n,r.name);u.updateFileSubpathQuery(o),t.logUserAction(r,c.UserAction.ArchiveNavigation,c.UserActionContext.PreviewContentMain)}},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.setUpLogger(),this.fetchArchiveContents()},t.prototype.componentWillUnmount=function(){this.teardownLogger(),this.props.resetState(),u.updateFileSubpathQuery(null)},t.prototype.componentDidUpdate=function(e){if(v.areFilesEqual(e.rootFile,this.props.rootFile)&&e.previewUrl===this.props.previewUrl||(this.props.resetState(),this.fetchArchiveContents()),e.treeApiStatus===g.ApiClientStatus.Fetch)switch(this.props.treeApiStatus){case g.ApiClientStatus.Success:this.onFetchSuccess();break;case g.ApiClientStatus.Error:this.onFetchFailure()}},t.prototype.fetchArchiveContents=function(){if(this.logFilePreviewTimeline(c.EventType.FilePreviewSupportConfirmed),this.props.previewUrl){this.logFilePreviewTimeline(c.EventType.FilePreviewDownloadAttempted);var e=m.getPreviewUrl(this.props.previewUrl),t=s.getFilename(this.props.rootFile);this.props.fetchRootArchiveEntry({url:e,filename:t})}else this.props.onError&&this.props.onError()},t.prototype.setUpLogger=function(){this.logger&&this.teardownLogger(),this.logger=new i.FilePreviewArchiveLogger,this.logger.listenTo(l.filePreviewEventEmitter)},t.prototype.teardownLogger=function(){var e;null===(e=this.logger)||void 0===e||e.unlistenTo(l.filePreviewEventEmitter),this.logger=null},t.prototype.logFilePreviewTimeline=function(e){this.props.filePreviewSession&&this.props.filePreviewSession.recordEvent(e)},t.prototype.logArchivePreviewEvent=function(e,t){void 0===t&&(t={}),l.filePreviewEventEmitter.emit(e,this.props.filePreviewSession,t)},t.prototype.logUserAction=function(e,t,r){a.logUserAction(t,r,{isDir:e.isDir,extension:e.isDir?"":o.getWhitelistedExtension(e.name)})},t.prototype.markWebTiming=function(){this.props.filePreviewSession&&this.props.filePreviewSession.markPrimaryEvent(),_.mark_time_to_view(),_.mark_time_to_interactive()},t.prototype.render=function(){return n.default.createElement("div",null,n.default.createElement(h.View,{entry:this.props.entry,fileExtension:d.getExtension(this.props.rootFile),isPasswordProtected:this.props.isPasswordProtected,onEntryRowClick:this.handleEntryRowClick,rootFile:this.props.rootFile,currentSubpath:this.props.fileSubpath,encryptionOptions:this.props.encryptionOptions,user:this.props.user,sharePermission:this.props.sharePermission,shareToken:this.props.shareToken}),n.default.createElement(p.ArchiveEntryWatcher,{rootFile:this.props.rootFile,fileSubpath:this.props.fileSubpath,sharedLinkUrl:this.props.sharedLinkUrl,user:this.props.user}),n.default.createElement(f.ArchiveKeyboardBindingConnector,{fileSubpath:this.props.fileSubpath}))},t.displayName="App",t})(n.default.Component);t.App=y})),define("modules/clean/react/previews/archive/archive_entry_watcher",["require","exports","tslib","react","react-redux","modules/clean/react/previews/archive/data/actions","modules/clean/react/previews/archive/data/selectors","modules/clean/react/previews/archive/utils"],(function(e,t,r,n,o,i,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ArchiveEntryWatcher=t.UnconnectedArchiveEntryWatcher=void 0;var l=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.fetchArchiveFiles=function(e){var r=t.props;(0,r.fetchArchiveFiles)({rootFile:r.rootFile,subpathInfos:e,sharedLinkUrl:r.sharedLinkUrl,user:r.user})},t}return r.__extends(t,e),t.prototype.componentDidUpdate=function(){var e=this.props.neededSubpathInfos;e.length&&this.fetchArchiveFiles(e)},t.prototype.render=function(){return null},t.displayName="UnconnectedArchiveEntryWatcher",t})((n=r.__importDefault(n)).default.Component);t.UnconnectedArchiveEntryWatcher=l;var c=a.makeGetArchiveEntry();var d={fetchArchiveFiles:i.fetchArchiveFiles};t.ArchiveEntryWatcher=o.connect((function(e,t){var r=t.rootFile,n=t.fileSubpath,o=c(e,{fileSubpath:n,rootFile:r});return{neededSubpathInfos:s.getNeededArchiveFileSubpathInfos(n,o).filter((function(t){return a.getShouldFetchArchiveFiles(e,{subpath:t.subpath})}))}}),d)(l)})),define("modules/clean/react/previews/archive/constants",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.COMPRESSED_CONTAINER_EXTENSIONS=t.COMPRESSED_EXTENSIONS=t.MAX_ROW_WIDTH_IN_EMS=t.DEFAULT_NUM_ROWS=void 0,t.DEFAULT_NUM_ROWS=10,t.MAX_ROW_WIDTH_IN_EMS=17,t.COMPRESSED_EXTENSIONS=["bz","bz2","gz","lz","lzma","xz","z"],t.COMPRESSED_CONTAINER_EXTENSIONS=["tar","xar"]})),define("modules/clean/react/previews/archive/data/actions",["require","exports","tslib","lodash","modules/clean/react/previews/archive/api","modules/clean/previews/data/actions"],(function(e,t,r,n,o,i){"use strict";var a;function s(){return{type:a.GetTreeApiFetch}}function l(e){var t=e.entry,r=e.isPasswordProtected;return{type:a.GetTreeApiSuccess,payload:{entry:t,isPasswordProtected:r}}}function c(e){return{type:a.GetTreeApiError,payload:{error:e}}}function d(e){var t=e.subpaths;return{type:a.GetArchiveFilesApiFetch,meta:{subpaths:t}}}function u(e){return{type:a.GetArchiveFilesApiSuccess,payload:{archiveFiles:e}}}function p(e,t){var r=t.subpaths;return{type:a.GetArchiveFilesApiError,meta:{subpaths:r},error:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.fetchArchiveFiles=t.fetchRootArchiveEntry=t.resetState=t.getArchiveFilesApiError=t.getArchiveFilesApiSuccess=t.getArchiveFilesApiFetch=t.getTreeApiError=t.getTreeApiSuccess=t.getTreeApiFetch=t.Actions=void 0,o=r.__importStar(o),(function(e){e.ResetState="ArchivePreviewResetState",e.GetTreeApiFetch="ArchivePreviewGetTreeApiFetch",e.GetTreeApiSuccess="ArchivePreviewGetTreeApiSuccess",e.GetTreeApiError="ArchivePreviewGetTreeApiError",e.GetArchiveFilesApiFetch="ArchivePreviewGetArchiveFilesApiFetch",e.GetArchiveFilesApiSuccess="ArchivePreviewGetArchiveFilesApiSuccess",e.GetArchiveFilesApiError="ArchivePreviewGetArchiveFilesApiError"})(a=t.Actions||(t.Actions={})),t.getTreeApiFetch=s,t.getTreeApiSuccess=l,t.getTreeApiError=c,t.getArchiveFilesApiFetch=d,t.getArchiveFilesApiSuccess=u,t.getArchiveFilesApiError=p,t.resetState=function(){return{type:a.ResetState}},t.fetchRootArchiveEntry=function(e){return function(t){t(s()),o.fetchRootArchiveEntry(e).then((function(e){var r=e.rootEntry,n=e.isPasswordProtected;t(l({entry:r,isPasswordProtected:n}))})).catch((function(e){t(c(e))}))}},t.fetchArchiveFiles=function(e){var t=e.rootFile,r=e.sharedLinkUrl,a=e.subpathInfos,s=e.user,l=a.map((function(e){return e.subpath}));return function(e){return e(d({subpaths:l})),o.fetchArchiveFiles({rootFile:t,sharedLinkUrl:r,subpathInfos:a,user:s}).then((function(r){return e(u(r)),e(i.populateArchivePreviews(t,n.values(r))),r})).catch((function(t){return e(p(t,{subpaths:l})),t}))}}})),define("modules/clean/react/previews/archive/data/reducer",["require","exports","tslib","modules/clean/react/previews/archive/data/actions","modules/clean/redux/constants"],(function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.previewArchiveReducer=t.initialState=void 0,t.initialState={archiveFiles:{},rootEntry:void 0,treeApiStatus:void 0,error:void 0},t.previewArchiveReducer=function(e,i){switch(void 0===e&&(e=t.initialState),i.type){case n.Actions.GetTreeApiFetch:return r.__assign(r.__assign({},e),{treeApiStatus:o.ApiClientStatus.Fetch});case n.Actions.GetTreeApiSuccess:return r.__assign(r.__assign({},e),{rootEntry:i.payload.entry,isPasswordProtected:i.payload.isPasswordProtected,treeApiStatus:o.ApiClientStatus.Success});case n.Actions.GetTreeApiError:return r.__assign(r.__assign({},e),{treeApiStatus:o.ApiClientStatus.Error,error:i.payload.error});case n.Actions.GetArchiveFilesApiFetch:return r.__assign(r.__assign({},e),{archiveFiles:r.__assign(r.__assign({},e.archiveFiles),i.meta.subpaths.reduce((function(e,t){return e[t]={archiveFile:void 0,apiStatus:o.ApiClientStatus.Fetch},e}),{}))});case n.Actions.GetArchiveFilesApiSuccess:for(var a=i.payload.archiveFiles,s={},l=0,c=Object.keys(a);l<c.length;l++){var d=c[l];s[d]={archiveFile:a[d],apiStatus:o.ApiClientStatus.Success}}return r.__assign(r.__assign({},e),{archiveFiles:r.__assign(r.__assign({},e.archiveFiles),s)});case n.Actions.GetArchiveFilesApiError:return r.__assign(r.__assign({},e),{archiveFiles:r.__assign({},i.meta.subpaths.reduce((function(e,t){return e[t]={archiveFile:void 0,apiStatus:o.ApiClientStatus.Error,error:i.error},e}),{}))});case n.Actions.ResetState:return t.initialState;default:return e}}})),define("modules/clean/react/previews/archive/data/selectors",["require","exports","tslib","lodash","reselect","modules/clean/react/previews/archive/data/utils","modules/clean/redux/constants","modules/clean/redux/namespaces"],(function(e,t,r,n,o,i,a,s){"use strict";function l(e){return e[s.PREVIEW_ARCHIVE_NAMESPACE_KEY]}Object.defineProperty(t,"__esModule",{value:!0}),t.getTreeApiStatus=t.isErrorStateForSubpath=t.getShouldFetchArchiveFiles=t.makeGetArchiveEntry=t.getEncryptedStatus=void 0,n=r.__importStar(n),t.getEncryptedStatus=function(e){return l(e).isPasswordProtected};var c=function(e,t){var r=(function(e,t){var r=l(e).archiveFiles;if(r)return r[t]})(e,t.subpath);if(r)return r.apiStatus},d=function(e){return l(e).rootEntry},u=n.flow(l,(function(e){return n.get(e,"archiveFiles",{})}));function p(e,t,r){var n=r.fileSubpath,o=r.rootFile;if(!e)return e;var a=n?i.walkEntryTree(e,n):e;return i.getEntryWithArchiveFiles({subpath:n,rootFile:o,entry:a,archiveFilesMap:t})}t.makeGetArchiveEntry=function(){return o.createSelector([d,u,function(e,t){return t}],p)},t.getShouldFetchArchiveFiles=function(e,t){var r=t.subpath;if(!r)return!1;var n=c(e,{subpath:r});return!n||![a.ApiClientStatus.Fetch,a.ApiClientStatus.Error].includes(n)},t.isErrorStateForSubpath=function(e,t){var r=t.subpath;return!!r&&c(e,{subpath:r})===a.ApiClientStatus.Error},t.getTreeApiStatus=function(e){return l(e).treeApiStatus}})),define("modules/clean/react/previews/archive/data/store",["require","exports","modules/clean/react/previews/archive/data/reducer","modules/clean/redux/namespaces","modules/clean/redux/store"],(function(e,t,r,n,o){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.getStoreForPreviewArchive=void 0,t.getStoreForPreviewArchive=function(){var e;return i||(i=o.getStoreAndRegisterReducers(((e={})[n.PREVIEW_ARCHIVE_NAMESPACE_KEY]=r.previewArchiveReducer,e))),i}})),define("modules/clean/react/previews/archive/data/utils",["require","exports","tslib","lodash","modules/clean/react/file_viewer/location_utils","modules/clean/react/previews/archive/utils"],(function(e,t,r,n,o,i){"use strict";function a(e){var t=e.subpath,n=e.entry,o=e.rootFile,a=e.archiveFilesMap;if(n.isDir||!t)return n;var s=a[t]&&a[t].archiveFile;return r.__assign(r.__assign({},n),{file:i.createFileFromEntryAndApi(n,o,s)})}Object.defineProperty(t,"__esModule",{value:!0}),t.getEntryWithArchiveFiles=t.walkEntryTree=void 0,n=r.__importStar(n),t.walkEntryTree=function(e,t){for(var r=t.substring(1).split("/"),n=e,i="";r.length;){var a=r.shift(),s=a?n.children[a]:void 0;if(!s)return i!==t&&o.updateFileSubpathQuery(i),n;n=s,i+="/"+a}return n},t.getEntryWithArchiveFiles=function(e){return e.entry.isDir?(i=(t=e).subpath,s=t.entry,l=t.rootFile,c=t.archiveFilesMap,d=n.mapValues(s.children,(function(e,t){return a({subpath:o.addToFileSubpath(i,t),entry:e,rootFile:l,archiveFilesMap:c})})),r.__assign(r.__assign({},s),{children:d})):a(e);var t,i,s,l,c,d}})),define("modules/clean/react/previews/archive/entry_row",["require","exports","tslib","react","spectrum/file_icon/index","spectrum/icon_content/index","spectrum/media_table/index","modules/clean/display_format","modules/clean/em_string","modules/clean/react/previews/archive/constants","modules/clean/react/previews/archive/utils","modules/clean/react/thumbnail"],(function(e,t,r,n,o,i,a,s,l,c,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EntryRow=void 0;var p=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClick=function(e){e.stopPropagation(),t.props.onClick&&t.props.onClick(e,t.props.entry)},t}return r.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props,r=t.entry,o=t.shouldHideSize,i=t.topOffset;return this.props.onClick?n.default.createElement(a.CulledMediaRow,{topOffset:i,onClick:this.handleClick,doubleLine:!0},(function(t){var n=t.isHovered;return f({entry:r,highlight:n,onClick:e.handleClick,shouldHideSize:o})})):n.default.createElement(a.CulledMediaRow,{topOffset:i,doubleLine:!0},f({entry:r,shouldHideSize:o}))},t.displayName="EntryRow",t})((n=r.__importDefault(n)).default.Component);t.EntryRow=p;var f=function(e){var t=e.entry,r=e.onClick,o=e.highlight,i=e.shouldHideSize,d=l.Emstring.em_snippet(t.name,c.MAX_ROW_WIDTH_IN_EMS),u=[n.default.createElement(a.MediaCell,{key:"rowname",title:r?n.default.createElement("button",{className:"entry-row-button",onClick:r,"aria-label":t.name},d):d,icon:n.default.createElement(m,{displayName:t.name,file:t.file,isDir:t.isDir}),highlight:o})];return t.size&&!i&&u.push(n.default.createElement(a.MediaCell,{key:"rowsize",title:s.format_bytes(t.size)})),u},m=function(e){return e.isDir?n.default.createElement(i.IconContent,{name:"folder-small"}):e.file&&d.shouldAllowVisualFolderIcons()?n.default.createElement(u.ThumbnailIcon,{className:"entry-row-icon",file:e.file,alt:e.displayName}):n.default.createElement(o.FileIcon,{path:e.displayName})}})),define("modules/clean/react/previews/archive/file_entry_view",["require","exports","tslib","react","classnames","modules/clean/react/file_viewer/data/selectors","modules/clean/redux/constants","modules/clean/react/previews/loading_indicator","modules/clean/react/file_viewer/file_preview","modules/clean/react/file_viewer/constants","modules/clean/react/size_class/size_class","modules/clean/react/previews/constants","modules/clean/previews/constants","react-redux","modules/clean/react/previews/archive/data/selectors","modules/clean/react/previews/archive/utils","modules/clean/react/size_class/constants","modules/clean/previews/data/selectors"],(function(e,t,r,n,o,i,a,s,l,c,d,u,p,f,m,h,_,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileEntryView=t._FileEntryView=t.PreviewTypeWhitelist=void 0,n=r.__importDefault(n),o=r.__importDefault(o),t.PreviewTypeWhitelist=[p.PreviewType.SsrDoc,p.PreviewType.Excel,p.PreviewType.HTML,p.PreviewType.Image,p.PreviewType.RawHTML],t._FileEntryView=function(e){var r=e.entry,o=e.extensionsEnabled,i=e.previewApiData,s=e.isErrorState,d=e.isFullscreen,p=e.isSidebarOpen,f=e.sidebar,m=e.sizeClass,g=e.rootFile,v=e.encryptionOptions,b=r.file,w=m!==_.SizeClass.Small,S={canCopyToDropboxRoles:[],canDownloadRoles:[],canPrintRoles:[],canRemoveLinkUids:[],canSyncToDropboxRoles:[],canViewContextMenuRoles:[],canViewMetadataRoles:[]};return b?n.default.createElement(l.FilePreviewWithLogging,{extensionsEnabled:o,file:b,isFullscreen:d,isSidebarOpen:p,sidebar:f,sourceAction:u.PreviewSourceAction.Click,sourceContext:u.PreviewSourceContext.ArchiveFile,maxFilenameEmLength:c.SizeClassFilenameLengthMap[m],previewTypeWhitelist:t.PreviewTypeWhitelist,sharePermission:S,shouldDisplayToolbar:w,previewApiData:i,sizeClass:m,encryptionOptions:v}):s?n.default.createElement(l.FilePreview,{extensionsEnabled:o,file:h.createFileFromEntry(r,g),previewApiData:{data:void 0,status:a.ApiClientStatus.Error},isFullscreen:d,isSidebarOpen:p,sidebar:f,sourceAction:u.PreviewSourceAction.Click,sourceContext:u.PreviewSourceContext.ArchiveFile,maxFilenameEmLength:c.SizeClassFilenameLengthMap[m],previewTypeWhitelist:t.PreviewTypeWhitelist,sharePermission:S,shouldDisplayToolbar:w,sizeClass:m,encryptionOptions:v}):n.default.createElement(y,null)};var v=d.withSizeClass(t._FileEntryView,{responsiveClassName:"preview-content--full-height"});t.FileEntryView=f.connect((function(e,t){return{previewApiData:g.getPreviewForArchiveFile(e,t.entry.file),extensionsEnabled:i.getExtensionsEnabled(e),isFullscreen:i.getIsFullScreen(e),isSidebarOpen:i.getIsSidebarOpen(e),isErrorState:m.isErrorStateForSubpath(e,{subpath:t.currentSubpath}),sidebar:i.getSidebar(e)}}))(v);var y=function(){return n.default.createElement("div",{className:o.default("preview-content","preview-content--center","preview-content--full-height")},n.default.createElement(s.LoadingIndicator,null))}})),define("modules/clean/react/previews/archive/folder_entry_view",["require","exports","tslib","react","classnames","lodash","spectrum/icon_content/index","spectrum/dimensions/index","spectrum/table/index","modules/clean/react/previews/archive/entry_row","modules/clean/react/size_class/size_class","modules/clean/react/size_class/constants","modules/core/i18n","modules/clean/react/file_viewer/file_conversion/utils"],(function(e,t,r,n,o,i,a,s,l,c,d,u,p,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FolderEntryView=void 0,n=r.__importDefault(n),o=r.__importDefault(o),i=r.__importStar(i),t.FolderEntryView=function(e){var t=e.entry,r=e.onEntryRowClick,o=e.shouldAllowFileNavigation,a=e.file,s=e.user,l=e.sharePermission,c=e.shareToken,d=i.values(t.children),u=d.length?n.default.createElement(h,{entries:d,onRowClick:r,shouldAllowFileNavigation:o}):n.default.createElement(_,null),p=f.getConversionsForPreview(a,s,c,l);return n.default.createElement(n.default.Fragment,null,p,u)};var m=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderEntryRow=function(e,r,o){var i=t.props.shouldAllowFileNavigation||e.isDir?t.props.onRowClick:void 0;return n.default.createElement(c.EntryRow,{entry:e,onClick:i,shouldHideSize:t.props.sizeClass===u.SizeClass.Small,topOffset:o})},t}return r.__extends(t,e),t.prototype.render=function(){var e=this;return n.default.createElement(s.Dimensions,{className:"preview-archive__table"},(function(t){t.width;var r=t.height;return n.default.createElement(l.Table,null,n.default.createElement(l.FixedTableHead,null,n.default.createElement(l.TableHeadCell,null,p.intl.formatMessage({id:"cJojIg",defaultMessage:"Name"})),e.props.sizeClass===u.SizeClass.Small?null:n.default.createElement(l.TableHeadCell,null,p.intl.formatMessage({id:"txUjQq",defaultMessage:"Size"}))),n.default.createElement(l.CulledTableBody,{items:e.props.entries,listItemHeight:72,renderRow:e.renderEntryRow,viewportHeight:r,shouldUseWindowAsScrollContainer:!1}))}))},t.displayName="InternalFolderListView",t})(n.default.Component),h=d.withSizeClass(m,{responsiveClassName:"preview-content--full-height"}),_=function(){return n.default.createElement("div",{className:o.default("preview-content","preview-content--center","preview-content--column","preview-content--full-height","preview-archive--empty")},n.default.createElement(a.IconContent,{name:"folder-small"}),n.default.createElement("div",{className:"empty-text u-pad-top-s"},p.intl.formatMessage({id:"YLBqRL",defaultMessage:"This folder is empty"})))}})),define("modules/clean/react/previews/archive/keyboard_binding_connector",["require","exports","tslib","react","ts-keycode-enum","modules/clean/react/file_viewer/location_utils","modules/clean/react/keyboard_binding/keyboard_binding","modules/clean/react/keyboard_binding/keyboard_binding_connector"],(function(e,t,r,n,o,i,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ArchiveKeyboardBindingConnector=void 0;var l=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleKeyPress=function(){var e=i.shortenFileSubpathBy(t.props.fileSubpath,1);return i.updateFileSubpathQuery(e),!0},t.keyboardBindings=[{keyboardEventCriteria:a.generateUnmodifiedKeyboardEventCriteria(o.Key.Escape),callback:t.handleKeyPress}],t}return r.__extends(t,e),t.prototype.render=function(){return n.default.createElement(s.KeyboardBindingConnector,{keyboardBindings:this.keyboardBindings})},t.displayName="ArchiveKeyboardBindingConnector",t})((n=r.__importDefault(n)).default.Component);t.ArchiveKeyboardBindingConnector=l})),define("modules/clean/react/previews/archive/preview_archive",["require","exports","tslib","react","react-redux","modules/clean/react/previews/archive/app","modules/clean/react/previews/archive/data/selectors","modules/clean/react/previews/archive/data/store","modules/clean/react/previews/archive/data/actions","modules/clean/react/components/css"],(function(e,t,r,n,o,i,a,s,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PreviewArchiveForTesting=t.PreviewArchive=void 0,n=r.__importDefault(n);var d=a.makeGetArchiveEntry();var u={fetchRootArchiveEntry:l.fetchRootArchiveEntry,resetState:l.resetState},p=o.connect((function(e,t){return{entry:d(e,{fileSubpath:t.fileSubpath,rootFile:t.rootFile}),isPasswordProtected:a.getEncryptedStatus(e),treeApiStatus:a.getTreeApiStatus(e)}}),u)(i.App);t.PreviewArchiveForTesting=p;var f=s.getStoreForPreviewArchive(),m=c.requireCssWithComponent((function(e){return n.default.createElement(o.Provider,{store:f},n.default.createElement(p,r.__assign({},e)))}),["/static/css/preview_archive-vflWyumo_.css"]);t.PreviewArchive=m})),define("modules/clean/react/previews/archive/utils",["require","exports","tslib","lodash","modules/clean/react/file_viewer/location_utils","modules/clean/previews/util","modules/core/uri"],(function(e,t,r,n,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNeededArchiveFileSubpathInfos=t.createFileFromEntryAndApi=t.createFileFromEntry=t.scanEntryContents=t.shouldAllowVisualFolderIcons=t.getPreviewUrl=void 0,n=r.__importStar(n),t.getPreviewUrl=function(e){var t=a.URI.parse(e.toString()).toString();return"//"===t.slice(0,2)&&(t="https:"+t),t},t.shouldAllowVisualFolderIcons=function(){return!1},t.scanEntryContents=function(e){for(var t={},r=[e];r.length;){var o=r.shift();if(o.isDir)r.push.apply(r,n.values(o.children));else{var a=i.getWhitelistedExtension(o.name);t[a]=++t[a]||1}}return t},t.createFileFromEntry=function(e,t){return{subpath:e.name,is_dir:!1,filename:e.name,ns_id:t.ns_id,sjid:t.sjid,bytes:e.size,sort_key:void 0,href:void 0,ts:void 0,file_id:void 0,revision_id:void 0,is_symlink:!1}},t.createFileFromEntryAndApi=function(e,t,r){if(r)return{bytes:e.size,file_id:void 0,filename:r.filename,href:void 0,is_dir:!1,ns_id:t.ns_id,revision_id:void 0,sjid:t.sjid,sort_key:void 0,subpath:r.subpath,thumbnail_url_tmpl:r.thumbnail_url_tmpl,ts:void 0,is_symlink:!1,preview:r.preview}},t.getNeededArchiveFileSubpathInfos=function(e,t){return t?t.isDir||t.file||!e?n.values(t.children).filter((function(e){return!e.isDir&&!e.file})).map((function(t){return{subpath:o.addToFileSubpath(e,t.name),size:t.size}})):[{subpath:e,size:t.size}]:[]}})),define("modules/clean/react/previews/archive/view",["require","exports","tslib","react","spectrum/media_table_skeleton/index","spectrum/snackbar/index","modules/clean/react/async/loadable","modules/clean/react/previews/archive/folder_entry_view","modules/clean/react/previews/archive/constants","modules/core/i18n"],(function(e,t,r,n,o,i,a,s,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.View=void 0,n=r.__importDefault(n);var d=a.Loadable({loader:function(){return new Promise((function(t,r){e(["modules/clean/react/previews/archive/file_entry_view"],t,r)})).then(r.__importStar).then((function(e){return e.FileEntryView}))}});t.View=function(e){var t=e.entry,r=e.rootFile,o=e.fileExtension,a=e.isPasswordProtected,s=e.onEntryRowClick,l=e.currentSubpath,d=e.encryptionOptions,f=e.user,m=e.sharePermission,h=e.shareToken;return n.default.createElement("div",{className:"preview-archive"},n.default.createElement("div",{className:"preview-archive__content"},t?n.default.createElement(u,{entry:t,rootFile:r,shouldAllowFileNavigation:!a,onEntryRowClick:s,currentSubpath:l,encryptionOptions:d,user:f,sharePermission:m,shareToken:h}):n.default.createElement(p,null),a?n.default.createElement(i.Snackbar,{title:c.intl.formatMessage({id:"xONQyk",defaultMessage:"Can’t preview items in password-protected {extension} files."},{extension:"."+o}),variant:"warn"}):null))};var u=function(e){return e.entry.isDir?n.default.createElement(s.FolderEntryView,{entry:e.entry,onEntryRowClick:e.onEntryRowClick,shouldAllowFileNavigation:e.shouldAllowFileNavigation,file:e.rootFile,user:e.user,sharePermission:e.sharePermission,shareToken:e.shareToken}):n.default.createElement(d,{entry:e.entry,rootFile:e.rootFile,currentSubpath:e.currentSubpath,encryptionOptions:e.encryptionOptions})},p=function(){return n.default.createElement("div",{className:"preview-archive__table"},n.default.createElement(o.MediaTableSkeleton,{numRows:l.DEFAULT_NUM_ROWS}))}})),define("modules/clean/react/share_download/copy_to_dropbox/actions",["require","exports","tslib","modules/clean/react/share_download/copy_to_dropbox/api","modules/core/browser"],(function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.copySharedFile=void 0,n=r.__importStar(n),o=r.__importStar(o),t.copySharedFile=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var i;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,n.copySharedFile(e,t)];case 1:return i=r.sent(),o.redirect(i),[2]}}))}))}})),define("modules/clean/react/share_download/copy_to_dropbox/api",["require","exports","tslib","modules/clean/deprecated_ajax/ajax_as_promised_jquery"],(function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.copySharedFile=void 0,n=r.__importStar(n),t.copySharedFile=function(e,t){var r={link_key:e.linkKey,link_type:e.linkType,secure_hash:e.secureHash,subpath:e.subPath,rlkey:e.rlkey};return e.itemId&&(r.item_id=e.itemId),new Promise((function(e,o){return n.WebProgressRequest({url:"/sm/c2d",data:r,subject_user:t,success:e})}))}})),define("modules/clean/react/share_download/copy_to_dropbox/modal",["require","exports","tslib","react","modules/clean/analytics","modules/clean/em_string","modules/clean/filepath/filepath","modules/clean/react/share_download/copy_to_dropbox/actions","modules/clean/react/components/modal","modules/clean/share_download/types","modules/clean/react/share_download/utils","modules/clean/viewer","modules/core/i18n","modules/core/notify","modules/clean/loggers/folder_preview_logger","modules/clean/react/file_viewer/constants","modules/clean/react/file_viewer/logging"],(function(e,t,r,n,o,i,a,s,l,c,d,u,p,f,m,h,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CopyToDropboxModal=void 0,n=r.__importDefault(n),a=r.__importStar(a);var g=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleAccept=function(){var e,r;null===(r=(e=t.props).onAccept)||void 0===r||r.call(e);var n=v(t.props.role);f.Notify.success(n),s.copySharedFile(t.props.shareToken,t.props.userId),t.props.folderPreviewSession?m.logEvent(h.UserAction.SaveToDropboxApprove,t.props.folderPreviewSession):_.logUserAction(h.UserAction.SaveToDropboxApprove,h.UserActionContext.Unknown)},t.handleDismiss=function(e){var r,n;null===(n=(r=t.props).onDismiss)||void 0===n||n.call(r,e),t.props.folderPreviewSession?m.logEvent(h.UserAction.SaveToDropboxCancel,t.props.folderPreviewSession):_.logUserAction(h.UserAction.SaveToDropboxCancel,h.UserActionContext.Unknown)},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){o.WebMiscActivityLogger.log("show-c2d-modal")},t.prototype.render=function(){var e=this.props,t=e.copyable,r=e.role,o=d.getCopyableName(t),s=d.getCopyableType(t);return n.default.createElement(l.Modal,{title:y(o,r),acceptButtonText:p.intl.formatMessage({id:"78AHo5",defaultMessage:"Save"}),dismissButtonText:p.intl.formatMessage({id:"d9/SE1",defaultMessage:"Cancel"}),onAccept:this.handleAccept,onDismiss:this.handleDismiss,style:"default-maestro"},n.default.createElement("p",{className:"db-modal-message"},(function(e,t,r){var o=u.Viewer.get_viewer(),s=o.get_user_by_role(t);if(e=i.Emstring.em_snippet(e,15),s&&s.is_cdm_member)return p.intl.formatMessage({id:"3Sb6Ws",defaultMessage:"<strong>{name}</strong> will be saved to the <strong>{cdm_tmf_name}</strong> folder in your {team_name} Dropbox account."},{name:e,cdm_tmf_name:a.filename(s.cdm_tmf_path),team_name:o.team_name,strong:function(e){return n.default.createElement("strong",null,e)}});if(o.is_paired)switch(t){case"personal":return p.intl.formatMessage({id:"nBgj3Q",defaultMessage:"<strong>{name}</strong> will be saved to your personal Dropbox account and synced to any connected devices."},{name:e,strong:function(e){return n.default.createElement("strong",null,e)}});case"work":switch(r){case c.CopyableType.Collection:return p.intl.formatMessage({id:"2yp43H",defaultMessage:"This album will be instantly saved to your {team_name} Dropbox and downloaded to all the computers linked to your {team_name} account."},{team_name:o.team_name});case c.CopyableType.Folder:return p.intl.formatMessage({id:"eJs/IE",defaultMessage:"This folder will be instantly saved to your {team_name} Dropbox and downloaded to all the computers linked to your {team_name} account."},{team_name:o.team_name});default:return p.intl.formatMessage({id:"Kb1en/",defaultMessage:"This file will be instantly saved to your {team_name} Dropbox and downloaded to all the computers linked to your {team_name} account."},{team_name:o.team_name})}}switch(r){case c.CopyableType.Collection:return p.intl.formatMessage({id:"35MZFn",defaultMessage:"This album will be instantly saved to your Dropbox and downloaded to all the computers linked to your account."});case c.CopyableType.Folder:return p.intl.formatMessage({id:"qkudum",defaultMessage:"This folder will be instantly saved to your Dropbox and downloaded to all the computers linked to your account."});default:return p.intl.formatMessage({id:"uGDUlE",defaultMessage:"This file will be instantly saved to your Dropbox and downloaded to all the computers linked to your account."})}})(o,r,s)))},t.displayName="CopyToDropboxModal",t})(n.default.Component);function v(e){var t=u.Viewer.get_viewer();if(t.is_paired)switch(e){case"personal":return p.intl.formatMessage({id:"9Q/1TS",defaultMessage:"Saving to your personal Dropbox..."});case"work":return p.intl.formatMessage({id:"5wQTp4",defaultMessage:"Saving to your {team_name} Dropbox..."},{team_name:t.team_name})}return p.intl.formatMessage({id:"vFhcfF",defaultMessage:"Saving to your Dropbox..."})}function y(e,t){var r=u.Viewer.get_viewer(),n=r.get_user_by_role(t);if(n&&n.is_cdm_member)return p.intl.formatMessage({id:"yHgTUN",defaultMessage:"Save to your member folder?"});if(r.is_paired)switch(t){case"personal":return p.intl.formatMessage({id:"fI7sAv",defaultMessage:"Save to your personal Dropbox account?"});case"work":var o=r.team_name,a=new i.Emstring(o||"").length,s=Math.max(10,15-a);return p.intl.formatMessage({id:"5SXeZ6",defaultMessage:"Save ‘{name}’ to my {team_name} Dropbox"},{name:i.Emstring.em_snippet(e,s),team_name:o})}return p.intl.formatMessage({id:"ktpG9L",defaultMessage:"Save ‘{name}’ to my Dropbox"},{name:i.Emstring.em_snippet(e,15)})}t.CopyToDropboxModal=g})),define("modules/clean/react/share_download/actions",["require","exports","tslib","react","modules/clean/auth/login_or_register/types","modules/clean/downloads","modules/clean/react/share_download/copy_to_dropbox/modal","modules/clean/react/components/modal","modules/clean/react/share_download/api","modules/core/persistence/storage","modules/clean/viewer","modules/core/assert","modules/core/browser","modules/core/exception","modules/core/i18n","modules/core/notify","modules/clean/react/share_download/api"],(function(e,t,r,n,o,i,a,s,l,c,d,u,p,f,m,h,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.authModalHelpers=t.toDropbox=t.direct=void 0,n=r.__importDefault(n),i=r.__importStar(i),l=r.__importStar(l),p=r.__importStar(p),t.direct=function(e,n,o,a){return r.__awaiter(this,void 0,void 0,(function(){var s,c,d;return r.__generator(this,(function(r){switch(r.label){case 0:return s=e.downloadTestUrl,c=e.url,o||f.reportException({err:new Error("No encryption options provided for direct download action"),severity:"non-critical",tags:["sharing-encryption-options"]}),[4,t.authModalHelpers.authenticateForDownload(n||null,o)];case 1:if(r.sent(),!s)return[3,5];r.label=2;case 2:return r.trys.push([2,4,,5]),[4,l.testDownload(s,a)];case 3:return r.sent(),[3,5];case 4:return r.sent()instanceof _.TooLargeError?h.Notify.error(m.intl.formatMessage({id:"pcsTpL",defaultMessage:"The zip file is too large."})):h.Notify.error(m.intl.formatMessage({id:"pllUQE",defaultMessage:"Failed to download zip file."})),[2];case 5:return r.trys.push([5,7,,8]),[4,l.fetchDownloadUrl(c,a)];case 6:return d=r.sent(),i.get({url:d}),[3,8];case 7:return r.sent(),h.Notify.error(m.intl.formatMessage({id:"6OUwIN",defaultMessage:"Failed to download."})),[3,8];case 8:return[2]}}))}))},t.toDropbox=function(e,o,i,l,c,m,h,_){return r.__awaiter(this,void 0,void 0,(function(){var g,v,y,b;return r.__generator(this,(function(r){switch(r.label){case 0:return v=!1,"anonymous"!==i?[3,2]:(c||f.reportException({err:new Error("No encryption options provided for anonymous sharing action"),severity:"non-critical",tags:["sharing-encryption-options"]}),[4,t.authModalHelpers.authenticateForSaveToDropbox(c)]);case 1:return g=r.sent(),v=!0,[3,4];case 2:return g=l?l.id:-1,u.assert(-1!==g,"role isn't anonymous => user cannot be null or undefined!"),d.Viewer.get_viewer().is_user_signed_in(l)?[3,4]:(c||f.reportException({err:new Error("No encryption options provided for multiaccount sharing action"),severity:"non-critical",tags:["sharing-encryption-options"]}),[4,t.authModalHelpers.doMultiAccountAuthentication(i,c)]);case 3:r.sent(),r.label=4;case 4:return y=function(e){null==_||_(),v&&p.reload(e)},b=function(){null==h||h()},s.Modal.showInstance(n.default.createElement(a.CopyToDropboxModal,{shareToken:e,copyable:o,userId:g,role:i,onDismiss:y,onAccept:b,folderPreviewSession:m})),[2]}}))}))},t.authModalHelpers={authenticateForDownload:function(t,i){return t!==o.LoginOrRegisterKind.DOWNLOAD||c.LocalStorage.get("has_seen_download_signup_modal")?Promise.resolve():new Promise((function(a,l){var d=function(){c.LocalStorage.set("has_seen_download_signup_modal",!0),a()},u=function(){c.LocalStorage.set("has_seen_download_signup_modal",!0),l()};new Promise((function(t,r){e(["modules/clean/auth/login_or_register/modal"],t,r)})).then(r.__importStar).then((function(e){var r=e.LoginOrRegisterModal;s.Modal.showInstance(n.default.createElement(r,{downloadAction:o.DownloadAction.DIRECT_DOWNLOAD,id:"shared-link-download-signup-modal",initialMode:o.Mode.REGISTER,kind:t,onAuthenticateSuccess:d,onCancel:u,signup_tag:"shmodel_download_register",encryptionOptions:i}))}))}))},authenticateForSaveToDropbox:function(t){return new Promise((function(i,a){var l=function(e){return i(e.id)};new Promise((function(t,r){e(["modules/clean/auth/login_or_register/modal"],t,r)})).then(r.__importStar).then((function(e){var r=e.LoginOrRegisterModal;s.Modal.showInstance(n.default.createElement(r,{downloadAction:o.DownloadAction.SAVE_TO_DROPBOX,id:"shared-link-immediate-signup-modal",initialMode:o.Mode.REGISTER,kind:o.LoginOrRegisterKind.DOWNLOAD,onAuthenticateSuccess:l,onCancel:a,signup_tag:"shmodel_modal_register",encryptionOptions:t}))}))}))},doMultiAccountAuthentication:function(t,o){return new Promise((function(i,a){new Promise((function(t,r){e(["modules/clean/auth/multi_account_login_modal"],t,r)})).then(r.__importStar).then((function(e){var r=e.MultiAccountLoginModal;s.Modal.showInstance(n.default.createElement(r,{onAuthenticateSuccess:i,onCancel:a,role:t,encryptionOptions:o}))}))}))}}})),define("modules/clean/react/share_download/models",["require","exports","tslib","immutable","react","modules/clean/filepath/filepath","modules/clean/react/file_viewer/constants","modules/clean/react/share_download/actions","modules/core/i18n","modules/core/exception","modules/clean/react/flows/conversions/actions/unzip","modules/clean/analytics","spectrum-sharing/utils/sharing_constants"],(function(e,t,r,n,o,i,a,s,l,c,d,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShareDownloadActionOption=void 0,n=r.__importStar(n),o=r.__importDefault(o),i=r.__importStar(i),s=r.__importStar(s);var f={text:void 0,handler:void 0,spriteName:void 0,isDisabled:void 0,userAction:void 0,role:void 0},m=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.buildDirectOption=function(e,n,o,i){var d=this;return o||c.reportException({err:new Error("No encryption options for building direct download option"),severity:"non-critical",tags:["sharing-encryption-options"]}),new t({text:l.intl.formatMessage({id:"n1Nx/q",defaultMessage:"Direct download"}),handler:function(){return r.__awaiter(d,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,s.direct(e,n,o,i)];case 1:return t.sent(),[2]}}))}))},spriteName:"download_arrow",userAction:a.UserAction.Download})},t.buildToDropboxOption=function(e,r,n,d,f,m,h,_,g,v){void 0===m&&(m=!1),h||c.reportException({err:new Error("No encryption options for building to dropbox option"),severity:"non-critical",tags:["sharing-encryption-options"]});var y=l.intl.formatMessage({id:"l/lvUk",defaultMessage:"Save to my Dropbox"}),b="dropbox",w=a.UserAction.SaveToDropbox;if(d&&d.is_cdm_member){var S=i.filename(d.cdm_tmf_path);y=S.length>12?l.intl.formatMessage({id:"QPvsZL",defaultMessage:"Save to my member folder"}):l.intl.formatMessage({id:"VIDWC/",defaultMessage:"Save to <strong>{cdm_tmf_name}</strong> folder"},{cdm_tmf_name:S,strong:function(e){return o.default.createElement("strong",null,e)}}),n.is_paired&&(b="s_briefcase",w=a.UserAction.SaveToDropboxWork)}else if(n.is_paired)switch(f){case"personal":y=l.intl.formatMessage({id:"S5UJEB",defaultMessage:"Save to personal Dropbox"}),b="s_house",w=a.UserAction.SaveToDropboxPersonal;break;case"work":y=l.intl.formatMessage({id:"76AF1h",defaultMessage:"Save to {team_name} Dropbox"},{team_name:n.team_name}),b="s_briefcase",w=a.UserAction.SaveToDropboxWork}return new t({text:y,handler:function(){d&&d.id&&u.ShareTibEventLogger.log(d.id,"SAVE_TO_DROPBOX",p.SHARE_ACTION_ORIGIN_TYPE.PREVIEW_PAGE,{ns_id:null==_?void 0:_.ns_id,rlkey:e.rlkey}),s.toDropbox(e,r,f,d,h,_,g,v)},spriteName:b,isDisabled:m,userAction:w,role:f})},t.extractToDropboxOption=function(e,r,n,o,s){void 0===s&&(s=!1);var c=l.intl.formatMessage({id:"IoJAyh",defaultMessage:"Extract to my Dropbox"}),u=a.UserAction.DecompressFile;if(e&&e.is_cdm_member){var p=i.filename(e.cdm_tmf_path);c=p.length>12?l.intl.formatMessage({id:"eN3/4H",defaultMessage:"Extract to my member folder"}):l.intl.formatMessage({id:"J+cK0b",defaultMessage:"Extract to {cdm_tmf_name} folder"},{cdm_tmf_name:p})}return new t({text:c,handler:function(){return d.UnzipAction.convert([r],e,{shareToken:o})},spriteName:"dropbox",isDisabled:s,userAction:u,role:n})},t})(n.Record(f));t.ShareDownloadActionOption=m})),define("modules/clean/react/share_download/util",["require","exports","tslib","react","modules/clean/react/file_viewer/constants","modules/clean/react/file_viewer/logging","modules/clean/react/file_viewer/utils","modules/clean/react/share_download/models","modules/clean/react/title_bar/overflow_menu","modules/clean/share_download/types","modules/clean/shared_link/types","modules/clean/viewer","modules/clean/loggers/folder_preview_logger","modules/clean/react/flows/conversions/actions/unzip","modules/clean/react/flows/conversions/utils"],(function(e,t,r,n,o,i,a,s,l,c,d,u,p,f,m){"use strict";function h(e,t,r,n,o,i,a){var l=e.canCopyToDropboxRoles,c=[];if(l.length>0){var d=u.Viewer.get_viewer(),p=d.get_users(!0),f=function(e,u){var p=-1===l.indexOf(u);c.push(s.ShareDownloadActionOption.buildToDropboxOption(t,r,d,e,u,p,n,o,i,a))};p.forEach((function(e){f(e,e.role)})),l.indexOf("anonymous")>-1&&f(void 0,"anonymous")}return c}function _(e,t,r,n,o,i,a,l){var u=e.canDownloadRoles,p=s.ShareDownloadActionOption.buildDirectOption,_=[];return c.isPendingEntry(n)?_:(u.length>0&&_.push(p(t,o,i)),_.push.apply(_,h(e,r,n,i,l)),a&&c.isEntry(n)&&d.isEntrySharedFile(n)&&m.canConvertFile(n,e)&&f.UnzipAction.selector([n])&&_.push(s.ShareDownloadActionOption.extractToDropboxOption(a,n,a.role,r,!1)),_)}function g(e,t,r,n,o){return function(s){n&&n(),e.handler&&e.handler(),r?p.logEvent(e.userAction,r):i.logUserAction(e.userAction,a.getSplitButtonUserActionContext(t,o))}}Object.defineProperty(t,"__esModule",{value:!0}),t.isDownloadAllowed=t.getDownloadOptionsAsPopoverOrMobileItems=t.callOptionHandler=t.getDownloadOptions=t.getToDropboxOptions=void 0,n=r.__importDefault(n),t.getToDropboxOptions=h,t.getDownloadOptions=_,t.callOptionHandler=g,t.getDownloadOptionsAsPopoverOrMobileItems=function(e,t,r,i,a,s){return _(e,t,r,i,null,a,null,s).map((function(e){return n.default.createElement(l.PopoverOrMobileItem,{key:e.userAction,disabled:e.isDisabled,onSelect:g(e,o.SplitButtonActionLocation.Split,s)},e.text)}))},t.isDownloadAllowed=function(e){return e.canDownloadRoles.length>0}})),define("modules/clean/react/title_bar/overflow_menu",["require","exports","tslib","react","modules/core/browser_detection","modules/clean/react/title_bubble","modules/core/i18n","dig-components/icons","dig-components/icons/src","spectrum/popover/index","spectrum/mobile_menu/index","modules/clean/react/file_viewer/constants","modules/clean/react/sticky_position"],(function(e,t,r,n,o,i,a,s,l,c,d,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PopoverOrMobileItem=t.OverflowMenu=void 0;var f=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handlePopoverSelection=function(e,t){return e&&e(t)},t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.children,r=e.contentWrapperClassName,s=e.hideOnDisabled,l=e.direction,f=(function(e){var t=Array.isArray(e)?e.filter((function(e){return!!e})):e;return null==e||Array.isArray(t)&&0===t.length})(t);if(f&&s)return null;if(o.is_mobile_or_tablet())return n.default.createElement(d.MobileMenu,{trigger:function(e){var t=e.openMobileMenu;return n.default.createElement(m,{disabled:f,onClick:t})}},t);var h=l===u.OverflowMenuDirection.ABOVE?"above":"below",_=l===u.OverflowMenuDirection.ABOVE?p.StickyPosition.TOP:p.StickyPosition.BOTTOM;return n.default.createElement(c.Popover,{className:"more-button-popover",onSelection:this.handlePopoverSelection},n.default.createElement(c.PopoverTrigger,{"aria-label":a.intl.formatMessage({id:"oeNPkV",defaultMessage:"More actions"}),disabled:f},n.default.createElement(i.TitleBubble,{content:a.intl.formatMessage({id:"S6stj+",defaultMessage:"More"}),distanceFromTarget:10,isTargetPositionFixed:!0,position:_},n.default.createElement(m,{disabled:f}))),n.default.createElement("div",{className:r},n.default.createElement(c.PopoverContent,{attachment:"right",position:h},t)))},t.displayName="OverflowMenu",t})((n=r.__importDefault(n)).default.Component);function m(e){e.disabled;var t=e.onClick;return n.default.createElement("span",{"aria-label":a.intl.formatMessage({id:"S6stj+",defaultMessage:"More"}),className:"u-mar-left-xs more-button",onClick:t},n.default.createElement(s.UIIcon,{src:l.MoreHorizontalLine}))}t.OverflowMenu=f;var h=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onSelect=function(e){o.is_mobile_or_tablet()&&e.preventDefault();var r=t.props.onSelect;return r&&r(e)},t}return r.__extends(t,e),t.prototype.render=function(){var e=o.is_mobile_or_tablet(),t=this.props,i=(t.onSelect,r.__rest(t,["onSelect"]));return e?n.default.createElement(d.MobileMenuItem,r.__assign({onSelect:this.onSelect},i)):n.default.createElement(c.PopoverContentItem,r.__assign({value:this.onSelect},i))},t.displayName="PopoverOrMobileItem",t})(n.default.Component);t.PopoverOrMobileItem=h})),define("modules/clean/share_download/types",["require","exports"],(function(e,t){"use strict";function r(e){return"ns_id"in e}Object.defineProperty(t,"__esModule",{value:!0}),t.isPendingEntry=t.isEntry=t.CopyableType=void 0,(function(e){e[e.Collection=0]="Collection",e[e.File=1]="File",e[e.Folder=2]="Folder"})(t.CopyableType||(t.CopyableType={})),t.isEntry=r,t.isPendingEntry=function(e){return r(e)&&null==e.ns_id}})),define("modules/clean/react/share_download/utils",["require","exports","modules/clean/share_download/types"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCopyableType=t.getCopyableName=void 0,t.getCopyableName=function(e){return r.isEntry(e)?e.filename:e.name},t.getCopyableType=function(e){return r.isEntry(e)?e.is_dir?r.CopyableType.Folder:r.CopyableType.File:r.CopyableType.Collection}})),define("modules/clean/shared_link/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isEntrySharedFile=void 0,t.isEntrySharedFile=function(e){return"sjid"in e}})),define("modules/clean/react/shared_link_folder/copy_to_dropbox_button",["require","exports","tslib","react","modules/core/i18n","modules/clean/react/share_download/util","modules/clean/react/share_download/models","dig-components/buttons","spectrum/button/index","modules/clean/react/file_viewer/constants","modules/clean/react/share_download/button_component","modules/clean/react/file_viewer/logging","modules/clean/react/file_viewer/utils","modules/clean/loggers/folder_preview_logger","classnames"],(function(e,t,r,n,o,i,a,s,l,c,d,u,p,f,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CopyToDropboxButton=void 0,n=r.__importDefault(n),m=r.__importDefault(m);var h=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.componentDidMount=function(){},t.prototype.onClickedOption=function(e,t){e.preventDefault(),t.handler(),this.props.folderPreviewSession?f.logEvent(t.userAction,this.props.folderPreviewSession):u.logUserAction(t.userAction,p.getSplitButtonUserActionContext(c.SplitButtonActionLocation.Main,this.props.location))},t.prototype.renderCopyToDropboxButton=function(){var e=this;if(0===this.props.sharePermission.canCopyToDropboxRoles.length)return null;var t=o.intl.formatMessage({id:"Y60BJ8",defaultMessage:"Save to Dropbox"}),r={"copy-to-dropbox-button":!0};this.props.shouldDisplayLayoutChange||(r.control__button=!0,r["control__button--collapsed"]=this.props.isCollapsed);var c=i.getToDropboxOptions(this.props.sharePermission,this.props.shareToken,this.props.copyable,this.props.encryptionOptions,this.props.folderPreviewSession);if(this.props.showDownloadOption&&this.props.sharedLinkInfo){var u=a.ShareDownloadActionOption.buildDirectOption(this.props.sharedLinkInfo,null,this.props.encryptionOptions);c.push(u)}if(1===c.length){if(this.props.shouldDisplayLayoutChange){var p=this.props.importance;return n.default.createElement(s.Button,{className:m.default(r),style:{display:"-webkit-box"},variant:p,onClick:function(t){return e.onClickedOption(t,c[0])},"aria-label":t},t)}p=this.props.importance;return n.default.createElement(l.Button,{className:m.default(r),style:{display:"-webkit-box"},variant:p,onClick:function(t){return e.onClickedOption(t,c[0])},"aria-label":t},t)}p=this.props.importance;return n.default.createElement(d.DownloadDropdown,{targetText:t+" ▾",options:c,onClick:this.props.onClick,location:this.props.location,importance:p,title:o.intl.formatMessage({id:"Y60BJ8",defaultMessage:"Save to Dropbox"}),isCollapsed:this.props.isCollapsed,isDisabled:!1,folderPreviewSession:this.props.folderPreviewSession})},t.prototype.render=function(){return n.default.createElement("div",null,this.renderCopyToDropboxButton())},t.displayName="CopyToDropboxButton",t})(n.default.Component);t.CopyToDropboxButton=h})),define("modules/clean/react/share_download/button_component",["require","exports","tslib","classnames","prop-types","react","dig-components/buttons","modules/clean/filepath/filepath","modules/clean/react/file_viewer/logging","modules/clean/react/file_viewer/constants","modules/clean/react/file_viewer/utils","modules/clean/react/share_download/util","modules/clean/react/share_download/models","modules/clean/react/share_download/util","modules/clean/share_download/types","modules/clean/react/title_bubble","modules/core/i18n","modules/core/browser_detection","modules/clean/react/file_viewer_sidebar/buttons/icon","modules/clean/loggers/folder_preview_logger","modules/clean/react/sticky_position","dig-components/icons","dig-components/icons/src","dig-components/layer","dig-components/menu"],(function(e,t,r,n,o,i,a,s,l,c,d,u,p,f,m,h,_,g,v,y,b,w,S,E,M){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShareDownloadButton=t.DownloadDropdown=t.DownloadSimpleButton=void 0,n=r.__importDefault(n),o=r.__importDefault(o),i=r.__importDefault(i),s=r.__importStar(s);var k=function(e){return!g.is_mobile_or_tablet()&&e.title&&e.isCollapsed?i.default.createElement(h.TitleBubble,{content:e.title,isTargetPositionFixed:!0,position:b.StickyPosition.LEFT},e.children):i.default.createElement(i.default.Fragment,null,e.children)},T=(function(e){function t(t){var r=e.call(this,t)||this;return r.state={isDisabled:!0},r}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.setState({isDisabled:this.props.isDisabled})},t.prototype.render=function(){var e={"download-button":!0,control__button:!0,"control__button--collapsed":this.props.isCollapsed};return this.props.className&&(e[this.props.className]=!0),i.default.createElement(k,{title:this.props.title,isCollapsed:this.props.isCollapsed},i.default.createElement(a.Button,{className:n.default(e),style:{display:"-webkit-box"},variant:this.props.importance,disabled:this.state.isDisabled,onClick:this.props.onClick,"aria-label":this.props.title,withIconLeft:i.default.createElement(w.UIIcon,{src:S.DownloadLine})},this.props.children))},t.defaultProps={isDisabled:!1,importance:"opacity"},t.displayName="DownloadMainButton",t})(i.default.Component),P=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this;return i.default.createElement(T,{isDisabled:this.props.isDisabled,onClick:function(t){t.preventDefault(),e.props.onClick&&e.props.onClick(e.props.option),e.props.option.handler(),e.props.folderPreviewSession?y.logEvent(e.props.option.userAction,e.props.folderPreviewSession):l.logUserAction(e.props.option.userAction,d.getSplitButtonUserActionContext(c.SplitButtonActionLocation.Main,e.props.location))},importance:this.props.importance,isCollapsed:this.props.isCollapsed,title:this.props.title},this.props.isCollapsed?i.default.createElement(v.ButtonIcon,{name:"download-file",isPrimary:"primary"===this.props.importance}):this.props.targetText)},t.displayName="DownloadSimpleButton",t})(i.default.Component);t.DownloadSimpleButton=P;var A=(function(e){function t(t){var r=e.call(this,t)||this;return r.onActionMenuSelection=function(e){u.callOptionHandler(e,c.SplitButtonActionLocation.Split,r.props.folderPreviewSession,r.props.onClick,r.props.location)()},r.state={isDisabled:!0},r}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.setState({isDisabled:this.props.isDisabled})},t.prototype.renderIcon=function(){return i.default.createElement(v.ButtonIcon,{name:"download-file",isPrimary:"primary"===this.props.importance,"aria-label":this.props.title})},t.prototype.renderActionMenu=function(){var e=this,t=this.props.options.map((function(e){return i.default.createElement(M.Menu.ActionItem,{"aria-label":e.text,key:e.text,value:e,disabled:e.isDisabled},e.text)})),o={"download-button":!0,control__button:!0,"control__button--collapsed":this.props.isCollapsed};return i.default.createElement(M.Menu.Wrapper,{key:"download-dropdown",onSelection:this.onActionMenuSelection,className:n.default(o)},(function(n){var o=n.getContentProps,s=n.getTriggerProps;return i.default.createElement(i.default.Fragment,null,i.default.createElement(k,{title:e.props.title,isCollapsed:e.props.isCollapsed},i.default.createElement(a.Button,r.__assign({className:"download-title-button"},s(),{variant:e.props.importance,disabled:e.state.isDisabled,"aria-label":e.props.title}),e.props.isCollapsed?e.renderIcon():e.props.targetText)),i.default.createElement(E.LayerContext.Provider,{value:500},i.default.createElement(M.Menu.Content,r.__assign({},o()),i.default.createElement(M.Menu.Segment,null,t))))}))},t.prototype.render=function(){return this.props.isDisabled?i.default.createElement(T,{isDisabled:!0,importance:this.props.importance,title:this.props.title,isCollapsed:this.props.isCollapsed},this.props.isCollapsed?null:this.props.targetText):this.renderActionMenu()},t.defaultProps={importance:"secondary"},t.displayName="DownloadDropdown",t})(i.default.Component);t.DownloadDropdown=A;var F=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.getTargetText=function(e){if(u.isDownloadAllowed(this.props.sharePermission))return e>1?{title:_.intl.formatMessage({id:"0YRjqy",defaultMessage:"Download ▾"})}:{title:_.intl.formatMessage({id:"pHnJw0",defaultMessage:"Download"})};if(this.props.user&&this.props.user.is_cdm_member){var t=s.filename(this.props.user.cdm_tmf_path);return t.length>25?{title:_.intl.formatMessage({id:"6m85k6",defaultMessage:"Add to my member folder"})}:{label:_.intl.formatMessage({id:"ck1w+U",defaultMessage:"Add to <strong>{cdm_tmf_name}</strong> folder"},{cdm_tmf_name:t,strong:function(e){return i.default.createElement("strong",{key:t,style:{fontWeight:800}},e)}}),title:_.intl.formatMessage({id:"nzqkZQ",defaultMessage:"Add to {cdm_tmf_name} folder"},{cdm_tmf_name:t})}}return{title:_.intl.formatMessage({id:"N8ovVA",defaultMessage:"Add to Dropbox"})}},t.prototype.getTooltipLabel=function(){return m.isPendingEntry(this.props.copyable)?_.intl.formatMessage({id:"DldXvN",defaultMessage:"Download is unavailable while file is uploading."}):_.intl.formatMessage({id:"gUTeT9",defaultMessage:"Downloads disabled."})},t.prototype.render=function(){var e=f.getDownloadOptions(this.props.sharePermission,this.props.sharedLinkInfo,this.props.shareToken,this.props.copyable,this.context.authModalKind||null,this.props.encryptionOptions,this.props.user,this.props.folderPreviewSession);if(this.props.downloadOnly){var t=new p.ShareDownloadActionOption({isDisabled:!0}),r=!0;return u.isDownloadAllowed(this.props.sharePermission)&&(t=p.ShareDownloadActionOption.buildDirectOption(this.props.sharedLinkInfo,null,this.props.encryptionOptions,this.props.shareToken.rlkey),r=!1),i.default.createElement(P,{isDisabled:r,targetText:_.intl.formatMessage({id:"pHnJw0",defaultMessage:"Download"}),title:_.intl.formatMessage({id:"pHnJw0",defaultMessage:"Download"}),option:t,onClick:this.props.onClick,location:this.props.location,importance:this.props.importance,isCollapsed:this.props.isCollapsed,folderPreviewSession:this.props.folderPreviewSession})}if(0===e.length)return i.default.createElement(A,{targetText:_.intl.formatMessage({id:"pHnJw0",defaultMessage:"Download"}),isDisabled:!0,options:[new p.ShareDownloadActionOption({isDisabled:!0})],onClick:this.props.onClick,location:this.props.location,title:this.getTooltipLabel(),importance:this.props.importance,isCollapsed:this.props.isCollapsed,folderPreviewSession:this.props.folderPreviewSession});var n=this.getTargetText(e.length);return 1===e.length?i.default.createElement(P,{isDisabled:!1,targetText:n.label||n.title,title:n.title,option:e[0],onClick:this.props.onClick,location:this.props.location,importance:this.props.importance,isCollapsed:this.props.isCollapsed,folderPreviewSession:this.props.folderPreviewSession}):i.default.createElement(A,{targetText:n.label||n.title,options:e,onClick:this.props.onClick,location:this.props.location,isDisabled:!1,importance:this.props.importance,isCollapsed:this.props.isCollapsed,title:_.intl.formatMessage({id:"pHnJw0",defaultMessage:"Download"}),folderPreviewSession:this.props.folderPreviewSession})},t.contextTypes={authModalKind:o.default.oneOf(["immediate","download",null])},t.displayName="ShareDownloadButton",t})(i.default.Component);t.ShareDownloadButton=F})),define("modules/clean/react/shared_link_folder/page",["require","exports","tslib","classnames","react","modules/clean/analytics","modules/clean/components/loading_indicator","modules/clean/react/browse/sort_helpers","modules/clean/react/components/css","modules/clean/react/async/loadable","modules/clean/em_string","modules/clean/react/open_in_app/banner","modules/clean/react/shared_link_folder/folder_icon","modules/clean/react/shared_link_folder/grid","modules/clean/react/shared_link_folder/list","modules/clean/react/shared_link_folder/view_toggle","modules/clean/react/takedown_warning","spectrum-sharing/utils/sharing_constants","modules/clean/web_timing_logger","modules/core/i18n","modules/clean/react/icon/icon_helper","modules/clean/react/size_class/size_class","modules/clean/react/size_class/constants","modules/clean/loggers/folder_preview_logger","modules/clean/react/file_viewer/app_download_interstitial/app_download_interstitial","modules/clean/react/shared_link_folder/folder_title","modules/core/i18n","modules/clean/bug_reporting/routing","typescript/component_libraries/pro-ui/src/components/branding/branding_block/optional_branding_block","modules/clean/react/branding/branding_modal_controller","modules/clean/react/share_sync/button","modules/clean/react/shared_link_folder/copy_to_dropbox_button","modules/clean/react/share_download/button","typescript/component_libraries/retrieval-components/src/view-mode-toggle/index","modules/clean/sharing/ui_util"],(function(e,t,r,n,o,i,a,s,l,c,d,u,p,f,m,h,_,g,v,y,b,w,S,E,M,k,T,P,A,F,C,O,D,x,N){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharedLinkFolderPage=t._SharedLinkFolderPage=void 0,n=r.__importDefault(n),o=r.__importDefault(o),v=r.__importStar(v);var R=c.Loadable({loader:function(){return new Promise((function(t,r){e(["modules/clean/react/shared_link_folder/title_bar"],t,r)})).then(r.__importStar).then((function(e){return e.SharedLinkFolderTitleBar}))}}),I=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={openInAppBannerClosed:!1,currentMode:x.ViewMode.LIST},t.shouldShowOpenInAppBanner=function(){var e=t.props.folder,r=t.state.openInAppBannerClosed;return e&&e.open_in_app_data&&!r},t.onOpenInAppClosed=function(){t.setState((function(e){return{openInAppBannerClosed:!0,currentMode:e.currentMode}}))},t.changeViewMode=function(e,r){t.setState((function(t){return{openInAppBannerClosed:t.openInAppBannerClosed,currentMode:e}}))},t.onInterstitialClose=function(){E.logEvent(E.EventType.appDownloadInterstitialClose,t.props.folderPreviewSession),t.props.onAppDownloadInterstitialDismissed()},t.onInterstitialContinue=function(){E.logEvent(E.EventType.appDownloadInterstitialContinue,t.props.folderPreviewSession),t.props.onAppDownloadInterstitialDismissed()},t.onAppDownload=function(){E.logEvent(E.EventType.appDownloadInterstitialInstall,t.props.folderPreviewSession)},t.handleBreadcrumbClick=function(e){var n=t.props,o=n.breadcrumbs,i=n.folderPreviewSession;i.extra=r.__assign(r.__assign({},i.extra),{origin_breadcrumb:o.length-1,destination_breadcrumb:e}),E.logEvent(E.EventType.breadcrumbClicked,i)},t}return r.__extends(t,e),t.prototype.UNSAFE_componentWillMount=function(){E.logEvent(E.EventType.attempted,this.props.folderPreviewSession)},t.prototype.componentWillUnmount=function(){E.logEvent(E.EventType.ended,this.props.folderPreviewSession)},t.prototype.componentDidMount=function(){this.ensureWebTimingMarked(),this.logSclTiming(),this.shouldShowAppDownloadInterstitial()&&E.logEvent(E.EventType.appDownloadInterstitialView,this.props.folderPreviewSession),setTimeout((function(){N.trackReceiverUserLeapEvent(N.ReceiverUserLeapEvent.VIEWED_SHARED_FOLDER)}),5e3)},t.prototype.componentDidUpdate=function(){this.ensureWebTimingMarked()},t.prototype.componentDidCatch=function(){E.logEvent(E.EventType.renderFailed,this.props.folderPreviewSession)},t.prototype.shouldShowAppDownloadInterstitial=function(){var e=this.props,t=e.folder;return!e.appDownloadInterstitialDismissed&&t&&t.open_in_app_data},t.prototype.ensureWebTimingMarked=function(){var e=this.props,t=e.contents,r=t.files,n=t.folders,o=e.hasMore,i=e.webTimer;(r.length>0||n.length>0||!o)&&(i&&(i.timeToView()||i.markTimeToView(),i.timeToInteractive()||i.markTimeToInteractive()),E.markPrimaryEvent(this.props.folderPreviewSession),E.logEvent(E.EventType.renderSucceeded,this.props.folderPreviewSession))},t.prototype.logSclTiming=function(){if(this.props.user&&this.props.folderShareToken.linkType===g.SharedLinkType.Content){var e=(new Date).getTime(),t={ns_id:this.props.folder.shared_folder_id,timing:e-v.start_time()};i.ShareTibEventLogger.log(this.props.user.id,"PREVIEW_RENDER",g.SHARE_ACTION_ORIGIN_TYPE.PREVIEW_PAGE,t)}},t.prototype.render=function(){var e=this.props,t=e.accountMenuOptions,r=e.brandingInfo,i=e.breadcrumbs,s=e.contents,l=e.folder,c=e.folderSharePermission,p=e.folderShareToken,f=e.folderSharedLinkInfo,m=e.folderPreviewSession,g=e.hasMore,v=e.onFileOpen,b=e.onFolderOpen,w=e.onListModeDisable,E=e.onListModeEnable,T=e.outOfQuota,C=e.shouldForceListMode,O=e.showSyncCoachmark,D=e.sizeClass,x=e.takedownRequestType,N=e.user,I=e.encryptionOptions,L=e.shouldDisplayLayoutChange;m.extra.size_class=D;var U,H=o.default.createElement(k.FolderTitle,{title:d.Emstring.em_snippet(l.filename,D!==S.SizeClass.Small?35:20),ownerName:f.ownerName,ownerTeamName:f.ownerTeamName,ownerTeamLogo:f.ownerTeamLogo,breadcrumbs:i,onCrumbClick:this.handleBreadcrumbClick}),B=n.default("sl-page-body",{"view-in-app-bar-present":this.shouldShowOpenInAppBanner()});if(this.shouldShowAppDownloadInterstitial()){var V=f.displayName;U=o.default.createElement("div",{"aria-label":V},o.default.createElement(M.AppDownloadInterstitial,{isFolder:!0,fileOrFolderName:V,open_in_app_data:l.open_in_app_data,ownerName:f.ownerName,ownerTeamName:f.ownerTeamName,onClose:this.onInterstitialClose,onContinue:this.onInterstitialContinue,onAppDownload:this.onAppDownload}))}return o.default.createElement(P.RegisterComponentWithBugReporter,{componentId:"web.folder_viewer",componentName:"Shared Folder Viewer"},o.default.createElement("div",null,o.default.createElement("div",{className:"sl-page-container"},o.default.createElement("div",{className:"sl-page-header"},o.default.createElement(R,{accountMenuOptions:t,folder:l,outOfQuota:T,sharedLinkInfo:f,shareToken:p,sharePermission:c,showSyncCoachmark:O,sizeClass:D,title:D===S.SizeClass.Small?H:void 0,user:N,encryptionOptions:I,folderPreviewSession:m,shouldDisplayLayoutChange:L}),this.shouldShowOpenInAppBanner()?o.default.createElement(u.OpenInAppBanner,{urls:l.open_in_app_data,onClose:this.onOpenInAppClosed}):null),o.default.createElement("div",{className:B},o.default.createElement(A.OptionalBrandingBlock,{brandingInfo:r,className:"sl-branding-header",sharedLinkInfo:f}),o.default.createElement("div",{className:"sl-header clearfix"},o.default.createElement("h3",{className:"sl-title"},null!=x?o.default.createElement("div",{className:"sl-takedown-warning"},o.default.createElement(_.TakedownWarning,{takedownType:x})):null,D!==S.SizeClass.Small?H:null)),L?o.default.createElement("div",{className:"sl-buttons"},this.renderCTAButtons(l,T,f,c,p,O,N,I,m,L),o.default.createElement("div",{className:"sl-view-toggle"},o.default.createElement(h.FolderViewModeToggle,{onViewModeChanged:this.changeViewMode,currentViewMode:this.state.currentMode}))):null,o.default.createElement(q,{files:s.files,folder:l,hasMore:g,shouldForceListMode:C,sizeClass:D,subfolders:s.folders,onListModeDisable:w,onListModeEnable:E,onFolderOpen:b,onFileOpen:v,shouldDisplayLayoutChange:L,currentMode:this.state.currentMode}),g?o.default.createElement("div",{className:"sl-loading-indicator"},o.default.createElement(a.LoadingIndicator,{style:a.LoadingIndicator.LoadingIndicatorStyle.BLUE_SPINNER})):null)),U||o.default.createElement(F.BrandingModalController,{brandingInfo:r,closeButtonText:y.intl.formatMessage({id:"eC3oZ9",defaultMessage:"View folder"}),sharedLinkInfo:f})))},t.prototype.renderCTAButtons=function(e,t,r,n,i,a,s,l,c,d){var u=i.linkType!==g.SharedLinkType.Shmodel&&n.canSyncToDropboxRoles.length>0&&""===i.subPath;return o.default.createElement(o.default.Fragment,null,u?o.default.createElement(C.ShareSyncButton,{folder:e,outOfQuota:t,sharedLinkInfo:r,sharePermission:n,shareToken:i,showSyncCoachmark:a,user:s,folderPreviewSession:c,encryptionOptions:l}):o.default.createElement(O.CopyToDropboxButton,{shareToken:i,sharedLinkInfo:r,sharePermission:n,copyable:e,encryptionOptions:l,user:s,folderPreviewSession:c,importance:"primary",showDownloadOption:!1,shouldDisplayLayoutChange:d}),o.default.createElement(D.ShareDownloadButton,{copyable:e,sharedLinkInfo:r,shareToken:i,sharePermission:n,user:s,downloadOnly:!0,encryptionOptions:l,folderPreviewSession:c}))},t.defaultProps={shouldForceListMode:!1,webTimer:v.get_timer()},t.displayName="SharedLinkFolderPage",t})(o.default.PureComponent);t._SharedLinkFolderPage=I;var L=l.requireCssWithComponent(I,["/static/css/react_title_bar-vflSGo9Xd.css","/static/css/react_file_viewer-vfldZQLtI.css","/static/js/typescript/component_libraries/pro-ui/src/index.web-vfl7fyKnY.css","/static/css/dig-components/index.web-vflfsfj-g.css"]),U=w.withSizeClass(L);t.SharedLinkFolderPage=U;function H(e,t){void 0===e&&(e=[]),void 0===t&&(t=[]);var n,o=(n=T.case_insensitive_comparator(!0),function(e,t){return s.compare(e.filename,t.filename,1,n)});return r.__spreadArrays(t,e).sort(o)}function B(e){return o.default.createElement("div",{className:"sl-body sl-body--empty-folder"},o.default.createElement(p.SharedLinkFolderFolderIcon,{className:"sl-empty-folder-icon",folder:e.folder,size:b.SpectrumIconSize.Large}),o.default.createElement("h3",{className:"sl-empty-folder-message"},y.intl.formatMessage({id:"YLBqRL",defaultMessage:"This folder is empty"})))}function q(e){var t=e.files,r=e.folder,n=e.hasMore,i=e.shouldForceListMode,a=e.sizeClass,s=e.subfolders,l=e.onFileOpen,c=e.onFolderOpen,d=e.shouldDisplayLayoutChange,u=e.currentMode,p=H(t,s);if(!p.length&&!n)return o.default.createElement(B,{folder:r});if(!d)return o.default.createElement("div",{className:"sl-body"},i?[o.default.createElement(m.SharedLinkFolderList,{key:"list",entries:p,sizeClass:a,onFolderOpen:c,onFileOpen:l}),o.default.createElement(h.FolderViewToggleOption,{key:"toggler",icon:"grid_light",label:y.intl.formatMessage({id:"vEc1Xz",defaultMessage:"View as grid"}),onClick:e.onListModeDisable})]:[o.default.createElement(f.SharedLinkFolderGrid,{key:"grid",entries:p,onFolderOpen:c,onFileOpen:l}),o.default.createElement(h.FolderViewToggleOption,{key:"toggler",icon:"list_light",label:y.intl.formatMessage({id:"XLVIFy",defaultMessage:"View as list"}),onClick:e.onListModeEnable})]);switch(u){case x.ViewMode.LIST:return o.default.createElement("div",{className:"sl-body"},o.default.createElement(m.SharedLinkFolderList,{key:"list",entries:p,sizeClass:a,onFolderOpen:c,onFileOpen:l}));case x.ViewMode.CONDENSED_LIST:return o.default.createElement("div",{className:"sl-body"},o.default.createElement(m.SharedLinkFolderList,{key:"list",entries:p,sizeClass:a,onFolderOpen:c,onFileOpen:l,smallList:!0}));case x.ViewMode.TILE:return o.default.createElement("div",{className:"sl-body"},o.default.createElement(f.SharedLinkFolderGrid,{key:"grid",entries:p,onFolderOpen:c,onFileOpen:l,largeGrid:!0}));case x.ViewMode.GRID:default:return o.default.createElement("div",{className:"sl-body"},o.default.createElement(f.SharedLinkFolderGrid,{key:"grid",entries:p,onFolderOpen:c,onFileOpen:l}))}}})),define("modules/clean/react/shared_link_folder/app",["require","exports","tslib","lodash","react","redux","react-redux","modules/clean/cloud_docs/open_with_utils","modules/clean/loggers/folder_preview_logger","modules/clean/open_in_app/actions","modules/clean/previews/constants","modules/clean/react/async/loadable","modules/clean/react/file_viewer/data/actions","modules/clean/react/file_viewer/data/selectors","modules/clean/react/file_viewer/location_utils","modules/clean/react/location/with_location","modules/clean/react/file_viewer/url_utils","modules/clean/react/previews/constants","modules/clean/react/shared_link_folder/data/actions","modules/clean/react/shared_link_folder/data/store","modules/clean/react/shared_link_folder/page","modules/clean/viewer","modules/clean/web_timing_logger","modules/constants/python","modules/clean/web_timing_logger","modules/core/persistence/storage","modules/constants/page_load","modules/core/langpack","react-intl","modules/core/i18n","modules/clean/react/shared_link_folder/utils","modules/clean/react/shared_link_folder/data/selectors","modules/clean/csrf","modules/core/browser","modules/clean/react/file_viewer/utils"],(function(e,t,r,n,o,i,a,s,l,c,d,u,p,f,m,h,_,g,v,y,b,w,S,E,M,k,T,P,A,F,C,O,D,x,N){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharedLinkFolderApp=t._SharedLinkFolderApp=t.AsyncFileCollectionViewer=void 0,n=r.__importStar(n),o=r.__importDefault(o),M=r.__importStar(M),P=r.__importStar(P);var R=n.memoize((function(){return new Promise((function(t,r){e(["modules/clean/react/file_viewer/collection_viewer"],t,r)})).then(r.__importStar)}));t.AsyncFileCollectionViewer=u.Loadable({loader:function(){return R().then((function(e){return e.FileCollectionViewer}))}});var I=function(e){return{label:e.filename,href:e.href}};function L(){var e=M.get_timer();return e.timeToInteractive()&&(e=M.get_timer("shared_link_folder_ajax")).initialize({requireTTI:!0,requireTTV:!0,url:"shared_link_folder_ajax"}),e}var U=(function(i){function a(e){var t,r,n=i.call(this,e)||this;n.handleOpenFile=function(e){e.preview_type&&e.preview_type===d.PreviewType.CloudDoc&&!s.isShortcut(e)?x.open_tab(e.href):n.previewDataPromise?n.previewDataPromise.then((function(){return _.openFile(e)})):_.openFile(e)},n.handleOpenFolder=function(e){n.previewDataPromise?n.previewDataPromise.then((function(){return C.openFolder(e)})):C.openFolder(e)};var o=w.Viewer.get_viewer(),a=o.work_user||o.personal_user,c=e.folderShareToken,u=e.folderData,p=e.shouldFetchPreviewData,f=C.getSecureHashOrSubPath(c);return n.state={folderHierarchyMap:(t={},t[f]=u?[u]:[],t),pageYOffset:0,previewSourceAction:g.PreviewSourceAction.Visit,user:a},n.folderPreviewSession=l.createSession({subfolder_nav_tracking:e.subfolderNavTracking,use_odyssey:p,folder_id:null===(r=e.folder)||void 0===r?void 0:r.folder.folder_id}),n.webTimer=L(),n.rlkey=c.rlkey,n}return r.__extends(a,i),a.prototype.UNSAFE_componentWillMount=function(){if(this.webTimer.applicationStart(),this.props.openImmediatelyInApp)return this.openImmediatelyInApp()},a.prototype.componentWillUnmount=function(){this.unsubscribe()},a.prototype.UNSAFE_componentWillReceiveProps=function(e){var t,r;!this.props.viewingFilename&&e.viewingFilename&&this.setState({pageYOffset:window.pageYOffset}),this.props.viewingFilename!==e.viewingFilename&&this.setState({previewSourceAction:g.PreviewSourceAction.Click});var n=e.folder?e.folder.folder.ns_id:void 0,o=C.getFolderShareTokenWithRlkey(e.folderShareToken,this.rlkey),i=C.getSecureHashOrSubPath(o),a=C.getFolderShareTokenWithRlkey(this.props.folderShareToken,this.rlkey);i!==C.getSecureHashOrSubPath(a)?(this.webTimer=L(),this.webTimer.restart(),this.folderPreviewSession=l.createSession({source_action:g.PreviewSourceAction.Click,subfolder_nav_tracking:e.subfolderNavTracking,has_cached_data:e.folder&&!!e.folder.entries.length,ns_id:n,folder_id:null===(t=e.folder)||void 0===t?void 0:t.folder.folder_id}),this.props.onFolderLoad(o,this.webTimer)):this.props.viewingFilename&&!e.viewingFilename&&(this.folderPreviewSession=l.createSession({source_action:g.PreviewSourceAction.FileViewerExit,subfolder_nav_tracking:e.subfolderNavTracking,has_cached_data:!0,ns_id:n,folder_id:null===(r=e.folder)||void 0===r?void 0:r.folder.folder_id})),e.folder&&e.folder.folder&&C.setPageTitle(e.folder.folder.filename)},a.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,(function(){var e,t,o,i,a,s,l=this;return r.__generator(this,(function(r){switch(r.label){case 0:return e=this.props,t=e.file,o=e.onFolderPrefetch,i=e.viewingFilename,a=C.getFolderShareTokenWithRlkey(this.props.folderShareToken,this.rlkey),i&&window.setTimeout(N.cleanupPrerenderPreview),a&&(this.previewDataPromise=o(a,t)),[4,S.waitForTTI()];case 1:return r.sent(),R(),[4,this.readFolderHierarchy()];case 2:return s=r.sent(),this.setState((function(e,t){var r=C.getFolderShareTokenWithRlkey(t.folderShareToken,l.rlkey),o=C.getSecureHashOrSubPath(r);return{folderHierarchyMap:n.get(s,o)?s:e.folderHierarchyMap}})),[2]}}))}))},a.prototype.componentDidUpdate=function(e){var t=this.props.viewingFilename,n=this.state.pageYOffset;t!==e.viewingFilename&&(t||window.scrollTo(0,n));var o=C.getFolderShareTokenWithRlkey(e.folderShareToken,this.rlkey),i=C.getSecureHashOrSubPath(o),a=C.getFolderShareTokenWithRlkey(this.props.folderShareToken,this.rlkey),s=C.getSecureHashOrSubPath(a);i!==s&&(this.setState((function(e,t){var n;if(!t.folder||!C.shouldUpdateFolderHierarchy(e.folderHierarchyMap,o,a))return{folderHierarchyMap:e.folderHierarchyMap};var l=t.folder.folder;return{folderHierarchyMap:r.__assign(r.__assign({},e.folderHierarchyMap),(n={},n[s]=r.__spreadArrays(e.folderHierarchyMap[i],[l]),n))}}),this.writeFolderHierarchy),C.removeRlkeyFromURL())},a.prototype.getUserStorageKey=function(){return r.__awaiter(this,void 0,void 0,(function(){var t,n;return r.__generator(this,(function(o){switch(o.label){case 0:return[4,new Promise((function(t,r){e(["sjcl"],t,r)})).then(r.__importStar)];case 1:return t=o.sent(),n=t.hash.sha256.hash(D.readCsrfToken()||""),[2,t.codec.base64.fromBits(n)]}}))}))},a.prototype.writeFolderHierarchy=function(){return r.__awaiter(this,void 0,void 0,(function(){var e,t,n,o;return r.__generator(this,(function(r){switch(r.label){case 0:return t=(e=k.SessionStorage).set,n=["shared_folder_hierarchy"],o={},[4,this.getUserStorageKey()];case 1:return t.apply(e,n.concat([(o[r.sent()]=this.state.folderHierarchyMap,o)])),[2]}}))}))},a.prototype.readFolderHierarchy=function(){return r.__awaiter(this,void 0,void 0,(function(){var e,t,o;return r.__generator(this,(function(r){switch(r.label){case 0:return t=(e=n).get,o=[k.SessionStorage.get("shared_folder_hierarchy")],[4,this.getUserStorageKey()];case 1:return[2,t.apply(e,o.concat([r.sent()]))]}}))}))},a.prototype.openImmediatelyInApp=function(){var e=this.props.folder;if(e)try{e.folder.open_in_app_data&&c.openImmediately(e.folder.open_in_app_data)}catch(e){}},a.prototype.render=function(){var e=this.props,r=e.accountMenuOptions,i=e.appDownloadInterstitialDismissed,a=e.brandingInfo,s=e.file,l=e.files,c=e.fileViewOrigin,d=e.fileViewTarget,u=e.folder,p=e.onAppDownloadInterstitialDismissed,f=e.outOfQuota,m=e.shouldForceListMode,h=e.showSyncCoachmark,v=e.subfolders,y=e.viewingFilename,w=e.encryptionOptions,S=e.shouldDisplayLayoutChange,M=this.state,k=M.folderHierarchyMap,T=M.user,P=M.previewSourceAction,A=n.get(k,C.getSecureHashOrSubPath(C.getFolderShareTokenWithRlkey(this.props.folderShareToken,this.rlkey)),[]).map(I);if(y&&s){var F=[],O=[],D=[],x=[];return Array.isArray(l)&&l.length?l.forEach((function(e,t){O.push(e.shareToken),D.push(e.sharedLinkInfo),F.push(e.sharePermission),x.push(e.file)})):(x=[s.file],F=[s.sharePermission],O=[s.shareToken],D=[s.sharedLinkInfo]),o.default.createElement(t.AsyncFileCollectionViewer,{brandingInfo:a,canClose:!0,className:"no-background",file:s.file,files:x,fileViewOrigin:c,fileViewTarget:d,fileViewAction:E.FileViewActionType.CLICK,initialPreviewSourceContext:g.PreviewSourceContext.SharedLinkFolder,initialPreviewSourceAction:P,skipOuterRouting:!0,sharedLinkInfos:D,sharePermissions:F,shareTokens:O,titleBarCloseUrl:_.getCurrentFolderHref(),onCloseViewer:_.closeFile,user:T,encryptionOptions:w})}if(!u)return null;var N=u.shareToken,R=u.sharedLinkInfo,L=u.folder,U=u.sharePermission,H=u.hasMore,B=u.takedownRequestType,q={files:Array.isArray(l)?l.map((function(e){return e.file})):[],folders:Array.isArray(v)?v.map((function(e){return e.folder})):[]};return L.folder_id&&(this.folderPreviewSession.extra.folder_id=L.folder_id),o.default.createElement(b.SharedLinkFolderPage,{accountMenuOptions:r,appDownloadInterstitialDismissed:i,brandingInfo:a,breadcrumbs:A,contents:q,folder:L,folderPreviewSession:this.folderPreviewSession,folderSharePermission:U,folderShareToken:N,folderSharedLinkInfo:R,hasMore:H,onAppDownloadInterstitialDismissed:p,onFileOpen:this.handleOpenFile,onFolderOpen:this.handleOpenFolder,onListModeDisable:C.disableListMode,onListModeEnable:C.enableListMode,outOfQuota:f,shouldForceListMode:m,showSyncCoachmark:h,takedownRequestType:B,user:T,webTimer:this.webTimer,encryptionOptions:w,shouldDisplayLayoutChange:S})},a.defaultProps={subfolderNavTracking:!1},a.displayName="SharedLinkFolderApp",a})(o.default.PureComponent);t._SharedLinkFolderApp=U;var H=a.connect((function(e,t){var r=f.getAppDownloadInterstitial(e);void 0===r&&(r=t.appDownloadInterstitialDismissed);var n=t.viewingFilename,o=O.getFolderShareTokenWithState(e,t.folderShareToken),i=C.getSecureHashOrSubPath(o);return{appDownloadInterstitialDismissed:r,file:O.getSharedFilePackageByFilenameForFolderPath(e,i,n||""),folder:O.getFolderByPath(e,i),files:O.getSharedFilePackagesForFolderPath(e,i),subfolders:O.getSubfoldersForFolderPath(e,i)}}),(function(e,t){var r=t.shouldFetchPreviewData;return i.bindActionCreators({onAppDownloadInterstitialDismissed:p.dismissAppDownloadInterstitial,onFolderLoad:v.fetchFolder,onFolderPrefetch:r?v.prefetchFolderFromOdyssey:v.prefetchFolder},e)}))(U),B=h.withLocation(H,(function(e){return{folderShareToken:C.getFolderShareTokenFromLocation(e),viewingFilename:m.getFilenameFromLocation(e),shouldForceListMode:"lst"in e.query,subfolderNavTracking:"subfolder_nav_tracking"in e.query}})),q=(function(e){function t(t){var r=e.call(this,t)||this;r.store=y.getStoreForSharedLinkFolder();var n=C.getFolderShareTokenWithRlkey(r.props.folderShareToken,r.store.rlkey);return y.hydrateStore(r.store,{initialFolder:r.props.folderData,initialPreview:r.props.preview,folderSharedLinkInfo:r.props.folderSharedLinkInfo,folderSharePermission:r.props.folderSharePermission,folderShareToken:n}),r}return r.__extends(t,e),t.prototype.render=function(){return o.default.createElement(A.IntlProvider,{defaultLocale:"en-US",locale:F.localeToBcp47LangTag(T.USER_LOCALE),messages:P},o.default.createElement(a.Provider,{store:this.store},o.default.createElement(B,r.__assign({},this.props))))},t.displayName="SharedLinkFolderAppWithProvider",t})(o.default.Component);t.SharedLinkFolderApp=q})),define("spectrum/mobile_menu/index",["require","exports","tslib","spectrum/mobile_menu/mobile_menu","spectrum/mobile_menu/mobile_menu_close_button","spectrum/mobile_menu/mobile_menu_content","spectrum/mobile_menu/mobile_menu_item"],(function(e,t,r,n,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r.__exportStar(n,t),r.__exportStar(o,t),r.__exportStar(i,t),r.__exportStar(a,t)})),define("modules/clean/loggers/folder_preview_logger",["require","exports","tslib","modules/clean/deprecated_ajax/ajax_jquery","modules/core/browser","modules/constants/request","modules/clean/react/previews/constants","modules/clean/web_timing_logger","modules/clean/uuid/uuid","modules/clean/loggers/device_type"],(function(e,t,r,n,o,i,a,s,l,c){"use strict";var d;function u(e){return+!!e}function p(e){return JSON.stringify(r.__assign(r.__assign({},e),{has_cached_data:u(e.has_cached_data),folder_preview_timeline:JSON.stringify(e.folder_preview_timeline),subfolder_nav_tracking:u(e.subfolder_nav_tracking),web_timing_data:JSON.stringify(e.web_timing_data)}))}function f(e){var t=r.__assign({},e.extra),n=o.performance();if(null!=n){var i=n.timing;i&&i.fetchStart&&(t.time_to_first_byte=i.responseStart-i.fetchStart,t.web_timing_data=i)}return{device_type:e.deviceType,folder_preview_session_id:e.id,folder_ns_id:e.ns_id||0,web_request_id:e.web_request_id,extra:p(t)}}Object.defineProperty(t,"__esModule",{value:!0}),t.logEvent=t.markPrimaryEvent=t.createSession=t.EventType=void 0,n=r.__importStar(n),o=r.__importStar(o),i=r.__importStar(i),(function(e){e.attempted="preview_attempted",e.renderSucceeded="render_succeeded",e.renderFailed="render_failed",e.ended="preview_session_ended",e.appDownloadInterstitialClose="app_download_interstitial_close",e.appDownloadInterstitialContinue="app_download_interstitial_continue",e.appDownloadInterstitialInstall="app_download_interstitial_install",e.appDownloadInterstitialView="app_download_interstitial_view",e.breadcrumbClicked="breadcrumb_clicked"})(d=t.EventType||(t.EventType={})),t.createSession=function(e){var t=void 0===e?{}:e,r=t.id,n=void 0===r?l.UUID.v4({allowInsecure:!0}):r,d=t.ns_id,u=void 0===d?0:d,p=t.deviceType,f=void 0===p?c.getDeviceType():p,m=t.web_request_id,h=void 0===m?i.REQUEST_ID:m,_=t.source_action,g=void 0===_?a.PreviewSourceAction.Visit:_,v=t.subfolder_nav_tracking,y=t.has_cached_data,b=t.use_odyssey,w=void 0!==b&&b,S=t.folder_id;return{id:n,ns_id:u,web_request_id:h,deviceType:f,extra:{start_time:g===a.PreviewSourceAction.Visit?s.start_time():o.now(),subfolder_nav_tracking:v,has_cached_data:y,source_action:g,folder_preview_timeline:{},use_odyssey:w,folder_id:S}}},t.markPrimaryEvent=function(e){var t=e.extra;if(!t.primary_mark_ts){var r=o.now();t.primary_mark_ts=r;var n=t.start_time;n&&t.primary_mark_ts&&(t.time_to_primary_mark=t.primary_mark_ts-n)}},t.logEvent=function(e,t){var i=t.extra.folder_preview_timeline,a=o.now();if(!i.preview_session_ended_ts){switch(e){case d.attempted:if(i.preview_attempted_ts)return;i.preview_attempted_ts=a;break;case d.ended:if(i.preview_session_ended_ts)return;i.preview_session_ended_ts=a;break;case d.renderSucceeded:if(i.render_succeeded_ts)return;i.render_succeeded_ts=a;break;case d.renderFailed:if(i.render_failed_ts)return;i.render_failed_ts=a}return(function(e,t){return n.SilentBackgroundBeaconRequest({url:"/log/folder_preview",data:r.__assign(r.__assign({},f(t)),{event_name:e})})})(e,t)}}})),define("modules/clean/prefetch/prefetch",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPrefetchData=void 0,t.getPrefetchData=function(e){var t=window[e];if(t)return(function(e){return new Promise((function(t,r){var n=e.getDataIfAvailable();n?n.payload?t(JSON.parse(n.payload)):r(n.error):e((function(e){return t(JSON.parse(e))}),r)}))})(t)}})),define("modules/clean/react/shared_link_folder/api",["require","exports","modules/clean/prefetch/prefetch","modules/clean/deprecated_ajax/ajax_jquery"],(function(e,t,r,n){"use strict";function o(e){return{_mount_access_perms:e._mount_access_perms,filename:e.filename,href:e.href,is_dir:e.is_dir,ns_id:e.ns_id,open_in_app_data:e.open_in_app_data,shared_folder_id:e.shared_folder_id,sort_key:e.sort_key,folder_id:e.folder_id}}function i(e){return{canCopyToDropboxRoles:e.canCopyToDropboxRoles,canDownloadRoles:e.canDownloadRoles,canPrintRoles:e.canPrintRoles,canRemoveLinkUids:e.canRemoveLinkUids,canSyncToDropboxRoles:e.canSyncToDropboxRoles,canViewContextMenuRoles:e.canViewContextMenuRoles,canViewMetadataRoles:e.canViewMetadataRoles,isEditFolderLink:e.isEditFolderLink,syncVarsByRoles:e.syncVarsByRoles}}function a(e){return{itemId:e.itemId,linkKey:e.linkKey,linkType:e.linkType,secureHash:e.secureHash,subPath:e.subPath,rlkey:e.rlkey}}function s(e){for(var t,r=[],n=0,s=e.entries;n<s.length;n++){var l=s[n];l.is_dir?r.push(o(l)):r.push({is_dir:(t=l).is_dir,filename:t.filename,sort_key:t.sort_key,href:t.href,bytes:t.bytes,preview:t.preview,ns_id:t.ns_id,preview_type:t.preview_type?t.preview_type:null,sjid:t.sjid,ts:t.ts,thumbnail_url_tmpl:t.thumbnail_url_tmpl,file_id:t.file_id,revision_id:t.revision_id,is_symlink:!1})}var c=e.share_permissions.map(i),d=e.share_tokens.map(a);return{entries:r,folder:o(e.folder),folderSharedLinkInfo:e.folder_shared_link_info,folderSharePermission:i(e.folder_share_permission),folderShareToken:a(e.folder_share_token),hasMoreEntries:e.has_more_entries,nextRequestVoucher:e.next_request_voucher,sharedLinkInfos:e.shared_link_infos,sharePermissions:c,shareTokens:d,takedownRequestType:e.takedown_request_type}}function l(e,t,r){var o={link_key:e.linkKey,link_type:e.linkType,secure_hash:e.secureHash,sub_path:e.subPath||""};return t&&(o.voucher=t),e.rlkey&&(o.rlkey=e.rlkey),new Promise((function(e,t){return n.WebRequest({type:"POST",url:"/list_shared_link_folder_entries",data:o,dataType:"json",success:function(t,n,o){if(r){var i=o.getResponseHeader("x-dropbox-request-id");r.end(i||void 0)}e(s(t))},error:function(e,r,n){t(new Error(n))}})}))}Object.defineProperty(t,"__esModule",{value:!0}),t.fetchNextPage=t.prefetchFirstPage=t.fetchPreviewAndSharingData=t.fetchPage=t.deserializePage=void 0,t.deserializePage=s,t.fetchPage=l,t.fetchPreviewAndSharingData=function(e){return l(e)},t.prefetchFirstPage=function(e){return(function(){var e=r.getPrefetchData("__REGISTER_SHARED_LINK_FOLDER_PRELOAD_HANDLER");if(e)return e.then(s)})()||l(e)},t.fetchNextPage=function(e,t){return l(e,t)}})),define("modules/clean/react/shared_link_folder/api_odyssey",["require","exports","tslib","modules/clean/prefetch/prefetch","modules/clean/react/shared_link_folder/api","modules/clean/filepath/filepath"],(function(e,t,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.prefetchFirstPage=t.deserializeFile=t.deserializeFolder=t.deserializeOdysseyResponse=void 0,i=r.__importStar(i);function a(e){for(var t=[],r=0,n=e.paginated?e.first_page.items:e.file_info;r<n.length;r++){var o=n[r];o.is_dir?t.push(s(o)):t.push(l(o))}return{entries:t,hasMoreEntries:e.paginated&&e.first_page.has_more_items,nextRequestVoucher:e.paginated?e.first_page.next_request_voucher:void 0}}function s(e){return{_mount_access_perms:e.mount_access_perms,filename:i.filename(e.fq_path),href:"",is_dir:!0,ns_id:e.ns_id,open_in_app_data:void 0,shared_folder_id:void 0,sort_key:[e.sort_key]}}function l(e){return{bytes:e.bytes,file_id:e.file_id,filename:i.filename(e.fq_path),href:"",is_dir:!1,is_symlink:e.is_symlink,ns_id:e.ns_id,revision_id:e.revision_id,sjid:e.sjid,sort_key:[e.sort_key],ts:e.ts}}t.deserializeOdysseyResponse=a,t.deserializeFolder=s,t.deserializeFile=l,t.prefetchFirstPage=function(e){return(function(){var e=n.getPrefetchData("__REGISTER_ODYSSEY_SHARED_LINK_FOLDER_PRELOAD_HANDLER");if(e)return e.then(a)})()||o.fetchPage(e)}})),define("modules/clean/react/shared_link_folder/data/actions",["require","exports","tslib","modules/clean/file_store/actions","modules/clean/react/shared_link_folder/api","modules/clean/react/shared_link_folder/api_odyssey","modules/clean/react/shared_link_folder/data/types","modules/clean/file_store/utils","modules/clean/previews/data/actions","modules/clean/redux/constants","modules/clean/react/shared_link_folder/utils"],(function(e,t,r,n,o,i,a,s,l,c,d){"use strict";function u(e,t){var n=(function(e){return e?{file:e.file,fileMetadata:r.__rest(e,["file"])}:{file:void 0,fileMetadata:void 0}})(t),o=n.file,i=n.fileMetadata,l=o&&s.getFileStoreId(o);return{type:a.Actions.HydrateSharedFolder,payload:{fileId:l,fileMetadata:i,folderPackage:r.__assign(r.__assign({},e),{entries:e.entries.length?e.entries:l?[{type:"file",id:l}]:[]})}}}function p(e,t){for(var r=d.getSecureHashOrSubPath(e),n=[],o={},i=0,l=t;i<l.length;i++){var c=l[i];if(c.is_dir){var u=c.filename;n.push({type:"folder",id:u}),o[u]={folder:c,entries:[],hasMore:!0}}else n.push({type:"file",id:s.getFileRevisionId(c)})}return{type:a.Actions.HydrateEntries,payload:{secureHashOrSubPath:r,entries:n,folderPackageMap:o}}}function f(e){return{type:a.Actions.FetchPageRequest,payload:e}}function m(e,t){return{type:a.Actions.FetchPageSuccess,payload:{fileMetadata:e,folderPackage:t}}}function h(e,t){return function r(i,l){void 0===l&&(l=0);var c=(function(e,t,r){var n;void 0===r&&(r=0);var o=e.entries,i=e.hasMoreEntries,l=e.sharedLinkInfos,c=e.sharePermissions,u=e.shareTokens,p=e.takedownRequestType,f={},m=((n={})[t]={entries:[],fromIndex:r,hasMore:i,takedownRequestType:p,folder:e.folder,sharedLinkInfo:e.folderSharedLinkInfo,sharePermission:e.folderSharePermission,shareToken:e.folderShareToken},n),h=[];return o.forEach((function(e,r){if(a.isFile(e)){var n=s.getFileStoreId(e);h.push(e),f[n]={sharedLinkInfo:l[r],sharePermission:c[r],shareToken:u[r]},m[t].entries.push({type:"file",id:n})}else{var o=d.getSecureHashOrSubPath(u[r]);m[t].entries.push({type:"folder",id:o}),m[o]={folder:e,fromIndex:0,hasMore:!0,sharedLinkInfo:l[r],sharePermission:c[r],shareToken:u[r]}}})),{files:h,fileMetadata:f,folderPackage:m}})(i,d.getSecureHashOrSubPath(t),l),u=c.files,p=c.fileMetadata,f=c.folderPackage;e(n.putFiles(u)),e(m(p,f)),i.hasMoreEntries&&i.nextRequestVoucher&&o.fetchNextPage(t,i.nextRequestVoucher).then((function(e){return r(e,l+i.entries.length)}))}}function _(e,t){return function(r){var o=t.entries,i=t.sharedLinkInfos,u=t.sharePermissions,p=t.shareTokens;if(o){var f=[],m={},h={},_=[];o.forEach((function(e,t){if(a.isFile(e)){var r=s.getFileStoreId(e);m[r]={sharedLinkInfo:i[t],sharePermission:u[t],shareToken:p[t]},f.push(e),_.push({type:"file",id:s.getFileRevisionId(e)})}else{var n=d.getSecureHashOrSubPath(p[t]);h[n]={entries:[],folder:e,fromIndex:0,hasMore:!0,sharedLinkInfo:i[t],sharePermission:u[t],shareToken:p[t]},_.push({type:"folder",id:n})}})),r(n.putFiles(f)),r(l.updatePreviewData(l.buildPreviewData(f,c.ApiClientStatus.Success))),r({type:a.Actions.HydratePreviewAndSharingData,payload:{parentSecureHashOrSubPath:e,parentFolderEntries:_,fileMetadataMap:m,folderPackageMap:h}})}}}Object.defineProperty(t,"__esModule",{value:!0}),t.hydratePreviewAndSharingData=t.fetchFolder=t.prefetchFolderFromOdyssey=t.prefetchFolder=t.fetchPageSuccess=t.hydrateEntries=t.hydrateSharedFolderAndFile=void 0,o=r.__importStar(o),i=r.__importStar(i),t.hydrateSharedFolderAndFile=function(e,t){return function(r){t&&r(n.putFile(t.file)),r(u(e,t))}},t.hydrateEntries=p,t.fetchPageSuccess=m,t.prefetchFolder=function(e,t){return function(t){t(f(e));var r=o.prefetchFirstPage(e);return r.then(h(t,e)),r}},t.prefetchFolderFromOdyssey=function(e,t){return function(r){var u=o.fetchPreviewAndSharingData(e);return r(f(e)),i.prefetchFirstPage(e).then((function(o){var i=(function(e,t){var r=e.entries,n=t?t.file:void 0;return{files:r.filter(a.isFile).map((function(e){return n&&s.areFilesEqual(n,e)?n:e})),entries:r}})(o,t),f=i.files,m=i.entries;r(n.putFiles(f)),r(l.updatePreviewData(l.buildPreviewData(f,c.ApiClientStatus.Request))),r(p(e,m)),u.then((function(t){var n=d.getSecureHashOrSubPath(e);r(_(n,t)),h(r,e)(t)}))})),u}},t.fetchFolder=function(e,t){return function(r){return r(f(e)),o.fetchPage(e,void 0,t).then(h(r,e))}},t.hydratePreviewAndSharingData=_})),define("modules/clean/react/shared_link_folder/data/reducer",["require","exports","tslib","lodash","modules/clean/react/shared_link_folder/data/types","modules/clean/react/shared_link_folder/utils","modules/clean/react/shared_link_folder/utils"],(function(e,t,r,n,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sharedLinkFolderReducer=void 0,n=r.__importStar(n);var s={fileMetadata:{},folderPackage:{},rlkey:""};t.sharedLinkFolderReducer=function(e,t){var l,c,d,u,p;switch(void 0===e&&(e=s),t.type){case o.Actions.FetchPageRequest:var f=t.payload,m=f.rlkey?f.rlkey:e.rlkey,h=a.getSecureHashOrSubPath(f),_=e.folderPackage[h];return _?r.__assign(r.__assign({},e),{folderPackage:r.__assign(r.__assign({},e.folderPackage),(l={},l[h]=r.__assign(r.__assign({},_),{hasMore:!0}),l)),rlkey:m}):e;case o.Actions.HydrateSharedFolder:var g=t.payload,v=g.fileId,y=g.fileMetadata,b=g.folderPackage,w=(h=a.getSecureHashOrSubPath(b.shareToken),null!=v?((c={})[v]=y,c):{});return r.__assign(r.__assign({},e),{fileMetadata:r.__assign(r.__assign({},e.fileMetadata),w),folderPackage:r.__assign(r.__assign({},e.folderPackage),(d={},d[h]=r.__assign(r.__assign({},b),{hasMore:!0}),d))});case o.Actions.HydrateEntries:var S=t.payload,E=(h=S.secureHashOrSubPath,S.entries),M=S.folderPackageMap;b=e.folderPackage[h];return r.__assign(r.__assign({},e),{folderPackage:r.__assign(r.__assign(r.__assign({},e.folderPackage),M),(u={},u[h]=r.__assign(r.__assign({},b),{entries:E}),u))});case o.Actions.FetchPageSuccess:var k=t.payload,T=(y=k.fileMetadata,k.folderPackage),P={};return Object.keys(T).forEach((function(t){var n=e.folderPackage[t]||{},o=T[t],a=o.fromIndex,s=r.__rest(o,["fromIndex"]);P[t]=r.__assign(r.__assign(r.__assign({},n),s),{entries:i.mergeFolderEntries(n.entries,s.entries,a,!s.hasMore)})})),r.__assign(r.__assign({},e),{fileMetadata:r.__assign(r.__assign({},e.fileMetadata),y),folderPackage:r.__assign(r.__assign({},e.folderPackage),P)});case o.Actions.HydratePreviewAndSharingData:var A=t.payload,F=A.fileMetadataMap,C=(M=A.folderPackageMap,A.parentSecureHashOrSubPath),O=A.parentFolderEntries,D=n.values(M).map((function(e){return e.folder.filename})),x=Object.keys(e.folderPackage).filter((function(e){return-1===D.indexOf(e)})).reduce((function(t,r){return t[r]=e.folderPackage[r],t}),{});return r.__assign(r.__assign({},e),{fileMetadata:r.__assign(r.__assign({},e.fileMetadata),F),folderPackage:r.__assign(r.__assign(r.__assign({},x),M),(p={},p[C]=r.__assign(r.__assign({},e.folderPackage[C]),{entries:O}),p))})}return e}})),define("modules/clean/react/shared_link_folder/data/selectors",["require","exports","tslib","lodash","modules/clean/redux/namespaces","modules/clean/file_store/selectors","modules/clean/react/shared_link_folder/utils"],(function(e,t,r,n,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFolderShareTokenWithState=t.getSharedFilePackageByFilenameForFolderPath=t.getSharedFilePackagesForFolderPath=t.getSubfoldersForFolderPath=t.getFolderByPath=void 0,n=r.__importStar(n);var s=function(e){return e[o.SHARED_LINK_FOLDER_NAMESPACE_KEY]};t.getFolderByPath=function(e,t){return s(e).folderPackage[t]};var l=function(e,r){var n=t.getFolderByPath(e,r);return n?n.entries.filter((function(e){return"file"===e.type})).map((function(e){return e.id})):[]};function c(e,t){var n=i.getFile(e,t);if(n){var o=(function(e,t){return s(e).fileMetadata[t]})(e,t);return r.__assign(r.__assign({},o),{file:n})}}t.getSubfoldersForFolderPath=function(e,r){var n=t.getFolderByPath(e,r);if(n)return n.entries.filter((function(e){return"folder"===e.type})).map((function(t){return(function(e,t){return s(e).folderPackage[t]})(e,t.id)}))},t.getSharedFilePackagesForFolderPath=function(e,t){return l(e,t).map((function(t){return c(e,t)})).filter(Boolean)},t.getSharedFilePackageByFilenameForFolderPath=function(e,t,r){var o=(function(e,t,r){if(r){var o=l(e,t);return n.find(o,(function(t){var n=i.getFile(e,t);return void 0!==n&&n.filename===r}))}})(e,t,r);if(o)return c(e,o)},t.getFolderShareTokenWithState=function(e,t){var r=s(e).rlkey,n=r||t.rlkey;return a.getFolderShareTokenWithRlkey(t,n)}})),define("modules/clean/react/shared_link_folder/data/store",["require","exports","tslib","lodash","modules/clean/file_store/reducer","modules/clean/react/file_viewer/data/reducer","modules/clean/react/shared_link_folder/data/actions","modules/clean/react/shared_link_folder/data/reducer","modules/clean/redux/store","modules/clean/redux/namespaces"],(function(e,t,r,n,o,i,a,s,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hydrateStore=t.getStoreForSharedLinkFolder=void 0,n=r.__importStar(n),t.getStoreForSharedLinkFolder=n.once((function(){var e,t=((e={})[c.FILE_NAMESPACE_KEY]=o.fileNamespaceReducer,e[c.FILE_VIEWER_NAMESPACE_KEY]=i.fileViewerReducer,e[c.SHARED_LINK_FOLDER_NAMESPACE_KEY]=s.sharedLinkFolderReducer,e);return l.getStoreAndRegisterReducers(t)})),t.hydrateStore=function(e,t){var r=t.initialPreview,n={folder:t.initialFolder,sharedLinkInfo:t.folderSharedLinkInfo,sharePermission:t.folderSharePermission,shareToken:t.folderShareToken,hasMore:!0,entries:[]};e.dispatch(a.hydrateSharedFolderAndFile(n,r))}})),define("modules/clean/react/shared_link_folder/data/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TakedownType=t.Actions=t.isFile=void 0,t.isFile=function(e){return!e.is_dir},(function(e){e.HydrateSharedFolder="SHARED_FOLDER/HYDRATE",e.HydrateEntries="SHARED_FOLDER/HYDRATE_ENTRIES",e.HydratePreviewAndSharingData="SHARED_FOLDER/HYDRATE_PREVIEW_AND_SHARING_DATA",e.FetchPageSuccess="SHARED_FOLDER/FETCH_SUCCESS",e.FetchPageRequest="SHARED_FOLDER/FETCH_REQUEST"})(t.Actions||(t.Actions={})),(function(e){e[e.DMCA=1]="DMCA",e[e.MALWARE=2]="MALWARE",e[e.ILLEGAL=3]="ILLEGAL",e[e.OTHER=4]="OTHER",e[e.SPAM=5]="SPAM",e[e.TERROR=6]="TERROR",e[e.CSAI=7]="CSAI",e[e.PHISHING=8]="PHISHING"})(t.TakedownType||(t.TakedownType={}))})),define("modules/clean/react/shared_link_folder/folder_icon",["require","exports","tslib","react","modules/clean/react/shared_link_folder/utils","spectrum/icon_content/index","modules/clean/react/icon/icon_helper"],(function(e,t,r,n,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharedLinkFolderFolderIcon=void 0,n=r.__importDefault(n),t.SharedLinkFolderFolderIcon=function(e){var t=e.className,r=e.folder,s=e.size;return n.default.createElement(i.IconContent,{className:t,name:a.spectrumFolderIcon({size:s,isConfidential:o.isNoAccessFolder(r)})})}})),define("modules/clean/react/shared_link_folder/folder_title",["require","exports","tslib","react","modules/constants/trademark","modules/core/uri","modules/core/i18n","modules/clean/react/shared_link_folder/utils","modules/clean/react/async/loadable"],(function(e,t,r,n,o,i,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContentOwner=t.FolderTitle=void 0,n=r.__importDefault(n);var c=l.Loadable({loader:function(){return new Promise((function(t,r){e(["modules/clean/react/breadcrumb/trail"],t,r)})).then(r.__importStar).then((function(e){return e.BreadcrumbTrail}))}}),d=(function(e){function o(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleCrumbClick=function(e,r,n){var o=t.props.onCrumbClick;e.preventDefault(),s.navigateToFolderHref(r.href),o&&o(n)},t}return r.__extends(o,e),o.prototype.render=function(){var e=this.props,o=e.breadcrumbs,i=e.ownerName,a=e.ownerTeamLogo,s=e.ownerTeamName,l=e.title;return n.default.createElement("div",{className:"sl-folder-title"},o&&o.length>0?n.default.createElement(c,r.__assign({},(function(e){var t,r;return e.length<=2?t=e:(t=e.slice(e.length-1),r=e.slice(0,e.length-1)),{inlineCrumbs:t,overflowCrumbs:r}})(o),{onChange:this.handleCrumbClick})):l,s?n.default.createElement(t.ContentOwner,{ownerName:i,ownerTeamName:s,ownerTeamLogo:a}):null)},o.displayName="FolderTitle",o})(n.default.PureComponent);t.FolderTitle=d;var u=new i.URI({path:"/business",query:{src:"schmodel"}}).toString();t.ContentOwner=function(e){var t=e.ownerName,r=e.ownerTeamName,i=e.ownerTeamLogo;return n.default.createElement("div",{className:"sl-subtitle"},null!=t?a.intl.formatMessage({id:"V1gDEG",defaultMessage:"from {owner} ({team})"},{owner:t,team:r}):a.intl.formatMessage({id:"mL9XU3",defaultMessage:"from {team}"},{team:r}),null!=i?n.default.createElement("span",null," ","via ",n.default.createElement("a",{href:u},o.TRADEMARK_BUSINESS)):null)}})),define("modules/clean/react/shared_link_folder/grid",["require","exports","tslib","react","classnames","modules/clean/em_string","modules/clean/previews/constants","modules/clean/react/icon/icon_helper","modules/clean/react/shared_link_folder/folder_icon","modules/clean/react/file_viewer/url_utils","modules/clean/react/thumbnail","spectrum/tooltip/index","modules/core/i18n"],(function(e,t,r,n,o,i,a,s,l,c,d,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FolderCell=t.FileCell=t.SharedLinkFolderGrid=t.FileTitle=void 0,n=r.__importDefault(n),o=r.__importDefault(o);function f(e){var t=e.label,r=e.filename,o=n.default.createElement("span",{className:"sl-grid-filename"},t);return r===t?o:n.default.createElement(u.Tooltip,{positioning:"below",tooltipContent:r,wrapperClassName:"sl-grid-tooltip-wrapper"},o)}function m(e){var t=e.entry,r=e.onFolderOpen,o=e.onFileOpen,a=e.largeGrid,s=i.Emstring.em_snippet(t.filename,16);return t.is_dir?n.default.createElement(_,{folder:t,label:s,onOpen:r,largeGrid:a}):n.default.createElement(h,{file:t,label:s,onOpen:o,largeGrid:a})}t.FileTitle=f,t.SharedLinkFolderGrid=function(e){var t=e.entries,r=e.onFileOpen,o=e.onFolderOpen,i=e.largeGrid,a="sl-grid-cell";return i&&(a+="-lg"),n.default.createElement("div",{className:"sl-grid"},n.default.createElement("div",{className:"sl-grid-header clearfix"},n.default.createElement("div",{className:"sl-grid-header-column sl-grid-header-column--sort"},p.intl.formatMessage({id:"gTD7Ga",defaultMessage:"Sorted by name"}))),n.default.createElement("ol",{className:"sl-grid-body"},t.map((function(e){return n.default.createElement("li",{className:a,key:e.filename},n.default.createElement(m,{entry:e,onFolderOpen:o,onFileOpen:r,largeGrid:i}))}))))};var h=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClick=c.linkClickHandler((function(e){e.preventDefault();var r=t.props,n=r.file;(0,r.onOpen)(n)})),t}return r.__extends(t,e),t.prototype.isVideo=function(){return this.props.file.preview_type===a.PreviewType.Video},t.prototype.render=function(){var e=this.props,t=e.file,r=e.label,i=e.largeGrid,a=o.default("sl-link sl-link--file",{"sl-link--disabled":""===t.href}),l="sl-grid-thumbnail-container",c="sl-grid-thumbnail";return i&&(l="sl-grid-thumbnail-container-lg",c="sl-grid-thumbnail-lg"),n.default.createElement("a",{href:t.href,onClick:this.handleClick,className:a},n.default.createElement("div",{className:l},n.default.createElement(d.ThumbnailIcon,{alt:t.filename,className:c,file:t,iconSize:s.SpectrumIconSize.Large}),this.isVideo()?n.default.createElement("div",{className:"sl-video-watermark"}):null),n.default.createElement(f,{label:r,filename:t.filename}))},t.displayName="FileCell",t})(n.default.PureComponent);t.FileCell=h;var _=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClick=c.linkClickHandler((function(e){e.preventDefault();var r=t.props,n=r.folder;(0,r.onOpen)(n)})),t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.folder,r=e.label,i=e.largeGrid,a=o.default("sl-link sl-link--folder",{"sl-link--disabled":""===t.href}),c="sl-grid-thumbnail-container",d="sl-grid-thumbnail";return i&&(c="sl-grid-thumbnail-container-lg",d="sl-grid-thumbnail-lg"),n.default.createElement("a",{href:t.href,onClick:this.handleClick,className:a},n.default.createElement("div",{className:c},n.default.createElement(l.SharedLinkFolderFolderIcon,{className:d,folder:t,size:s.SpectrumIconSize.Large})),n.default.createElement(f,{label:r,filename:t.filename}))},t.displayName="FolderCell",t})(n.default.PureComponent);t.FolderCell=_})),define("modules/clean/react/shared_link_folder/list",["require","exports","tslib","react","classnames","spectrum/table/index","spectrum/media_table/index","modules/clean/datetime/datetime","modules/clean/em_string","modules/clean/react/shared_link_folder/folder_icon","modules/clean/react/thumbnail","modules/core/i18n","modules/core/uri","modules/clean/react/size_class/constants","modules/clean/react/file_viewer/url_utils","modules/clean/display_format"],(function(e,t,r,n,o,i,a,s,l,c,d,u,p,f,m,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharedLinkFolderList=void 0,n=r.__importDefault(n),o=r.__importDefault(o);var _=["1 1 50%","1 1 30%","1 1 20%"];function g(e){var t=e.entry,r=e.sizeClass,o=e.onFolderOpen,i=e.onFileOpen,a=e.smallList;return t.is_dir?n.default.createElement(y,{folder:t,sizeClass:r,onOpen:o,smallList:a}):n.default.createElement(b,{file:t,sizeClass:r,onOpen:i,smallList:a})}function v(e){var t=e.icon,r=e.lastModified,i=e.name,c=e.fileSize,d=e.sizeClass,u=e.onClick,p=e.href,_=e.smallList,g=m.linkClickHandler((function(e){e.preventDefault(),"function"==typeof u&&u()})),v=o.default("sl-list-row",{"sl-list-row--disabled":""===p});return n.default.createElement(a.MediaRow,{className:v},n.default.createElement(a.MediaCell,{className:"sl-list-column--filename",icon:t,title:l.Emstring.em_snippet(i,40)},n.default.createElement("a",{href:p,"aria-label":i,onClick:g})),d!==f.SizeClass.Small?n.default.createElement(a.MediaCell,{className:"sl-list-column--modified",title:r?s.format_date(r,s.localized_datetime_format):"--"}):null,_?n.default.createElement(a.MediaCell,{className:"sl-list-column--size",title:c?h.format_bytes(c):"--"}):null)}function y(e){var t=e.folder,r=e.sizeClass,o=e.onOpen,i=e.smallList,a="";""!==t.href&&(a=p.URI.parse(t.href).updateQuery({lst:""}).toString());return n.default.createElement(v,{icon:n.default.createElement(c.SharedLinkFolderFolderIcon,{className:"sl-list-icon",folder:t}),href:a,name:t.filename,onClick:function(){return o(t)},sizeClass:r,smallList:i})}function b(e){var t=e.file,r=e.sizeClass,o=e.onOpen,i=e.smallList;return n.default.createElement(v,{icon:n.default.createElement(d.ThumbnailIcon,{alt:t.filename,className:"sl-list-icon",file:t}),lastModified:new Date(1e3*t.ts),name:t.filename,fileSize:t.bytes,href:t.href,onClick:function(){return o(t)},sizeClass:r,smallList:i})}t.SharedLinkFolderList=function(e){var t=e.entries,r=e.sizeClass,a=e.onFileOpen,s=e.onFolderOpen,l=e.smallList;return n.default.createElement(i.Table,{columnFlex:_,className:o.default("sl-list-container",{"sl-list-container-condensed-list":l})},n.default.createElement(i.TableHead,null,n.default.createElement(i.TableHeadCell,null,u.intl.formatMessage({id:"cJojIg",defaultMessage:"Name"})),r!==f.SizeClass.Small?n.default.createElement(i.TableHeadCell,null,u.intl.formatMessage({id:"wqMlXT",defaultMessage:"Modified"})):null,l?n.default.createElement(i.TableHeadCell,null,u.intl.formatMessage({id:"QG1cgy",defaultMessage:"Size"})):null),n.default.createElement(i.TableBody,null,t.map((function(e){return n.default.createElement(g,{key:e.filename,entry:e,sizeClass:r,onFileOpen:a,onFolderOpen:s,smallList:l})}))))}})),define("modules/clean/react/shared_link_folder/utils",["require","exports","tslib","modules/core/uri","modules/clean/history","modules/core/notify","modules/core/i18n","spectrum-sharing/utils/sharing_constants","modules/clean/viewer"],(function(e,t,r,n,o,i,a,s,l){"use strict";function c(e){var t=e._mount_access_perms;return null!=t&&!t.includes("can_view")}function d(e){var t=e.getPath();try{t=decodeURIComponent(t)}catch(e){}o.default.push_state(n.URI.encode_parts(t),e.getQuery())}function u(e,t){void 0===t&&(t=!1);var r=n.URI.parse(e);"lst"in o.default.get_uri().getQuery()&&r.updateQuery({lst:""}),t&&r.updateQuery({subfolder_nav_tracking:"1"}),d(r)}function p(e){return e.rlkey?e.subPath.startsWith("/")?e.subPath:"/"+e.subPath:e.secureHash}function f(e){return l.Viewer.get_viewer().is_signed_in?a.intl.formatMessage({id:"dbYCaa",defaultMessage:"{folder_name} - Dropbox"},{folder_name:e}):a.intl.formatMessage({id:"3J1lxt",defaultMessage:"Dropbox - {folder_name} - Simplify your life"},{folder_name:e})}function m(e,t,n,o){if(void 0===n&&(n=0),void 0===o&&(o=!1),!Array.isArray(t))return e||[];if(!t.length)return[];if(!Array.isArray(e))return t;var i=r.__spreadArrays(e);return i.splice.apply(i,r.__spreadArrays([n,t.length],t)),o?i.slice(0,n+t.length):i}Object.defineProperty(t,"__esModule",{value:!0}),t.mergeFolderEntries=t.mergeListChunk=t.setPageTitle=t.generatePageTitle=t.shouldUpdateFolderHierarchy=t.getSecureHashOrSubPath=t.getFolderShareTokenWithRlkey=t.getFolderShareTokenFromLocation=t.removeRlkeyFromURL=t.disableListMode=t.enableListMode=t.openFolder=t.navigateToFolderHref=t.isNoAccessFolder=void 0,o=r.__importDefault(o),t.isNoAccessFolder=c,t.navigateToFolderHref=u,t.openFolder=function(e){c(e)?i.Notify.error(a.intl.formatMessage({id:"IzGklK",defaultMessage:"Can’t open {folder_name}. Ask your admin for access."},{folder_name:e.filename})):u(e.href,!0)},t.enableListMode=function(){(function(e,t){var r={};r[e]=t;var n=o.default.get_uri();n.updateQuery(r),d(n)})("lst","")},t.disableListMode=function(){var e,t;e="lst",(t=o.default.get_uri()).removeQuery(e),d(t)},t.removeRlkeyFromURL=function(){o.default.remove_query_param("rlkey")},t.getFolderShareTokenFromLocation=function(e){var t=e.path,r=e.query,n="";r&&r.rlkey&&(n=r.rlkey.toString());var o=s.SharedLinkType.Shmodel;"/sh"===t.substr(0,3)?(o=s.SharedLinkType.Shmodel,t=t.substring(4,t.length)):"/scl/fo"===t.substr(0,7)&&(o=s.SharedLinkType.Content,t=t.substring(8,t.length));var i=t.split("/");return{linkKey:i[0],linkType:o,secureHash:i[1],subPath:i.slice(2).join("/"),rlkey:n}},t.getFolderShareTokenWithRlkey=function(e,t){return r.__assign(r.__assign({},e),{rlkey:t||e.rlkey})},t.getSecureHashOrSubPath=p,t.shouldUpdateFolderHierarchy=function(e,t,r){if(r.rlkey&&t.rlkey&&r.rlkey===t.rlkey)return!e[p(r)];var n=r.secureHash,o=r.subPath,i=t.secureHash,a=t.subPath;return!e[n]||o.startsWith(a)&&e[i].length>=e[n].length},t.generatePageTitle=f,t.setPageTitle=function(e){document.title=f(e)},t.mergeListChunk=m,t.mergeFolderEntries=m})),define("modules/clean/react/shared_link_folder/view_toggle",["require","exports","tslib","classnames","react","modules/clean/react/sprite","typescript/component_libraries/retrieval-components/src/view-mode-toggle/index"],(function(e,t,r,n,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FolderViewModeToggle=t.FolderViewToggleOption=void 0,n=r.__importDefault(n),o=r.__importDefault(o),t.FolderViewToggleOption=function(e){var t=e.icon,r=e.label,a=e.onClick;return o.default.createElement("button",{"aria-label":r,className:n.default({"sl-view-toggle-option":!0}),name:r,onClick:a,value:r},o.default.createElement(i.Sprite,{group:"web",name:t,alt:r}))},t.FolderViewModeToggle=o.default.memo((function(e){var t=e.className,r=e.currentViewMode,n=e.onViewModeChanged;return o.default.createElement(a.ViewModeToggle,{className:t,currentMode:r,onSelection:n})})),t.FolderViewModeToggle.displayName="FolderViewModeToggle"})),define("modules/clean/react/share_sync/actions",["require","exports","tslib","modules/clean/sharing/shared_content_link_mount_folder","modules/clean/sharing/ui_notifications_util","modules/core/i18n","modules/clean/viewer"],(function(e,t,r,n,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.syncToDropbox=void 0,n=r.__importStar(n),t.syncToDropbox=function(t,s,l,c,d,u,p){if(d&&u){var f=void 0;if("anonymous"!==s)f=a.Viewer.get_viewer().get_uid_by_role(s);f||(f=-1);var m={activeUserId:f,accessLevel:u.access_level,folderName:u.sync_folder_name,folderSize:u.sync_folder_size,nsId:t,role:s,previewUrl:null==u?void 0:u.sync_preview_url,outOfQuotaQP:null==u?void 0:u.sync_out_of_quota_qp,clickOutToClose:!0,fromLinkAccess:d,encryptionOptions:c,rlkey:p};new Promise((function(t,r){e(["modules/clean/sharing/shared_content_link_sync_modal"],t,r)})).then(r.__importStar).then((function(e){e.showSharedContentLinkSyncModal(m)})).catch((function(){o.sharingNotificationError(i.intl.formatMessage({id:"WWCt7I",defaultMessage:"Something went wrong, please try again."}))}))}else n.mountSharedFolder(t,s,l,!0,!1,null,void 0,c,d,p)}})),define("modules/clean/react/share_sync/button",["require","exports","tslib","react","modules/clean/filepath/filepath","modules/clean/react/share_sync/models","spectrum-sharing/utils/sharing_constants","spectrum-sharing/utils/sharing_constants","modules/clean/sharing/views/sync_coachmark","modules/clean/viewer","modules/core/i18n","modules/constants/payments","modules/clean/analytics","dig-components/buttons","dig-components/menu"],(function(e,t,r,n,o,i,a,s,l,c,d,u,p,f,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShareSyncButton=void 0,n=r.__importDefault(n),o=r.__importStar(o),a=r.__importStar(a),u=r.__importStar(u);var h=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props.options.map((function(e){return n.default.createElement(m.Menu.ActionItem,{value:e,key:e.text,disabled:e.isDisabled},e.text)}));return n.default.createElement(m.Menu.Wrapper,{onSelection:function(e){return e.handler()}},(function(o){var i=o.getTriggerProps,a=o.getContentProps;return n.default.createElement(n.default.Fragment,null,n.default.createElement(f.Button,r.__assign({},i(),{variant:"primary"}),e.props.targetText),n.default.createElement(m.Menu.Content,r.__assign({},a()),n.default.createElement(m.Menu.Segment,null,t)))}))},t.displayName="SyncOptionsDropdown",t})(n.default.Component),_=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.logShareFolderPreviewUpgradeBtn=function(e){p.GrowthEventsLogger.log("wb_nq_pre_fo_up_b",{action:e,button_text:"Upgrade to Add Folder",destination_url:"http://www.dropbox.com/low-space",location:"top",quota_status:"near",upsell_type:"button"})},t.handleUpgradeButtonClick=function(){t.logShareFolderPreviewUpgradeBtn("click"),t.logToTiburon("OUT_OF_QUOTA_UPGRADE_BUTTON_CLICK")},t}return r.__extends(t,e),t.prototype.componentDidUpdate=function(e){this.props.outOfQuota&&!this.props.shareToken.subPath&&e.shareToken.subPath&&this.logToTiburon("OUT_OF_QUOTA_UPGRADE_BUTTON_RENDER")},t.prototype.componentDidMount=function(){this.props.outOfQuota&&(this.logShareFolderPreviewUpgradeBtn("view"),this.logToTiburon("OUT_OF_QUOTA_UPGRADE_BUTTON_RENDER"))},t.prototype.logToTiburon=function(e){p.ShareTibEventLogger.log(this.props.user.id,e,s.SHARE_ACTION_ORIGIN_TYPE.PREVIEW_PAGE,{rlkey:this.props.shareToken.rlkey,ns_id:this.props.folder.shared_folder_id})},t.prototype.onClickedOption=function(e,t){e.preventDefault(),t.handler()},t.prototype.getSyncOptions=function(){var e=this,t=this.props.sharePermission.canSyncToDropboxRoles,r=c.Viewer.get_viewer(),n=t.map((function(t){var n=e.props.sharePermission.isEditFolderLink?e.props.sharePermission.syncVarsByRoles[t]:void 0;return i.ShareSyncActionOption.buildOption(e.props.folder,r,t,a.SHARE_ACTION_ORIGIN_TYPE.PREVIEW_PAGE,e.props.folderPreviewSession,e.props.shareToken.linkType,e.props.encryptionOptions,e.props.sharePermission.isEditFolderLink,e.props.shareToken.rlkey,n)}));return 0!==r.get_users(!0).length||this.props.sharePermission.isEditFolderLink||n.push(i.ShareSyncActionOption.buildOption(this.props.folder,null,"anonymous",a.SHARE_ACTION_ORIGIN_TYPE.PREVIEW_PAGE,this.props.folderPreviewSession,this.props.shareToken.linkType,this.props.encryptionOptions,this.props.sharePermission.isEditFolderLink,this.props.shareToken.rlkey)),n},t.prototype.renderSyncCoachmark=function(){var e=this.props.sharePermission.canSyncToDropboxRoles.length>0;return this.props.showSyncCoachmark&&e?n.default.createElement("div",{className:"sync-button__coachmark-container"},n.default.createElement(l.SharingSyncCoachmark,null)):null},t.prototype.renderSyncButton=function(){var e,t=this;if(""!==this.props.shareToken.subPath)return null;var r="control__button sync-button";if(this.props.outOfQuota){var i=u.OUT_OF_SPACE_URL+"?oqa=wb_oq_pre_fo_up_b";return n.default.createElement("a",{className:r,href:i,onClick:this.handleUpgradeButtonClick},d.intl.formatMessage({id:"JhDJcU",defaultMessage:"Upgrade to Add Folder"}))}var a=void 0,s=this.getSyncOptions();if((null===(e=this.props.user)||void 0===e?void 0:e.is_cdm_member)&&1===s.length){var l=o.filename(this.props.user.cdm_tmf_path);a=l.length>25?d.intl.formatMessage({id:"6m85k6",defaultMessage:"Add to my member folder"}):d.intl.formatMessage({id:"nzqkZQ",defaultMessage:"Add to {cdm_tmf_name} folder"},{cdm_tmf_name:l})}else a=d.intl.formatMessage({id:"N8ovVA",defaultMessage:"Add to Dropbox"});if(1===s.length)return n.default.createElement(f.Button,{className:r,variant:"primary",style:{display:"-webkit-box"},onClick:function(e){return t.onClickedOption(e,s[0])}},a);if(s.length>1){var c=a+" ▾";return n.default.createElement(h,{targetText:c,folder:this.props.folder,shareToken:this.props.shareToken,options:s})}return null},t.prototype.render=function(){return n.default.createElement("div",null,this.renderSyncCoachmark(),this.renderSyncButton())},t.displayName="ShareSyncButton",t})(n.default.Component);t.ShareSyncButton=_})),define("modules/clean/react/share_sync/models",["require","exports","tslib","immutable","react","modules/clean/filepath/filepath","modules/clean/react/share_sync/actions","modules/core/i18n","modules/clean/loggers/folder_preview_logger","modules/clean/react/file_viewer/constants","spectrum-sharing/utils/sharing_constants","modules/clean/analytics","modules/core/browser"],(function(e,t,r,n,o,i,a,s,l,c,d,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShareSyncActionOption=void 0,n=r.__importStar(n),o=r.__importDefault(o),i=r.__importStar(i),a=r.__importStar(a),p=r.__importStar(p);var f={text:void 0,handler:void 0,isDisabled:!1,spriteName:void 0},m=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.buildOption=function(e,r,n,f,m,h,_,g,v,y){var b,w=s.intl.formatMessage({id:"nlZiMz",defaultMessage:"Add to my Dropbox"}),S="dropbox";if(null!==r&&null!==n&&(b=r.get_user_by_role(n)),b&&b.is_cdm_member){var E=i.filename(b.cdm_tmf_path);w=E.length>12?s.intl.formatMessage({id:"6m85k6",defaultMessage:"Add to my member folder"}):s.intl.formatMessage({id:"ck1w+U",defaultMessage:"Add to <strong>{cdm_tmf_name}</strong> folder"},{cdm_tmf_name:E,strong:function(e){return o.default.createElement("strong",null,e)}}),(null==r?void 0:r.is_paired)&&(S="s_briefcase")}else if(null==r?void 0:r.is_paired)switch(n){case"personal":w=s.intl.formatMessage({id:"temGiX",defaultMessage:"Add to personal Dropbox"}),S="s_house";break;case"work":w=s.intl.formatMessage({id:"m4EGX2",defaultMessage:"Add to {team_name} Dropbox"},{team_name:r.team_name}),S="s_briefcase"}return new t({text:w,handler:function(){h===d.SharedLinkType.Shmodel&&l.logEvent(c.UserAction.AddToDropbox,m),b?u.ShareTibEventLogger.log(b.id,"ADD_TO_DROPBOX",d.SHARE_ACTION_ORIGIN_TYPE.PREVIEW_PAGE,{ns_id:e.shared_folder_id,rlkey:v}):u.ShareTibEventLogger.log_unauth("ADD_TO_DROPBOX",d.SHARE_ACTION_ORIGIN_TYPE.PREVIEW_PAGE,{ns_id:e.shared_folder_id,rlkey:v,scl_url:p.get_uri().toString()}),a.syncToDropbox(e.shared_folder_id,n,f,_,g,y,v)},spriteName:S})},t})(n.Record(f));t.ShareSyncActionOption=m})),define("modules/clean/auth/multi_account_login_modal",["require","exports","tslib","react","modules/clean/auth/login/form","modules/clean/react/components/modal","modules/clean/viewer","modules/core/assert","modules/core/i18n","spectrum/modal/index"],(function(e,t,r,n,o,i,a,s,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TestOnlyMultiAccountLoginModal=t.TestOnlyAssumePersonalLockedModal=t.MultiAccountLoginModal=void 0;var d=(function(e){function t(t){var r=e.call(this,t)||this;return r.getUser=function(){var e,t=r.props,n=t.user,o=t.userId,i=t.role;return null!=n?e=n:null!=o?e=r.viewer.get_user_by_id(o,!0):null!=i&&(e=r.viewer.get_user_by_role(i,!0)),e},r.onLoginSuccess=function(e){r.viewer._sign_in_all_users(),r.props.onAuthenticateSuccess&&!r.props.continuationUrl&&r.props.onAuthenticateSuccess(),r.closeModal()},r.closeModal=function(e){e&&e.stopPropagation(),r.props.onCancel&&r.props.onCancel(),i.Modal.close()},s.assert(null!==t.onAuthenticateSuccess&&void 0!==t.onAuthenticateSuccess||null!==t.continuationUrl&&void 0!==t.continuationUrl,"onAuthenticateSuccess and continuationUrl are mutually exclusive"),r.viewer=a.Viewer.get_viewer(),r}return r.__extends(t,e),t.prototype.render=function(){if(this.viewer.is_team_assume_user_session)return n.default.createElement(p,{displayName:this.viewer.display_name,onRequestClose:this.closeModal,open:!0,teamName:this.viewer.team_name});var e=this.getUser();return s.assert(null!=e,"invalid user"),s.assert(!this.viewer.is_user_signed_in(e),"called multi-account login for a user that's already signed in"),n.default.createElement(u,{onRequestClose:this.closeModal,onAuthenticateSuccess:this.onLoginSuccess,open:!0,continuationUrl:this.props.continuationUrl,teamName:this.viewer.team_name||"",user:e,encryptionOptions:this.props.encryptionOptions})},t.displayName="MultiAccountLoginModal",t})((n=r.__importDefault(n)).default.PureComponent);t.MultiAccountLoginModal=d;var u=function(e){var t=e.user.role;if(!t)return null;var r="personal"===t?l.intl.formatMessage({id:"DCfdq9",defaultMessage:"Sign in to your personal Dropbox"}):l.intl.formatMessage({id:"L5lWSy",defaultMessage:"Sign in to your {team_name} Dropbox"},{team_name:e.teamName});return n.default.createElement(c.Modal,{appElement:document.body,ariaLabel:l.intl.formatMessage({id:"lggZdA",defaultMessage:"Multi-account login modal"}),bodyClassName:"multiaccount-login-modal",bodyId:"multiaccount-login-modal",className:"mc-util-modal",displayCloseButton:!0,onRequestClose:e.onRequestClose,open:e.open,overlayClassName:"file-viewer-modal-overlay"},n.default.createElement("div",{className:"mc-util-modal-header"},r),n.default.createElement("div",{className:"mc-util-modal-body"},n.default.createElement(o.LoginForm,{canRedirect:!!e.continuationUrl,continuationUrl:e.continuationUrl||void 0,emailProps:{initialValue:e.user.email,readonly:!0},googleLoginProps:{positionBelow:!1},maestroStyle:!0,onLoginSuccess:e.onAuthenticateSuccess,rememberMeCheckboxProps:{checked:!0},type:"multi",encryptionOptions:e.encryptionOptions})))};t.TestOnlyMultiAccountLoginModal=u;var p=function(e){var t=e.displayName,r=e.onRequestClose,o=e.teamName;return n.default.createElement(c.UtilityModal,{appElement:document.body,ariaLabel:l.intl.formatMessage({id:"XTU3gF",defaultMessage:"Personal account locked modal"}),className:"team-assume-user-modal",displayCloseButton:!0,onRequestClose:r,open:e.open,primaryAction:l.intl.formatMessage({id:"u/p3Pl",defaultMessage:"Close"}),title:l.intl.formatMessage({id:"YcDQxL",defaultMessage:"Personal account not accessible"})},n.default.createElement("div",null,l.intl.formatMessage({id:"9uHtUs",defaultMessage:"{display_name}’s personal account isn’t managed by the {team_name} team, so its contents aren’t accessible to admins."},{display_name:t,team_name:o})))};t.TestOnlyAssumePersonalLockedModal=p})),define("modules/clean/sharing/shared_content_link_mount_folder",["require","exports","tslib","react","modules/clean/browse_interface","modules/clean/react/components/modal","modules/clean/auth/multi_account_login_modal","modules/clean/sharing/api/client","api_v2/user_client","modules/clean/sharing/ui_notifications_util","modules/clean/viewer","modules/core/browser","modules/core/assert","modules/core/i18n","modules/clean/flux/dispatcher","modules/clean/sharing/share_page/action_types","modules/clean/auth/login_or_register/types","modules/clean/auth/login_or_register/modal","modules/clean/sharing/ui_util","spectrum-sharing/utils/sharing_constants","modules/clean/analytics","modules/clean/sharing/access_level"],(function(e,t,r,n,o,i,a,s,l,c,d,u,p,f,m,h,_,g,v,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mountSharedFolder=void 0,n=r.__importDefault(n),o=r.__importStar(o),u=r.__importStar(u),t.mountSharedFolder=function e(t,r,S,E,M,k,T,P,A,F){void 0===M&&(M=!1),void 0===k&&(k=null);var C,O=d.Viewer.get_viewer();if("anonymous"!==r){if(r&&(O.is_role_signed_in(r)||i.Modal.showInstance(n.default.createElement(a.MultiAccountLoginModal,{role:r,onAuthenticateSuccess:function(){e(t,r,S,E,!1,null,T)}}))),r){var D=O.get_uid_by_role(r);p.assert(!!D,"selected role should have corresponding uid"),C=D||-1}else p.assert(!O.is_paired,"role can not be unspecified for paired viewer"),C=O.get_user_ids()[0];var x=f.intl.formatMessage({id:"Zd8jt8",defaultMessage:"Adding to your Dropbox..."});O.is_paired&&(x=O.get_user_by_id(C).is_team?f.intl.formatMessage({id:"PTGTT4",defaultMessage:"Adding to your {team_name} Dropbox..."},{team_name:O.team_name}):f.intl.formatMessage({id:"IVdsoO",defaultMessage:"Adding to your personal Dropbox..."})),c.sharingNotificationInProgress(x,!1);var N=new s.FolderShareApiClient({userId:C,client:new l.UserApiV2Client});m.Dispatcher.dispatch({type:h.SharePageActionTypes.MOUNT_FOLDER_REQUEST,metadata:T,user:O.get_user_by_id(C),shared_folder_id:t}),(function(e){return e?N.addMembers({accessLevel:w.ACCESS_LEVEL.WRITER,contentId:t,members:[{".tag":"email",email:O.get_email_by_role(r)}],quiet:!0}):Promise.resolve()})(A).then((function(){N.mount({contentId:t}).then((function(e){(function(e){if(e){var n=e;(null==k?void 0:k.ns_path)&&(n+=k.ns_path);var i=O.get_user_by_id(C),a=o.browse_uri_for_fq_path(i,n),s=M?"1":"0";a.updateQuery({from_scl_sync_modal:s});var l={role:r,file_id:k?k.file_id:null,ns_id:k?k.ns_id:t};b.ShareTibEventLogger.log(C,"BROWSE_SUCCESS",y.SHARE_ACTION_ORIGIN_TYPE.SYNC_MODAL,l),u.redirect(a.toString())}})(e.path_lower)})).catch((function(e){var r=e&&e.error&&e.error[".tag"],n=y.SHARE_ACTION_ORIGIN_TYPE.PREVIEW_PAGE;b.ShareTibEventLogger.log(C,"ADD_TO_DROPBOX_MOUNT_ERROR",n,{ns_id:t,rlkey:F,error_tag:r}),e&&e.error&&"insufficient_quota"===e.error[".tag"]?c.sharingNotificationError(f.intl.formatMessage({id:"jENkzW",defaultMessage:"Can’t add folder. Your Dropbox account is full."})):v.isTotalMountsExceededError(e)?c.sharingNotificationError(v.getTotalMountsExceededMsg()):v.isTreeSizeExceededError(e)?c.sharingNotificationError(v.getTreeSizeExceededMsg()):v.isHomeMountsExceededError(e)?c.sharingNotificationError(v.getHomeMountsExceededMsg()):c.sharingNotificationError(f.intl.formatMessage({id:"EQfnGr",defaultMessage:"We were unable to complete your request."}))}))})).catch((function(e){var r=e&&e.error&&e.error[".tag"],n=y.SHARE_ACTION_ORIGIN_TYPE.PREVIEW_PAGE;b.ShareTibEventLogger.log(C,"ADD_TO_DROPBOX_ADD_MEMBER_ERROR",n,{ns_id:t,rlkey:F,error_tag:r}),c.sharingNotificationError(f.intl.formatMessage({id:"EQfnGr",defaultMessage:"We were unable to complete your request."}))}))}else{i.Modal.showInstance(n.default.createElement(g.LoginOrRegisterModal,{downloadAction:_.DownloadAction.SAVE_TO_DROPBOX,id:"shared-link-immediate-signup-modal",initialMode:_.Mode.REGISTER,kind:_.LoginOrRegisterKind.DOWNLOAD,onAuthenticateSuccess:function(e){return u.reload},onCancel:u.reload,signup_tag:"shmodel_modal_register",encryptionOptions:P}))}}})),define("spectrum/backdrop/index",["require","exports","tslib","spectrum/backdrop/backdrop"],(function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r.__exportStar(n,t)})),define("spectrum/backdrop/backdrop",["require","exports","tslib","classnames","react"],(function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Backdrop=void 0,n=r.__importDefault(n),o=r.__importStar(o),t.Backdrop=function(e){var t=e.className,i=e.isVisible,a=r.__rest(e,["className","isVisible"]);return i?o.createElement("div",Object.assign({className:n.default("mc-backdrop",t)},a)):null},t.Backdrop.displayName="Backdrop"})),define("spectrum/mobile_menu/mobile_menu",["require","exports","tslib","react","classnames","focus-trap-react","spectrum/backdrop/index","spectrum/mobile_menu/mobile_menu_content","spectrum/mobile_menu/mobile_menu_close_button","spectrum/portal/index","spectrum/scroll_locker/index"],(function(e,t,r,n,o,i,a,s,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MobileMenu=void 0,n=r.__importStar(n),o=r.__importDefault(o),i=r.__importDefault(i);var u=(function(e){function t(){var t=e.apply(this,arguments)||this;return t.initBodyPadding="0",t.state={isVisible:!1},t.openMobileMenu=function(){t.initBodyPadding=d.getBodyPadding(),t.setState({isVisible:!0},d.lockScroll)},t.closeMobileMenu=function(){t.setState({isVisible:!1},(function(){return d.unlockScroll(t.initBodyPadding)}))},t.handleKeyDown=function(e){var r=e.key;if("Escape"!==r){var n=e.target;if("ArrowUp"===r||"ArrowLeft"===r){var o=n.previousElementSibling;o&&o.focus()}if("ArrowDown"===r||"ArrowRight"===r){var i=n.nextElementSibling;i&&i.focus()}}else t.closeMobileMenu()},t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.children,d=e.className,u=e.closeButton,p=e.trigger,f=r.__rest(e,["children","className","closeButton","trigger"]);return n.createElement("div",Object.assign({className:o.default("mc-mobile-menu",d)},f),p({openMobileMenu:this.openMobileMenu}),this.state.isVisible?n.createElement(c.Portal,{isShowInitially:!0},n.createElement("div",{className:"mc-mobile-menu-container",onKeyDown:this.handleKeyDown},n.createElement(i.default,{focusTrapOptions:{returnFocusOnDeactivate:!0}},n.createElement(a.Backdrop,{onClick:this.closeMobileMenu,isVisible:!0}),n.createElement(s.MobileMenuContent,{closeMobileMenu:this.closeMobileMenu},n.createElement("div",{className:"mc-mobile-menu-section"},t),n.createElement("div",{className:"mc-mobile-menu-section"},u?u({closeMobileMenu:this.closeMobileMenu}):n.createElement(l.MobileMenuCloseButton,null)))))):null)},t})(n.Component);t.MobileMenu=u})),define("spectrum/mobile_menu/mobile_menu_close_button",["require","exports","tslib","react","spectrum/mobile_menu/mobile_menu_item"],(function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MobileMenuCloseButton=void 0,n=r.__importStar(n),t.MobileMenuCloseButton=function(){return n.createElement(o.MobileMenuItem,{className:"mc-mobile-menu-close-button",shouldCloseMenuOnSelect:!0},"Close")},t.MobileMenuCloseButton.displayName="MobileMenuCloseButton"})),define("spectrum/mobile_menu/mobile_menu_content",["require","exports","tslib","react","classnames","prop-types"],(function(e,t,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MobileMenuContent=void 0,n=r.__importStar(n),o=r.__importDefault(o),i=r.__importDefault(i);var a=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.getChildContext=function(){return{closeMobileMenu:this.props.closeMobileMenu}},t.prototype.render=function(){var e=this.props,t=e.className,i=e.children,a=(e.closeMobileMenu,r.__rest(e,["className","children","closeMobileMenu"]));return n.createElement("div",Object.assign({className:o.default("mc-mobile-menu-content",t)},a),i)},t})(n.Component);t.MobileMenuContent=a,a.childContextTypes={closeMobileMenu:i.default.func}})),define("spectrum/mobile_menu/mobile_menu_item",["require","exports","tslib","react","classnames","prop-types","react-touch-events"],(function(e,t,r,n,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MobileMenuItem=void 0,n=r.__importStar(n),o=r.__importDefault(o),i=r.__importDefault(i),a=r.__importDefault(a);var s=(function(e){function t(){var t=e.apply(this,arguments)||this;return t.handleSelect=function(e){var r=t.props,n=r.shouldCloseMenuOnSelect,o=r.shouldPreventDefaultOnSelectItem,i=r.onSelect;n&&t.context.closeMobileMenu(),o&&e.preventDefault(),i&&i(e)},t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.className,i=(e.shouldCloseMenuOnSelect,e.children),s=(e.onSelect,e.shouldPreventDefaultOnSelectItem,r.__rest(e,["className","shouldCloseMenuOnSelect","children","onSelect","shouldPreventDefaultOnSelectItem"]));return n.createElement(a.default,{onTap:this.handleSelect},n.createElement("button",Object.assign({},s,{className:o.default("mc-mobile-menu-item",t),onClick:this.handleSelect}),i))},t})(n.Component);t.MobileMenuItem=s,s.contextTypes={closeMobileMenu:i.default.func},s.defaultProps={shouldCloseMenuOnSelect:!0,shouldPreventDefaultOnSelectItem:!0}})),define("modules/clean/sharing/views/sync_coachmark",["require","exports","tslib","react","modules/clean/deprecated_ajax/ajax_jquery","modules/clean/react/bubble","modules/clean/react/components/css","modules/clean/react/image","modules/clean/static_urls","modules/core/i18n"],(function(e,t,r,n,o,i,a,s,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingSyncCoachmark=void 0,n=r.__importDefault(n),o=r.__importStar(o),i=r.__importDefault(i);var d=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={show:!0},t.hideSyncCoachmark=function(){t.setState({show:!1})},t}return r.__extends(t,e),t.prototype.componentWillMount=function(){o.BackgroundRequest({url:"/sharing/seen_sync_coachmark"})},t.prototype.render=function(){return this.state.show?n.default.createElement(i.default,{arrow:i.default.ARROW.TOP_LEFT,className:"sync-coachmark u-pad-s"},n.default.createElement(s.Image,{className:"u-l-ib",src:l.static_url("/static/images/sharing/sync_coachmark-vflvg8Oy0.png"),srcHiRes:l.static_url("/static/images/sharing/sync_coachmark@2x-vflhX3Mhx.png")}),n.default.createElement("div",{className:"u-l-ib u-pad-left-s sync-coachmark__content"},n.default.createElement("h2",null,c.intl.formatMessage({id:"utNf/m",defaultMessage:"Stay in sync"})),n.default.createElement("p",null,c.intl.formatMessage({id:"SIGEzu",defaultMessage:"For easy access to this folder in the future, add it to your Dropbox."})),n.default.createElement("button",{className:"c-btn c-btn--secondary",onClick:this.hideSyncCoachmark},c.intl.formatMessage({id:"W4An+g",defaultMessage:"Got it"})))):n.default.createElement("div",null)},t.displayName="SharingSyncCoachmark",t})(n.default.Component);t.SharingSyncCoachmark=a.requireCssWithComponent(d,["/static/css/sharing/sync_coachmark-vflHD6MS5.css"])})),define("modules/clean/react/welcome_modal",["require","exports","tslib","react","modules/clean/growth/experiments/logger","modules/clean/react/components/css","modules/clean/react/image","modules/clean/react/components/modal","modules/clean/static_urls","modules/core/browser","modules/core/i18n","spectrum/button/index","spectrum/modal/index"],(function(e,t,r,n,o,i,a,s,l,c,d,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WelcomeModal=t.TestOnlyWelcomeModal=void 0,n=r.__importStar(n),o=r.__importDefault(o),c=r.__importStar(c);var f=function(e){var t=function(e){e&&e.stopPropagation(),s.Modal.close(),c.reload()};return n.createElement(p.Modal,{appElement:document.body,ariaLabel:"Welcome to Dropbox modal",bodyClassName:"welcome-modal-body",bodyId:e.id||"welcome-modal",className:"welcome-modal",displayCloseButton:!0,onRequestClose:t,open:!0,overlayClassName:"file-viewer-modal-overlay"},n.createElement("div",{className:"welcome-modal-illo"},n.createElement(a.Image,{src:l.static_url("/static/images/growth/dropbox_files-vfl7phztL.png"),srcHiRes:l.static_url("/static/images/growth/dropbox_files@2x-vflABjXqu.png")})),n.createElement("h1",{className:"welcome-modal-title"},d.intl.formatMessage({id:"qoqdPt",defaultMessage:"Welcome to Dropbox!"})),n.createElement("div",{className:"welcome-modal-text"},d.intl.formatMessage({id:"LgDSr+",defaultMessage:"Now it’s easy to securely back up your files and photos, access them from any device, and share them with others."})),n.createElement(u.Button,{className:"go-to-dropbox-button",fullWidth:!0,href:e.redirect_url||"/home",onClick:function(){o.default.log("sharing","shared_link_welcome_modal_button_click")},tagName:"a",variant:"primary"},d.intl.formatMessage({id:"Dkf+Pc",defaultMessage:"Go to my Dropbox"})),n.createElement("div",{className:"welcome-modal-no-thanks"},n.createElement(u.Button,{className:"button-as-link",fullWidth:!0,onClick:t,variant:"styleless"},d.intl.formatMessage({id:"ZZs8no",defaultMessage:"No thanks, stay on this page"}))))};t.TestOnlyWelcomeModal=f;var m=i.requireCssWithComponent(f,["/static/css/welcome_modal-vfl8PUD8a.css"]);t.WelcomeModal=m})),define("modules/clean/auth/login_or_register/modal",["require","exports","tslib","react","classnames","lodash","modules/clean/auth/login_or_register/logging_util","modules/clean/auth/login/form","modules/clean/auth/login_or_register/types","modules/clean/auth/register/form","modules/clean/auth/register/types","modules/clean/growth/experiments/logger","dig-components/typography","modules/clean/react/comments2/data/logger","modules/clean/react/components/css","modules/clean/react/components/modal","modules/clean/react/welcome_modal","modules/core/browser","modules/core/assert","modules/core/i18n","modules/core/notify","spectrum/button/index","spectrum/modal/index","modules/clean/react/maestro_nav/shared_code/dropbox_logo","react-intl"],(function(e,t,r,n,o,i,a,s,l,c,d,u,p,f,m,h,_,g,v,y,b,w,S,E,M){"use strict";var k;Object.defineProperty(t,"__esModule",{value:!0}),t.LoginOrRegisterModal=t.TestOnlyLoginOrRegisterModal=t.TestOnlyCommentsHeader=t.TestOnlyCommentTextVariantCssClass=t.PIINotificationText=t.ExperimentalToggleMessage=t.DefaultHeaderContent=void 0,n=r.__importDefault(n),o=r.__importDefault(o),u=r.__importDefault(u),f=r.__importStar(f),g=r.__importStar(g);var T=((k={})[l.CommentTextVariant.DEFAULT]="default-variant",k[l.CommentTextVariant.POST]="post-comment-variant",k[l.CommentTextVariant.SUBSCRIBE]="subscribe-variant",k);t.TestOnlyCommentTextVariantCssClass=T,t.DefaultHeaderContent=function(e){var t=e.mode;return n.default.createElement("div",{className:"modal-header"},n.default.createElement(E.DropboxLogo,{className:"modal-header__dropbox-logo"}),n.default.createElement("span",null,y.intl.formatMessage(t===l.Mode.LOGIN?M.defineMessage({id:"nOuyMw",defaultMessage:"Save it for later in your Dropbox account"}):M.defineMessage({id:"eUpi8/",defaultMessage:"Save it for later in Dropbox"}))))},t.ExperimentalToggleMessage=function(e){var t=e.mode,r=e.onHeaderLinkClick,o=t===l.Mode.LOGIN?M.defineMessage({id:"vHTAAQ",defaultMessage:"Sign in or <a>create an account</a>"}):M.defineMessage({id:"+OG7LA",defaultMessage:"Sign up or <a>sign in to your account</a>"});return n.default.createElement(n.default.Fragment,null,y.intl.formatMessage(o,{a:function(e){return n.default.createElement(w.Button,{className:"button-as-link toggle-form-link",onClick:r,variant:"styleless"},e)}}))};var P=function(e){var t,r=e.className,o=e.commentTextVariant,i=e.mode;switch(o){case l.CommentTextVariant.POST:t=i===l.Mode.LOGIN?y.intl.formatMessage({id:"KXgMVH",defaultMessage:"To post your comment, sign in to Dropbox."}):y.intl.formatMessage({id:"LakyAx",defaultMessage:"To post your comment, create a free Dropbox account."});break;case l.CommentTextVariant.SUBSCRIBE:t=i===l.Mode.LOGIN?y.intl.formatMessage({id:"oHZbXS",defaultMessage:"To subscribe to this file, sign in to Dropbox."}):y.intl.formatMessage({id:"fy/9XT",defaultMessage:"To subscribe to this file, create a free Dropbox account."});break;default:t=i===l.Mode.LOGIN?y.intl.formatMessage({id:"3qW+D4",defaultMessage:"To continue, sign in to Dropbox."}):y.intl.formatMessage({id:"uMjLqH",defaultMessage:"To continue, create a free Dropbox account."})}return n.default.createElement("div",{className:"text-variant "+r},t)};t.TestOnlyCommentsHeader=P,t.PIINotificationText=function(){return n.default.createElement(p.Text,{variant:"label",size:"xsmall",tagName:"p",color:"faint",className:"pii-notification"},y.intl.formatMessage(M.defineMessage({id:"KgnCKc",defaultMessage:"People with access to this folder will see your name, email, and folder activity."})))};var A=(function(e){function p(r){var o=e.call(this,r)||this;return o.logWebActivityOnce=i.once((function(){return a.logModalMiscActivity(o.props.kind,o.props.downloadAction)})),o.renderHeader=function(){if(o.state.isThirdPartyRegistrationContinuation)return n.default.createElement("div",{className:"mc-util-modal-header center"},n.default.createElement("h1",null,y.intl.formatMessage({id:"Ft3ikL",defaultMessage:"Create account and continue"})));var e=o.props,r=e.commentParams,i=e.customHeaderContent,a=e.kind;if(i){var s=i;return n.default.createElement(s,{mode:o.state.mode,changeMode:o.toggleMode})}return n.default.createElement("div",{className:"mc-util-modal-header center"},a===l.LoginOrRegisterKind.COMMENT?n.default.createElement(P,{className:T[r.variant],commentTextVariant:r.variant,mode:o.state.mode}):n.default.createElement(t.DefaultHeaderContent,{mode:o.state.mode}))},o.renderFooter=function(){var e=o.props.customFooterContent;if(e){var t=e;return n.default.createElement(t,null)}return null},o.toggleMode=function(e){e.preventDefault(),o.setState((function(e){if(o.props.kind===l.LoginOrRegisterKind.COMMENT){var t=e.mode===l.Mode.LOGIN?"sign_up_modal_toggle_to_sign_up":"sign_up_modal_toggle_to_sign_in";f.logEvent(t,{stream:o.props.commentParams.stream})}return{mode:e.mode===l.Mode.LOGIN?l.Mode.REGISTER:l.Mode.LOGIN}}),(function(){return a.logAuthIntent(o.state.mode)}))},o.onAuthenticateSuccess=function(e,t){var r=o.state.mode,i=o.props,a=i.downloadAction,s=i.kind;if(r===l.Mode.LOGIN?b.Notify.success(y.intl.formatMessage({id:"Ye/4Vz",defaultMessage:"Successfully signed in to Dropbox"})):b.Notify.success(y.intl.formatMessage({id:"4wqmq+",defaultMessage:"Successfully signed up for Dropbox"})),o.props.kind===l.LoginOrRegisterKind.COMMENT){var c=r===l.Mode.LOGIN?"sign_up_modal_sign_in_success":"sign_up_modal_sign_up_success";f.logEvent(c,{stream:o.props.commentParams.stream})}var d=t&&o.shouldRedirectToTeamDiscoveryPage(t);if(d)return g.redirect(d);if(o.props.onAuthenticateSuccess&&o.props.onAuthenticateSuccess(e),s===l.LoginOrRegisterKind.IMMEDIATE||s===l.LoginOrRegisterKind.SIDEBAR||a===l.DownloadAction.DIRECT_DOWNLOAD)if(r===l.Mode.REGISTER){if(t&&t.force_redirect_url&&t.redirect_url)return g.redirect(t.redirect_url);u.default.log("sharing","shared_link_welcome_modal_view"),h.Modal.showInstance(n.default.createElement(_.WelcomeModal,{id:"shared-link-welcome-modal"}))}else r===l.Mode.LOGIN&&g.reload();else o.closeModal()},o.onCancel=function(e){var t;e&&e.stopPropagation(),a.logModalDismissed(o.state.mode,null!==(t=o.props.kind)&&void 0!==t?t:void 0),o.props.onCancel&&o.props.onCancel(),o.closeModal()},o.closeModal=function(e){e&&e.stopPropagation(),h.Modal.close()},o.state={mode:r.initialMode||l.Mode.LOGIN,isThirdPartyRegistrationContinuation:!1},v.assert(!(r.kind===l.LoginOrRegisterKind.COMMENT&&!r.commentParams),"Comment parameters must be provided if calling this modal from comments code"),o}return r.__extends(p,e),p.prototype.componentDidMount=function(){var e;a.logAuthIntent(this.state.mode),a.logModalShown(this.state.mode,null!==(e=this.props.kind)&&void 0!==e?e:void 0),this.logWebActivityOnce()},p.prototype.render=function(){var e,i=this,a=this.state.mode,u=this.props,p=u.id,f=u.signup_tag,m=u.showGoogleRegistration,h=u.showPIINotification,_=u.googleRegisterProps,v=u.customHeaderContent,y=u.customFooterContent,b=u.loginContinuationUrl;return n.default.createElement(S.Modal,{ariaLabel:"Login or register modal",appElement:document.body,bodyId:p,className:o.default("mc-util-modal mc-util-modal-regular login-or-register-modal","conversion-experiment"),displayCloseButton:!0,onRequestClose:this.onCancel,open:!0,overlayClassName:null!==(e=this.props.modalOverlayClassName)&&void 0!==e?e:"file-viewer-modal-overlay",width:400},this.renderHeader(),n.default.createElement("div",{className:"mc-util-modal-body"},!v&&n.default.createElement(t.ExperimentalToggleMessage,{mode:this.state.mode,onHeaderLinkClick:this.toggleMode}),a===l.Mode.LOGIN&&n.default.createElement(s.LoginForm,{canRedirect:!1,continuationUrl:b||g.get_href(),className:"login-form-wrapper",googleLoginProps:{positionBelow:!0,signupTag:f},appleLoginProps:{positionBelow:!0},onLoginSuccess:this.onAuthenticateSuccess,rememberMeCheckboxProps:{checked:!0},encryptionOptions:this.props.encryptionOptions}),a===l.Mode.REGISTER&&n.default.createElement(c.RegisterForm,{additionalParams:f?{signup_tag:f}:void 0,canRedirect:!1,className:"register-form-wrapper",onRegisterSuccess:this.onAuthenticateSuccess,tosCheckboxProps:{inline:!1},marketingOptInProps:{show:!!this.props.showMarketingOptIn,checked:!1},googleRegisterProps:m?r.__assign(r.__assign({},_||{}),{position:"BOTTOM"}):void 0,onRegisterFormEvent:function(e){e===d.RegisterFormEvent.GOOGLE_REGISTER_SUCCESS&&i.setState({isThirdPartyRegistrationContinuation:!0})}}),h&&n.default.createElement(t.PIINotificationText,null)),y&&this.renderFooter())},p.prototype.shouldRedirectToTeamDiscoveryPage=function(e){var t=this.state.mode;if(this.props.kind===l.LoginOrRegisterKind.SIDEBAR&&t===l.Mode.REGISTER&&e.force_redirect_url&&e.redirect_url&&e.redirect_url.indexOf("/team/discover/suggest")>-1)return e.redirect_url},p.defaultProps={showGoogleRegistration:!0},p.displayName="LoginOrRegisterModal",p})(n.default.PureComponent);t.TestOnlyLoginOrRegisterModal=A;var F=m.requireCssWithComponent(A,["/static/css/spectrum/index.web-vfliw9181.css","/static/css/components/login_or_register_modal-vflUe5qth.css","/static/css/legacy_packages/components-vfl9706n8.css","/static/css/components/button-vfllw60O5.css","/static/css/scooter/scooter-scoped-vflpl9JSl.css","/static/css/recaptcha_challenge-vflrcf67y.css","/static/css/recaptcha_v2_challenge-vflYEW-GO.css"]);t.LoginOrRegisterModal=F})),define("prod_assets_web_modules/react-touch-events",["./common/_commonjsHelpers","react"],(function(e,t){"use strict";var r,n,o=(function(e){return e&&e.__esModule?e:{default:e}})(t),i={exports:{}};return r=i,e.commonjsGlobal,n=function(e){return(function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.i=function(e){return e},r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=8)})([function(e,t,r){function n(e){return function(){return e}}var o=function(){};o.thatReturns=n,o.thatReturnsFalse=n(!1),o.thatReturnsTrue=n(!0),o.thatReturnsNull=n(null),o.thatReturnsThis=function(){return this},o.thatReturnsArgument=function(e){return e},e.exports=o},function(e,t,r){var n;n=function(e){if(void 0===e)throw new Error("invariant requires an error message argument")},e.exports=function(e,t,r,o,i,a,s,l){if(n(t),!e){var c;if(void 0===t)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var d=[r,o,i,a,s,l],u=0;(c=new Error(t.replace(/%s/g,(function(){return d[u++]})))).name="Invariant Violation"}throw c.framesToPop=1,c}}},function(e,t,r){var n,o=r(0);n=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=0,i="Warning: "+e.replace(/%s/g,(function(){return r[o++]}));"undefined"!=typeof console&&console.error(i);try{throw new Error(i)}catch(e){}},o=function(e,t){if(void 0===t)throw new Error("`warning(condition, format, ...args)` requires a warning message argument");if(0!==t.indexOf("Failed Composite propType: ")&&!e){for(var r=arguments.length,o=Array(r>2?r-2:0),i=2;i<r;i++)o[i-2]=arguments[i];n.apply(void 0,[t].concat(o))}},e.exports=o},function(e,t,r){e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t,r){var n="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103;e.exports=r(7)((function(e){return"object"==typeof e&&null!==e&&e.$$typeof===n}),!0)},function(t,r){t.exports=e},function(e,t,r){var n=r(1),o=r(2),i=r(3),a={};e.exports=function(e,t,r,s,l){for(var c in e)if(e.hasOwnProperty(c)){var d;try{n("function"==typeof e[c],"%s: %s type `%s` is invalid; it must be a function, usually from React.PropTypes.",s||"React class",r,c),d=e[c](t,c,s,r,null,i)}catch(e){d=e}if(o(!d||d instanceof Error,"%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",s||"React class",r,c,typeof d),d instanceof Error&&!(d.message in a)){a[d.message]=!0;var u=l?l():"";o(!1,"Failed %s type: %s%s",r,d.message,null!=u?u:"")}}}},function(e,t,r){var n=r(0),o=r(1),i=r(2),a=r(3),s=r(6);e.exports=function(e,t){var r="function"==typeof Symbol&&Symbol.iterator,l="<<anonymous>>",c={array:f("array"),bool:f("boolean"),func:f("function"),number:f("number"),object:f("object"),string:f("string"),symbol:f("symbol"),any:p(n.thatReturnsNull),arrayOf:function(e){return p((function(t,r,n,o,i){if("function"!=typeof e)return new u("Property `"+i+"` of component `"+n+"` has invalid PropType notation inside arrayOf.");var s=t[r];if(!Array.isArray(s))return new u("Invalid "+o+" `"+i+"` of type `"+h(s)+"` supplied to `"+n+"`, expected an array.");for(var l=0;l<s.length;l++){var c=e(s,l,n,o,i+"["+l+"]",a);if(c instanceof Error)return c}return null}))},element:p((function(t,r,n,o,i){var a=t[r];return e(a)?null:new u("Invalid "+o+" `"+i+"` of type `"+h(a)+"` supplied to `"+n+"`, expected a single ReactElement.")})),instanceOf:function(e){return p((function(t,r,n,o,i){if(!(t[r]instanceof e)){var a=e.name||l;return new u("Invalid "+o+" `"+i+"` of type `"+((s=t[r]).constructor&&s.constructor.name?s.constructor.name:l)+"` supplied to `"+n+"`, expected instance of `"+a+"`.")}var s;return null}))},node:p((function(e,t,r,n,o){return m(e[t])?null:new u("Invalid "+n+" `"+o+"` supplied to `"+r+"`, expected a ReactNode.")})),objectOf:function(e){return p((function(t,r,n,o,i){if("function"!=typeof e)return new u("Property `"+i+"` of component `"+n+"` has invalid PropType notation inside objectOf.");var s=t[r],l=h(s);if("object"!==l)return new u("Invalid "+o+" `"+i+"` of type `"+l+"` supplied to `"+n+"`, expected an object.");for(var c in s)if(s.hasOwnProperty(c)){var d=e(s,c,n,o,i+"."+c,a);if(d instanceof Error)return d}return null}))},oneOf:function(e){return Array.isArray(e)?p((function(t,r,n,o,i){for(var a=t[r],s=0;s<e.length;s++)if(d(a,e[s]))return null;return new u("Invalid "+o+" `"+i+"` of value `"+a+"` supplied to `"+n+"`, expected one of "+JSON.stringify(e)+".")})):(i(!1,"Invalid argument supplied to oneOf, expected an instance of array."),n.thatReturnsNull)},oneOfType:function(e){return Array.isArray(e)?p((function(t,r,n,o,i){for(var s=0;s<e.length;s++)if(null==(0,e[s])(t,r,n,o,i,a))return null;return new u("Invalid "+o+" `"+i+"` supplied to `"+n+"`.")})):(i(!1,"Invalid argument supplied to oneOfType, expected an instance of array."),n.thatReturnsNull)},shape:function(e){return p((function(t,r,n,o,i){var s=t[r],l=h(s);if("object"!==l)return new u("Invalid "+o+" `"+i+"` of type `"+l+"` supplied to `"+n+"`, expected `object`.");for(var c in e){var d=e[c];if(d){var p=d(s,c,n,o,i+"."+c,a);if(p)return p}}return null}))}};function d(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function u(e){this.message=e,this.stack=""}function p(e){var r={},n=0;function s(s,c,d,p,f,m,h){if(p=p||l,m=m||d,h!==a)if(t)o(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");else if("undefined"!=typeof console){var _=p+":"+d;!r[_]&&n<3&&(i(!1,"You are manually calling a React.PropTypes validation function for the `%s` prop on `%s`. This is deprecated and will throw in the standalone `prop-types` package. You may be seeing this warning due to a third-party PropTypes library. See https://fb.me/react-warning-dont-call-proptypes for details.",m,p),r[_]=!0,n++)}return null==c[d]?s?null===c[d]?new u("The "+f+" `"+m+"` is marked as required in `"+p+"`, but its value is `null`."):new u("The "+f+" `"+m+"` is marked as required in `"+p+"`, but its value is `undefined`."):null:e(c,d,p,f,m)}var c=s.bind(null,!1);return c.isRequired=s.bind(null,!0),c}function f(e){return p((function(t,r,n,o,i,a){var s=t[r];return h(s)!==e?new u("Invalid "+o+" `"+i+"` of type `"+(function(e){var t=h(e);if("object"===t){if(e instanceof Date)return"date";if(e instanceof RegExp)return"regexp"}return t})(s)+"` supplied to `"+n+"`, expected `"+e+"`."):null}))}function m(t){switch(typeof t){case"number":case"string":case"undefined":return!0;case"boolean":return!t;case"object":if(Array.isArray(t))return t.every(m);if(null===t||e(t))return!0;var n=(function(e){var t=e&&(r&&e[r]||e["@@iterator"]);if("function"==typeof t)return t})(t);if(!n)return!1;var o,i=n.call(t);if(n!==t.entries){for(;!(o=i.next()).done;)if(!m(o.value))return!1}else for(;!(o=i.next()).done;){var a=o.value;if(a&&!m(a[1]))return!1}return!0;default:return!1}}function h(e){var t=typeof e;return Array.isArray(e)?"array":e instanceof RegExp?"object":(function(e,t){return"symbol"===e||"Symbol"===t["@@toStringTag"]||"function"==typeof Symbol&&t instanceof Symbol})(t,e)?"symbol":t}return u.prototype=Error.prototype,c.checkPropTypes=s,c.PropTypes=c,c}},function(e,t,r){var n=(function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}})();function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var a=r(5),s=r(4);function l(e){return e.touches[0].clientX}function c(e){return e.touches[0].clientY}var d=(function(e){function t(){var e,r,n;o(this,t);for(var a=arguments.length,s=Array(a),d=0;d<a;d++)s[d]=arguments[d];return r=n=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),n.handleTouchStart=function(e){n.touchStarted||(n.touchStarted=!0,n.touchMoved=!1,n.swipeOutBounded=!1,n.startX=l(e),n.startY=c(e),n.currentX=0,n.currentY=0)},n.handleTouchMove=function(e){if(n.currentX=l(e),n.currentY=c(e),n.touchMoved){if(!n.swipeOutBounded){var t=n.props.swipeTolerance;n.swipeOutBounded=Math.abs(n.startX-n.currentX)>t&&Math.abs(n.startY-n.currentY)>t}}else{var r=n.props.tapTolerance;n.touchMoved=Math.abs(n.startX-n.currentX)>r||Math.abs(n.startY-n.currentY)>r}},n.handleTouchCancel=function(){n.touchStarted=n.touchMoved=!1,n.startX=n.startY=0},n.handleTouchEnd=function(e){if(n.touchStarted=!1,n.touchMoved){if(!n.swipeOutBounded&&n.props.onSwipe){var t,r=n.props.swipeTolerance;t=Math.abs(n.startX-n.currentX)<r?n.startY>n.currentY?"top":"bottom":n.startX>n.currentX?"left":"right",n.props.onSwipe(t,e)}}else n.props.onTap&&n.props.onTap(e)},i(n,r)}return(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)})(t,e),n(t,[{key:"render",value:function(){var e=this.props.children,t=e?a.Children.only(e):a.createElement("button",null);return a.cloneElement(t,{onTouchStart:this.handleTouchStart,onTouchMove:this.handleTouchMove,onTouchCancel:this.handleTouchCancel,onTouchEnd:this.handleTouchEnd})}}]),t})(a.Component);d.defaultProps={tapTolerance:10,swipeTolerance:30},d.propTypes={children:s.node,tapTolerance:s.number,swipeTolerance:s.number,onTap:s.func,onSwipe:s.func},e.exports=d}])},r.exports=n(o.default),e.getDefaultExportFromCjs(i.exports)}));
//# sourceMappingURL=pkg-file_viewer_archive.min.js-vflmrkb2U.map
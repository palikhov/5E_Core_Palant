define(["require","exports","tslib","react","react-redux","file-viewer/watermarking/plugin/redux/index","file-viewer/watermarking/plugin/utils/index","file-viewer/watermarking/plugin/selectors"],(function(e,t,a,i,r,n,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WatermarkingLayer=void 0,i=a.__importDefault(i);var c="watermarking-preview-layer__30XVHIRHlE__watermarking_plugin";t.WatermarkingLayer=r.connect((function(e,t){var a=t.context.fileViewerId,i=e.mode,r=e.imageWatermarkOptions,n=e.textWatermarkOptions,s=e.layerSize;return{mode:i[a],watermarkOptions:o.getCurrentWatermarkOptions(a,e),imageWatermarkOptions:r[a],textWatermarkOptions:n[a],canvasHeight:s[a].canvasHeight,canvasWidth:s[a].canvasWidth}}),(function(e,t){var a=t.context.fileViewerId;return{setImageWatermarkOptions:function(t){return e(n.setImageWatermarkOptions(a,t))},setLayerSize:function(t,i){return e(n.setLayerSize(a,t,i))}}}))((function(e){var t=e.mode,a=e.watermarkOptions,r=e.imageWatermarkOptions,n=e.textWatermarkOptions,o=e.canvasHeight,m=e.canvasWidth,g=e.ui.scaleFactor,l=e.setLayerSize;return i.default.createElement("canvas",{height:o,width:m,className:c,ref:function(e){null!=e&&(l(e.clientHeight,e.clientWidth),(function(e){var t=e.canvas,a=e.scale,i=e.mode,r=e.watermarkOptions,n=e.textWatermarkOptions,o=e.imageWatermarkOptions,c=t.getContext("2d");if(null!==c){c.clearRect(0,0,t.width,t.height);var m=r.position,g=r.marginX,l=r.marginY;if("REPEAT"===m){var d=void 0;try{d=s.tilingFunc({scale:a,mode:i,textWatermarkOptions:n,imageWatermarkOptions:o})}catch(e){if("NO_TILE_INPUT"===e.message)return;throw e}for(var h=0,u=0,v=(d.startY+u)%d.distanceY-d.height;v<t.height;v+=d.distanceY){for(var p=(d.startX+h)%d.distanceX-d.width;p<t.width;p+=d.distanceX)c.drawImage(d.canvas,p,v);h+=d.offsetXPerRow,u+=d.offsetYPerCol}}else{var f=void 0;if("text"===i){var w=n.text,k=n.size,O=n.fontFamily,W=n.color,x=n.opacity,y=n.angle;f=s.drawTextTile({text:w,size:k*a,fontFamily:O,color:W,opacity:x,angle:y}).canvas}else{var T=o.image;k=o.size,x=o.opacity,y=o.angle;if(!T)return;f=s.drawImageTile({image:T,scale:k*a,opacity:x,angle:y}).canvas}var _=g*a,E=l*a;p=_,v=E;"CENTER"===m?(p=(t.width-f.width)/2,v=(t.height-f.height)/2):"NORTHEAST"===m?p=t.width-f.width-_:"SOUTHWEST"===m?v=t.height-f.height-E:"SOUTHEAST"===m&&(p=t.width-f.width-_,v=t.height-f.height-E),c.drawImage(f,p,v)}}})({canvas:e,scale:g,mode:t,watermarkOptions:a,imageWatermarkOptions:r,textWatermarkOptions:n}))}})}))}));
//# sourceMappingURL=watermarking_layer.min.js-vflzSLZYG.map
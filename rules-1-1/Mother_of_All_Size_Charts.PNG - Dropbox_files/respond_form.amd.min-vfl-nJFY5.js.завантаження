define(["require","exports","tslib","react","dig-components/buttons","classnames","typescript/component_libraries/flows/src/components/spacer/index","react-intl","react-intl","dig-components/chips","dig-components/icons","dig-components/icons/src","dig-components/text_fields","dig-components/typography","dig-components/avatar","dig-components/tooltips","dig-components/badges"],(function(e,a,t,l,o,r,n,s,i,p,d,c,u,m,f,v,g){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.ApprovalRespondForm=a.ApprovalRespondFormInternal=void 0,l=t.__importStar(l),r=t.__importDefault(r),a.ApprovalRespondFormInternal=function(e){var a,t,s=e.onCancel,_=e.onRespondSuccess,b=e.onEditSuccess,h=e.user,E=e.inlineWithComments,M=e.ioClient,I=e.fileId,R=e.threadId,y=e.editArgs,A=l.useState(null!==(a=null==y?void 0:y.content)&&void 0!==a?a:""),C=A[0],F=A[1],L=l.useState("approved"==(null==y?void 0:y.approvalMetadata.status)||"rejected"!=(null==y?void 0:y.approvalMetadata.status)&&void 0),S=L[0],N=L[1],T=l.useState(!1),x=T[0],B=T[1],q=l.useState(!1),j=q[0],z=q[1],k=l.default.useRef(null),w={title:(t=i.useIntl()).formatMessage({id:"TKvySt",defaultMessage:"Respond to request"}),submitButtonLabel:t.formatMessage({id:"mVrd/b",defaultMessage:"Submit"}),cancelButtonLabel:t.formatMessage({id:"KQ8scR",defaultMessage:"Cancel"}),detailsInputLabel:t.formatMessage({id:"rFAfdB",defaultMessage:"Details"}),detailsInputPlaceholder:t.formatMessage({id:"hzYIsD",defaultMessage:"Tell requester more about your decision"}),approveChipLabel:t.formatMessage({id:"TjnDNv",defaultMessage:"Approve"}),rejectChipLabel:t.formatMessage({id:"YEnec6",defaultMessage:"Request change"}),genericError:t.formatMessage({id:"vK1TiB",defaultMessage:"Something went wrong. Please try again later."}),approveOrRequestFirstTooltip:t.formatMessage({id:"2p63Fj",defaultMessage:"Approve or request change first"}),addDetailsTooltip:t.formatMessage({id:"wWiE03",defaultMessage:"Add details about your change request"}),betaBadgeLabel:t.formatMessage({id:"HA3jPv",defaultMessage:"Beta"})},D=w.title,P=w.submitButtonLabel,O=w.cancelButtonLabel,U=w.detailsInputLabel,K=w.detailsInputPlaceholder,W=w.approveChipLabel,H=w.rejectChipLabel,Y=w.genericError,Q=w.approveOrRequestFirstTooltip,V=w.addDetailsTooltip,G=w.betaBadgeLabel,J=M.getLogger();l.default.useEffect((function(){J.logShownRespondForm(I,R)}),[I,R]);var X=function(){B(!1),z(!0);var e={type:"approval",status:S?"approved":"rejected",approver_email:null==y?void 0:y.approvalMetadata.approver_email,requester_email:null==y?void 0:y.approvalMetadata.requester_email,approval_type:"response",actor:"approver",approver_display_name:null==y?void 0:y.approvalMetadata.approver_display_name};y?M.editApprovalResponse(I,y.commentId,S,C).then((function(a){J.logApprovalResponseResubmitSucccess(I,R,C.length,e.status,a.comment_id),b&&b(y.commentId,R,{text:C,metadata:[e]})})).catch((function(){B(!0),z(!1)})):M.respondToApprovalRequest(I,R,S,C).then((function(a){_&&_({text:C,metadata:[e]},R),J.logSubmitResponseSuccess(I,R,e.status,C.length,a.comment_id)})).catch((function(){B(!0),z(!1)}))},Z=S||void 0!==S&&!!C,$=function(e){return l.default.createElement(o.Button,{onClick:X,variant:"primary",size:"small",disabled:e,className:"approval-form__footer_primary-action",isLoading:j},P)},ee=function(e){J.logApproveChipClick(I,R,e),N(e)};return l.default.createElement("div",{className:r.default("approval-form",{"inline-with-comments":E}),ref:k},l.default.createElement("div",{className:"approval-form__title"},l.default.createElement(f.Avatar,{src:h.photoUrl,backgroundColor:f.avatarColorForUserIdentifier(h.initials),hasNoOutline:!0,size:"small",style:{marginRight:"6px"}},h.initials),l.default.createElement(m.Text,{isBold:!0,tagName:"h1"},D),l.default.createElement(g.AccessoryBadge,null,G)),l.default.createElement("div",{className:"approval-form__body"},l.default.createElement("div",{className:"approval-respond-form__action-chips-group"},l.default.createElement(p.FilterChip,{className:S?"approve-action-selected":void 0,isSelected:S,onClick:function(){return ee(!0)},withIconLeft:l.default.createElement("div",{className:"approval-respond-form__icon-container"},l.default.createElement(d.UIIcon,{size:"small",src:c.CheckmarkCircleLine})),size:"small"},W),l.default.createElement(n.Spacer,{multiplier:2}),l.default.createElement(p.FilterChip,{className:!1===S?"reject-action-selected":void 0,isSelected:!1===S,onClick:function(){return ee(!1)},withIconLeft:l.default.createElement("div",{className:"approval-respond-form__icon-container"},l.default.createElement(d.UIIcon,{size:"small",src:c.WarningLine})),size:"small"},H)),l.default.createElement(n.Spacer,{multiplier:2}),l.default.createElement(u.FormLabel,{htmlFor:"approval-respond-form__details-input"},l.default.createElement(m.Text,{isBold:!0,size:"small",tagName:"label"},U)),l.default.createElement(u.TextArea,{className:"approval-forms__text-area",id:"approval-respond-form__details-input",placeholder:K,"aria-label":K,value:C,onChange:function(e){F(e.currentTarget.value)},style:{boxSizing:"border-box"}}),x&&l.default.createElement(u.FormHelperText,{isInvalid:!0},Y)),l.default.createElement("div",{className:"approval-form__footer"},l.default.createElement(o.Button,{onClick:function(){s&&(J.logCancelApproval(I,"respond_approval_form"),s())},variant:"transparent",size:"small",disabled:j},O),Z?$(!1):l.default.createElement(v.Tooltip,{title:null==S?Q:S||C?null:V,placement:"top-start",auto:!0,boundary:k},l.default.createElement("span",{style:{display:"inline-block"},tabIndex:0},$(!0)))))},a.ApprovalRespondFormInternal.displayName="ApprovalRespondFormInternal",a.ApprovalRespondForm=function(e){return l.default.createElement(s.RawIntlProvider,{value:e.intl},l.default.createElement(a.ApprovalRespondFormInternal,Object.assign({},e)))},a.ApprovalRespondForm.displayName="ApprovalRespondForm"}));
//# sourceMappingURL=respond_form.amd.min.js-vflSveLoM.map
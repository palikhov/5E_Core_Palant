define(["require","exports","tslib","dig-components/icons","dig-components/icons/src","dig-components/menu","modules/clean/file_store/utils","modules/clean/react/app_actions/redirect","modules/clean/react/components/css","modules/clean/react/extensions/cloud_docs_compat","modules/clean/react/extensions/common","modules/clean/react/extensions/data/helpers","modules/clean/react/extensions/extensions_mini_directory_modal","modules/clean/react/extensions/menu_survey","modules/clean/react/extensions/unity_and_cloud_editors","modules/clean/react/extensions/utils","modules/clean/react/file_viewer/constants","modules/clean/react/file_viewer/open_button/types","modules/clean/react/file_viewer/unity/with_unity","modules/clean/static_urls","modules/core/i18n","react","modules/clean/react/file_viewer/file_conversion/file_conversion_options"],(function(e,t,n,o,i,r,s,a,c,l,u,p,d,m,f,_,A,g,y,v,h,E,O){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionsPopoverV2NoUnity=t.ExtensionsPopoverV2WithUnity=void 0;var w=(function(e){function t(t){var s=e.call(this,t)||this;return s.createAppActionClickHandler=function(e){return function(){var t=s.props,o=t.file,i=t.user,r=t.featureFlags,c=t.telemetryContext,p=t.updateLinkState;if(a.redirectToActionOrShowAuth(i,[o],e,r,c,p),"redirect"===e.handler[".tag"]){var d=u.getAppActionExtras(e);u.logEvent(s.props.currentSession,"select_action",n.__assign({menu_version:2},d))}else if("cloud_editor"===e.handler[".tag"]){var m=l.isWopiAction(e)?g.OpenButtonAction.OPEN_WITH:g.OpenButtonAction.OPEN_WITH_CLOUD_DOC;u.logEvent(s.props.currentSession,"select_legacy_action",{type:m})}}},s.wrapperForAction=function(e){return{appAction:e,handler:s.createAppActionClickHandler(e),userAction:A.UserAction.OpenWithAppAction,actionName:e.description}},s.renderActionRow=function(e){var t,n=e.icon;t=n.is_static?v.static_url("/static/images/generic_app_icon-vflIPYT1H.png"):n.url;var o=e.description,i=s.props.isInActionBar?_.toActionBarValue(s.wrapperForAction(e)):s.wrapperForAction(e);return E.default.createElement(r.Menu.ActionItem,{key:e.id,value:i,withLeftAccessory:E.default.createElement("img",{alt:"",src:t,width:24,height:24})},o)},s.renderUnpromotedActions=function(e,t){var a=s.props,c=a.user,l=a.file,p=a.categoryIdToInfos,m=a.featureFlags,f=a.currentSession,A=a.telemetryContext,g=a.updateLinkState,y=a.isInActionBar,v=e.length>0,O={handler:function(){var o=n.__spreadArrays(e,t);d.showExtensionsMiniDirectoryModal(h.intl.formatMessage({id:"KVD2SP",defaultMessage:"Open or edit with these apps"}),c,l,o,p,m,g,A,f),u.logEvent(f,v?"select_show_more":"select_add_app",{surface:A&&A.surface})}},w=y?_.toActionBarValue(O):O;return E.default.createElement(r.Menu.ActionItem,{key:h.intl.formatMessage({id:"R/67N/",defaultMessage:"Show more"}),value:w,withLeftAccessory:v&&!y?null:E.default.createElement(o.UIIcon,{src:i.AddCircleLine})},v?h.intl.formatMessage({id:"Gevpqz",defaultMessage:"Connect more apps"}):h.intl.formatMessage({id:"XFA09U",defaultMessage:"Connect apps"}))},s}return n.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.user,o=t.appActions,i=t.openOptions,s=t.bylines,a=t.currentSession,c=t.isInActionBar,l=u.getOpenOptionsWithLogging(i,a),d=p.partitionOptions(l),_=d.unityOptions,A=d.cloudEditorOptions,g=d.previewOption,y=d.openInReplayOption,v=d.openInDesktopOption,h=d.goToFolderOption,w=p.partitionActions(o),x=w.cloudEditors,I=w.installedActions,M=w.unpromotedActions,C=I.length>0,S=M.length>0;return E.default.createElement(E.default.Fragment,null,E.default.createElement(O.FileConversionOptions,{openOptions:l,currentSession:a,wrapValuesForActionBar:!!c}),E.default.createElement(f.UnityAndCloudEditors,{isInActionBar:c,unityOptions:_,legacyCloudEditorOptions:A,cloudEditorAppActions:x.map((function(t){return e.wrapperForAction(t)})),bylines:s,currentSession:a,previewOption:g,openInReplayOption:y,openInDesktopOption:v,goToFolderOption:h,wrapValuesForActionBar:!!c}),c&&(C||S)&&E.default.createElement(r.Menu.Segment,null,I.map((function(t){return e.renderActionRow(t)})),this.renderUnpromotedActions(I,M)),!c&&C&&E.default.createElement(r.Menu.Segment,{key:"installed-actions"},I.map((function(t){return e.renderActionRow(t)}))),!c&&S&&E.default.createElement(r.Menu.Segment,null,this.renderUnpromotedActions(I,M)),E.default.createElement(m.OpenMenuSurvey,{userId:n.id,session:a}))},t.displayName="ExtensionsPopoverV2Component",t})((E=n.__importDefault(E)).default.Component);t.ExtensionsPopoverV2WithUnity=function(e){return s.isBrowseFile(e.file)?E.default.createElement(y.WithUnity,{file:e.file,user:e.user,render:function(t){return E.default.createElement(w,n.__assign({},e,{unityInfo:t}))}}):null},t.ExtensionsPopoverV2NoUnity=c.requireCssWithComponent(w,["/static/css/app_actions/index-vfl6RtqH3.css","/static/css/extensions/index-vflTeCGSU.css"])}));
//# sourceMappingURL=extensions_popover_content_component_v2.min.js-vflbxbFQT.map
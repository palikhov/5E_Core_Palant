define(["require","exports","tslib","react","modules/clean/bug_reporting/routing","modules/clean/react/file_viewer/app_download_interstitial/app_download_interstitial","modules/clean/react/file_viewer/constants","modules/clean/analytics","modules/clean/web_timing_logger","modules/clean/file_store/utils","modules/core/browser_detection","modules/clean/react/file_viewer/utils","modules/clean/react/open_in_app/banner"],(function(e,n,t,i,o,a,r,l,s,p,d,u,c){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.makeOpenInAppPluginLoader=n.APP_DOWNLOAD_PLUGIN_ID=n.FvsdkAppDownloadInterstitial=void 0,i=t.__importDefault(i),d=t.__importStar(d),n.FvsdkAppDownloadInterstitial=function(e){var n=e.file,t=e.sharedLinkInfo,d=e.onDismiss,u=e.openInAppData,c=e.fileViewerSessionId,f=e.filePreviewSessionId,_=p.getFilename(n),I=i.default.useCallback((function(e){n.ns_id&&n.sjid&&l.MobileFilePreviewLogger.log(e,c,f,n.ns_id,n.sjid,{context:r.UserActionContext.AppDownloadInterstitial})}),[]);i.default.useEffect((function(){s.mark_time_to_interactive(),I(r.UserAction.AppDownloadInterstitialView)}),[]);var m=i.default.useCallback((function(){d(),I(r.UserAction.AppDownloadInterstitialContinue)}),[d,I]),A=i.default.useCallback((function(){d(),I(r.UserAction.AppDownloadInterstitialClose)}),[d]),w=i.default.useCallback((function(){d(),I(r.UserAction.AppDownloadInterstitialInstall)}),[d]);return i.default.createElement(o.RegisterComponentWithBugReporter,{componentId:"web.previews",componentName:"File Preview"},i.default.createElement("div",{"aria-label":_},i.default.createElement(a.AppDownloadInterstitial,{fileOrFolderName:_,open_in_app_data:u,onContinue:m,onAppDownload:w,ownerName:t.ownerName,ownerTeamName:t.ownerTeamName,onClose:A})))},n.FvsdkAppDownloadInterstitial.displayName="FvsdkAppDownloadInterstitial";var f=function(e,t,o,a){var l=this;this.context=e,this.getActiveFile=t,this.user=o,this.hideOpenInAppInterstitial=a,this.openInAppBannerOnClick=function(){l.context.logUserAction({action:r.UserAction.OpenInApp,context:r.UserActionContext.OpenInAppBanner})},this.getHeader=function(){if(l.context.sdkConfig.preview_content_only)return null;if(!d.is_mobile_or_tablet()&&(d.iOS||d.is_android()))return null;var e=l.getActiveFile(),n=e.file,t=e.shareToken,o=e.sharePermission,a=u.getOpenInAppUrls(n,t,o,l.user);if(a){var r=!(n&&t&&o);return function(e){var n=e.onHide;return i.default.createElement("div",{style:{width:"100%"}},i.default.createElement(c.OpenInAppBanner,{urls:a,onClick:l.openInAppBannerOnClick,onClose:n,isMountedFile:r}))}}return null},this.getInterstitial=function(){if(l.hideOpenInAppInterstitial)return null;var e=l.getActiveFile(),t=e.file,o=e.sharedLinkInfo;return p.isSharedFile(t)&&o&&t.open_in_app_data?function(e){var a=e.onHide;return i.default.createElement(n.FvsdkAppDownloadInterstitial,{file:t,openInAppData:t.open_in_app_data,sharedLinkInfo:o,onDismiss:a,fileViewerSessionId:l.context.getFileViewerSessionId(),filePreviewSessionId:l.context.getFilePreviewSessionId()})}:null},this.lifecycle={}};n.APP_DOWNLOAD_PLUGIN_ID="app_download",n.makeOpenInAppPluginLoader=function(e,n,i){var o=this;return function(a){return t.__awaiter(o,void 0,void 0,(function(){return t.__generator(this,(function(o){return[2,(function(o){function a(t){return o.call(this,t,e,n,i)||this}return t.__extends(a,o),a})(f)]}))}))}}}));
//# sourceMappingURL=app_download_interstitial.min.js-vflyLsZLS.map
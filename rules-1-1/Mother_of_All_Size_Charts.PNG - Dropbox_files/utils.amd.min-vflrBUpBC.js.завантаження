define(["require","exports","tslib","typescript/component_libraries/files_components/src/blades/file_activity/data/types","typescript/component_libraries/files_components/src/blades/file_activity/strings","typescript/component_libraries/files_components/src/blades/file_activity/types","typescript/component_libraries/files_components/src/common/filepath"],(function(e,t,a,i,n,r,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldIncludeActivity=t.countSelected=t.getActivityDisplayText=t.processEvents=void 0;t.processEvents=function(e,t){return e.status!==i.EventState.loaded?[]:e.activity.sort((function(e,t){return e.timestamp<t.timestamp?1:e.timestamp>t.timestamp?-1:0})).map(s(t)).reduce(E(t.intl),[])};var s=function(e){return function(i){var n=t.getActivityDisplayText(a.__assign({activity:i},e));return n?a.__assign({type:r.CardType.event,id:i.id,user:i.user,timestamp:i.timestamp},n):void 0}},c=function(e,t){var a=new Date;a.setHours(0,0,0,0);var i=a.getTime(),n=i-864e5,r=new Date(t),_=r.getTime();return _>=i?e.formatMessage({id:"ihD7Zm",defaultMessage:"Today"}):_>=n?e.formatMessage({id:"ZA9ZwS",defaultMessage:"Yesterday"}):e.formatDate(r,{year:"numeric",month:"short",day:"numeric"})},E=function(e){return function(t,a){if(void 0===a)return t;var i=0===t.length?void 0:t[t.length-1],n=c(e,a.timestamp);return!i||"timestamp"in i&&c(e,i.timestamp)!==n?t.concat({type:r.CardType.dateBanner,eventCardDate:n},a):t.concat(a)}},o=function(e,t,a){return t===a.id?e.formatMessage({id:"fGE/Cv",defaultMessage:"You"}):a.display_name};function u(e,t,i,n,r){void 0===n&&(n={});var _=e.intl,s=e.viewingUserId,c=e.activity.user;return{eventHeadline:s===c.id?_.formatMessage(t,n):_.formatMessage(i,a.__assign(a.__assign({},n),{name:c.display_name})),cardSubheading:r}}t.getActivityDisplayText=function(e){var t=e.activity,i=a.__rest(e,["activity"]);switch(t[".tag"]){case"add":return u(a.__assign({activity:t},i),n.YOU_ADDED_FILE,n.OTHER_ADDED_FILE);case"edit":return u(a.__assign({activity:t},i),n.YOU_EDITED_FILE,n.OTHER_EDITED_FILE);case"move":return d(a.__assign({activity:t},i));case"rename":return l(a.__assign({activity:t},i));case"view":return u(a.__assign({activity:t},i),n.YOU_VIEWED_FILE,n.OTHER_VIEWED_FILE);case"file_settings_change":return m(a.__assign({activity:t},i));case"shared_content_change":return v(a.__assign({activity:t},i));case"shared_content_invite":return O(a.__assign({activity:t},i));case"file_lock_change":return p(a.__assign({activity:t},i));case"comment_new":return u(a.__assign({activity:t},i),n.YOU_NEW_COMMENT,n.OTHER_NEW_COMMENT);case"comment_reply":return u(a.__assign({activity:t},i),n.YOU_REPLIED_COMMENT,n.OTHER_REPLIED_COMMENT);case"trello_file_activity":case"shared_link_change":case"slack_link_share":case"zoom_screen_share":return}};var d=function(e){var t=e.activity,a=e.rootNamespaceName;if("path"in t){var i=_.parentDirName(t.path)||a,r=t.last_path&&(_.parentDirName(t.last_path)||a);return r?u(e,n.YOU_MOVED_FILE_FROM_TO,n.OTHER_MOVED_FILE_FROM_TO,{source:r,destination:i}):u(e,n.YOU_MOVED_FILE_TO,n.OTHER_MOVED_FILE_TO,{destination:i})}return u(e,n.YOU_MOVED_FILE,n.OTHER_MOVED_FILE)},l=function(e){var t=e.activity;return"filename"in t&&t.last_filename?u(e,n.YOU_RENAMED_FILE_FROM_TO,n.OTHER_RENAMED_FILE_FROM_TO,{source:t.last_filename,destination:t.filename}):u(e,n.YOU_RENAMED_FILE,n.OTHER_RENAMED_FILE)},m=function(e){var t=e.activity,a="changed_viewer_info_policy"in t?t.changed_viewer_info_policy:void 0;switch(null==a?void 0:a[".tag"]){case"enabled":return u(e,n.YOU_ENABLED_VIEWER_INFO,n.OTHER_DISABLED_VIEWER_INFO);case"disabled":return u(e,n.YOU_DISABLED_VIEWER_INFO,n.OTHER_DISABLED_VIEWER_INFO);default:return u(e,n.YOU_CHANGED_FILE_SETTINGS,n.OTHER_CHANGED_FILE_SETTINGS)}};var v=function(e){var t=e.activity;if("access_type"in t){var a=(function(e){return e.changed_group?e.changed_group.name:e.changed_user?e.changed_user.display_name:e.changed_email?e.changed_email:void 0})(t);if(a){var i={entity:a};switch(t.access_type[".tag"]){case"writer":case"owner":case"reader":return u(e,n.YOU_ENABLED_COMMENTING,n.OTHER_ENABLED_COMMENTING,i);case"reader_no_comment":return u(e,n.YOU_GAVE_VIEW_ONLY_ACCESS,n.OTHER_GAVE_VIEW_ONLY_ACCESS,i);case"no_access":return u(e,n.YOU_REMOVED_ACCESS,n.OTHER_REMOVED_ACCESS,i)}}}},O=function(e){var t=e.activity,i=e.intl,r=e.viewingUserId;if("shared_users"in t){var _=t.shared_users,s=t.shared_emails,c=t.shared_groups;_.sort((function(e,t){return o(i,r,e).localeCompare(o(i,r,t))})),s.sort(),c.sort((function(e,t){return e.name.localeCompare(t.name)}));var E=a.__spreadArrays(_.map((function(e){return o(i,r,e)})),s,c.map((function(e){return e.name}))),d={entity:E[0],count:E.length-1};return 1===E.length?u(e,n.YOU_SHARED_WITH_ONE,n.OTHER_SHARED_WITH_ONE,d):E.length>1?u(e,n.YOU_SHARED_WITH_MANY,n.OTHER_SHARED_WITH_MANY,d):void 0}},p=function(e){var t=e.activity;if("activity_type"in t)return"lock"===t.activity_type[".tag"]?u(e,n.YOU_LOCKED_FILE,n.OTHER_LOCKED_FILE):u(e,n.YOU_UNLOCKED_FILE,n.OTHER_UNLOCKED_FILE)};t.countSelected=function(e){return i.ALL_FILTER_TYPES.reduce((function(t,a){return e[a]?t+1:t}),0)},t.shouldIncludeActivity=function(e){return e=0===t.countSelected(e)?i.INCLUDE_ALL_FILTER:e,function(t){switch(t[".tag"]){case"add":return e[i.FilterType.added];case"edit":return e[i.FilterType.edited];case"move":return e[i.FilterType.moved];case"rename":return e[i.FilterType.renamed];case"view":return e[i.FilterType.viewed];case"file_settings_change":case"file_lock_change":case"shared_content_change":case"shared_content_invite":return e[i.FilterType.shared];case"comment_new":case"comment_reply":return e[i.FilterType.commented];case"trello_file_activity":case"shared_link_change":case"slack_link_share":case"zoom_screen_share":return!1}}}}));
//# sourceMappingURL=utils.amd.min.js-vfl2a_dt8.map
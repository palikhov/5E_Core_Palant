define(["require","exports","tslib","file-viewer/pass/types"],(function(e,i,r,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.reducers=i.DEFAULT_STATE=i.DEFAULT_VIEWING_USER_IDS=i.DEFAULT_FILE_MEMBERS=i.DEFAULT_FILE_MEMBER_COUNTS=i.DEFAULT_SEEN_STATES=void 0,i.DEFAULT_SEEN_STATES={order:[],infos:{}},i.DEFAULT_FILE_MEMBER_COUNTS={count:0,exceeds_limit:!1},i.DEFAULT_FILE_MEMBERS={order:[],users:{},invitees:{}},i.DEFAULT_VIEWING_USER_IDS=[],i.DEFAULT_STATE={seenState:{},fileMemberCounts:{},fileMembers:{},viewingUserIds:{}};function s(e){return!!e.user||"email"===e.invitee[".tag"]}i.reducers={seenState:function(e,n){var s;return void 0===e&&(e=i.DEFAULT_STATE.seenState),"@@previews/initializeFilePreview"!==n.type||e[n.payload.fileInfo.file_id]?"@@apiv2_redux/seen_state/get_seen_state_info_result"===n.type&&n.payload.result?r.__assign(r.__assign({},e),n.payload.result.reduce((function(e,i){var r=i.seen_state_info.seen_states;return e[i.file_info.file_identifier||""]={order:r.map((function(e){return e.seen_state_user.user_id})),infos:r.reduce((function(e,i){return e[i.seen_state_user.user_id]=i,e}),{})},e}),{})):e:r.__assign(r.__assign({},e),((s={})[n.payload.fileInfo.file_id]=i.DEFAULT_SEEN_STATES,s))},fileMemberCounts:function(e,n){var s,t;if(void 0===e&&(e=i.DEFAULT_STATE.fileMemberCounts),"@@previews/initializeFilePreview"===n.type&&!e[n.payload.fileInfo.file_id])return r.__assign(r.__assign({},e),((s={})[n.payload.fileInfo.file_id]=i.DEFAULT_FILE_MEMBER_COUNTS,s));if("@@apiv2_redux/sharing/get_file_member_counts_result"===n.type&&n.payload.result){var _=n.payload.arg.file;return r.__assign(r.__assign({},e),((t={})[_]=n.payload.result,t))}return e},fileMembers:function(e,n){var t,_;if(void 0===e&&(e=i.DEFAULT_STATE.fileMembers),"@@previews/initializeFilePreview"===n.type&&!e[n.payload.fileInfo.file_id])return r.__assign(r.__assign({},e),((t={})[n.payload.fileInfo.file_id]=i.DEFAULT_FILE_MEMBERS,t));if("@@apiv2_redux/sharing/list_file_members_result"===n.type&&n.payload.result){var a=n.payload.arg.file,u=n.payload.result,l=u.users,f=u.invitees.filter(s),o={order:r.__spreadArrays(l.map((function(e){return e.user.account_id})),f.map((function(e){return e.user?e.user.account_id:e.invitee.email}))),users:l.reduce((function(e,i){return e[i.user.account_id]=i,e}),{}),invitees:f.reduce((function(e,i){return e[i.user?i.user.account_id:i.invitee.email]=i,e}),{})};return r.__assign(r.__assign({},e),((_={})[a]=o,_))}return e},viewingUserIds:function(e,s){var t;return void 0===e&&(e=i.DEFAULT_STATE.viewingUserIds),"@@previews/initializeFilePreview"!==s.type||e[s.payload.fileInfo.file_id]?"@@presence/updateViewingUsers"===s.type?r.__assign(r.__assign({},e),Object.keys(s.payload).reduce((function(e,i){return e[i]=s.payload[i].filter((function(e){return e.info.status!==n.PresenceStatus.offline})).map((function(e){return e.agent.userId})),e}),{})):"@@presence/updateViewingUsersWithDelta"===s.type?r.__assign(r.__assign({},e),Object.keys(s.payload).reduce((function(i,t){for(var _=e[t]||[],a=function(e){e.info.status===n.PresenceStatus.offline?i[t]=_.filter((function(i){return i!==e.agent.userId})):_.includes(e.agent.userId)||(i[t]=r.__spreadArrays(_,[e.agent.userId]))},u=0,l=s.payload[t];u<l.length;u++){a(l[u])}return i}),{})):e:r.__assign(r.__assign({},e),((t={})[s.payload.fileInfo.file_id]=i.DEFAULT_VIEWING_USER_IDS,t))}}}));
//# sourceMappingURL=reducer.min.js-vflsldmAK.map
define("family/common/features",["require","exports","tslib","react"],(function(e,t,a,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useFeatureFlag=t.FeatureFlagProvider=t.FAMILY_FEATURE_FLAGS=void 0;var o,i=(n=a.__importStar(n)).createContext,l=n.useContext;(o=t.FAMILY_FEATURE_FLAGS||(t.FAMILY_FEATURE_FLAGS={})).HAS_FAMILY_SHARED_FOLDER="has_family_shared_folder",o.SHOW_SUGGESTED_FOLDERS="show_suggested_folders",o.SHOW_FAMILY_MAY_2021_UPDATES="show_family_may_2021_updates";var r=i({});t.FeatureFlagProvider=function(e){var t=e.children,a=e.flags;return n.createElement(r.Provider,{value:a},t)},t.FeatureFlagProvider.displayName="FeatureFlagProvider",t.useFeatureFlag=function(e){return!!l(r)[e]}})),define("family/common/links",["require","exports","tslib","react","dig-components/typography"],(function(e,t,a,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ageGatingHelpCenterLink=t.AGE_GATING_HELP_CENTER_ARTICLE=t.REMOVE_MEMBER_HELP_CENTER_ARTICLE=t.FAMILY_ROOM_HELP_CENTER_ARTICLE=void 0,n=a.__importStar(n),t.FAMILY_ROOM_HELP_CENTER_ARTICLE="https://help.dropbox.com/accounts-billing/plans-upgrades/share-files-family-plan#familyroom",t.REMOVE_MEMBER_HELP_CENTER_ARTICLE="https://help.dropbox.com/accounts-billing/plans-upgrades/manage-family-plan#remove",t.AGE_GATING_HELP_CENTER_ARTICLE="https://help.dropbox.com/accounts-billing/plans-upgrades/dropbox-family-age-requirements",t.ageGatingHelpCenterLink=function(e){return n.createElement(o.Link,{href:t.AGE_GATING_HELP_CENTER_ARTICLE},e)}})),define("modules/clean/account_page/constants",["require","exports","modules/core/uri"],(function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GIGABYTE_IN_BYTES=t.MEGABYTE_IN_BYTES=t.ROOT_DOWNGRADE_URI=t.CancellationType=void 0,(function(e){e[e.ALL=1]="ALL",e[e.PLAN=2]="PLAN",e[e.SCHEDULE=3]="SCHEDULE",e[e.LICENSES=4]="LICENSES",e[e.ADDON=5]="ADDON",e[e.IND_SUBSCRIPTION=6]="IND_SUBSCRIPTION",e[e.FAMILY_NONPAYER=7]="FAMILY_NONPAYER"})(t.CancellationType||(t.CancellationType={})),t.ROOT_DOWNGRADE_URI=new a.URI({path:"/downgrade",query:{oqa:"acc_cancel"}}),t.MEGABYTE_IN_BYTES=1048576,t.GIGABYTE_IN_BYTES=1073741824})),define("modules/clean/account_page/tabs/billing",["require","exports","tslib","react","react-redux","styled-components","modules/clean/account_page/components/key_value_block","modules/clean/account_page/components/loading","modules/clean/account_page/widgets/billing/action_creators","modules/clean/account_page/widgets/billing/payment_methods_util","modules/clean/payments/billing_instrument/payment_methods_util","modules/clean/account_page/widgets/billing/views/billing_history","modules/clean/account_page/widgets/billing/views/invoice_details","modules/clean/account_page/widgets/billing/views/license_keys","modules/clean/account_page/widgets/plan/action_creators","modules/clean/account_page/widgets/plan/add_ons/action_creators","modules/clean/account_page/widgets/plan/views/add_schedule_modal","modules/clean/account_page/widgets/plan/views/cancel_subs_warning_modal","modules/clean/account_page/widgets/plan/views/change_plan_modal","modules/clean/account_page/widgets/plan/views/change_schedule_modal","modules/clean/active_user","modules/clean/analytics","modules/clean/dbmodal_stack","modules/clean/event_handler","modules/clean/payments/skus/constants","modules/clean/payments/skus/sku_content","modules/clean/payments/skus/subscription_status","modules/clean/react/components/css","modules/clean/react/payments/edit_invoice_address_modal/edit_invoice_address_modal_loader","modules/clean/react/payments/error/browser_update_required_modal","modules/clean/react/payments/update_individual_billing/update_individual_billing_modal_loader","modules/clean/react/payments/update_individual_billing/update_individual_store_creator","modules/clean/teams/admin/lib/billing_history","modules/clean/web_timing_logger","modules/constants/trademark","modules/core/browser","modules/core/i18n","modules/core/notify","modules/core/uri","modules/clean/account_page/widgets/plan/api"],(function(e,t,a,n,o,i,l,r,s,d,c,u,p,m,_,g,f,h,y,b,v,P,M,S,E,C,T,A,w,I,D,N,x,L,k,R,B,O,F,U){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initialize_module=t.moduleInit=t.BillingTab=t.BillingTabView=void 0,n=a.__importDefault(n),o=a.__importStar(o),i=a.__importDefault(i),R=a.__importStar(R);var q=i.default.div(j||(j=a.__makeTemplateObject(["\n  .billing-table-container {\n    border-radius: 0;\n    border: 1px solid var(--color__faint__border);\n\n    .billing-history-table {\n      width: 100%;\n      border-collapse: collapse;\n\n      .row-header {\n        background-color: var(--color__faint__background);\n        padding: var(--spacing__unit--2) 0;\n        color: var(--color__faint__text);\n        font-size: var(--type__body__standard--fontsize);\n        height: auto;\n        font-weight: normal;\n      }\n\n      .caret {\n        vertical-align: middle;\n      }\n\n      .date-header-cell {\n        font-weight: normal;\n        text-align: left;\n        color: var(--color__faint__text);\n      }\n\n      .date-row {\n        padding-left: var(--spacing__unit--2);\n        padding-right: var(--spacing__unit--3);\n        width: 80px;\n        font-weight: normal;\n        text-align: left;\n        font-size: var(--type__body__small--fontsize);\n        color: var(--color__faint__text);\n      }\n\n      .desc-row {\n        font-weight: normal;\n        text-align: left;\n        font-size: var(--type__body__small--fontsize);\n        color: var(--color__faint__text);\n      }\n\n      .price-row {\n        padding-left: var(--spacing__unit--3);\n        padding-right: var(--spacing__unit--2);\n        width: 100px;\n        font-weight: normal;\n        text-align: left;\n        font-size: var(--type__body__small--fontsize);\n        color: var(--color__faint__text);\n      }\n\n      .row-content {\n        height: 56px;\n        border-top: 1px solid var(--color__faint__border);\n        color: var(--color__standard__text);\n\n        &__links {\n          white-space: nowrap;\n          padding: var(--spacing__base_unit);\n          text-align: right;\n\n          a,\n          button {\n            &:not(:first-child) {\n              margin-left: var(--spacing__base_unit);\n            }\n          }\n        }\n      }\n\n      .row-content__date {\n        padding-left: var(--spacing__unit--2);\n        padding-right: var(--spacing__unit--3);\n        width: 80px;\n        text-align: left;\n        color: var(--color__standard__text);\n      }\n\n      .row-content__description {\n        color: var(--color__standard__text);\n\n        .description-line {\n          margin: 0;\n        }\n      }\n\n      .row-content__price {\n        padding-left: var(--spacing__unit--3);\n        padding-right: var(--spacing__unit--2);\n        width: 100px;\n        text-align: left;\n        color: var(--color__standard__text);\n      }\n\n      .billing-history-row {\n        border-top: 1px solid var(--color__faint__border);\n      }\n\n      .billing-history-col {\n        text-align: center;\n        height: ver(--spacing__unit--5);\n      }\n    }\n  }\n"],["\n  .billing-table-container {\n    border-radius: 0;\n    border: 1px solid var(--color__faint__border);\n\n    .billing-history-table {\n      width: 100%;\n      border-collapse: collapse;\n\n      .row-header {\n        background-color: var(--color__faint__background);\n        padding: var(--spacing__unit--2) 0;\n        color: var(--color__faint__text);\n        font-size: var(--type__body__standard--fontsize);\n        height: auto;\n        font-weight: normal;\n      }\n\n      .caret {\n        vertical-align: middle;\n      }\n\n      .date-header-cell {\n        font-weight: normal;\n        text-align: left;\n        color: var(--color__faint__text);\n      }\n\n      .date-row {\n        padding-left: var(--spacing__unit--2);\n        padding-right: var(--spacing__unit--3);\n        width: 80px;\n        font-weight: normal;\n        text-align: left;\n        font-size: var(--type__body__small--fontsize);\n        color: var(--color__faint__text);\n      }\n\n      .desc-row {\n        font-weight: normal;\n        text-align: left;\n        font-size: var(--type__body__small--fontsize);\n        color: var(--color__faint__text);\n      }\n\n      .price-row {\n        padding-left: var(--spacing__unit--3);\n        padding-right: var(--spacing__unit--2);\n        width: 100px;\n        font-weight: normal;\n        text-align: left;\n        font-size: var(--type__body__small--fontsize);\n        color: var(--color__faint__text);\n      }\n\n      .row-content {\n        height: 56px;\n        border-top: 1px solid var(--color__faint__border);\n        color: var(--color__standard__text);\n\n        &__links {\n          white-space: nowrap;\n          padding: var(--spacing__base_unit);\n          text-align: right;\n\n          a,\n          button {\n            &:not(:first-child) {\n              margin-left: var(--spacing__base_unit);\n            }\n          }\n        }\n      }\n\n      .row-content__date {\n        padding-left: var(--spacing__unit--2);\n        padding-right: var(--spacing__unit--3);\n        width: 80px;\n        text-align: left;\n        color: var(--color__standard__text);\n      }\n\n      .row-content__description {\n        color: var(--color__standard__text);\n\n        .description-line {\n          margin: 0;\n        }\n      }\n\n      .row-content__price {\n        padding-left: var(--spacing__unit--3);\n        padding-right: var(--spacing__unit--2);\n        width: 100px;\n        text-align: left;\n        color: var(--color__standard__text);\n      }\n\n      .billing-history-row {\n        border-top: 1px solid var(--color__faint__border);\n      }\n\n      .billing-history-col {\n        text-align: center;\n        height: ver(--spacing__unit--5);\n      }\n    }\n  }\n"]))),V=(function(e){function t(t){var a=e.call(this,t)||this;return a.browserUpdateRequired=function(){return!!a.props.browserUpdateRequired&&(I.BrowserUpdateModalLoader.showInstance(),!0)},a.handlePaymentUpdate=function(){a.browserUpdateRequired()||(P.ProEventsLogger.log("de_billing_tab_update_payment_method_click"),a.props.billingInfo.scheduled_for_downgrade?h.CancelChangesModalConfirmation.showInstance({transitionPerformed:a.reloadData,subStatus:a.subStatus}):D.IndividualUpdateBillingModalLoader.showInstance())},a.handlePaymentAdd=function(){a.browserUpdateRequired()||(P.ProEventsLogger.log("de_billing_tab_add_payment_method_click"),D.IndividualUpdateBillingModalLoader.showInstance())},a.handlePaymentAddToResubscribe=function(){a.browserUpdateRequired()||(P.ProEventsLogger.log("de_billing_tab_add_payment_method_resubscribe_click"),O.Notify.success(B.intl.formatMessage({id:"CDgQc9",defaultMessage:"Please update your billing information to be resubscribed."})),D.IndividualUpdateBillingModalLoader.showInstance())},a.reloadData=function(){var e=a.props,t=e.loadBillingInfo,n=e.loadPlanDataIfNecessary,o=e.loadAddonsInfoIfNecessary,i=e.loadAvailableAddonsInfoIfNecessary;U.resetApolloStore(),t(!0),o(!0),i(!0),n(!0)},a.handleBillingChange=function(){P.ProEventsLogger.log("de_billing_tab_change_billing_modal_open");var e=a.props.billingInfo,t=e.payment_info;e.scheduled_for_downgrade?h.CancelChangesModalConfirmation.showInstance({transitionPerformed:a.reloadData,subStatus:a.subStatus}):b.ChangeScheduleModalView.showInstance({transitionPerformed:a.reloadData,paymentInfo:t,browserUpdateRequired:a.props.browserUpdateRequired,isFromBillingTab:!0})},a.handleRebillUpsell=function(e){e&&e.showChangePlanConfirm&&y.ChangePlanModalView.showInstance({mode:y.ChangePlanMode.CONFIRM,transitionPerformed:a.reloadData})},a.handleAddBillUpsell=function(){a.props.trialsConfig&&a.props.showNptScheduleModal&&(f.AddScheduleModalView.showInstance({project:a.props.trialsConfig.project,productType:C.SkuContentClient.deserialize(a.props.trialsConfig.trialPlan.skuContent).dropboxDisplayName(),userId:a.user.id,skuCode:a.props.trialsConfig.trialPlan.skuCode,duration:a.props.trialsConfig.trialPlan.duration,billingId:a.props.billingInfo.payment_info.gateway_id}),P.ProEventsLogger.log("de_billing_tab_trigger_add_schedule_modal",{source:"billing_info_updated",project:a.props.trialsConfig.project}))},a.onEditInvoiceDetailsClick=function(){P.ProEventsLogger.log("de_billing_tab_edit_invoice_modal_open"),w.EditInvoiceAddressModalLoader.showUpdateTaxProfileModal(!1,a.onInvoiceDetailsUpdated)},a.onInvoiceDetailsUpdated=function(){a.props.loadBillingInfo(!0)},a.renderLicenseKeys=function(){return n.default.createElement("div",{className:"jest-license-keys account-page-block"},n.default.createElement(m.LicenseKeys,{licenseKeys:a.props.billingInfo.license_keys}))},a.renderBillingHistory=function(){var e=a.props.billingInfo,t=e.transactions,o=e.show_edit_invoice_modal,i=e.edit_past_invoices,l=o&&i,r=!1;null!==t&&t.transactions.length>0&&(r=x.getHistoryData(t.transactions).length>3);return n.default.createElement(u.BillingHistory,{showEditInvoiceModal:l,transactions:t.transactions,filters:t.filters,hasMore:r})},a.renderPaymentMethod=function(){var e,t;if(!(a.disallowChangesToCurrentBilling||a.props.trialsConfig&&a.props.trialsConfig.hideBillingModal)){var o=a.props.billingInfo.payment_info,i=o.gateway_id,r=o.expiration_date,s=o.description,u=o.is_reseller_billing,p=o.end_date,m=o.deactivated,_=o.is_on_trial,g=o.reseller_name,f=o.reseller_link;if(u){var h=B.intl.formatMessage({id:"b9rPCC",defaultMessage:"Go to {reseller_name} to view or make changes to your account details"},{reseller_name:g}),y=n.default.createElement("a",{href:f,target:"_blank",rel:"noopener noreferrer"},h);return n.default.createElement(l.KeyValueBlock,{className:"jest-update-payment",keyText:y})}if(-1!==i){if(!d.shouldHidePaymentMethod(i)&&!a.props.billingInfo.payment_method)return n.default.createElement(l.KeyValueBlock,{className:"add-payment jest-update-payment",keyText:B.intl.formatMessage({id:"7Au+O9",defaultMessage:"You can add your payment information now to have your subscription automatically renew when it expires"}),linkText:B.intl.formatMessage({id:"YcxVqg",defaultMessage:"Add"}),onLinkClick:a.handlePaymentAddToResubscribe});if(c.isLicenseKey(i))return n.default.createElement("div",{className:"account-page-block"},n.default.createElement(l.KeyValueBlock,{className:"jest-update-payment",keyText:B.intl.formatMessage({id:"DlX7Ow",defaultMessage:"Payment method"}),subtext:B.intl.formatMessage({id:"nST3rs",defaultMessage:"Add your payment information now to have your subscription automatically renew when it expires"}),linkText:B.intl.formatMessage({id:"CyOG7U",defaultMessage:"Add payment method"}),onLinkClick:a.handlePaymentAdd}));if(d.shouldHidePaymentMethod(i)){var b=d.getPaymentMethodDisabledMessage(i,u,(null===(t=null===(e=a.subStatus)||void 0===e?void 0:e.subState.plan)||void 0===t?void 0:t.displayName())||k.TRADEMARK_PLUS,p,m,_);return n.default.createElement(l.KeyValueBlock,{className:"jest-update-payment",keyText:b})}var v=s;return null!==r&&(v=B.intl.formatMessage({id:"3tRkOA",defaultMessage:"{payment_description}, exp: {expiration_date}"},{payment_description:s,expiration_date:r})),n.default.createElement(l.KeyValueBlock,{className:"update-payment-key-value jest-update-payment",keyText:B.intl.formatMessage({id:"DlX7Ow",defaultMessage:"Payment method"}),valueText:v,linkText:B.intl.formatMessage({id:"+5HiT6",defaultMessage:"Update"}),onLinkClick:a.handlePaymentUpdate})}}},a.renderBillingPeriod=function(){if(!a.disallowChangesToCurrentBilling&&!a.isPlusTrialPlan){var e=a.props.billingInfo,t=e.payment_info,o=e.scheduled_for_downgrade;if(!d.shouldHideBillingChange(t.gateway_id,t.is_reseller_billing)&&t.period){if(!t.schedule_switchable&&!o&&!a.isProfessionalTrialPlan)return n.default.createElement(l.KeyValueBlock,{className:"change-billing-period jest-change-billing-period",keyText:B.intl.formatMessage({id:"R8sDaj",defaultMessage:"Sorry, you cannot change your billing schedule at this time."})});var i="yearly"===t.period?B.intl.formatMessage({id:"qklV/o",defaultMessage:"Plan billed yearly"}):B.intl.formatMessage({id:"tWmQYf",defaultMessage:"Plan billed monthly"});return n.default.createElement(l.KeyValueBlock,{className:"change-billing-period jest-change-billing-period",keyText:B.intl.formatMessage({id:"2ln1p6",defaultMessage:"Billing period"}),valueText:i,linkText:B.intl.formatMessage({id:"ZPvZld",defaultMessage:"Change"}),onLinkClick:a.handleBillingChange,disabled:t&&t.is_in_grace_period})}}},a.renderInvoiceDetails=function(){var e=a.props.billingInfo,t=e.show_edit_invoice_modal,o=e.payment_info,i=e.payment_method,l=e.has_invoice_details;if(a.user.paid&&t&&!d.shouldHideBillingChange(o.gateway_id,o.is_reseller_billing)&&o.period)return n.default.createElement(p.InvoiceDetails,{onLinkClick:a.onEditInvoiceDetailsClick,has_invoice_details:l,country_code:i?i.country_code:void 0})},a.user=v.mustGetActiveUser(),M.DBModalStack.register(N.BILLING_INFO_UPDATED,(function(e){P.ProEventsLogger.log("de_payment_modal_save_click"),U.resetApolloStore(),a.props.loadBillingInfo(!0),a.props.loadPlanDataIfNecessary(!0),a.handleRebillUpsell(e.detail),a.handleAddBillUpsell()})),a}return a.__extends(t,e),t.prototype.componentDidMount=function(){var e=this;this.props.loadBillingInfo(),this.checkTTIstate(),P.ProEventsLogger.log("de_billing_tab_view"),this.events.on(window,"hashchange",(function(){e.displayResubscribeBillingModal(),e.displayUpdateBillingModal(),e.displayAddScheduleModal()})),this.displayResubscribeBillingModal(),this.displayUpdateBillingModal(),this.displayAddScheduleModal()},t.prototype.componentDidUpdate=function(){this.checkTTIstate()},t.prototype.displayUpdateBillingModal=function(){var e,t=R.get_hash(),a=void 0!==t&&-1!==t.search("billing_info")&&-1===t.search("resubscribe_billing_info"),n=F.URI.parse(R.get_href()).getQuery().modal,o=n&&"billing_info"===n,i=F.URI.parse(R.get_href()).getQuery().reason;if(a||o){if(!this.user.paid)return;if(this.browserUpdateRequired())return;if(this.props.trialsConfig&&this.props.trialsConfig.hideBillingModal)return;D.IndividualUpdateBillingModalLoader.showInstance(),P.ProEventsLogger.log("de_billing_tab_trigger_update_billing_modal",{reason:i,project:null===(e=this.props.trialsConfig)||void 0===e?void 0:e.project})}},t.prototype.displayResubscribeBillingModal=function(){var e=R.get_hash();if(void 0!==e&&-1!==e.search("resubscribe_billing_info")){if(this.browserUpdateRequired())return;D.IndividualUpdateBillingModalLoader.showInstance()}},t.prototype.displayAddScheduleModal=function(){var e=R.get_hash(),t=void 0!==e&&-1!==e.search("add_schedule"),a=F.URI.parse(R.get_href()).getQuery().modal;(t||a&&"add_schedule"===a)&&this.user.paid&&!this.browserUpdateRequired()&&this.props.trialsConfig&&!this.props.trialsConfig.hideBillingModal&&(f.AddScheduleModalView.showInstance({project:this.props.trialsConfig.project,productType:C.SkuContentClient.deserialize(this.props.trialsConfig.trialPlan.skuContent).dropboxDisplayName(),userId:this.user.id,skuCode:this.props.trialsConfig.trialPlan.skuCode,duration:this.props.trialsConfig.trialPlan.duration,billingId:this.props.billingInfo.payment_info.gateway_id}),P.ProEventsLogger.log("de_billing_tab_trigger_add_schedule_modal",{source:"redirect_url",project:this.props.trialsConfig.project}))},Object.defineProperty(t.prototype,"subStatus",{get:function(){var e=this.props.billingInfo.serialized_sub_status;if(e)return T.SubscriptionStatus.deserialize(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isPlusTrialPlan",{get:function(){var e,t;return(null===(t=null===(e=this.subStatus)||void 0===e?void 0:e.subState.plan)||void 0===t?void 0:t.productType)===E.ProductPlanType.PLUS_TRIAL},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isProfessionalTrialPlan",{get:function(){var e,t;return(null===(t=null===(e=this.subStatus)||void 0===e?void 0:e.subState.plan)||void 0===t?void 0:t.productType)===E.ProductPlanType.PROFESSIONAL_TRIAL},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isFamilyPayerPlan",{get:function(){var e,t;return(null===(t=null===(e=this.subStatus)||void 0===e?void 0:e.subState.plan)||void 0===t?void 0:t.productType)===E.ProductPlanType.FAMILY_PAYER},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isFamilyNonPayerPlan",{get:function(){var e,t;return(null===(t=null===(e=this.subStatus)||void 0===e?void 0:e.subState.plan)||void 0===t?void 0:t.productType)===E.ProductPlanType.FAMILY_NONPAYER},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"disallowChangesToCurrentBilling",{get:function(){return!this.user.paid||this.isFamilyNonPayerPlan},enumerable:!1,configurable:!0}),t.prototype.checkTTIstate=function(){this.props.dataLoadedForTTI&&(L.mark_time_to_view(),L.mark_time_to_interactive())},t.prototype.isLoading=function(){return"ready"!==this.props.loadingState},t.prototype.render=function(){return this.isLoading()?n.default.createElement(r.Loading,null):n.default.createElement(q,{className:"account-page-tab"},this.renderPaymentMethod(),this.renderBillingPeriod(),this.renderInvoiceDetails(),!this.isFamilyPayerPlan&&!this.isFamilyNonPayerPlan&&this.renderLicenseKeys(),this.renderBillingHistory())},t.displayName="BillingTabView",t=a.__decorate([S.eventHandler],t)})(n.default.Component);t.BillingTabView=V;var j,Y=o.connect((function(e,t){return{browserUpdateRequired:t.browserUpdateRequired,billingInfo:e.billingInfo.billingInfo,loadingState:e.billingInfo.loadingState,dataLoadedForTTI:"ready"===e.billingInfo.loadingState}}),(function(e){return{loadBillingInfo:function(t){return void 0===t&&(t=!1),e(s.loadDataIfNecessary(t))},loadPlanDataIfNecessary:function(t,a){return void 0===t&&(t=!1),e(_.loadDataIfNecessary(t,a))},loadAddonsInfoIfNecessary:function(t){return void 0===t&&(t=!1),e(g.loadAddonsInfoIfNecessary(t))},loadAvailableAddonsInfoIfNecessary:function(t){return void 0===t&&(t=!1),e(g.loadAvailableAddonsInfoIfNecessary(t))}}}))(V);t.BillingTab=A.requireCssWithComponent(Y,["/static/css/plan_management-vflirqNOR.css"]),t.moduleInit=function(e){},t.initialize_module=function(e){}})),define("modules/clean/account_page/widgets/billing/payment_methods_util",["require","exports","tslib","react","styled-components","modules/core/i18n","modules/constants/trademark","modules/clean/analytics","modules/clean/payments/skus/constants","modules/clean/payments/billing_instrument/payment_method_constants","modules/clean/payments/cash","modules/clean/payments/billing_instrument/payment_methods_util"],(function(e,t,a,n,o,i,l,r,s,d,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPaymentMethodDisabledMessage=t.getBillingDisabledMessage=t.getProfessionalTrialScheduleDescription=t.getProfessionalTrialPlanDescription=t.getTrialDescription=t.getAppleLink=t.shouldHideBillingSummary=t.shouldHideBillingChange=t.shouldHidePaymentMethod=void 0,n=a.__importDefault(n);var p,m=(o=a.__importDefault(o)).default.a(p||(p=a.__makeTemplateObject(["\n  font-size: var(--type__body__small--fontsize);\n  color: var(--color__dbx__blue--100);\n  text-align: left;\n  width: 500px;\n"],["\n  font-size: var(--type__body__small--fontsize);\n  color: var(--color__dbx__blue--100);\n  text-align: left;\n  width: 500px;\n"])));function _(e){return[d.GOOGLE_PLAY_SUBSCRIPTION,d.IOS_ONE_TIME_PAYMENT,d.IOS_SANDBOX_ONE_TIME_PAYMENT,d.IOS_RECURRING_PAYMENT,d.IOS_SANDBOX_RECURRING_PAYMENT,d.NO_CHARGE_GATEWAY,d.RESELLER_LICENSE_KEY].includes(e)}function g(){r.ProEventsLogger.log("account_plan_ios_apple_cancel_help_clicked")}function f(){return n.default.createElement(m,{href:"https://support.apple.com/HT202039",target:"_blank",rel:"noopener noreferrer",onClick:g},i.intl.formatMessage({id:"KmMbqM",defaultMessage:"Learn how to manage your Apple App Store subscription"}))}t.shouldHidePaymentMethod=_,t.shouldHideBillingChange=function(e,t){return t||_(e)},t.shouldHideBillingSummary=function(e,t){var a=null==e?void 0:e.gateway_id;return a&&a===d.NO_CHARGE_GATEWAY&&t===s.ProductPlanType.FREE},t.getAppleLink=f,t.getTrialDescription=function(e,t,a){var o,r=u.isIOS(e);o=t.is_trial_overdue?r?n.default.createElement("div",null,i.intl.formatMessage({id:"7ivi5Y",defaultMessage:"You started a Dropbox {plus} trial through the iOS app."},{plus:l.TRADEMARK_PLUS}),n.default.createElement("br",null),i.intl.formatMessage({id:"/4tX/Q",defaultMessage:"For billing details, please check your iTunes receipt."}),n.default.createElement("br",null),i.intl.formatMessage({id:"HZjsks",defaultMessage:"Your subscription is on an extension period."})):i.intl.formatMessage({id:"CABcgS",defaultMessage:"Your trial has expired but we were unable to process your credit card for the Dropbox {plus} upgrade."},{plus:l.TRADEMARK_PLUS}):t.is_close_to_trial_conversion?i.intl.formatMessage({id:"oJVrbs",defaultMessage:"Your trial will automatically upgrade to a Dropbox {plus} account in the next 48 hours."},{plus:l.TRADEMARK_PLUS}):i.intl.formatMessage({id:"AAPE8r",defaultMessage:"{num_days, plural, one{Your trial will automatically upgrade to a {dropbox_plus} account in {num_days} day.} other{Your trial will automatically upgrade to a {dropbox_plus} account in {num_days} days.}}"},{dropbox_plus:l.DROPBOX_PLUS,num_days:t.days_left});var s=n.default.createElement("noscript",null);return r&&!t.is_trial_overdue&&(s=f()),n.default.createElement("span",null,o,n.default.createElement("br",null),s)},t.getProfessionalTrialPlanDescription=function(e){if(e&&e.nextBillingSummary&&e.subState.billingSchedule)return i.intl.formatMessage({id:"QBzB1q",defaultMessage:"Starting on {conversion_date}, we’ll bill you once a {period_noun} for your Dropbox {professional} plan. Your new {period_adj} total will be {price}."},{professional:l.TRADEMARK_PROFESSIONAL,conversion_date:e.formattedNextBillingDate,period_noun:e.subState.billingSchedule.scheduleDescriptionNoun,period_adj:e.subState.billingSchedule.scheduleDescriptionAdjective,price:c.Cash.formatWithTaxLabels(e.nextBillingSummary.total,e.nextBillingSummary)})},t.getProfessionalTrialScheduleDescription=function(e){if(e&&e.nextBillingSummary&&e.subState.billingSchedule)return i.intl.formatMessage({id:"8WOGDU",defaultMessage:"Your Dropbox {professional} plan will convert on {conversion_date}. Your {period} total will be {price} (including taxes)."},{professional:l.TRADEMARK_PROFESSIONAL,conversion_date:e.formattedNextBillingDate,period:e.subState.billingSchedule.scheduleDescriptionAdjective,price:c.Cash.formatWithTaxLabels(e.nextBillingSummary.total,e.nextBillingSummary)})},t.getBillingDisabledMessage=function(e){return e.isResellerBilling?n.default.createElement("a",{href:e.resellerLink,target:"_blank",rel:"noopener noreferrer"},i.intl.formatMessage({id:"sCHiez",defaultMessage:"Go to {reseller_name} to view or make changes to your account details."},{reseller_name:e.resellerName})):e.gatewayId===d.GOOGLE_PLAY_SUBSCRIPTION?i.intl.formatMessage({id:"qmzNq4",defaultMessage:"You purchased Dropbox {dropbox_plan} through Google Play. To make changes to your subscription, visit the Google Play Store."},{dropbox_plan:e.dropboxPlan}):e.gatewayId===d.IOS_ONE_TIME_PAYMENT?i.intl.formatMessage({id:"9Oab9R",defaultMessage:"You purchased Dropbox {dropbox_plan} through the iOS app. Your plan will expire on {end_date}."},{dropbox_plan:e.dropboxPlan,end_date:e.endDate}):[d.IOS_RECURRING_PAYMENT,d.IOS_SANDBOX_RECURRING_PAYMENT].includes(e.gatewayId)?e.deactivated?i.intl.formatMessage({id:"TDhZyM",defaultMessage:"Your subscription from Apple is no longer active."}):e.isOnTrial?n.default.createElement("div",null,n.default.createElement("span",null,i.intl.formatMessage({id:"W5pK97",defaultMessage:"You started a Dropbox {dropbox_plan} trial through the iOS app."},{dropbox_plan:e.dropboxPlan})),n.default.createElement("br",null),f()):n.default.createElement("div",null,n.default.createElement("span",null,i.intl.formatMessage({id:"J5IeA4",defaultMessage:"You purchased Dropbox {dropbox_plan} through the iOS app."},{dropbox_plan:e.dropboxPlan})),n.default.createElement("br",null),f()):i.intl.formatMessage({id:"R8sDaj",defaultMessage:"Sorry, you cannot change your billing schedule at this time."})},t.getPaymentMethodDisabledMessage=function(e,t,a,o,l,r){return t?i.intl.formatMessage({id:"FN1EQh",defaultMessage:"You’re being externally billed."}):e===d.GOOGLE_PLAY_SUBSCRIPTION?i.intl.formatMessage({id:"qmzNq4",defaultMessage:"You purchased Dropbox {dropbox_plan} through Google Play. To make changes to your subscription, visit the Google Play Store."},{dropbox_plan:a}):e===d.IOS_ONE_TIME_PAYMENT?i.intl.formatMessage({id:"9Oab9R",defaultMessage:"You purchased Dropbox {dropbox_plan} through the iOS app. Your plan will expire on {end_date}."},{dropbox_plan:a,end_date:o}):[d.IOS_RECURRING_PAYMENT,d.IOS_SANDBOX_RECURRING_PAYMENT].includes(e)?l?i.intl.formatMessage({id:"TDhZyM",defaultMessage:"Your subscription from Apple is no longer active."}):r?n.default.createElement("div",null,n.default.createElement("span",null,i.intl.formatMessage({id:"W5pK97",defaultMessage:"You started a Dropbox {dropbox_plan} trial through the iOS app."},{dropbox_plan:a})),n.default.createElement("br",null),f()):n.default.createElement("div",null,n.default.createElement("span",null,i.intl.formatMessage({id:"J5IeA4",defaultMessage:"You purchased Dropbox {dropbox_plan} through the iOS app."},{dropbox_plan:a})),n.default.createElement("br",null),f()):i.intl.formatMessage({id:"R8sDaj",defaultMessage:"Sorry, you cannot change your billing schedule at this time."})}})),define("modules/clean/account_page/widgets/billing/action_creators",["require","exports","tslib","modules/clean/account_page/widgets/billing/api","modules/clean/active_user"],(function(e,t,a,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadDataIfNecessary=void 0,t.loadDataIfNecessary=function(e){var t=this;return void 0===e&&(e=!1),function(i,l){return a.__awaiter(t,void 0,void 0,(function(){var t;return a.__generator(this,(function(a){switch(a.label){case 0:return"never_loaded"===l().billingInfo.loadingState||e?(i({type:"billing_info_load"}),[4,n.getBillingInfo(o.mustGetActiveUserId())]):[3,2];case 1:return t=a.sent(),i({type:"billing_info_loaded",billingInfo:t}),[2,!0];case 2:return[2,!1]}}))}))}}})),define("modules/clean/account_page/widgets/billing/api",["require","exports","modules/clean/deprecated_ajax/ajax_as_promised_jquery"],(function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBillingInfo=void 0,t.getBillingInfo=function(e){return a.WebRequest({url:"/account/ajax_billing_tab_model",subject_user:e,dataType:"json"})}})),define("modules/clean/account_page/widgets/billing/billing_history/api",["require","exports","tslib","modules/clean/deprecated_ajax/ajax_as_promised_jquery"],(function(e,t,a,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBillingHistory=void 0,t.getBillingHistory=function(e,t,o,i){return a.__awaiter(this,void 0,Promise,(function(){return a.__generator(this,(function(a){return[2,n.WebRequest({url:"/account/ajax_load_more_billing_history/",data:{block:t,filter_type:o,filter_change:i},subject_user:e,dataType:"json"})]}))}))}})),define("modules/clean/account_page/widgets/billing/billing_history/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BillingHistoryOrder=void 0,(function(e){e.ASCENDING="ASCENDING",e.DESCENDING="DESCENDING"})(t.BillingHistoryOrder||(t.BillingHistoryOrder={}))})),define("modules/clean/account_page/widgets/billing/views/billing_history",["require","exports","tslib","react","modules/core/i18n","modules/clean/active_user","modules/clean/teams/admin/widgets/billing_history/billing_history_table","modules/clean/teams/admin/lib/billing_history","modules/clean/analytics","modules/clean/account_page/widgets/billing/billing_history/api","modules/clean/account_page/widgets/billing/billing_history/types","dig-components/progress_indicators"],(function(e,t,a,n,o,i,l,r,s,d,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BillingHistory=void 0;var p=(function(e){function t(t){var n=e.call(this,t)||this;return n.loadMoreBillingHistory=function(e){return a.__awaiter(n,void 0,void 0,(function(){var t;return a.__generator(this,(function(a){switch(a.label){case 0:return this.setState({isLoading:!0}),s.ProEventsLogger.log("de_billing_history_view_more_click"),e.preventDefault(),[4,d.getBillingHistory(i.mustGetActiveUserId(),this.state.numBlocksLoaded,this.state.filter,!1)];case 1:return t=a.sent(),this.setState((function(e){return{transactions:e.isInitialLoad?t.transactions:e.transactions.concat(t.transactions),hasMore:t.hasMore,isLoading:!1,numBlocksLoaded:e.numBlocksLoaded+1,isInitialLoad:!1}})),[2,!1]}}))}))},n.changeFilter=function(e){return a.__awaiter(n,void 0,void 0,(function(){var t,n;return a.__generator(this,(function(a){switch(a.label){case 0:return this.setState({isLoading:!0,filter:e}),s.ProEventsLogger.log("de_billing_history_change_filter_click"),[4,d.getBillingHistory(i.mustGetActiveUserId(),this.state.numBlocksLoaded,e,!0)];case 1:return t=a.sent(),this.state.isInitialLoad&&(n=r.getHistoryData(t.transactions),t.hasMore=n.length>3),this.setState((function(e){return{transactions:t.transactions,hasMore:t.hasMore,isLoading:!1,numBlocksLoaded:e.numBlocksLoaded,isInitialLoad:e.isInitialLoad}})),[2,!1]}}))}))},n.changeOrder=function(){n.setState((function(e){return{order:e.order===c.BillingHistoryOrder.ASCENDING?c.BillingHistoryOrder.DESCENDING:c.BillingHistoryOrder.ASCENDING}})),s.ProEventsLogger.log("de_billing_history_change_order_click")},n.handlePopoverSelection=function(e){n.state.filter!==e&&n.state.order!==e&&(e===c.BillingHistoryOrder.ASCENDING||e===c.BillingHistoryOrder.DESCENDING?n.changeOrder():n.changeFilter(e))},n.state={transactions:n.props.transactions?n.props.transactions.slice():[],hasMore:n.props.hasMore,isLoading:!1,numBlocksLoaded:0,isInitialLoad:!0,filter:"all_time",order:c.BillingHistoryOrder.ASCENDING},n}return a.__extends(t,e),t.prototype.render=function(){return n.default.createElement("div",{className:"account-page-block"},n.default.createElement("span",{className:"account-page-block__heading"},o.intl.formatMessage({id:"h9UTH1",defaultMessage:"Billing history"})),n.default.createElement("p",{className:"account-page-block__subtext"},o.intl.formatMessage({id:"efUvgd",defaultMessage:"View invoices and receipts for all payments made on your Dropbox account."})),n.default.createElement("div",{className:"billing-table-container"},n.default.createElement(l.BillingHistoryTable,{billingHistoryRecords:this.getHistory(),amountLabel:o.intl.formatMessage({id:"Q9yFMv",defaultMessage:"Amount"}),displayNoTransactionsOnEmptyRecords:!0,showEditInvoiceModal:this.props.showEditInvoiceModal,noTransactionLabel:o.intl.formatMessage({id:"lj3d2i",defaultMessage:"No transaction history"}),footer:this.buildFooter(),logAccountBillingTabEvents:!0,isTeam:!1,filter:this.state.filter,order:this.state.order,onSelection:this.handlePopoverSelection,filters:this.props.filters})))},t.prototype.getHistory=function(){var e=[];return this.state.transactions.length>0&&(e=r.getHistoryData(this.state.transactions),this.state.isInitialLoad&&(e=e.slice(0,3))),this.state.order===c.BillingHistoryOrder.ASCENDING?e:e.reverse()},t.prototype.buildFooter=function(){return this.state.isLoading?n.default.createElement("tr",{className:"billing-history-row"},n.default.createElement("td",{colSpan:4,className:"billing-history-col"},n.default.createElement(u.Spinner,{size:"small","aria-valuetext":o.intl.formatMessage({id:"jybGUg",defaultMessage:"Loading"})}))):this.state.hasMore?n.default.createElement("tr",{className:"billing-history-row"},n.default.createElement("td",{colSpan:4,className:"billing-history-col"},n.default.createElement("a",{href:"#",className:"account-page__link",rel:"noopener noreferrer",onClick:this.loadMoreBillingHistory},o.intl.formatMessage({id:"Td8CMX",defaultMessage:"View more billing history"})))):void 0},t.displayName="BillingHistory",t})((n=a.__importDefault(n)).default.Component);t.BillingHistory=p})),define("modules/clean/account_page/widgets/billing/views/license_keys",["require","exports","tslib","modules/core/i18n","modules/core/browser","react","styled-components","modules/clean/account_page/components/account_table","modules/clean/account_page/components/key_value_block"],(function(e,t,a,n,o,i,l,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LicenseKeys=void 0,o=a.__importStar(o),i=a.__importDefault(i);var d,c,u,p,m,_,g,f,h,y,b,v=(l=a.__importDefault(l)).default(r.BodyRow)(d||(d=a.__makeTemplateObject(["\n  height: 56px;\n  border-top: 1px solid var(--color__faint__border);\n"],["\n  height: 56px;\n  border-top: 1px solid var(--color__faint__border);\n"]))),P=l.default(r.HeaderCell)(c||(c=a.__makeTemplateObject(["\n  font-weight: normal;\n  text-align: left;\n  font-size: var(--type__body__small--fontsize);\n  color: var(--color__faint__text);\n  width: 240px;\n  padding-left: var(--spacing__unit--2);\n"],["\n  font-weight: normal;\n  text-align: left;\n  font-size: var(--type__body__small--fontsize);\n  color: var(--color__faint__text);\n  width: 240px;\n  padding-left: var(--spacing__unit--2);\n"]))),M=l.default(r.HeaderCell)(u||(u=a.__makeTemplateObject(["\n  font-weight: normal;\n  text-align: left;\n  font-size: var(--type__body__small--fontsize);\n  color: var(--color__faint__text);\n  width: 170px;\n  padding-right: var(--spacing__unit--2);\n"],["\n  font-weight: normal;\n  text-align: left;\n  font-size: var(--type__body__small--fontsize);\n  color: var(--color__faint__text);\n  width: 170px;\n  padding-right: var(--spacing__unit--2);\n"]))),S=l.default(r.HeaderRow)(p||(p=a.__makeTemplateObject(["\n  height: var(--spacing__unit--5);\n  background-color: var(--color__faint__background);\n  font-weight: normal;\n"],["\n  height: var(--spacing__unit--5);\n  background-color: var(--color__faint__background);\n  font-weight: normal;\n"]))),E=l.default(r.Table)(m||(m=a.__makeTemplateObject(["\n  width: 100%;\n  border-collapse: collapse;\n  .activated {\n    background-color: var(--color__faint__background);\n  }\n"],["\n  width: 100%;\n  border-collapse: collapse;\n  .activated {\n    background-color: var(--color__faint__background);\n  }\n"]))),C=l.default(r.TableFooter)(_||(_=a.__makeTemplateObject(["\n  width: 100%;\n  text-align: center;\n  border-top: 1px solid var(--color__faint__border);\n"],["\n  width: 100%;\n  text-align: center;\n  border-top: 1px solid var(--color__faint__border);\n"]))),T=l.default.tr(g||(g=a.__makeTemplateObject(["\n  height: 45px;\n"],["\n  height: 45px;\n"]))),A=l.default(r.BodyCell)(f||(f=a.__makeTemplateObject(["\n  color: var(--color__standard__text);\n  text-align: left;\n"],["\n  color: var(--color__standard__text);\n  text-align: left;\n"]))),w=l.default(r.BodyCell)(h||(h=a.__makeTemplateObject(["\n  color: var(--color__standard__text);\n  text-align: left;\n"],["\n  color: var(--color__standard__text);\n  text-align: left;\n"]))),I=l.default(r.BodyCell)(y||(y=a.__makeTemplateObject(["\n  color: var(--color__standard__text);\n  text-align: left;\n  width: 170px;\n  padding-right: var(--spacing__unit--2);\n"],["\n  color: var(--color__standard__text);\n  text-align: left;\n  width: 170px;\n  padding-right: var(--spacing__unit--2);\n"]))),D=l.default(r.BodyCell)(b||(b=a.__makeTemplateObject(["\n  color: var(--color__standard__text);\n  text-align: left;\n  width: 240px;\n  padding-left: var(--spacing__unit--2);\n"],["\n  color: var(--color__standard__text);\n  text-align: left;\n  width: 240px;\n  padding-left: var(--spacing__unit--2);\n"]))),N=(function(e){function t(t){var a=e.call(this,t)||this;return a.licenseRowsIncrement=3,a.handleRedeemClick=function(){o.redirect("/pro/redeem_key")},a.buildLicenseFooter=function(){if(a.state.showViewMore)return i.default.createElement(T,{className:"license-footer-row"},i.default.createElement("td",{colSpan:4},i.default.createElement("a",{onClick:a.showMoreLicense,href:"",rel:"noopener noreferrer"},n.intl.formatMessage({id:"fiL806",defaultMessage:"View more license keys"}))))},a.showMoreLicense=function(e){e.preventDefault(),a.setState((function(e,t){var n=e.maxShow+a.licenseRowsIncrement;return{maxShow:n,showViewMore:n<t.licenseKeys.length}}))},a.buildStatus=function(e){return e.activated?n.intl.formatMessage({id:"7rnsEt",defaultMessage:"Activated on {activated_date}"},{activated_date:e.activated_date}):n.intl.formatMessage({id:"QJkpjq",defaultMessage:"Scheduled for future use"})},a.buildDuration=function(e){return e.duration?e.duration:n.intl.formatMessage({id:"CNLpjm",defaultMessage:"N/A"})},a.buildLicenseKeyTable=function(){var e=a.props.licenseKeys;if(0!==e.length)return i.default.createElement("div",null,i.default.createElement(E,{className:"license-table"},i.default.createElement(r.TableHead,null,i.default.createElement(S,null,i.default.createElement(P,null,n.intl.formatMessage({id:"xn3SDu",defaultMessage:"Key"})),i.default.createElement(r.HeaderCell,null,n.intl.formatMessage({id:"Ncw9cm",defaultMessage:"Redeemed"})),i.default.createElement(r.HeaderCell,null,n.intl.formatMessage({id:"E3AATa",defaultMessage:"Duration"})),i.default.createElement(M,null,n.intl.formatMessage({id:"uufVvn",defaultMessage:"Status"})))),i.default.createElement(C,null,a.buildLicenseFooter()),i.default.createElement(r.TableBody,null,e.map((function(e,t){if(!(t>=a.state.maxShow))return i.default.createElement(v,{className:"license-body-row "+(e.activated?"activated":"unused"),key:e.key},i.default.createElement(D,null,e.key),i.default.createElement(A,{className:"license-redeemded"},e.redeemed_date),i.default.createElement(w,null,a.buildDuration(e)),i.default.createElement(I,null,a.buildStatus(e)))})))))},a.state={maxShow:3,showViewMore:!1},a}return a.__extends(t,e),t.prototype.componentDidMount=function(){this.setState((function(e,t){return{showViewMore:e.maxShow<t.licenseKeys.length}}))},t.prototype.render=function(){return i.default.createElement("div",{className:"license-keys"},i.default.createElement(s.KeyValueBlock,{className:"redeem-license-key",keyText:n.intl.formatMessage({id:"M25rlh",defaultMessage:"License keys"}),linkText:n.intl.formatMessage({id:"dDHqbP",defaultMessage:"Redeem a license key"}),onLinkClick:this.handleRedeemClick,subtext:n.intl.formatMessage({id:"qDYIgp",defaultMessage:"License keys will be applied before any other form of payment method"})}),this.buildLicenseKeyTable())},t.displayName="LicenseKeys",t})(i.default.Component);t.LicenseKeys=N})),define("modules/clean/account_page/widgets/billing/views/invoice_details",["require","exports","tslib","react","modules/core/i18n","modules/clean/account_page/components/key_value_block","modules/clean/payments/validation"],(function(e,t,a,n,o,i,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InvoiceDetails=void 0;var r=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.country_code,a=e.has_invoice_details,r=o.intl.formatMessage({id:"uD4mCH",defaultMessage:"Add details to your invoice, such as company name and address."});t&&l.hasVat(t)&&(r=o.intl.formatMessage({id:"uhx0D0",defaultMessage:"Add details to your invoice, such as company name, address, and VAT ID."}));var s=a?o.intl.formatMessage({id:"+5HiT6",defaultMessage:"Update"}):o.intl.formatMessage({id:"VLPo6o",defaultMessage:"Add invoice details"});return n.default.createElement(i.KeyValueBlock,{className:"jest-invoice-details",keyText:o.intl.formatMessage({id:"IyXKYR",defaultMessage:"Invoice details"}),linkText:s,subtext:r,onLinkClick:this.props.onLinkClick})},t.displayName="InvoiceDetails",t})((n=a.__importDefault(n)).default.Component);t.InvoiceDetails=r})),define("modules/clean/account_page/widgets/plan/action_creators",["require","exports","tslib","modules/clean/account_page/widgets/plan/api","modules/clean/active_user"],(function(e,t,a,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadDataIfNecessary=void 0,t.loadDataIfNecessary=function(e,t){var i=this;return function(l,r){return a.__awaiter(i,void 0,void 0,(function(){var i;return a.__generator(this,(function(a){switch(a.label){case 0:return"never_loaded"===r().planTab.loadingState||e?(t||l({type:"plan_tab_load_info"}),[4,n.getPlanInfo(o.mustGetActiveUserId())]):[3,2];case 1:return i=a.sent(),l({type:"plan_tab_info_loaded",planInfo:i}),[2,!0];case 2:return[2,!1]}}))}))}}})),define("modules/clean/account_page/widgets/plan/add_ons/action_creators",["require","exports","tslib","modules/clean/active_user","modules/clean/account_page/widgets/plan/add_ons/api"],(function(e,t,a,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadAvailableAddonsInfoIfNecessary=t.loadAddonsInfoIfNecessary=void 0,t.loadAddonsInfoIfNecessary=function(e,t){var i=this;return function(l,r){return a.__awaiter(i,void 0,void 0,(function(){var i;return a.__generator(this,(function(a){switch(a.label){case 0:return"never_loaded"===r().planTab.addonsLoadingState||e?(l({type:"load_addons_info"}),i=void 0,t?[4,(new o.AddonsInfoTeamClient).getCurrentAddonsInfoForTeam(n.mustGetActiveUserId())]:[3,2]):[3,5];case 1:return i=a.sent(),[3,4];case 2:return[4,(new o.AddonsInfoClient).getCurrentAddonsInfo(n.mustGetActiveUserId())];case 3:i=a.sent(),a.label=4;case 4:return l({type:"addons_info_loaded",addonsInfo:i.addons_info}),[2,!0];case 5:return[2,!1]}}))}))}},t.loadAvailableAddonsInfoIfNecessary=function(e){var t=this;return function(i,l){return a.__awaiter(t,void 0,void 0,(function(){var t;return a.__generator(this,(function(a){switch(a.label){case 0:return"never_loaded"===l().planTab.availableAddonsLoadingState||e?(i({type:"load_available_addons_info"}),[4,(new o.AddonsInfoClient).getAvailableAddonsInfo(n.mustGetActiveUserId())]):[3,2];case 1:return t=a.sent(),i({type:"available_addons_info_loaded",availableAddonsInfo:t.available_addons_info}),[2,!0];case 2:return[2,!1]}}))}))}}})),define("modules/clean/account_page/widgets/plan/add_ons/api",["require","exports","tslib","api_v2/user_client","api_v2/team_client","modules/clean/viewer"],(function(e,t,a,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.performAddonTransition=t.getAddonTransitionPreview=t.AddonsInfoTeamClient=t.AddonsInfoClient=void 0;var l=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.getCurrentAddonsInfo=function(e){return this.ns("growth_plans").rpc("get_current_addons_info",void 0,{subjectUserId:e})},t.prototype.getAvailableAddonsInfo=function(e){return this.ns("growth_plans").rpc("get_available_addons_info",void 0,{subjectUserId:e})},t.prototype.getAddonTransitionPreview=function(e,t){return this.ns("growth_plans").rpc("get_addon_transition_preview",t,{subjectUserId:e})},t.prototype.performAddonTransition=function(e,t){return this.ns("growth_plans").rpc("perform_addon_transition",t,{subjectUserId:e})},t})(n.UserApiV2Client);t.AddonsInfoClient=l;var r=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.getCurrentAddonsInfoForTeam=function(e){return this.ns("growth_plans").rpc("get_current_addons_info_for_team",void 0,{subjectUserId:e})},t.prototype.getAvailableAddonsInfoForTeam=function(e){return this.ns("growth_plans").rpc("get_available_addons_info_for_team",void 0,{subjectUserId:e})},t.prototype.getAddonTransitionPreviewForTeam=function(e,t){return this.ns("growth_plans").rpc("get_addon_transition_preview_for_team",t,{subjectUserId:e})},t.prototype.performAddonTransitionForTeam=function(e,t){return this.ns("growth_plans").rpc("perform_addon_transition_for_team",t,{subjectUserId:e})},t})(o.TeamApiV2Client);t.AddonsInfoTeamClient=r,t.getAddonTransitionPreview=function(e,t,a){return s(e)?(new l).getAddonTransitionPreview(t,a):(new r).getAddonTransitionPreviewForTeam(t,a)},t.performAddonTransition=function(e,t,a){return s(e)?(new l).performAddonTransition(t,a):(new r).performAddonTransitionForTeam(t,a)};var s=function(e){var t=i.Viewer.get_viewer();return"personal"===e||t.team_is_limited}})),define("modules/clean/account_page/widgets/plan/api",["require","exports","tslib","modules/clean/deprecated_ajax/ajax_as_promised_jquery","api_v2/default_user_client","apiql/client/apollo","modules/clean/active_user"],(function(e,t,a,n,o,i,l){"use strict";var r;function s(){return r||(r=i.createApolloClient(l.mustGetActiveUserId(),{connectToDevTools:!0})),r}Object.defineProperty(t,"__esModule",{value:!0}),t.resetApolloStore=t.getApolloClient=t.getFamilyQuotaInfo=t.getPlanInfo=void 0,t.getPlanInfo=function(e){return a.__awaiter(this,void 0,Promise,(function(){return a.__generator(this,(function(t){return[2,n.WebRequest({url:"/account/ajax_plan_tab_model",subject_user:e,dataType:"json"})]}))}))},t.getFamilyQuotaInfo=function(e){return a.__awaiter(this,void 0,Promise,(function(){return a.__generator(this,(function(t){switch(t.label){case 0:return[4,new o.DefaultUserApiV2Client(e).ns("users").rpc("get_current_account",void 0,{})];case 1:return[2,t.sent().family_quota_info]}}))}))},t.getApolloClient=s,t.resetApolloStore=function(){s().resetStore()}})),define("modules/clean/account_page/widgets/plan/notifications/action_creators",["require","exports","tslib"],(function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setProductChangeNotificationSeen=t.setCancellationNotificationSeen=void 0,t.setCancellationNotificationSeen=function(){var e=this;return function(t){return a.__awaiter(e,void 0,void 0,(function(){return a.__generator(this,(function(e){return t({type:"cancellation_notification_seen"}),[2,!0]}))}))}},t.setProductChangeNotificationSeen=function(){var e=this;return function(t){return a.__awaiter(e,void 0,void 0,(function(){return a.__generator(this,(function(e){return t({type:"product_change_notification_seen"}),[2,!0]}))}))}}})),define("modules/clean/account_page/widgets/plan/constants",["require","exports","modules/clean/payments/skus/constants"],(function(e,t,a){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.planTypeToUpgrades=t.CHANGE_IND_PLAN_MODAL_UPDATED=void 0,t.CHANGE_IND_PLAN_MODAL_UPDATED="change_inv_plan_modal:updated",t.planTypeToUpgrades=((n={})[a.ProductPlanType.FAMILY_PAYER]=[a.ProductPlanType.PROFESSIONAL],n[a.ProductPlanType.PROFESSIONAL]=[a.ProductPlanType.FAMILY_PAYER,a.ProductPlanType.HS_DBX_PRO_BUNDLE],n[a.ProductPlanType.PLUS]=[a.ProductPlanType.PROFESSIONAL,a.ProductPlanType.FAMILY_PAYER,a.ProductPlanType.HS_DBX_PRO_BUNDLE],n[a.ProductPlanType.STANDARD]=[a.ProductPlanType.PROFESSIONAL,a.ProductPlanType.FAMILY_PAYER,a.ProductPlanType.HS_DBX_PRO_BUNDLE],n[a.ProductPlanType.TRANSFER]=[a.ProductPlanType.PROFESSIONAL],n[a.ProductPlanType.SYNC_EVERYTHING]=[a.ProductPlanType.PLUS,a.ProductPlanType.PROFESSIONAL],n)})),define("modules/clean/account_page/widgets/plan/revenue_api_migration_utils",["require","exports","tslib","lodash","modules/core/exception","modules/clean/metrics/index","modules/clean/payments/billing_instrument/payment_method_constants","apiql/client/components/account-gql","modules/clean/payments/skus/constants"],(function(e,t,a,n,o,i,l,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.compareScheduledPlan=t.filterRevAPIScheduledPlan=t.convertLegacyScheduledPlan=t.isAccountScheduledPlanResult=t.compareCurrentPlan=t.filterRevAPICurrentPlan=t.convertLegacyCurrentPlan=t.isAccountCurrentPlanResult=t.comparePaymentInfo=t.filterRevAPIPaymentInfo=t.convertLegacyPaymentInfo=t.isAccountPaymentInfoResult=t.compareChangePlanPreviewData=t.filterRevAPIChangePlanPreviewData=t.convertLegacyChangePlanPreviewData=t.isAccountChangePlanPreviewResult=t.compareAvailablePlansData=t.convertLegacyAvailablePlansData=t.legacyProductTypeToProductFamily=t.isAccountAvailablePlansResult=t.recordRevAPIConsistencyStats=t.reportRevAPIException=t.PersonalPlanManagementRoutes=t.RevAPIConsistencyException=void 0;var d,c={INDIVIDUAL_BASIC:[[s.ProductFamily.PRO,s.ProductPlanType.BASIC]],FAMILY:[[s.ProductFamily.FAMILY,s.ProductPlanType.FAMILY_PAYER]],PLUS:[[s.ProductFamily.PRO,s.ProductPlanType.PLUS]],PROFESSIONAL:[[s.ProductFamily.PRO,s.ProductPlanType.PROFESSIONAL]],TRANSFER:[[s.ProductFamily.PRO,s.ProductPlanType.TRANSFER]],BACKUP:[[s.ProductFamily.PRO,s.ProductPlanType.SYNC_EVERYTHING]],HELLOSIGN_PRO_BUNDLE:[[s.ProductFamily.PRO,s.ProductPlanType.HS_DBX_PRO_BUNDLE]],TEAM_BASIC:[[s.ProductFamily.TEAM,s.ProductPlanType.BASIC]],STANDARD:[[s.ProductFamily.TEAM,s.ProductPlanType.NEW_STANDARD]],ADVANCED:[[s.ProductFamily.TEAM,s.ProductPlanType.ADVANCED]],SERVER:[[s.ProductFamily.TEAM,s.ProductPlanType.SERVER]],ENTERPRISE:[[s.ProductFamily.ENTERPRISE,s.ProductPlanType.NEW_STANDARD],[s.ProductFamily.ENTERPRISE,s.ProductPlanType.SERVER]],EDUCATION:[[s.ProductFamily.EDUCATION,s.ProductPlanType.STANDARD]],TEAM_DEPRECATED:[[s.ProductFamily.TEAM,s.ProductPlanType.STANDARD],[s.ProductFamily.ENTERPRISE,s.ProductPlanType.STANDARD]]},u=(function(e){function t(t){var a=e.call(this,t)||this;return a.name="RevAPIConsistencyException",a}return a.__extends(t,e),t})(Error);t.RevAPIConsistencyException=u,(function(e){e.GET_AVAILABLE_PLANS="get_available_plans",e.GET_CHANGE_PLAN_PREVIEW="get_change_plan_preview",e.GET_PAYMENT_INFO="get_payment_info",e.GET_CURRENT_PLAN="get_current_plan",e.GET_SCHEDULED_PLAN="get_scheduled_plan"})(d=t.PersonalPlanManagementRoutes||(t.PersonalPlanManagementRoutes={})),t.reportRevAPIException=function(e,t){var a={};if(t)for(var n=0,i=Object.keys(t);n<i.length;n++){var l=i[n];a["mismatch_"+l]=t[l]}o.reportException({err:new u(e),severity:o.SEVERITY.NONCRITICAL,tags:["rev_api_migration_pa"],exc_extra:a})},t.recordRevAPIConsistencyStats=function(e,t){i.getMetricsReporter().createStats({ns:"personal_plan_management",name:"revapi_consistency/"+t}).record(e?1:0)},t.isAccountAvailablePlansResult=function(e){return Boolean(e&&"AccountAvailablePlansResult"===e.__typename)},t.legacyProductTypeToProductFamily=function(e,t){var a;for(a in c)if(a)for(var n=0,o=c[a];n<o.length;n++){var i=o[n];if(i){var l=i[0],r=i[1];if(l===e&&r===t)return a}}return"UNKNOWN_PRODUCT_FAMILY"},t.convertLegacyAvailablePlansData=function(e){if(e)return e.map((function(e){return{advertised_contract_length_price:e.displayCost.formatCurrency(),advertised_space_short_tb:e.formattedSpecQuotaGb,contract_length_quantity:1,contract_length_unit:e.scheduleDescription.toUpperCase(),dropbox_brand_display_name:"Dropbox "+e.displayName(),offering_id:e.code,product_family:t.legacyProductTypeToProductFamily(e.productFamily,e.productType)}}))},t.compareAvailablePlansData=function(e,o,i){var l=!0,r=e.map((function(e){return e.offering_id})),s=o.map((function(e){return e.offering_id}));n.isEqual(r,s)||(l=!1,t.reportRevAPIException("Different number of available plans",a.__assign({revAPIPlanIDs:r,legacyPlanIDs:s},i))),l&&o.forEach((function(n,o){var r;for(r in n)"__typename"!==r&&p(n[r])!==p(e[o][r])&&(l=!1,t.reportRevAPIException("Mismatch Catalog and RevAPI available plans data",a.__assign({property:r,revAPIValue:e[o][r],legacyAPIValue:n[r],revAPIOfferingID:e[o].offering_id,legacyOfferingID:n.offering_id},i)))})),t.recordRevAPIConsistencyStats(l,d.GET_AVAILABLE_PLANS)};var p=function(e){return"string"==typeof e?0===e.indexOf("AU$")?"":e.replace(/\s/g,"").replace(/\./g,",").replace(",00",""):e};t.isAccountChangePlanPreviewResult=function(e){return Boolean(e&&"AccountChangePlanPreviewResult"===e.__typename)},t.convertLegacyChangePlanPreviewData=function(e){if(e)return{immediate_price:e.formatted_prorated_price,offering_id:e.sku_code,preview_request_token:"",tax_included_in_total_amount:e.price_includes_tax,upcoming_bill_date:e.formatted_long_date,upcoming_bill_total_price:e.formatted_total_price,vat_id:e.vat}},t.filterRevAPIChangePlanPreviewData=function(e){return{immediate_price:e.immediate_price,offering_id:e.offering_id,preview_request_token:"",tax_included_in_total_amount:e.tax_included_in_total_amount,upcoming_bill_date:e.upcoming_bill_date,upcoming_bill_total_price:e.upcoming_bill_total_price,vat_id:e.vat_id}},t.compareChangePlanPreviewData=function(e,a,o,i){var l=t.filterRevAPIChangePlanPreviewData(o),r=!0;if(!n.isEqual(i,l)){var s=void 0;for(s in i)p(i[s])!==p(l[s])&&(r=!1,t.reportRevAPIException("Mismatch Legacy and RevAPI change plan preview data",{property:s,revAPIValue:l[s],legacyAPIValue:i[s],scheduledUserPlanID:e,chosenPlanID:a}))}t.recordRevAPIConsistencyStats(r,d.GET_CHANGE_PLAN_PREVIEW)},t.isAccountPaymentInfoResult=function(e){return Boolean(e&&"AccountPaymentInfoResult"===e.__typename)},t.convertLegacyPaymentInfo=function(e){if(e){var t,a="unknown"===e.account?null:e.account.slice(-4),n=!0,o=null;switch(e.gateway_id){case l.BRAINTREE:t=r.AccountPaymentInfoType.Card,o=e.type;break;case l.ADYEN_SEPA_GATEWAY:t=r.AccountPaymentInfoType.Sepa;break;case l.ADYEN_IDEAL_GATEWAY:t=r.AccountPaymentInfoType.Ideal;break;case l.PAYPAL_REFERENCE_TRANSACTION:t=r.AccountPaymentInfoType.Paypal,a=null;break;default:t=r.AccountPaymentInfoType.Unknown,n=!1}return{active_payment_method_type:t,last_digits:a,vat_country_code:e.country_code,can_update_payment_method_via_web_storefront:n,credit_type:o}}},t.filterRevAPIPaymentInfo=function(e){return{active_payment_method_type:e.active_payment_method_type,last_digits:e.last_digits,vat_country_code:e.vat_country_code,can_update_payment_method_via_web_storefront:e.can_update_payment_method_via_web_storefront,credit_type:e.credit_type}},t.comparePaymentInfo=function(e,a){var o=t.filterRevAPIPaymentInfo(e),i=n.isEqual(a,o);if(!i){var l=void 0;for(l in a)a[l]!==o[l]&&t.reportRevAPIException("Mismatch Legacy and RevAPI payment info",{property:l,revAPIValue:o[l],legacyAPIValue:a[l]})}t.recordRevAPIConsistencyStats(i,d.GET_PAYMENT_INFO)},t.isAccountCurrentPlanResult=function(e){return Boolean(e&&"AccountCurrentPlanResult"===e.__typename)},t.convertLegacyCurrentPlan=function(e){var t=null==e?void 0:e.subState;if(e&&t){var n=t.plan;if(n){var o=m(n);return a.__assign(a.__assign({},o),{contract_interval_end:t.formattedNextBillingDate,total_addon_offerings:[]})}}},t.filterRevAPICurrentPlan=function(e){e.__typename,e.advertised_space_long_rounded;var t=a.__rest(e,["__typename","advertised_space_long_rounded"]);return a.__assign(a.__assign({},t),{total_addon_offerings:[]})},t.compareCurrentPlan=function(e,a){var o=t.filterRevAPICurrentPlan(e),i=n.isEqual(a,o);if(!i){var l=void 0;for(l in a){var r=p(a[l]),s=p(o[l]);n.isEqual(r,s)||t.reportRevAPIException("Mismatch Legacy and RevAPI current plan info",{property:l,revAPIValue:s,legacyAPIValue:r})}}t.recordRevAPIConsistencyStats(i,d.GET_CURRENT_PLAN)},t.isAccountScheduledPlanResult=function(e){return Boolean(e&&"AccountScheduledPlanResult"===e.__typename)},t.convertLegacyScheduledPlan=function(e,t){var n,o=null==e?void 0:e.scheduledSubState,i=null==e?void 0:e.subState;if(e&&o&&i){var l=o.plan;if(l){var r=m(l),s=null===(n=e.nextBillingSummary)||void 0===n?void 0:n.total;return a.__assign(a.__assign({},r),{total_addon_offerings:[],scheduled_downgrade_to_basic:t,upcoming_billing_date:i.formattedNextBillingDate,upcoming_billing_total_amount:s?s.formatCurrency():"NO TOTAL PROVIDED"})}}},t.filterRevAPIScheduledPlan=function(e){e.__typename;var t=a.__rest(e,["__typename"]);return a.__assign(a.__assign({},t),{total_addon_offerings:[]})},t.compareScheduledPlan=function(e,a){var o=t.filterRevAPIScheduledPlan(e),i=n.isEqual(a,o);if(!i){var l=void 0;for(l in a){var r=p(a[l]),s=p(o[l]);n.isEqual(r,s)||t.reportRevAPIException("Mismatch Legacy and RevAPI scheduled plan info",{property:l,revAPIValue:s,legacyAPIValue:r})}}t.recordRevAPIConsistencyStats(i,d.GET_SCHEDULED_PLAN)};var m=function(e){return{advertised_space_short_tb:e.formattedSpecQuotaGb||"",contract_length_quantity:1,contract_length_unit:e.scheduleDescription.toUpperCase(),dropbox_brand_display_name:e.displayUntranslatableNameDirectFromSku,offering_id:e.code,product_family:t.legacyProductTypeToProductFamily(e.productFamily,e.productType)}}})),define("modules/clean/account_page/widgets/plan/revenue_api_migration_comparisons",["require","exports","tslib","apiql/client/components/account-gql","modules/clean/account_page/widgets/plan/revenue_api_migration_utils","react"],(function(e,t,a,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompareRevApiScheduledPlan=t.CompareRevApiCurrentPlan=t.CompareRevApiChangePlanPreview=t.CompareRevApiAvailablePlans=t.CompareRevApiPaymentInfo=void 0,t.CompareRevApiPaymentInfo=function(e){var t=n.useGetAccountPaymentInfoQuery(),a=t.loading,l=t.error,r=t.data;return i.useEffect((function(){var t=r&&r.account_payment_info&&o.isAccountPaymentInfoResult(r.account_payment_info)?r.account_payment_info:void 0;if(l)return o.recordRevAPIConsistencyStats(!1,o.PersonalPlanManagementRoutes.GET_PAYMENT_INFO),void o.reportRevAPIException("Error loading payment info",{error:l});!a&&t&&e.legacyPaymentInfo&&o.comparePaymentInfo(t,e.legacyPaymentInfo)}),[a,e.legacyPaymentInfo]),null},t.CompareRevApiAvailablePlans=function(e){var t=n.useGetAccountAvailablePlansQuery({variables:{filter_product_family:e.filterProductFamily,filter_contract_length:e.filterContractLength}}),l=t.loading,r=t.error,s=t.data,d={context:e.context,userUpcomingPlanID:e.upcomingPlanId};return i.useEffect((function(){var t=s&&s.account_available_plans&&o.isAccountAvailablePlansResult(s.account_available_plans)?s.account_available_plans:void 0;if(r)return o.recordRevAPIConsistencyStats(!1,o.PersonalPlanManagementRoutes.GET_AVAILABLE_PLANS),void o.reportRevAPIException("Error loading available plans data",a.__assign({error:r},d));!l&&t&&e.legacyAvailablePlans&&(t.available_plans?o.compareAvailablePlansData(t.available_plans,e.legacyAvailablePlans,d):(o.recordRevAPIConsistencyStats(!1,o.PersonalPlanManagementRoutes.GET_AVAILABLE_PLANS),o.reportRevAPIException("Available plans list not provided",a.__assign({error:r},d))))}),[l,e.legacyAvailablePlans]),null},t.CompareRevApiChangePlanPreview=function(e){var t=n.useGetAccountChangePlanPreviewQuery({variables:{offering_id:e.offeringId,vat_id:e.vatId}}),a=t.loading,l=t.error,r=t.data;return i.useEffect((function(){var t=r&&r.account_change_plan_preview&&o.isAccountChangePlanPreviewResult(r.account_change_plan_preview)?r.account_change_plan_preview:void 0;if(l)return o.recordRevAPIConsistencyStats(!1,o.PersonalPlanManagementRoutes.GET_CHANGE_PLAN_PREVIEW),void o.reportRevAPIException("Error loading change plan preview data",{error:l});!a&&t&&e.legacyChangePlanPreviewData&&o.compareChangePlanPreviewData(e.scheduledPlanID,e.offeringId,t,e.legacyChangePlanPreviewData)}),[a,e.legacyChangePlanPreviewData]),null},t.CompareRevApiCurrentPlan=function(e){var t=n.useGetAccountCurrentPlanQuery({variables:{should_hide_pricing_info:e.shouldHidePricingInfo}}),a=t.loading,l=t.error,r=t.data;return i.useEffect((function(){var t=r&&r.account_current_plan&&o.isAccountCurrentPlanResult(r.account_current_plan)?r.account_current_plan:void 0;if(l)return o.recordRevAPIConsistencyStats(!1,o.PersonalPlanManagementRoutes.GET_CURRENT_PLAN),void o.reportRevAPIException("Error loading current plan ",{error:l});!a&&t&&e.legacyCurrentPlanInfo&&o.compareCurrentPlan(t,e.legacyCurrentPlanInfo)}),[a,e.legacyCurrentPlanInfo]),null},t.CompareRevApiScheduledPlan=function(e){var t=n.useGetAccountScheduledPlanQuery({variables:{should_hide_pricing_info:e.shouldHidePricingInfo}}),a=t.loading,l=t.error,r=t.data;return i.useEffect((function(){var t=r&&r.account_scheduled_plan&&o.isAccountScheduledPlanResult(r.account_scheduled_plan)?r.account_scheduled_plan:void 0;if(l)return o.recordRevAPIConsistencyStats(!1,o.PersonalPlanManagementRoutes.GET_SCHEDULED_PLAN),void o.reportRevAPIException("Error loading scheduled plan",{error:l});!a&&t&&e.legacyScheduledPlanInfo&&o.compareScheduledPlan(t,e.legacyScheduledPlanInfo)}),[a,e.legacyScheduledPlanInfo]),null}})),define("modules/clean/account_page/widgets/plan/strings",["require","exports","react-intl","modules/core/i18n","modules/clean/payments/skus/constants","modules/clean/payments/cash","modules/clean/family/constants","modules/clean/account_page/constants","modules/clean/display_format","dropbox/proto/storefront_platform_js_init_data/types"],(function(e,t,a,n,o,i,l,r,s,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getResubscribeUpsellDescription=t.getResubscribeUpsellPlanDetailsButtonText=t.getResubscribeUpsellResubscribeButtonText=t.getDowngradeSnackbarMessage=t.CANCEL_DESCRIPTION=t.getPaidPlanScheduledToCancelDescription=t.getPlanFeatureDescription=t.getPaidPlanDefaultDescription=t.getPriceBreakdownByPlan=t.getPaidPlanDefaultBillingSummary=t.getPaidPlanName=t.getLockedTeamPlanName=void 0;var c=d.storefront_platform.StorefrontPlatformContractLengthUnit;t.getLockedTeamPlanName=function(e,t){var a=e?n.intl.formatMessage({id:"h2UqcJ",defaultMessage:"(team downgraded)"}):n.intl.formatMessage({id:"LGoRkl",defaultMessage:"(trial ended)"});return n.intl.formatMessage({id:"3onAtc",defaultMessage:"{plan_name} {downgraded_text}"},{plan_name:t,downgraded_text:a})},t.getPaidPlanName=function(e,t,a){var i,l;return 1024===e.specQuotaGb||e.productFamily===o.ProductFamily.FAMILY?(i=e.displayName(!1,!1,a),l=n.intl.formatMessage({id:"Trr3KV",defaultMessage:"Dropbox {plan}"},{plan:i})):l=e.displayName(!0),l},t.getPaidPlanDefaultBillingSummary=function(e,t){var a="";return(null==t?void 0:t.scheduleDescriptionNoun)&&(null==e?void 0:e.total)&&(a=n.intl.formatMessage({id:"fRlyEz",defaultMessage:"{total} per {period}."},{total:i.Cash.formatWithTaxLabels(e.total,e),period:t.scheduleDescriptionNoun})),a},t.getPriceBreakdownByPlan=function(e,t,a){return t&&e&&a&&e.lineItems.find((function(e){return e.sku.productType===a.productType}))?n.intl.formatMessage({id:"Sd6QRw",defaultMessage:"{total} per {period}."},{total:a.displayCost.formatCurrency(),period:t.scheduleDescriptionNoun}):""},t.getPaidPlanDefaultDescription=function(e,t,a,o){return o?n.intl.formatMessage({id:"pO8IP6",defaultMessage:"Your {plan} plan will renew on {date}. {billing_summary}"},{plan:e,date:a,billing_summary:t}):n.intl.formatMessage({id:"Ofo1Y4",defaultMessage:"This account’s {plan} plan will renew on {date}. {billing_summary}"},{plan:e,date:a,billing_summary:t})},t.getPlanFeatureDescription=function(e,t){var a=e.content&&e.content.spaceShortFormTb();switch(e.productType){case o.ProductPlanType.STANDARD:case o.ProductPlanType.PLUS:return a?n.intl.formatMessage({id:"gK4PxX",defaultMessage:"Smart Sync, stress-free sharing, offline folders on mobile, and {plan_space} storage."},{plan_space:a}):n.intl.formatMessage({id:"/Jj95M",defaultMessage:"Smart Sync, stress-free sharing, offline folders on mobile."});case o.ProductPlanType.HS_DBX_PRO_BUNDLE:return a&&(null==t?void 0:t.isEsignUpsell)?n.intl.formatMessage({id:"7XEHpu",defaultMessage:"Includes {space} of storage and unlimited e-signatures. Up to 20% off vs. buying each separately."},{space:a}):n.intl.formatMessage({id:"IXOQ0a",defaultMessage:"Includes Dropbox Pro and unlimited e-signatures with HelloSign Essentials."});case o.ProductPlanType.PROFESSIONAL:return a?n.intl.formatMessage({id:"Muci4i",defaultMessage:"Everything in Plus, shared link controls, and {plan_space} storage."},{plan_space:a}):n.intl.formatMessage({id:"wULqRj",defaultMessage:"Everything in Plus, with shared link controls."},{plan_space:a});case o.ProductPlanType.FAMILY_PAYER:return n.intl.formatMessage({id:"9Ru4ky",defaultMessage:"{count, plural, one{Up to {count} member, easy family sharing, and {plan_space} storage.} other{Up to {count} members, easy family sharing, and {plan_space} storage.}}"},{count:l.MAX_LICENSES,plan_space:a});case o.ProductPlanType.TRANSFER:return n.intl.formatMessage({id:"4k1fvl",defaultMessage:"Send transfers up to {transfer_send_size_limit} at a time with password protection and customized experiences."},{transfer_send_size_limit:s.format_bytes(100*r.GIGABYTE_IN_BYTES,2,!0,!0,!1)});case o.ProductPlanType.SYNC_EVERYTHING:return n.intl.formatMessage({id:"ACkjCJ",defaultMessage:"Automatic backup and recovery protection for one device."})}return""},t.getPaidPlanScheduledToCancelDescription=function(e,t,a){return a?n.intl.formatMessage({id:"DbT6E7",defaultMessage:"Your {plan} will downgrade to Dropbox Basic on {date}."},{plan:e,date:t}):n.intl.formatMessage({id:"KxyGh1",defaultMessage:"This account’s {plan} will downgrade to Dropbox Basic on {date}."},{plan:e,date:t})},t.CANCEL_DESCRIPTION=a.defineMessages({default_plan:{id:"XHP8sT",defaultMessage:"If you cancel your plan, your account will drop from {quota} to {basic_space_short_form_gb} of space (plus any bonus space earned previously)."},default_plan_with_addon_warning:{id:"n0hWtQ",defaultMessage:"If you cancel your plan, your account will drop from {quota} to {basic_space_short_form_gb} of space (plus any bonus space earned previously), and any add-ons will be removed."},family_non_payer_no_shared_folder:{id:"kBU+3Q",defaultMessage:"Your account will be downgraded to {dropbox_basic}, and you’ll lose access to {trademark_family} storage and features."},family_non_payer_with_shared_folder:{id:"JuNSrl",defaultMessage:"Your account will be downgraded to {dropbox_basic}, and you’ll lose access to the plan’s storage, features, and the Family Room folder."},family_payer_no_shared_folder:{id:"VGD5gM",defaultMessage:"You and your family members will be downgraded to {dropbox_basic}, and you’ll lose access to the plan’s features."},family_payer_with_shared_folder:{id:"OpkK4e",defaultMessage:"You and your family will be downgraded to {dropbox_basic}, and you’ll lose access to the plan’s storage, features, and the Family Room folder."},backup:{id:"7xDVJJ",defaultMessage:"If you cancel your plan, your computer backup will remain available but it’ll be limited to the {basic_space_short_form_gb} storage quota of the {dropbox_basic} plan. If you exceed your quota, automatic backups will stop."},transfer:{id:"rYm7Gd",defaultMessage:"If you cancel your plan, you’ll lose access to your {transfer_send_size_limit} send size, as well as custom expiration dates, passwords, and branding. Any existing transfer stats, logos, and custom backgrounds will be removed. Expired transfers older than 30 days will be permanently deleted."},other_addon_warning:{id:"0jUnCn",defaultMessage:"Any current add-ons will be removed."}}),t.getDowngradeSnackbarMessage=function(e){return e?n.intl.formatMessage({id:"K7hrab",defaultMessage:"Done! Your paid plan will end on {endDate}. You won't be charged again."},{endDate:e}):n.intl.formatMessage({id:"tL5Ofr",defaultMessage:"Done! Your paid plan has been cancelled. You won't be charged again."})},t.getResubscribeUpsellResubscribeButtonText=function(){return n.intl.formatMessage({id:"vEt76n",defaultMessage:"Resubscribe"})},t.getResubscribeUpsellPlanDetailsButtonText=function(){return n.intl.formatMessage({id:"06582P",defaultMessage:"See plan details"})},t.getResubscribeUpsellDescription=function(e,t,a,o){var i=n.intl.formatMessage({id:"ZydEtp",defaultMessage:"You cancelled {planName} on {endDate}. Resubscribe for {billingPrice} per month."},{planName:e,endDate:t,billingPrice:a}),l=n.intl.formatMessage({id:"P1UfTK",defaultMessage:"You cancelled {planName} on {endDate}. Resubscribe for {billingPrice} per year."},{planName:e,endDate:t,billingPrice:a});return o===c.MONTH?i:l}})),define("modules/clean/account_page/widgets/plan/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProductAddonType=t.PerformPlanTransition=void 0,(function(e){e[e.MONTHLY=1]="MONTHLY",e[e.YEARLY=2]="YEARLY",e[e.PLUS=3]="PLUS",e[e.PROFESSIONAL=4]="PROFESSIONAL",e[e.ADD_EVH=5]="ADD_EVH",e[e.REMOVE_EVH=6]="REMOVE_EVH",e[e.FAMILY_PAYER=7]="FAMILY_PAYER",e[e.BACKUP=8]="BACKUP",e[e.HS_DBX_PRO_BUNDLE=9]="HS_DBX_PRO_BUNDLE"})(t.PerformPlanTransition||(t.PerformPlanTransition={})),(function(e){e.EVH="EVH",e.QUOTA="QUOTA",e.LEGAL_HOLD="LEGAL_HOLD",e.PREMIUM_SUPPORT="PREMIUM_SUPPORT",e.MEDIA="MEDIA",e.API_RATE="API_RATE"})(t.ProductAddonType||(t.ProductAddonType={}))})),define("modules/clean/account_page/widgets/plan/views/add_schedule_modal",["require","exports","tslib","react","classnames","modules/clean/analytics","modules/clean/account_page/util","modules/clean/payments/skus/constants","modules/clean/react/components/css","spectrum/button/index","dig-components/modal","modules/clean/react/components/modal","dig-components/typography","modules/clean/static_urls","modules/core/i18n","modules/clean/react/payments/checkout/components/inputs/labeled_checkbox_input","modules/core/notify","modules/core/browser","modules/clean/react/growth/trials/requests","modules/clean/react/growth/logging_util","modules/clean/account_page/widgets/plan/views/npt_billing_schedule_items"],(function(e,t,a,n,o,i,l,r,s,d,c,u,p,m,_,g,f,h,y,b,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AddScheduleModalView=t.REFRESH_DELAY_SECONDS=void 0,n=a.__importDefault(n),o=a.__importDefault(o),u=a.__importStar(u),h=a.__importStar(h),t.REFRESH_DELAY_SECONDS=5;var P=(function(e){function P(a){var n=e.call(this,a)||this;return n.closeModals=function(){n.setState({isOpen:!1})},n.onTermsCheck=function(){n.setState({displayTermsErrorMsg:!1,termsChecked:!n.state.termsChecked})},n.redirectToBilling=function(){h.redirect("/account/billing")},n.onAccept=function(){var e=n.props,a=e.project,o=e.userId,l=e.skuCode,r=e.billingId,s=n.state,d=s.trialPriceConversions,c=s.finalBillingScheduleId;if(s.termsChecked){var u={trial_sku_code:l,conversion_token:d[c].conversion_token,billing_id:r.toString()};n.setState({submitting:!0}),i.ProEventsLogger.log("add_schedule_modal_accept",{scheduleId:c,advertised_monthly_price:d[c].advertised_monthly_price,advertised_yearly_price:d[c].advertised_yearly_price,currency:d[c].currency,total_amount:d[c].total_amount,project:a}),y.enableAutoConvert(o,a,b.ComponentName.TRIAL_ENABLE_AUTO_CONVERT_MODAL,u,(function(){f.Notify.success(_.intl.formatMessage({id:"RNIIJ0",defaultMessage:"You’ve added your billing period!"}),t.REFRESH_DELAY_SECONDS,n.redirectToBilling)}),(function(){f.Notify.error(_.intl.formatMessage({id:"OXfp6E",defaultMessage:"There was an error adding the billing period!"})),n.doneSubmittingRequest(),n.closeModals()}))}else n.setState({displayTermsErrorMsg:!0})},n.changeProductScheduleType=function(e){n.setState({finalBillingScheduleId:e})},n.getTermsErrorString=function(){var e=n.state.displayTermsErrorMsg,t=_.intl.formatMessage({id:"a2NBnL",defaultMessage:"Please agree to the terms of service."});return e?t:""},n.onDismissModal=function(){i.ProEventsLogger.log("add_schedule_modal_dismiss",{project:n.props.project}),n.closeModals()},n.state={displayTermsErrorMsg:!1,finalBillingScheduleId:r.ScheduleId.YEARLY,loadingContent:!0,submitting:!1,termsChecked:!1,trialPriceConversions:{},type:"",isOpen:!0},n}return a.__extends(P,e),P.showInstance=function(e){u.Modal.showInstance(n.default.createElement(P.AddScheduleModal,a.__assign({},e)))},P.prototype.componentDidMount=function(){this.loadPlanTransitions()},P.prototype.loadPlanTransitions=function(){var e=this,t=this.props,a=t.project,n=t.productType,o=t.userId,i={trial_sku_code:t.skuCode,trial_duration:t.duration,schedule_ids:[r.ScheduleId.MONTHLY,r.ScheduleId.YEARLY]};y.getPriceConversionsForSchedule(o,a,b.ComponentName.TRIAL_ENABLE_AUTO_CONVERT_MODAL,i,(function(t){if(t){var a=t.trial_price_conversions;a[r.ScheduleId.MONTHLY]&&a[r.ScheduleId.YEARLY]||(f.Notify.error(_.intl.formatMessage({id:"C2BKnZ",defaultMessage:"Failed to load modal."})),e.closeModals()),e.setState({loadingContent:!1,type:n,trialPriceConversions:a})}}),(function(){f.Notify.error(_.intl.formatMessage({id:"C2BKnZ",defaultMessage:"Failed to load modal."})),e.closeModals()}))},P.prototype.doneSubmittingRequest=function(){this.setState((function(e){return a.__assign(a.__assign({},e),{submitting:!1})}))},Object.defineProperty(P.prototype,"scheduleTransitionText",{get:function(){var e=this.state,t=e.trialPriceConversions,a=e.finalBillingScheduleId,o=t[a.toString()],i=a===r.ScheduleId.MONTHLY?"month":"year",s=_.intl.formatMessage({id:"OUUNz7",defaultMessage:"I agree to the <link>Dropbox Terms</link> and the <strong>Automatic Renewal Terms</strong> above"},{link:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.default.createElement("a",{"aria-label":_.intl.formatMessage({id:"zmINZ0",defaultMessage:"terms"}),className:"terms-info__tos--terms-link",href:"#",key:"link_dbx",onClick:l.logClickAndOpenTab("de_terms_link_click","/terms",{from:"add_schedule_modal"})},e)},strong:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.default.createElement("strong",null,e)}}),d=n.default.createElement("span",null,s);return n.default.createElement("div",null,n.default.createElement("span",{className:"change-summary"},_.intl.formatMessage({id:"38ZvV3",defaultMessage:"Purchase summary"})),n.default.createElement("p",{className:"plan-transition"},_.intl.formatMessage({id:"Ufvtdi",defaultMessage:"Your trial ends on {date}. If you don’t <cancelLink>cancel</cancelLink> your free trial by that date, we’ll charge you {scheduled_total} per {schedule} (including applicable taxes) until you cancel your plan. If you have any charges after your trial, they <refundLink>won’t be refunded</refundLink> when you <downgradeLink>cancel</downgradeLink>, <legalLink>unless it’s legally required</legalLink>. All amounts shown are in {currency}."},{date:o.formatted_trial_end_date,schedule:i,scheduled_total:o.total_amount,currency:o.currency,strong:function(e){return n.default.createElement("strong",null,e)},cancelLink:function(e){return n.default.createElement("a",{"aria-label":_.intl.formatMessage({id:"lGpNw6",defaultMessage:"CancelLink"}),href:"#",onClick:l.logClickAndOpenTab("de_cancel_link_click","/help/accounts-billing/cancellations-refunds/cancel-free-trial",{from:"add_schedule_modal"})},e)},refundLink:function(e){return n.default.createElement("a",{"aria-label":_.intl.formatMessage({id:"WSrUNs",defaultMessage:"RefundLink"}),href:"#",onClick:l.logClickAndOpenTab("de_refund_link_click","/terms",{from:"add_schedule_modal"})},e)},downgradeLink:function(e){return n.default.createElement("a",{"aria-label":_.intl.formatMessage({id:"zuLHeg",defaultMessage:"DowngradeLink"}),href:"#",onClick:l.logClickAndOpenTab("de_downgrade_link_click","/help/accounts-billing/cancellations-refunds/downgrade-dropbox-plus-professional-plans",{from:"add_schedule_modal"})},e)},legalLink:function(e){return n.default.createElement("a",{"aria-label":_.intl.formatMessage({id:"enHZxv",defaultMessage:"LegalLink"}),href:"#",onClick:l.logClickAndOpenTab("de_legal_link_click","/help/accounts-billing/payments-billing/refund",{from:"add_schedule_modal"})},e)}})),n.default.createElement(g.LabeledCheckboxInput,{checked:this.state.termsChecked,onChange:this.onTermsCheck,labelText:d,name:"terms-checkbox",className:"billing-terms-and-service",errorText:this.getTermsErrorString()}))},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"acceptButtonDisabled",{get:function(){var e=this.state,t=e.loadingContent,a=e.submitting;return t||a},enumerable:!1,configurable:!0}),P.prototype.render=function(){var e,t=this.state,a=t.loadingContent,i=t.trialPriceConversions,l=t.finalBillingScheduleId,r=t.type,s=_.intl.formatMessage({id:"nRgwkK",defaultMessage:"Step 2/2: choose your billing period"});e=a?n.default.createElement("div",{className:"loading-indicator"},n.default.createElement("img",{src:m.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:_.intl.formatMessage({id:"jybGUg",defaultMessage:"Loading"})})):n.default.createElement("div",null,n.default.createElement("div",null,n.default.createElement(v.NptBillingScheduleItems,{trialPriceConversions:i,finalBillingScheduleId:l,planName:r,changeProductScheduleType:this.changeProductScheduleType})),n.default.createElement("div",{className:"plan-footer u-font-meta"},this.scheduleTransitionText));var g=o.default("change-plan-modal");return n.default.createElement(c.Modal,{overlayClassName:g,open:this.state.isOpen,isCentered:!0,withCloseButton:_.intl.formatMessage({id:"11bV9n",defaultMessage:"Cancel"}),shouldCloseOnOverlayClick:!1,onRequestClose:this.onDismissModal,onAfterClose:u.Modal.close},n.default.createElement(c.Modal.Header,{hasBottomSpacing:"title-standard"},n.default.createElement(p.Title,{isBold:!1,size:"small"},s)),n.default.createElement(c.Modal.Body,{hasVerticalSpacing:!0},e),n.default.createElement(c.Modal.Footer,{hasTopBorder:!0},n.default.createElement(d.Button,{variant:"secondary",onClick:this.onDismissModal},_.intl.formatMessage({id:"dqvpHx",defaultMessage:"Cancel"})),n.default.createElement(d.Button,{className:"confirm-purchase-button",disabled:this.acceptButtonDisabled,variant:"primary",onClick:this.onAccept},_.intl.formatMessage({id:"/w1aTc",defaultMessage:"Confirm purchase"}))))},P.AddScheduleModal=s.requireCssWithComponent(P,["/static/css/teams/admin/widgets/add_schedule_modal/add_schedule_modal-vflzjyX-t.css"]),P.displayName="AddScheduleModalView",P})(n.default.Component);t.AddScheduleModalView=P})),define("modules/clean/account_page/widgets/plan/views/addons/addon_info_component",["require","exports","tslib","react","styled-components","modules/core/i18n","modules/clean/analytics","dig-components/buttons","dig-components/icons","dig-components/icons/src","modules/clean/account_page/widgets/plan/views/addons/strings"],(function(e,t,a,n,o,i,l,r,s,d,c){"use strict";var u,p,m,_,g,f;Object.defineProperty(t,"__esModule",{value:!0}),t.AddonInfoComponent=t.AddonDropdown=t.AddonCTA=t.AddonDescription=t.AddonTitle=t.AddonDetailsContainer=t.AddonContainer=void 0,n=a.__importDefault(n),o=a.__importDefault(o),t.AddonContainer=o.default.div(u||(u=a.__makeTemplateObject(["\n  margin-bottom: 32px;\n  margin-top: 0px;\n  font-size: var(--type__body__standard--fontsize);\n  display: flex;\n  justify-content: space-between;\n  min-width: 500px;\n"],["\n  margin-bottom: 32px;\n  margin-top: 0px;\n  font-size: var(--type__body__standard--fontsize);\n  display: flex;\n  justify-content: space-between;\n  min-width: 500px;\n"]))),t.AddonDetailsContainer=o.default.div(p||(p=a.__makeTemplateObject(["\n  margin-right: 48px;\n"],["\n  margin-right: 48px;\n"]))),t.AddonTitle=o.default.p(m||(m=a.__makeTemplateObject(["\n  margin-bottom: var(--spacing__unit--2);\n  color: var(--color__standard__text);\n"],["\n  margin-bottom: var(--spacing__unit--2);\n  color: var(--color__standard__text);\n"]))),t.AddonDescription=o.default.p(_||(_=a.__makeTemplateObject(["\n  margin-bottom: 0;\n  color: var(--color__faint__text);\n  line-height: var(--type__body__standard--lineheight);\n  width: 100%;\n  box-sizing: border-box;\n"],["\n  margin-bottom: 0;\n  color: var(--color__faint__text);\n  line-height: var(--type__body__standard--lineheight);\n  width: 100%;\n  box-sizing: border-box;\n"]))),t.AddonCTA=o.default.div(g||(g=a.__makeTemplateObject(["\n  display: flex;\n  align-items: self-end;\n"],["\n  display: flex;\n  align-items: self-end;\n"]))),t.AddonDropdown=o.default.div(f||(f=a.__makeTemplateObject(["\n  display: flex;\n  align-items: center;\n  color: var(--color__standard__text);\n  margin-bottom: 32px;\n"],["\n  display: flex;\n  align-items: center;\n  color: var(--color__standard__text);\n  margin-bottom: 32px;\n"]))),t.AddonInfoComponent=function(e){var a,o=e.addonInfo,u=e.addonIndex,p=e.addonButton,m=e.addonSectionStatus,_=e.addonsInfoMinimized,g=e.showButton,f=e.showPrice,h=e.defaultAddonsToShow,y=e.billingSchedule,b=e.updateMinimizedState,v=i.intl.formatMessage({id:"vAUdR2",defaultMessage:"View all add-ons"}),P=o.name,M=o.description,S=o.formatted_total_amount,E=o.is_license_based,C=(f?c.getPaidAddonBillingSummary(S,E,y)+" ":"")+M,T=u===h&&_;return u<h||u>=h&&!_?a=n.default.createElement(t.AddonContainer,null,n.default.createElement(t.AddonDetailsContainer,null,n.default.createElement(t.AddonTitle,{"data-testid":"plan-status-addon-title"},P),n.default.createElement(t.AddonDescription,{"data-testid":"plan-status-addon-addonDescription"},C)),n.default.createElement(t.AddonCTA,null,g&&p)):T&&(a=n.default.createElement(t.AddonDropdown,null,n.default.createElement(s.UIIcon,{size:"standard",src:d.ChevronDownLine}),n.default.createElement(r.Button,{variant:"transparent",className:"jest-addons-info-dropdown-cta",size:"standard",onClick:function(){b(),l.ProEventsLogger.log("addons_showall",{addon_status:m})}},v))),n.default.createElement("div",{key:u,className:"jest-addons-info-section"},a)},t.AddonInfoComponent.displayName="AddonInfoComponent"})),define("modules/clean/account_page/widgets/plan/views/addons/addon_management_modal",["require","exports","tslib","react","modules/core/browser","dig-components/typography","modules/core/notify","modules/clean/account_page/widgets/plan/views/change_confirmation_modal","modules/clean/account_page/widgets/plan/add_ons/api","modules/clean/react/components/modal","modules/clean/active_user","modules/clean/analytics","modules/core/i18n","modules/clean/account_page/widgets/plan/api","modules/clean/react/payments/update_individual_billing/update_individual_billing_modal_loader","modules/clean/react/payments/error/browser_update_required_modal","modules/clean/account_page/widgets/plan/views/update_billing_info","modules/clean/dbmodal_stack","modules/clean/react/payments/update_individual_billing/update_individual_store_creator","modules/clean/payments/three_ds_helper","modules/clean/account_page/widgets/plan/views/individual_inline_payment_method","modules/clean/account_page/widgets/plan/views/addons/strings","modules/clean/account_page/widgets/plan/views/addons/constants"],(function(e,t,a,n,o,i,l,r,s,d,c,u,p,m,_,g,f,h,y,b,v,P,M){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AddonManagementModal=void 0,n=a.__importDefault(n),o=a.__importStar(o);var S=(function(e){function t(a){var n=e.call(this,a)||this;return n.updateThreeDsData=function(e){n.threeDsData=e},n.onAccept=function(){n.setState({submitting:!0});var e=n.props,t=e.addonInfo,a=e.isAddition,i=e.onAddonUpdate,r="personal"===n.currentUser.role?M.AddonRedirectPath.ACCOUNT_PAGE:M.AddonRedirectPath.BILLING_PAGE,d=a?"addon_purchase_confirm":"addon_remove_confirm";u.ProEventsLogger.log(d,{addon_family:t.addon_family});var c={offering_id:t.offering_id,is_addition:a,preview_request_token:n.previewResult.preview_request_token,redirect_path:r,browser_info:b.collectBrowserInfo(),three_ds_data:n.threeDsData};s.performAddonTransition(n.currentUser.role,n.currentUser.id,c).then((function(e){if(e.change_completed)return i();if(e.redirect_url&&o.redirect(e.redirect_url),e.three_ds_error_data&&n.threeDsMessageHandler){var t=JSON.parse(e.three_ds_error_data);n.threeDsMessageHandler(t)}})).catch((function(e){l.Notify.error(e.message)})).finally((function(){n.setState({submitting:!1}),n.updateThreeDsData(""),n.closeModal()}))},n.onCancel=function(){var e=n.props.isAddition?"addon_purchase_cancel":"addon_remove_cancel";u.ProEventsLogger.log(e,{addon_family:n.props.addonInfo.addon_family}),n.closeModal()},n.closeModal=function(){n.setState({open:!1}),d.Modal.close()},n.onCancelSubscriptionLinkClick=function(){o.open_tab("https://help.dropbox.com/accounts-billing/cancellations-refunds/downgrade-dropbox-plus-professional-plans")},n.onRefundLinkClick=function(){o.open_tab("https://help.dropbox.com/accounts-billing/payments-billing/refund")},n.updateBillingInfo=function(e){n.closeModal(),h.DBModalStack.register(y.BILLING_INFO_UPDATED,(function(){m.resetApolloStore(),t.showInstance(n.props)})),n.props.browserUpdateRequired?g.BrowserUpdateModalLoader.showInstance():_.IndividualUpdateBillingModalLoader.showInstance()},n.currentUser=c.mustGetActiveUser(),n.threeDsData="",n.state={open:!0,loadingContent:!0,submitting:!1},n}return a.__extends(t,e),t.showInstance=function(e){d.Modal.showInstance(n.default.createElement(t,a.__assign({},e)))},t.prototype.componentDidMount=function(){var e=this,t=this.props,a=t.isAddition,n=t.addonInfo,o=t.trigger,i=a?"addon_purchase_view":"addon_remove_view";u.ProEventsLogger.log(i,{addon_family:n.addon_family,refer_parameters:o});var r={offering_id:n.offering_id,is_addition:a};s.getAddonTransitionPreview(this.currentUser.role,this.currentUser.id,r).then((function(t){var a=new b.ThreeDsHandler({updateThreeDsData:e.updateThreeDsData,submitThreeDsChallenge:e.onAccept,triggerThreeDsChallenge:function(){},submitThreeDsFingerprint:e.onAccept,triggerThreeDsFingerprint:function(){},isDesktop:!1,isSeleniumChangesTest:!1});e.threeDsMessageHandler=a.handle3DsMessage,e.previewResult=t})).catch((function(t){l.Notify.error(t.message),e.closeModal()})).finally((function(){e.setState({loadingContent:!1})}))},t.prototype.getPaymentInfo=function(){var e=this.previewResult,t=e.active_payment_method_type,a=e.last_digits;if(t){var o={active_payment_method_type:t[".tag"],last_digits:a};return n.default.createElement(v.IndividualInlinePaymentMethodView,{accountPaymentInfo:o})}},t.prototype.getDescription=function(){var e=this;if(this.state.loadingContent)return"";var t=this.props,a=t.isAddition,o=t.addonInfo,l=t.totalQuota,r=t.planQuota,s=t.billingSchedule,d=t.formattedAddonAttribute,c=o.name,u=o.description,m=o.addon_family,_=this.previewResult,g=_.upcoming_bill_date,h=_.upcoming_bill_total_price,y=_.upcoming_bill_addon_price,b=_.current_bill_addon_price,v=_.total_includes_taxes,S=_.last_digits,E=p.intl.formatMessage({id:"69RiKK",defaultMessage:"{price} (taxes included)"},{price:h}),C=v?E:h,T=a?M.AddonTransitionType.ADD:M.AddonTransitionType.REMOVE,A=P.getAddonDescription(m,T),w=P.getAddonLegalDescription(T);return n.default.createElement("div",null,n.default.createElement(i.Text,null,p.intl.formatMessage(A,{addon_name:c,addon_description:u,schedule_noun:null==s?void 0:s.scheduleDescriptionNoun,upcoming_addon_price:y,addon_quota:d,addon_retention:d,total_quota:l,plan_quota:r})),n.default.createElement(i.Text,{size:"small",color:"faint"},p.intl.formatMessage(w,{br:n.default.createElement("br",null),schedule:null==s?void 0:s.scheduleDescriptionAdjective,schedule_noun:null==s?void 0:s.scheduleDescriptionNoun,current_addon_price:b,upcoming_addon_price:y,next_billing_date:g,new_total:C,payment_info:this.getPaymentInfo(),last_digits:S,cancelSubscriptionLink:function(t){return n.default.createElement(i.Link,{href:"#","aria-label":p.intl.formatMessage({id:"vMob1H",defaultMessage:"Link to cancel subscription help article."}),onClick:e.onCancelSubscriptionLinkClick,hasNoUnderline:!0},t)},refundLink:function(t){return n.default.createElement(i.Link,{href:"#","aria-label":p.intl.formatMessage({id:"U8EUPD",defaultMessage:"Link to refund help article"}),onClick:e.onRefundLinkClick,hasNoUnderline:!0},t)},updateBillingInfoLink:n.default.createElement(f.UpdateBillingInfoLink,{updateBillingCTA:this.updateBillingInfo})})))},t.prototype.render=function(){var e=this.props,t=e.isAddition,a=e.addonInfo,o=this.state,i=o.open,l=o.loadingContent,s=o.submitting,d=p.intl.formatMessage(P.getAddonTitle(t),{addon_name:a.name}),c=p.intl.formatMessage({id:"v9SfkL",defaultMessage:"Confirm"}),u=p.intl.formatMessage({id:"uVzYam",defaultMessage:"Cancel"});return n.default.createElement(r.ChangeConfirmationModal,{acceptButtonDisabled:s,acceptButtonText:c,description:this.getDescription(),dismissButtonText:u,loadingContent:l,onAccept:this.onAccept,onDismiss:this.onCancel,open:i,submitting:s,title:d})},t.displayName="AddonManagementModal",t})(n.default.Component);t.AddonManagementModal=S})),define("modules/clean/account_page/widgets/plan/views/addons/addon_section",["require","exports","tslib","react","modules/core/i18n","dig-components/buttons","modules/clean/account_page/widgets/plan/views/addons/addon_info_component","modules/clean/account_page/widgets/plan/views/addons/utils","modules/clean/account_page/widgets/plan/views/addons/constants","modules/clean/account_page/components/key_value_block"],(function(e,t,a,n,o,i,l,r,s,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AddonSection=void 0,n=a.__importStar(n),t.AddonSection=function(e){var t=n.useState(!0),a=t[0],c=t[1],u=function(){c(!1)},p=e.addonSectionStatus,m=e.addonsInfo,_=e.addonsLoadingState,g=e.billingSchedule,f=e.browserUpdateRequired,h=e.onAddonUpdate;if("ready"!==_||!(null==m?void 0:m.length))return null;if(p===s.AddonSectionStatus.CURRENT){var y=e.formattedSpecQuotaGb,b=e.totalQuota;r.logAddonsView(m,p);var v=o.intl.formatMessage({id:"bnNVIg",defaultMessage:"Remove"}),P=m.map((function(t,o){var d=n.default.createElement(i.Button,{variant:"transparent",className:"plan-status-section__remove-addon-button",onClick:function(){return r.openAddonManagementModal(t,s.AddonManagementModalTrigger.BUTTON,!1,h,g,f,y,b)}},v),c=(function(t){var a,n,o=e.isPersonalUser,i=e.eligibleFor1tb,l=e.onlyShowDescription,r=t.is_paid_addon&&!t.scheduled_to_remove;return o?(a=r,n=r&&!i):(a=r&&!l,n=r&&!l),{showPrice:a,showButton:n}})(t),m=c.showPrice,_=c.showButton;return n.default.createElement(l.AddonInfoComponent,{key:"current-addon-"+o,addonIndex:o,addonInfo:t,addonButton:d,addonSectionStatus:p,billingSchedule:g,addonsInfoMinimized:a,showButton:_,showPrice:m,defaultAddonsToShow:2,updateMinimizedState:u})}));return n.default.createElement("div",{className:"account-addons-section"},P)}var M=e.isSubscriptionMgmtAddonsRollout,S=e.inGracePeriod;if(!M)return null;r.logAddonsView(m,p);var E=o.intl.formatMessage({id:"ZkhfIA",defaultMessage:"Add"}),C=m.map((function(e,t){var o=n.default.createElement(i.Button,{variant:"transparent",className:"plan-status-section__add-addon-button",onClick:function(){return r.openAddonManagementModal(e,s.AddonManagementModalTrigger.BUTTON,!0,h,g,f)},disabled:S},E);return n.default.createElement(l.AddonInfoComponent,{key:"available-addon-"+t,addonIndex:t,addonInfo:e,addonButton:o,addonSectionStatus:p,billingSchedule:g,addonsInfoMinimized:a,showButton:!0,showPrice:!0,defaultAddonsToShow:1,updateMinimizedState:u})}));return n.default.createElement("div",{className:"account-plan-section addons-section"},n.default.createElement(d.KeyValueBlock,{className:"zero_padding",keyText:o.intl.formatMessage({id:"lfz3xn",defaultMessage:"Available add-ons"})}),n.default.createElement("div",{className:"account-addons-section"},C))},t.AddonSection.displayName="AddonSection"})),define("modules/clean/account_page/widgets/plan/views/addons/constants",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AddonTransitionType=t.AddonSectionStatus=t.AddonRedirectPath=t.AddonManagementModalTrigger=void 0,(function(e){e.BUTTON="button",e.QUERY_PARAM="query_param"})(t.AddonManagementModalTrigger||(t.AddonManagementModalTrigger={})),(function(e){e.ACCOUNT_PAGE="/account/plan",e.BILLING_PAGE="/team/admin/billing"})(t.AddonRedirectPath||(t.AddonRedirectPath={})),(function(e){e.CURRENT="current",e.AVAILABLE="available"})(t.AddonSectionStatus||(t.AddonSectionStatus={})),(function(e){e.ADD="Add",e.REMOVE="Remove"})(t.AddonTransitionType||(t.AddonTransitionType={}))})),define("modules/clean/account_page/widgets/plan/views/addons/strings",["require","exports","react-intl","modules/core/i18n","modules/clean/account_page/widgets/plan/types","modules/clean/ts_utils","modules/clean/account_page/widgets/plan/views/addons/constants"],(function(e,t,a,n,o,i,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPaidAddonBillingSummary=t.getAddonLegalDescription=t.getAddonDescription=t.getAddonTitle=t.ADDON_STRINGS=void 0,t.ADDON_STRINGS=a.defineMessages({ADD_ADDON_TITLE:{id:"7WmcLH",defaultMessage:"Add {addon_name}"},REMOVE_ADDON_TITLE:{id:"P2d7hJ",defaultMessage:"Remove {addon_name}"},BILLING_SUMMARY:{id:"utV4HI",defaultMessage:"{price} per {period}."},LICENSE_BILLING_SUMMARY:{id:"mNQboU",defaultMessage:"{price} per license per {period}."},EVH_ADD:{id:"frV3Nx",defaultMessage:"You're buying {addon_retention} file recovery and version history for {upcoming_addon_price} per {schedule_noun}, which applies to any file deleted or modified after purchase."},EVH_REMOVE:{id:"EZeHar",defaultMessage:"When you remove Extended Version History, you will lose access to {addon_retention} file recovery and version history."},QUOTA_ADD:{id:"pM2UbV",defaultMessage:"You're buying {addon_quota} of additional storage space for {upcoming_addon_price} per {schedule_noun}."},QUOTA_REMOVE:{id:"rACkS4",defaultMessage:"Your storage space will decrease from {total_quota} to {plan_quota}. If you've used over {plan_quota} of storage space, Dropbox will stop syncing files to your devices."},LEGAL_HOLD_REMOVE:{id:"LDxrjw",defaultMessage:"When you remove Data Governance, you will lose access to compliance and audit support tools."},PREMIUM_SUPPORT_REMOVE:{id:"JXecv3",defaultMessage:"When you remove Premium Support, your team members will lose access to enhanced customer support."},MEDIA_REMOVE:{id:"4MOAh3",defaultMessage:"When you remove Media Creative tools, you will lose access to simplified media support tools."},API_RATE_REMOVE:{id:"6VfUNX",defaultMessage:"When you remove Unlimited API Call Rate, you will lose access to unlimited API calls."},LEGAL_ADD:{id:"S3fgQV",defaultMessage:"{br}{br}When you click confirm, we'll charge you {current_addon_price} now, which is prorated for the current billing period. Starting on {next_billing_date} your {schedule} subscription will increase by {upcoming_addon_price} and your new {schedule} total will be {new_total} until you <cancelSubscriptionLink>cancel</cancelSubscriptionLink>. If you cancel, previous charges won't be refunded <refundLink>unless it's legally required</refundLink>.{br}{br}{payment_info} {updateBillingInfoLink}."},LEGAL_REMOVE:{id:"I1A5yW",defaultMessage:"{br}{br}By clicking Confirm, your {schedule} subscription will decrease by {upcoming_addon_price} per {schedule_noun} on {next_billing_date}, and your subscription will be {new_total} per {schedule_noun}."}}),t.getAddonTitle=function(e){return e?t.ADDON_STRINGS.ADD_ADDON_TITLE:t.ADDON_STRINGS.REMOVE_ADDON_TITLE},t.getAddonDescription=function(e,a){switch(e){case o.ProductAddonType.EVH:return a===l.AddonTransitionType.ADD?t.ADDON_STRINGS.EVH_ADD:t.ADDON_STRINGS.EVH_REMOVE;case o.ProductAddonType.QUOTA:return a===l.AddonTransitionType.ADD?t.ADDON_STRINGS.QUOTA_ADD:t.ADDON_STRINGS.QUOTA_REMOVE;case o.ProductAddonType.LEGAL_HOLD:return t.ADDON_STRINGS.LEGAL_HOLD_REMOVE;case o.ProductAddonType.PREMIUM_SUPPORT:return t.ADDON_STRINGS.PREMIUM_SUPPORT_REMOVE;case o.ProductAddonType.MEDIA:return t.ADDON_STRINGS.MEDIA_REMOVE;case o.ProductAddonType.API_RATE:return t.ADDON_STRINGS.API_RATE_REMOVE;default:return i.enforceExhaustive(e)}},t.getAddonLegalDescription=function(e){return e===l.AddonTransitionType.ADD?t.ADDON_STRINGS.LEGAL_ADD:t.ADDON_STRINGS.LEGAL_REMOVE},t.getPaidAddonBillingSummary=function(e,a,o){var i="";if(null==o?void 0:o.scheduleDescriptionNoun){var l=a?t.ADDON_STRINGS.LICENSE_BILLING_SUMMARY:t.ADDON_STRINGS.BILLING_SUMMARY;i=n.intl.formatMessage(l,{price:e,period:o.scheduleDescriptionNoun})}return i}})),define("modules/clean/account_page/widgets/plan/views/addons/utils",["require","exports","tslib","modules/clean/display_format","modules/clean/account_page/widgets/plan/types","modules/clean/analytics","modules/clean/account_page/widgets/plan/views/addons/addon_management_modal"],(function(e,t,a,n,o,i,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatQuota=t.getAddonAttribute=t.isAddonUpdateIncludedWithLicenseChange=t.addonScheduledForRemoval=t.logAddonsView=t.openAddonManagementModal=void 0,t.openAddonManagementModal=function(e,a,n,o,r,s,d,c){var u={addon_family:e.addon_family,trigger:a};n?i.ProEventsLogger.log("addon_add_click",u):i.ProEventsLogger.log("addon_remove_click",u);var p=t.getAddonAttribute(e);l.AddonManagementModal.showInstance({addonInfo:e,trigger:a,isAddition:n,billingSchedule:r,onAddonUpdate:o,formattedAddonAttribute:p,browserUpdateRequired:s,planQuota:d,totalQuota:t.formatQuota(c)})},t.logAddonsView=function(e,t){var n={};e.forEach((function(e,t){return n["addon_family_"+t]=e.addon_family})),i.ProEventsLogger.log("addons_view",a.__assign(a.__assign({},n),{addon_status:t}))},t.addonScheduledForRemoval=function(e,t){for(var a=0,n=t;a<n.length;a++){var o=n[a];if(e.productType===o.productType)return!1}return!0},t.isAddonUpdateIncludedWithLicenseChange=function(e,a,n){if(a&&e&&n)for(var o=e.addons.skus,i=a.addons.skus,l=0,r=o;l<r.length;l++){var s=r[l];if(s.isLicenseBased&&!t.addonScheduledForRemoval(s,i))return!0}return!1},t.getAddonAttribute=function(e){var t=e.addon_attribute;switch(e.addon_family){case o.ProductAddonType.EVH:if(null==t?void 0:t.vacuuming_policy_max_days)return null==t?void 0:t.vacuuming_policy_max_days;break;case o.ProductAddonType.QUOTA:if(null==t?void 0:t.quota_gb)return n.formatGigabytes(t.quota_gb,2,!0,!0)}return""},t.formatQuota=function(e){return e?n.format_bytes(e,2,!0,!0,!1):""}})),define("modules/clean/account_page/widgets/plan/views/basic_plan_status",["require","exports","tslib","react","modules/core/browser","styled-components","modules/core/i18n","modules/clean/static_urls","modules/clean/analytics","modules/constants/trademark","dig-components/typography","dig-components/buttons","modules/clean/hql/index","dropbox/proto/hql_events/revenue/revenue","dropbox/proto/hql_events/extensions","dropbox/proto/hql_events/taxonomy"],(function(e,t,a,n,o,i,l,r,s,d,c,u,p,m,_,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BasicPlanStatusSection=void 0,n=a.__importDefault(n),o=a.__importStar(o),i=a.__importDefault(i);var f,h,y,b,v,P,M=g.hql_events.TaxonomyAppSurface.AppSurface,S=g.hql_events.TaxonomyActionSurface.ActionSurface,E=i.default.div(f||(f=a.__makeTemplateObject(["\n  flex-basis: 140px;\n  text-align: right;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n"],["\n  flex-basis: 140px;\n  text-align: right;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n"]))),C=i.default.div(h||(h=a.__makeTemplateObject(["\n  width: 36px;\n  margin: 0 var(--spacing__unit--2) auto var(--spacing__base_unit);\n  height: 69px;\n"],["\n  width: 36px;\n  margin: 0 var(--spacing__unit--2) auto var(--spacing__base_unit);\n  height: 69px;\n"]))),T=i.default.div(y||(y=a.__makeTemplateObject(["\n  display: flex;\n  padding-top: var(--spacing__unit--2);\n"],["\n  display: flex;\n  padding-top: var(--spacing__unit--2);\n"]))),A=i.default.div(b||(b=a.__makeTemplateObject(["\n  flex-grow: 1;\n  color: var(--color__faint__text);\n  font-size: var(--type__body__small--fontsize);\n  line-height: var(--type__body__large--lineight);\n"],["\n  flex-grow: 1;\n  color: var(--color__faint__text);\n  font-size: var(--type__body__small--fontsize);\n  line-height: var(--type__body__large--lineight);\n"]))),w=i.default(c.Title)(v||(v=a.__makeTemplateObject(["\n  font-size: var(--type__body__large--fontsize);\n  margin-bottom: 0;\n  color: var(--color__standard__text);\n"],["\n  font-size: var(--type__body__large--fontsize);\n  margin-bottom: 0;\n  color: var(--color__standard__text);\n"]))),I=i.default(u.Button)(P||(P=a.__makeTemplateObject(["\n  .plan-status-section__link--inline {\n    font-style: italic;\n  }\n"],["\n  .plan-status-section__link--inline {\n    font-style: italic;\n  }\n"])));t.BasicPlanStatusSection=function(e){var t=e.planName,a=void 0===t?d.DROPBOX_BASIC:t,i=e.plansUrl,c=void 0===i?"/plans?oqa=acc_general_upgrade":i,f=e.limitedTeam,h=e.hidePlansLink,y=e.hideUpgradeButton,b=e.upgradePlanButton;return b||(b=n.default.createElement(E,{className:"plan-status-section__upgrade_btn"},n.default.createElement(u.Button,{variant:"primary",size:"standard",role:"link",onClick:function(){var e;e=_.hql_events.HQLEventIdentity.create({eventClass:_.hql_events.HQLEventIdentity.EventClass.create({className:g.hql_events.TaxonomyClass.ClassName.SEE_AND_CLICK}),legacyEvent:_.hql_events.HQLEventIdentity.LegacyEvent.create({table:"pro_events",name:"de_general_tab_upgrade_to_plus_click"}),actionEventId:_.hql_events.HQLEventIdentity.ActionEventIdentity.create({object:"basic_upgrade_button",action:g.hql_events.TaxonomyAction.Action.SELECT})}),p.logEvent(m.hql_events.SelectBasicUpgradeButton.create({hqlMetadata:_.hql_events.HQLMetadata.create({appSurface:M.WEB,actionSurface:S.CENTER_PANE_GENERAL_TAB,identityOverride:e})})),s.ProEventsLogger.log("de_general_tab_upgrade_to_plus_click",{},(function(){o.redirect("/upgrade?oqa=acc_general_upgrade")}))},className:"jest-upgrade-plan-button"},l.intl.formatMessage({id:"7/M9u2",defaultMessage:"Upgrade"})))),n.default.createElement(n.default.Fragment,null,n.default.createElement("div",{className:"plan-status-section__infohead account-plan-section__title"},l.intl.formatMessage({id:"7Fz7qP",defaultMessage:"Current plan"})),n.default.createElement(T,{className:"plan-status-section has-no-border"},n.default.createElement(C,{className:"plan-status-section__icon"},n.default.createElement("img",{src:r.static_url("/static/images/logo_catalog/dropbox-business-icon_m1-vflczuza3.svg"),alt:l.intl.formatMessage({id:"ORB1Kv",defaultMessage:"See other plans"})})),n.default.createElement(A,{className:"plan-status-section__description"},n.default.createElement(w,{size:"small",isBold:!0,className:"plan-status-section__title"},a),f,!h&&n.default.createElement(I,{size:"small",className:"plan-status-section__link",variant:"transparent",onClick:function(){o.open_tab(c)},role:"link"},l.intl.formatMessage({id:"ORB1Kv",defaultMessage:"See other plans"}))),!y&&b))}})),define("modules/clean/account_page/widgets/plan/views/cancel_changes_modal",["require","exports","tslib","react","modules/clean/deprecated_ajax/ajax_jquery","modules/clean/account_page/widgets/plan/constants","modules/clean/account_page/constants","modules/clean/react/components/modal","modules/clean/analytics","modules/clean/payments/skus/constants","modules/clean/payments/skus/subscription_service","modules/constants/trademark","modules/core/i18n","modules/clean/dbmodal_stack","modules/clean/active_user","modules/core/notify","modules/clean/account_page/widgets/plan/views/change_confirmation_modal","api_v2/user_client","modules/clean/payments/skus/billing_schedule","modules/core/exception","modules/clean/account_page/widgets/plan/views/loading_view","modules/clean/subscription/tools/amp_logger"],(function(e,t,a,n,o,i,l,r,s,d,c,u,p,m,_,g,f,h,y,b,v,P){"use strict";var M;Object.defineProperty(t,"__esModule",{value:!0}),t.CancelChangesModalConfirmationView=void 0,n=a.__importDefault(n),o=a.__importStar(o),(function(e){e[e.NeverLoaded=0]="NeverLoaded",e[e.Loading=1]="Loading",e[e.Ready=2]="Ready"})(M||(M={}));var S=new Set([d.ProductFamily.PRO,d.ProductFamily.FAMILY]),E=(function(e){function t(t){var a=e.call(this,t)||this;return a.onAccept=function(){var e=a.props,t=e.cancellationType,n=e.addonFamilyType;a.cancelScheduledChange(t,n)},a.closeModals=function(){var e=a.props.onClose;e&&e(),a.setState({open:!1})},a.handleWrongPlanError=function(e,t){b.reportException({err:new Error("Current user plan (id: "+e+", family: "+t+") is invalid for cancel_changes_modal"),severity:b.SEVERITY.CRITICAL})},a.getDisplayName=function(e,t){if(e&&t){if(S.has(t))return d.productPlanTypeToIndividualDisplayName(e);if(t===d.ProductFamily.TEAM)return d.productPlanTypeToBusinessDisplayName(e,t)}return a.handleWrongPlanError(e,t),""},a.loadDowngradeInfo=function(){a.setState({loadingDowngradeInfo:M.Loading}),(new h.UserApiV2Client).ns("growth").rpc("get_cancel_changes_info",void 0,{subjectUserId:_.mustGetActiveUserId()}).then((function(e){a.setState({loadingDowngradeInfo:M.Ready,downgradeInfo:{subState:e.sub_state,finalSubState:e.final_sub_state}})})).catch((function(){g.Notify.error(p.intl.formatMessage({id:"yhOAKQ",defaultMessage:"There was an issue cancelling your changes, please contact Customer Support."})),b.reportException({err:new Error("get_cancel_changes_info call failed for user attempting to cancel changes of type: "+a.props.cancellationType),severity:b.SEVERITY.CRITICAL}),a.modalLogger.logModalError("modal_init"),a.closeModals()}))},new c.SubscriptionService,a.state={loadingDowngradeInfo:M.NeverLoaded,submitting:!1,open:!0},a.modalLogger=P.getSubscriptionAMPLogger({ns:"personal",modal:P.ModalTypes.CANCEL_CHANGES_MODAL}),a}return a.__extends(t,e),t.showInstance=function(e){r.Modal.showInstance(n.default.createElement(t,a.__assign({},e)))},t.prototype.componentDidMount=function(){this.loadDowngradeInfo()},Object.defineProperty(t.prototype,"currentProductPlanType",{get:function(){var e,t;return null===(t=null===(e=this.state.downgradeInfo)||void 0===e?void 0:e.subState.product_plan_type)||void 0===t?void 0:t.toString()},enumerable:!1,configurable:!0}),t.prototype.submittingRequest=function(){this.setState((function(e){return a.__assign(a.__assign({},e),{submitting:!0})}))},t.prototype.doneSubmittingRequest=function(){this.setState((function(e){return a.__assign(a.__assign({},e),{submitting:!1})}))},t.prototype.cancelScheduledChange=function(e,t){var a=this,n=this.props,r=n.transitionPerformed,d=n.productLine,c=this.state.downgradeInfo;if(c){var u=c.subState,f=c.finalSubState;this.modalLogger.setProductPlanType(this.currentProductPlanType),this.submittingRequest();var h=y.getScheduleDescriptionAdjective(u.schedule_id),b=y.getScheduleDescriptionAdjective(f.schedule_id);o.WebRequest({url:"/account/ajax_cancel_scheduled_change",data:{scheduled_change_type:e,addon_family_type:t,product_line:d},subject_user:_.mustGetActiveUserId(),success:function(t){g.Notify.success(p.intl.formatMessage({id:"dC654w",defaultMessage:"You’ve cancelled your change!"})),e===l.CancellationType.SCHEDULE&&(s.ProEventsLogger.log("de_change_billing_cancel_change"),s.ProEventsLogger.log("scheduled_billing_change_prompt_click_confirmed",{cta:"cancel_change_confirm",currentBillingSchedule:h,nextBillingSchedule:b})),e===l.CancellationType.ADDON&&s.ProEventsLogger.log("de_addon_modal_cancel_change"),e===l.CancellationType.PLAN&&s.ProEventsLogger.log("scheduled_plan_change_prompt_click_confirmed",{cta:"cancel_change_confirm"}),a.modalLogger.logModalSuccess(),r&&r(),a.doneSubmittingRequest(),a.closeModals(),a.props.reOpenModalDialogAfterCancellation&&m.DBModalStack.trigger(i.CHANGE_IND_PLAN_MODAL_UPDATED,null)},error:function(){g.Notify.error(p.intl.formatMessage({id:"iQ7Rjk",defaultMessage:"Failed to cancel changes."})),a.modalLogger.logModalError("modal_submit"),a.doneSubmittingRequest(),a.closeModals(),a.props.reOpenModalDialogAfterCancellation&&m.DBModalStack.trigger(i.CHANGE_IND_PLAN_MODAL_UPDATED,null)}})}},t.prototype.render=function(){var e=this.props.cancellationType,t=this.state,a=t.open,o=t.submitting,i=t.downgradeInfo;if(t.loadingDowngradeInfo!==M.Ready||!i)return n.default.createElement(v.LoadingView,{className:"cancel_changes_modal__loading-indicator"});var r,s=i.subState,c=i.finalSubState,m=y.getScheduleDescriptionAdjective(c.schedule_id),_=this.getDisplayName(s.product_plan_type,s.product_family),g=this.getDisplayName(c.product_plan_type,c.product_family),h=p.intl.formatMessage({id:"G4ktGR",defaultMessage:"Confirm cancelling change"});switch(e){case l.CancellationType.PLAN:r=c.schedule_id===d.ScheduleId.YEARLY?p.intl.formatMessage({id:"1VHHGq",defaultMessage:"You’re cancelling your scheduled plan change. Your Dropbox {plan} plan will renew on <strong>{date}</strong> and you will be billed yearly."},{trademark_plus:u.TRADEMARK_PLUS,plan:_,date:s.next_billing_date,strong:function(e){return n.default.createElement("strong",null,e)}}):p.intl.formatMessage({id:"hOx+lQ",defaultMessage:"You’re cancelling your scheduled plan change. Your Dropbox {plan} plan will renew on <strong>{date}</strong> and you will be billed monthly."},{trademark_plus:u.TRADEMARK_PLUS,plan:_,date:s.next_billing_date,strong:function(e){return n.default.createElement("strong",null,e)}});break;case l.CancellationType.SCHEDULE:r=s.schedule_id===d.ScheduleId.YEARLY?p.intl.formatMessage({id:"U+lU7/",defaultMessage:"You’re cancelling your scheduled billing change. Your Dropbox {plan} plan will renew on <strong>{date}</strong> and you will be billed yearly."},{plan:g,date:s.next_billing_date,strong:function(e){return n.default.createElement("strong",null,e)}}):p.intl.formatMessage({id:"AtC6hy",defaultMessage:"You’re cancelling your scheduled billing change. Your Dropbox {plan} plan will renew on <strong>{date}</strong> and you will be billed monthly."},{plan:g,date:s.next_billing_date,strong:function(e){return n.default.createElement("strong",null,e)}});break;case l.CancellationType.ADDON:r=p.intl.formatMessage({id:"30QKkb",defaultMessage:"You’re cancelling your add-on changes. Your Dropbox {plan} plan will renew on <strong>{date}</strong> and you will be billed {schedule}."},{plan:g,date:s.next_billing_date,schedule:m,strong:function(e){return n.default.createElement("strong",null,e)}});break;case l.CancellationType.IND_SUBSCRIPTION:h=p.intl.formatMessage({id:"NCTtwj",defaultMessage:"Confirmation"}),r=p.intl.formatMessage({id:"ikAVu1",defaultMessage:"By confirming, your downgrade to Dropbox Basic will be cancelled."});break;case l.CancellationType.ALL:h=p.intl.formatMessage({id:"NCTtwj",defaultMessage:"Confirmation"}),r=p.intl.formatMessage({id:"AmEj2/",defaultMessage:"By confirming, all existing scheduled changes will be cancelled."});break;default:h=p.intl.formatMessage({id:"NCTtwj",defaultMessage:"Confirmation"}),r=p.intl.formatMessage({id:"kMZoFx",defaultMessage:"By confirming, the scheduled change will be cancelled."})}var b=p.intl.formatMessage({id:"BKISIV",defaultMessage:"Confirm"}),P=p.intl.formatMessage({id:"7VYYNS",defaultMessage:"Don’t cancel"});return n.default.createElement(f.ChangeConfirmationModal,{acceptButtonDisabled:o,acceptButtonText:b,description:r,dismissButtonText:P,loadingContent:!1,onAccept:this.onAccept,onDismiss:this.closeModals,open:a,submitting:o,title:h})},t.displayName="CancelChangesModalConfirmationView",t})(n.default.Component);t.CancelChangesModalConfirmationView=E})),define("modules/clean/account_page/widgets/plan/views/cancel_subs_warning_modal",["require","exports","tslib","modules/clean/deprecated_ajax/ajax_jquery","modules/core/notify","react","modules/core/i18n","modules/clean/payments/skus/constants","modules/clean/active_user","modules/clean/account_page/constants","modules/clean/react/components/modal","modules/clean/account_page/widgets/plan/views/change_confirmation_modal","modules/clean/subscription/tools/amp_logger"],(function(e,t,a,n,o,i,l,r,s,d,c,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CancelChangesModalConfirmation=void 0,n=a.__importStar(n);var m=(function(e){function t(t){var a=e.call(this,t)||this;return a.closeModals=function(){a.setState({open:!1}),c.Modal.close()},a.onAccept=function(){var e=a.props,t=e.planType,n=e.onAccept;t===r.ProductPlanType.HS_DBX_PRO_BUNDLE?a.closeModals():a.cancelScheduledChange(),n&&n()},a.state={submitting:!1,open:!0},a}return a.__extends(t,e),t.showInstance=function(e){c.Modal.showInstance(i.default.createElement(t,a.__assign({},e)))},t.prototype.submittingRequest=function(){this.setState((function(e){return a.__assign(a.__assign({},e),{submitting:!0})}))},t.prototype.doneSubmittingRequest=function(){this.setState((function(e){return a.__assign(a.__assign({},e),{submitting:!1})}))},t.prototype.cancelScheduledChange=function(){var e,t,a,i=this,r=this.props,c=r.transitionPerformed,u=r.userIdOverride,m=p.getSubscriptionAMPLogger({ns:"personal",modal:p.ModalTypes.CANCEL_SUBS_WARNING_MODAL,productPlanType:null===(a=null===(t=null===(e=this.props.subStatus)||void 0===e?void 0:e.subState)||void 0===t?void 0:t.plan)||void 0===a?void 0:a.productType.toString()}),_=null;_=u||s.mustGetActiveUserId(),this.submittingRequest(),n.WebRequest({url:"/account/ajax_cancel_scheduled_change",data:{scheduled_change_type:d.CancellationType.IND_SUBSCRIPTION},subject_user:_,success:function(e){o.Notify.success(l.intl.formatMessage({id:"dC654w",defaultMessage:"You’ve cancelled your change!"})),c&&c(),m.logModalSuccess(),i.doneSubmittingRequest(),i.closeModals()},error:function(){o.Notify.error(l.intl.formatMessage({id:"iQ7Rjk",defaultMessage:"Failed to cancel changes."})),m.logModalError("modal_submit"),i.doneSubmittingRequest(),i.closeModals()}})},t.prototype.render=function(){var e=this.props,t=e.planType,a=e.subStatus,n=this.state,o=n.submitting,s=n.open;if(!a)return i.default.createElement("noscript",null);var d=(function(e){if(e===r.ProductPlanType.SYNC_EVERYTHING)return{title:l.intl.formatMessage({id:"yOnuCE",defaultMessage:"All set."}),getDescription:function(e){return l.intl.formatMessage({id:"muP0dn",defaultMessage:"You’ll have access to your plan until <strong>{date}</strong>. After that, your backup will remain available but it’ll be limited to the 2 GB storage quota of the Dropbox Basic plan. If you exceed your quota, automatic backups will stop."},{date:e,strong:function(e){return i.default.createElement("strong",null,e)}})},acceptButtonText:l.intl.formatMessage({id:"bGzf4A",defaultMessage:"I changed my mind, keep Backup"}),dismissButtonText:l.intl.formatMessage({id:"eyC1rP",defaultMessage:"Close"})};if(e===r.ProductPlanType.HS_DBX_PRO_BUNDLE)return{title:l.intl.formatMessage({id:"RQS9wP",defaultMessage:"Are you sure you want to cancel?"}),getDescription:function(e,t){var a=t.dropboxDisplayName,n=t.spaceShortFormTb;return l.intl.formatMessage({id:"w/CLLG",defaultMessage:"If you cancel today, you’ll be moved to a free plan on <strong>{date}</strong>, and you’ll lose access to {current_plan} features including:{br}<ul><li>{space_quota} of Dropbox space</li><li>Unlimited eSignatures</li><li>Any saved templates</li></ul>"},{br:i.default.createElement("br",null),current_plan:a,date:e,li:function(e){return i.default.createElement("li",{style:{marginBottom:"var(--spacing__unit--1)"}},e)},strong:function(e){return i.default.createElement("strong",null,e)},space_quota:n,ul:function(e){return i.default.createElement("ul",{style:{paddingLeft:0,listStylePosition:"inside"}},e)}})},acceptButtonText:l.intl.formatMessage({id:"1wtgq1",defaultMessage:"Confirm cancel"}),dismissButtonText:l.intl.formatMessage({id:"ZyFp/R",defaultMessage:"Don’t cancel"})};return{title:l.intl.formatMessage({id:"Au8OeU",defaultMessage:"Plan downgrade scheduled"}),getDescription:function(e){return l.intl.formatMessage({id:"tQTXOk",defaultMessage:"Your plan is scheduled to be downgraded to Dropbox Basic on <strong>{date}</strong>. If you want to make any changes, first cancel your scheduled downgrade."},{date:e,strong:function(e){return i.default.createElement("strong",null,e)}})},acceptButtonText:l.intl.formatMessage({id:"vhlPqJ",defaultMessage:"Cancel downgrade"}),dismissButtonText:l.intl.formatMessage({id:"DYOfu0",defaultMessage:"Dismiss"})}})(t),c=d.title,p=d.getDescription,m=d.acceptButtonText,_=d.dismissButtonText,g=a.subState.formattedNextBillingDate,f=(function(e){var t,a,n,o,i=(null===(a=null===(t=e.subState.plan)||void 0===t?void 0:t.content)||void 0===a?void 0:a.dropboxDisplayName())||"",l=(null===(o=null===(n=e.subState.plan)||void 0===n?void 0:n.content)||void 0===o?void 0:o.spaceShortFormTb())||"";return{dropboxDisplayName:i,spaceShortFormTb:l}})(a);return i.default.createElement(u.ChangeConfirmationModal,{acceptButtonDisabled:o,acceptButtonText:m,description:p(g,f),dismissButtonText:_,loadingContent:!1,onAccept:this.onAccept,onDismiss:this.closeModals,open:s,submitting:o,title:c})},t.displayName="CancelChangesModalConfirmation",t})((i=a.__importDefault(i)).default.Component);t.CancelChangesModalConfirmation=m})),define("modules/clean/account_page/widgets/plan/views/cancellable_notifications_view",["require","exports","tslib","react","classnames","styled-components","modules/clean/react/components/css","modules/core/i18n","modules/clean/account_page/widgets/billing/payment_methods_util","modules/clean/teams/admin/widgets/billing_notifications/cancellable_item","modules/clean/account_page/constants","modules/clean/payments/skus/constants","modules/constants/trademark","modules/clean/account_page/widgets/plan/views/cancel_changes_modal","modules/clean/analytics","api_v2/user_client","modules/clean/active_user","modules/clean/ts_utils"],(function(e,t,a,n,o,i,l,r,s,d,c,u,p,m,_,g,f,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CancellableNotificationsView=t.CancellableNotificationsViewControl=void 0,n=a.__importDefault(n),o=a.__importDefault(o);var y,b=(i=a.__importDefault(i)).default.div(y||(y=a.__makeTemplateObject(["\n  border-bottom: 1px solid var(--color__faint__background);\n"],["\n  border-bottom: 1px solid var(--color__faint__background);\n"]))),v=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={},t.getFamilyPayerScheduledChange=function(e){(new g.UserApiV2Client).ns("growth_plans").rpc("get_scheduled_change_family_manager",void 0,{subjectUserId:f.mustGetActiveUserId()}).then((function(a){t.setState({payerHasScheduledDowngrade:a.has_scheduled_plan_change,payerScheduledChangeDate:a.scheduled_change_date},e)}))},t.handleCancelSubscriptionAction=function(){t.handleCancelActions(c.CancellationType.IND_SUBSCRIPTION)},t.handleCancelPlanAction=function(){t.shouldLogScheduledProToPlusChange()&&_.ProEventsLogger.log("scheduled_plan_change_prompt_click",{cta:"cancel_change"}),t.handleCancelActions(c.CancellationType.PLAN)},t.handleCancelScheduleAction=function(){t.shouldLogScheduledBillingChange()&&_.ProEventsLogger.log("scheduled_billing_change_prompt_click",{cta:"cancel_change",currentBillingSchedule:t.props.subStatus.subState.billingSchedule.id===u.ScheduleId.MONTHLY?"monthly":"yearly",nextBillingSchedule:t.props.subStatus.scheduledSubState.billingSchedule.id===u.ScheduleId.MONTHLY?"monthly":"yearly"}),t.handleCancelActions(c.CancellationType.SCHEDULE)},t.handleCancelAddonAction=function(e){t.handleCancelActions(c.CancellationType.ADDON,e)},t.handleCancelActions=function(e,a){var n=t.props,o=n.subStatus,i=n.transitionPerformed,l=n.reOpenModalDialogAfterCancellation;o&&m.CancelChangesModalConfirmationView.showInstance({transitionPerformed:i,cancellationType:e,addonFamilyType:a,reOpenModalDialogAfterCancellation:l})},t}return a.__extends(t,e),t.prototype.componentDidMount=function(){var e,t,a=this;(null===(t=null===(e=this.props.subStatus)||void 0===e?void 0:e.subState.plan)||void 0===t?void 0:t.productType)===u.ProductPlanType.FAMILY_NONPAYER&&this.getFamilyPayerScheduledChange((function(){a.shouldLogScheduledFamilyMemberDowngradePrompt()&&_.ProEventsLogger.log("scheduled_family_member_downgrade_prompt_view")})),this.shouldLogScheduledProToPlusChange()&&_.ProEventsLogger.log("scheduled_plan_change_prompt_view"),this.shouldLogScheduledBillingChange()&&_.ProEventsLogger.log("scheduled_billing_change_prompt_view",{currentBillingSchedule:this.props.subStatus.subState.billingSchedule.id===u.ScheduleId.MONTHLY?"monthly":"yearly",nextBillingSchedule:this.props.subStatus.scheduledSubState.billingSchedule.id===u.ScheduleId.MONTHLY?"monthly":"yearly"})},t.prototype.shouldDisplayFamilyPayersScheduledChange=function(){var e,t;return(null===(t=null===(e=this.props.subStatus)||void 0===e?void 0:e.subState.plan)||void 0===t?void 0:t.productType)===u.ProductPlanType.FAMILY_NONPAYER&&!0===this.state.payerHasScheduledDowngrade&&void 0!==this.state.payerScheduledChangeDate},t.prototype.renderCancelSubscriptionNotification=function(){var e=this.props,t=e.subStatus,a=e.scheduledForDowngrade;if(t)return a?this.props.useAlternateNotifications?(_.ProEventsLogger.log("cancel_banner_view"),n.default.createElement(d.CancellableItemView,{title:r.intl.formatMessage({id:"97TpvL",defaultMessage:"Cancellation scheduled for <b>{date}</b>."},{date:t.formattedNextBillingDate,b:function(e){return n.default.createElement("b",null,e)}}),handleAction:this.handleCancelSubscriptionAction,useCTA:!0,useAlternateStyle:!0})):n.default.createElement(d.CancellableItemView,{title:r.intl.formatMessage({id:"4c06XP",defaultMessage:"Scheduled plan change"}),description:r.intl.formatMessage({id:"Ai+Hmi",defaultMessage:"Dropbox Basic"}),handleAction:this.handleCancelSubscriptionAction,useCTA:!0}):void 0},t.prototype.shouldRenderDowngradePlanNotif=function(){var e=this.props,t=e.subStatus,a=e.scheduledForDowngrade;if(!t||a)return!1;var n=t.scheduledSubState;if(!n)return!1;var o=t.subState.plan,i=n.plan;return!(!o||!i)&&(o.productType!==i.productType||o.productType===i.productType&&o.productSpec!==i.productSpec)},t.prototype.shouldRenderBillingChangeNotif=function(){var e=this.props,t=e.subStatus,a=e.scheduledForDowngrade;if(!t||a)return!1;var n=t.scheduledSubState;return!!(n&&n.billingSchedule&&t.subState.billingSchedule)&&t.subState.billingSchedule.id!==n.billingSchedule.id},t.prototype.shouldLogScheduledProToPlusChange=function(){if(this.shouldRenderDowngradePlanNotif()){var e=this.props.subStatus.subState.plan,t=this.props.subStatus.scheduledSubState.plan;return e.productType===u.ProductPlanType.PROFESSIONAL&&t.productType===u.ProductPlanType.PLUS}return!1},t.prototype.shouldLogScheduledBillingChange=function(){return this.shouldRenderBillingChangeNotif()},t.prototype.shouldLogScheduledFamilyMemberDowngradePrompt=function(){return this.shouldDisplayFamilyPayersScheduledChange()},t.prototype.renderDowngradePlanNotification=function(){if(this.shouldRenderDowngradePlanNotif()){var e=this.props.subStatus.scheduledSubState.plan,t=r.intl.formatMessage({id:"McVRyL",defaultMessage:"Dropbox {scheduled_plan}"},{scheduled_plan:e.displayName()});return n.default.createElement(d.CancellableItemView,{title:r.intl.formatMessage({id:"4c06XP",defaultMessage:"Scheduled plan change"}),description:t,handleAction:this.handleCancelPlanAction,useCTA:!0,className:"cancel-plan-schedule"})}},t.prototype.renderFamilyMemberScheduledChange=function(){if(this.shouldDisplayFamilyPayersScheduledChange())return n.default.createElement(d.CancellableItemView,{title:r.intl.formatMessage({id:"27UqZZ",defaultMessage:"Your plan will change from {dropbox_family} to {dropbox_basic}"},{dropbox_family:p.DROPBOX_FAMILY,dropbox_basic:p.DROPBOX_BASIC}),className:"cancel-plan-schedule"})},t.prototype.renderScheduledChange=function(){if(this.shouldRenderBillingChangeNotif()){var e=this.props.subStatus.scheduledSubState.billingSchedule.scheduleDescriptionAdjective;return n.default.createElement(d.CancellableItemView,{title:r.intl.formatMessage({id:"pSiFZ2",defaultMessage:"Scheduled billing period"}),description:r.intl.formatMessage({id:"HCfuYu",defaultMessage:"{billing} billing"},{billing:e.charAt(0).toUpperCase()+e.slice(1)}),handleAction:this.handleCancelScheduleAction,useCTA:!0,className:"cancel-billing-schedule"})}},t.prototype.getAddonCancellationNotificationText=function(e){switch(e){case u.ProductAddonType.EVH:return r.intl.formatMessage({id:"ruwa4d",defaultMessage:"Remove extended version history"});case u.ProductAddonType.QUOTA:return r.intl.formatMessage({id:"OgTPbs",defaultMessage:"Remove storage space"});default:return}},t.prototype.renderAddonChange=function(){var e=this,t=this.props,a=t.subStatus,o=t.scheduledForDowngrade;if(a&&!o){var i=a.scheduledSubState;if(i){var l=a.subState.addons.skus,s=i.addons.skus;if(l.length>s.length){var c=s.map((function(e){return e.productType}));return l.filter((function(e){return-1===c.indexOf(e.productType)})).map((function(t,a){return n.default.createElement(d.CancellableItemView,{key:a,title:r.intl.formatMessage({id:"3YA4ZU",defaultMessage:"Scheduled add-on change"}),description:e.getAddonCancellationNotificationText(t.productType),handleAction:function(){e.handleCancelAddonAction(t.productType)},useCTA:!0,className:"cancel-evh-schedule"})}))}}}},t.prototype.appendAllCancellationTypes=function(e){e.push(this.renderCancelSubscriptionNotification()),e.push(this.renderDowngradePlanNotification()),e.push(this.renderScheduledChange()),e.push(this.renderAddonChange())},t.prototype.render=function(){var e=this.props,t=e.displaySingleChangeCancellationItem,a=e.scheduledForDowngrade,i=e.subStatus,l=e.paymentInfo,d=e.hasLicenseKey,p=e.displayNewTotal;if(!i)return n.default.createElement("noscript",null);if(!l||s.shouldHideBillingChange(l.gateway_id,l.is_reseller_billing))return n.default.createElement("noscript",null);if(!this.props.useAlternateNotifications&&a&&!this.shouldDisplayFamilyPayersScheduledChange())return n.default.createElement("noscript",null);var m=[];if(t)switch(t){case c.CancellationType.IND_SUBSCRIPTION:m.push(this.renderCancelSubscriptionNotification());break;case c.CancellationType.PLAN:m.push(this.renderDowngradePlanNotification());break;case c.CancellationType.SCHEDULE:m.push(this.renderScheduledChange());break;case c.CancellationType.ADDON:m.push(this.renderAddonChange());break;case c.CancellationType.FAMILY_NONPAYER:m.push(this.renderFamilyMemberScheduledChange());break;case c.CancellationType.ALL:this.appendAllCancellationTypes(m);break;case c.CancellationType.LICENSES:break;default:h.enforceExhaustive(t)}if(!(m=m.filter((function(e){return void 0!==e}))).length)return n.default.createElement("noscript",null);var _="";a||!p||this.shouldDisplayFamilyPayersScheduledChange()||(_=r.intl.formatMessage({id:"BunHhw",defaultMessage:"Your new {schedule} total will be {total}."},{schedule:u.productScheduleToProductScheduleDescription(i.finalSubState.plan.schedule),total:i.nextBillingSummary.total.toString()}));var g=this.shouldDisplayFamilyPayersScheduledChange()?this.state.payerScheduledChangeDate:i.subState.formattedNextBillingDate,f=n.default.createElement("div",{className:"cancellable-scheduled-notifications cancellable-scheduled-notifications__header"},r.intl.formatMessage({id:"/3HS66",defaultMessage:"Changes are scheduled for <strong>{date}</strong>."},{date:g,strong:function(e){return n.default.createElement("strong",null,e)}})," ",_),y=o.default("cancellable-scheduled-notifications cancellable-scheduled-notifications__items",{"cancellable-scheduled-notifications__items--alternate":this.props.useAlternateNotifications});return this.props.useAlternateNotifications&&(f=null,y=o.default(y,"cancellable-scheduled-notifications__items--alternate")),n.default.createElement(b,{className:"cancellable-scheduled-notifications personal-cancellable-scheduled-notifications"},f,!d&&n.default.createElement("div",{className:y},m))},t.displayName="CancellableNotificationsViewControl",t})(n.default.Component);t.CancellableNotificationsViewControl=v,t.CancellableNotificationsView=l.requireCssWithComponent(v,["/static/css/teams/admin/widgets/billing_notifications/cancellable_scheduled_notifications-vflBpufaG.css"])})),define("modules/clean/account_page/widgets/plan/views/change_confirmation_modal",["require","exports","tslib","react","styled-components","spectrum/modal/index","dig-components/buttons","modules/core/i18n","modules/clean/static_urls","dig-components/typography"],(function(e,t,a,n,o,i,l,r,s,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChangeConfirmationModal=void 0,n=a.__importDefault(n);var c,u,p,m,_,g,f=(o=a.__importDefault(o)).default(i.Modal)(c||(c=a.__makeTemplateObject(["\n  color: var(--color__standard__text);\n  display: flex;\n  flex-direction: column;\n  font-size: var(--type__body__standard--fontsize);\n  border-radius: 0;\n"],["\n  color: var(--color__standard__text);\n  display: flex;\n  flex-direction: column;\n  font-size: var(--type__body__standard--fontsize);\n  border-radius: 0;\n"]))),h=o.default.div(u||(u=a.__makeTemplateObject(["\n  font-family: var(--type__body__standard--fontfamily);\n  padding: var(--spacing__unit--3);\n"],["\n  font-family: var(--type__body__standard--fontfamily);\n  padding: var(--spacing__unit--3);\n"]))),y=o.default(d.Title)(p||(p=a.__makeTemplateObject(["\n  font-family: var(--type__title__small--fontfamily);\n  font-size: var(--type__title__small--fontsize);\n  font-weight: var(--type__title__small--fontweight_strong);\n  margin-bottom: var(--spacing__unit--3);\n"],["\n  font-family: var(--type__title__small--fontfamily);\n  font-size: var(--type__title__small--fontsize);\n  font-weight: var(--type__title__small--fontweight_strong);\n  margin-bottom: var(--spacing__unit--3);\n"]))),b=o.default.div(m||(m=a.__makeTemplateObject(["\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  height: 65px;\n  padding-left: var(--spacing__unit--3);\n  padding-right: var(--spacing__unit--3);\n\n  .change-confirmation-modal__btn-submit {\n    margin-left: var(--spacing__base_unit);\n  }\n"],["\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  height: 65px;\n  padding-left: var(--spacing__unit--3);\n  padding-right: var(--spacing__unit--3);\n\n  .change-confirmation-modal__btn-submit {\n    margin-left: var(--spacing__base_unit);\n  }\n"]))),v=o.default.div(_||(_=a.__makeTemplateObject(["\n  white-space: nowrap;\n"],["\n  white-space: nowrap;\n"]))),P=o.default.div(g||(g=a.__makeTemplateObject(["\n  display: flex;\n  justify-content: center;\n  padding: 100px;\n"],["\n  display: flex;\n  justify-content: center;\n  padding: 100px;\n"]))),M=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleAccept=function(){t.props.onAccept()},t.handleDismiss=function(){t.props.onDismiss()},t}return a.__extends(t,e),t.prototype.render=function(){var e,t=this.props,a=t.acceptButtonDisabled,o=t.acceptButtonText,i=t.description,c=t.dismissButtonText,u=t.loadingContent,p=t.open,m=t.link,_=t.title,g=t.submitting;return e=u?n.default.createElement(P,{className:"change-confirmation-modal__loading-indicator"},n.default.createElement("img",{src:s.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:r.intl.formatMessage({id:"60HSB/",defaultMessage:"Loading"})})):n.default.createElement("div",{className:"change-confirmation-modal"},n.default.createElement(h,null,n.default.createElement(y,{className:"change-confirmation-modal__title"},_),n.default.createElement(d.Text,{className:"change-confirmation-modal__description"},i)),n.default.createElement(b,null,n.default.createElement(v,null,m),n.default.createElement("div",null,n.default.createElement(l.Button,{className:"change-confirmation-modal__btn-cancel",variant:"opacity",disabled:g,onClick:this.handleDismiss},c),n.default.createElement(l.Button,{className:"change-confirmation-modal__btn-submit",variant:"primary",disabled:a,onClick:this.handleAccept},o)))),n.default.createElement(f,{appElement:document.getElementById("embedded-app")||document.body,ariaLabel:r.intl.formatMessage({id:"qgM6UX",defaultMessage:"Change Confirmation Modal"}),className:"ChangeConfirmationModal",displayCloseButton:!c,onRequestClose:this.handleDismiss,open:p,overlayClickClose:!1,width:560},e)},t.displayName="ChangeConfirmationModal",t})(n.default.Component);t.ChangeConfirmationModal=M})),define("modules/clean/account_page/widgets/plan/views/change_plan_modal",["require","exports","tslib","modules/core/browser","modules/core/notify","react","modules/clean/deprecated_ajax/ajax_jquery","modules/clean/react/components/css","modules/clean/react/badge","modules/clean/teams/admin/widgets/admin_priced_list/admin_priced_list","modules/clean/teams/admin/widgets/admin_priced_list/admin_priced_list_item","modules/clean/account_page/widgets/plan/constants","modules/constants/individual_invoice_modal","modules/clean/account_page/widgets/plan/views/cancel_changes_modal","modules/clean/account_page/widgets/plan/views/confirm_age_modal","modules/clean/account_page/widgets/plan/views/plus_to_family_modal","modules/clean/payments/validation","modules/clean/account_page/widgets/plan/views/cancellable_notifications_view","modules/clean/account_page/constants","modules/clean/payments/cash","modules/clean/payments/skus/catalog_sku","modules/clean/dbmodal_stack","modules/clean/account_page/widgets/plan/views/individual_inline_payment_method","modules/clean/react/components/modal","modules/clean/analytics","modules/clean/payments/skus/constants","modules/clean/payments/skus/subscription_status","modules/core/i18n","modules/clean/account_page/util","modules/clean/active_user","modules/clean/react/browse/uri_helper","modules/clean/static_urls","modules/clean/react/arbor/aspen/elements/arbor_inputs","modules/clean/react/payments/error/browser_update_required_modal","modules/clean/react/payments/update_individual_billing/update_individual_billing_modal_loader","modules/clean/react/payments/update_individual_billing/update_individual_store_creator","modules/clean/account_page/widgets/plan/views/update_billing_info","modules/clean/payments/three_ds_helper","modules/clean/family/constants","modules/clean/account_page/widgets/plan/views/disband_family_confirmation_modal","modules/clean/payments/skus/sku_content","modules/clean/account_page/widgets/plan/views/change_plan_preview_summary","apiql/client/components/account-gql","dropbox/proto/age_gating_types/status","@apollo/react-hooks","apollo-client","modules/clean/account_page/widgets/plan/api","modules/clean/subscription/tools/amp_logger","modules/clean/account_page/widgets/plan/revenue_api_migration_utils","modules/clean/account_page/widgets/plan/revenue_api_migration_comparisons","modules/clean/account_page/widgets/plan/types","modules/clean/react/campaigns/campaign_events_api","modules/clean/account_page/widgets/plan/strings"],(function(e,t,a,n,o,i,l,r,s,d,c,u,p,m,_,g,f,h,y,b,v,P,M,S,E,C,T,A,w,I,D,N,x,L,k,R,B,O,F,U,q,V,j,Y,H,G,z,W,Q,K,X,Z,J){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChangePlanModalView=t.ChangePlanOrigin=t.ChangePlanMode=void 0,n=a.__importStar(n),i=a.__importDefault(i),l=a.__importStar(l);var $,ee,te=[C.ProductPlanType.STANDARD,C.ProductPlanType.PLUS,C.ProductPlanType.PROFESSIONAL,C.ProductPlanType.FAMILY_PAYER,C.ProductPlanType.HS_DBX_PRO_BUNDLE];(function(e){e.DEFAULT="default",e.CONFIRM="confirm"})($=t.ChangePlanMode||(t.ChangePlanMode={})),(function(e){e.DEFAULT="default",e.PLUS_TO_FAMILY="plus_to_family",e.ESIGN_UPSELL_V1="esign_upsell_v1",e.ESIGN_UPSELL_V2="esign_upsell_v2",e.ESIGN_SDK_FILE_VIEWER_UPSELL_V1="esign_sdk_file_viewer_upsell_v1"})(ee=t.ChangePlanOrigin||(t.ChangePlanOrigin={}));var ae=(function(e){function t(r){var s=e.call(this,r)||this;return s._isMounted=null,s._timeModalOpened=null,s._loggedRevAPIChangePlanPreviews={},s.setLoggedRevAPIChangePlanPreviews=function(e){e.forEach((function(e){return s._loggedRevAPIChangePlanPreviews[e.code]=!1}))},s.onLoadTransitionsError=function(){o.Notify.error(A.intl.formatMessage({id:"HcIX4g",defaultMessage:"Failed to load modal."})),s.modalLogger.logModalError("modal_init"),s.closeModals()},s.logChangePlan=function(e,t,n){var o=s.state.subStatus;o&&o.subState.billingSchedule&&(s.log("change_plan_modal_change_plan",a.__assign({from_product_plan_type:C.ProductPlanType[e],to_product_plan_type:C.ProductPlanType[t]},n)),s.modalLogger.logModalSuccess())},s.onChangePlanConfirmation=function(){var e,a,n=s.state,o=n.subStatus,i=n.basicSkuQuotaGb,l=s.getChosenSku();(null===(a=null===(e=null==o?void 0:o.subState)||void 0===e?void 0:e.plan)||void 0===a?void 0:a.productType)===C.ProductPlanType.FAMILY_PAYER&&(null==l?void 0:l.productType)!==C.ProductPlanType.FAMILY_PAYER&&i?(P.DBModalStack.register(U.FAMILY_DISBAND_MODAL_GO_BACK,(function(){t.showInstance(s.props)})),U.showDisbandModal({confirmChangePlan:s.onAccept,basicSkuQuotaGb:i,displayFamilyRoomCheckbox:s.state.displayFamilyRoomCheckbox})):s.ageGatingCheck()},s.onAccept=function(e,t){var a,i=s.state.subStatus;if(null==i?void 0:i.subState.plan){var r,d=s.getChosenSku(),c=null===(a=null==i?void 0:i.subState.plan)||void 0===a?void 0:a.productType,u=null==d?void 0:d.productType;switch(u){case C.ProductPlanType.PLUS:case C.ProductPlanType.STANDARD:r=X.PerformPlanTransition.PLUS;break;case C.ProductPlanType.PROFESSIONAL:r=X.PerformPlanTransition.PROFESSIONAL;break;case C.ProductPlanType.FAMILY_PAYER:r=X.PerformPlanTransition.FAMILY_PAYER;break;case C.ProductPlanType.SYNC_EVERYTHING:r=X.PerformPlanTransition.BACKUP;break;case C.ProductPlanType.HS_DBX_PRO_BUNDLE:r=X.PerformPlanTransition.HS_DBX_PRO_BUNDLE}var p=s.props.campaignContext;p&&Z.logCampaignClick(p,"change-plan-modal"),s.setState((function(e){return{showErrors:!0}}));var m=s.state,_=m.vat,g=m.accountPaymentInfo,f=m.threeDsData,h=m.handle3DsMessage,y=m.shouldShowPlusToFamilyModal;if((null==g?void 0:g.vat_country_code)&&s.vatValidator(g.vat_country_code,_))if(r&&c&&u){s.setState((function(e){return{submitting:!0}})),s.log("de_change_plan_modal_confirm_change_click",t);var b={transition_change_type:r,browser_info:O.collectBrowserInfo(),three_ds_data:f};s.updateThreeDsData(""),_&&(b.vat=_,s.log("vat_provided_on_upgrade",t)),l.WebRequest({url:"/account/perform_personal_transition",data:b,subject_user:s.getUserId(),success:function(e){var a=JSON.parse(e);if(a.redirect)return n.redirect(a.redirect);o.Notify.success(A.intl.formatMessage({id:"zpOY3S",defaultMessage:"You’ve changed your plan!"})),s.removeShowModalParams(),s.logChangePlan(c,u,t),s.props.transitionPerformed&&s.props.transitionPerformed();var i=V.isPlanChangeUpgrade(c,u);return(null==d?void 0:d.productType)===C.ProductPlanType.PROFESSIONAL&&i?n.redirect("/professional_onboarding"):(null==d?void 0:d.productType)===C.ProductPlanType.FAMILY_PAYER?y?n.redirect(F.FAMILY_INVITE_URI_PATH_SUCCESS):n.redirect(F.FAMILY_INVITE_URI_PATH):(document.dispatchEvent(new Event("db:change_plan_modal:plan_changed")),s.closeModals(),void((null==d?void 0:d.productType)===C.ProductPlanType.HS_DBX_PRO_BUNDLE&&s.props.launchHelloSignDeepIntegration&&s.props.launchHelloSignDeepIntegration()))},error:function(t,a,n){e&&e(),s.setState((function(e){return{submitting:!1}}));var i=!1,l=null;try{l=JSON.parse(n)}catch(e){}finally{h&&l&&(i=!0,h(l))}i?s.modalLogger.logModalError("3ds"):(o.Notify.error(A.intl.formatMessage({id:"PMSOip",defaultMessage:"There was an error changing the plan!"})),s.modalLogger.logModalError("modal_submit"),s.closeModals())}})}else o.Notify.error(A.intl.formatMessage({id:"WDKLwG",defaultMessage:"There was an error changing the plan!"}))}},s.ageGatingCheck=function(e,t){var a=s.state,o=a.subStatus,i=a.ageGatingResult;if(null==o?void 0:o.subState.plan){var l=s.getChosenSku(),r=o.subState.plan.productType,d=null==l?void 0:l.productType;if(i===Y.age_gating_types.AgeGatingStatus.PENDING_AGE_CAPTURE&&d===C.ProductPlanType.FAMILY_PAYER)_.ConfirmAgeModalView.showInstance({currentPlan:C.ProductPlanType[r],onAccept:s.onAccept,onErrorHandler:e,loggingExtra:t});else{if(i===Y.age_gating_types.AgeGatingStatus.WILL_BE_DISABLED)return n.redirect("/age_gating/block");s.onAccept(e,t)}}},s.updateThreeDsData=function(e){s.setState({threeDsData:e})},s.onDismiss=function(){s.log("de_change_plan_modal_cancel_click");var e=s.props.campaignContext;e&&Z.logCampaignDismissed(e)},s.closeModals=function(){S.Modal.close()},s.renderVat=function(){var e=null;if(!s.vatDisplayEnabled)return e;var t=s.state,a=t.vat,n=t.accountPaymentInfo,o=t.showErrors,l=null==n?void 0:n.vat_country_code;if(l){var r=f.getVatPrefix(l),d=s.getVatErrorMessage(l),c=s.getVatLabel(l);e=i.default.createElement(x.ArborTextInput,{className:"jest-vat-input",name:"vat",placeholderText:r,labelText:c,isValid:!o||s.vatValidator(l,a),errorText:d,value:a,onChange:s.onVatChange})}return e},s.onVatChange=function(e,t,a){var n=a;s.setState((function(e){return{vat:n,showErrors:!1}}))},s.renderPaymentMethod=function(){var e=s.state.accountPaymentInfo,t=s.props.hideUpdateBillingInfo;if(!s.isPlanScheduledToChange())return i.default.createElement("div",{className:"upgrade-payment-method-link"},i.default.createElement(M.IndividualInlinePaymentMethodView,{accountPaymentInfo:e,paymentErrorMessage:A.intl.formatMessage({id:"qWYni+",defaultMessage:"Please update your billing information to change your plan."}),renderUpdateLink:t?void 0:i.default.createElement(B.UpdateBillingInfoLink,{updateBillingCTA:s.updateBillingInfo})}))},s.updateBillingInfo=function(e){e.stopPropagation(),e.preventDefault(),s.log("de_update_billing_info_click"),s.showUpdateBillingModal()},s.showUpdateBillingModal=function(){S.Modal.close(),P.DBModalStack.register(R.BILLING_INFO_UPDATED,(function(){z.resetApolloStore(),t.showInstance(s.props)})),s.props.browserUpdateRequired?L.BrowserUpdateModalLoader.showInstance():k.IndividualUpdateBillingModalLoader.showInstance()},s.handleCancelScheduleAction=function(e){s.handleCancelActions(y.CancellationType.SCHEDULE),e.preventDefault()},s.handleCancelActions=function(e){var t=s.state.subStatus,a=s.props.transitionPerformed;return t&&m.CancelChangesModalConfirmationView.showInstance({transitionPerformed:a,cancellationType:e,reOpenModalDialogAfterCancellation:!0}),!1},s.transitionPerformedClosure=function(e){if(s.props.transitionPerformed)return s.props.transitionPerformed()},s.state={loadingContent:!0,submitting:!1,type:C.ProductPlanType.STANDARD,showErrors:!1,vat:""},s.modalLogger=W.getSubscriptionAMPLogger({ns:"personal",modal:W.ModalTypes.CHANGE_PLAN_MODAL}),s}return a.__extends(t,e),t.prototype.getUrlOption=function(e){var t=e,a=n.get_href().match(/option=([a-zA-Z_]*)/);if(a&&a.length>1){var o=a[1];"plus"===o&&(t=e===C.ProductPlanType.PROFESSIONAL?C.ProductPlanType.PLUS:e),"pro"===o&&(t=C.ProductPlanType.PROFESSIONAL),"family"===o&&(t=C.ProductPlanType.FAMILY_PAYER),"hellosign_dbx_pro"===o&&(t=C.ProductPlanType.HS_DBX_PRO_BUNDLE)}return t},t.showInstance=function(e){S.Modal.showInstance(i.default.createElement(t.ChangePlanModal,a.__assign({},e)))},t.prototype.componentDidMount=function(){this._isMounted=!0,this._timeModalOpened=Date.now(),this.loadPlanTransitions()},t.prototype.componentWillUnmount=function(){this._isMounted=!1},Object.defineProperty(t.prototype,"productTypeStr",{get:function(){var e,t,a;return null===(a=null===(t=null===(e=this.state.subStatus)||void 0===e?void 0:e.subState)||void 0===t?void 0:t.plan)||void 0===a?void 0:a.productType.toString()},enumerable:!1,configurable:!0}),t.prototype.logTTI=function(){if(this._timeModalOpened){var e=Date.now()-this._timeModalOpened;this.modalLogger.setProductPlanType(this.productTypeStr),this.modalLogger.logModalTTI(e)}},t.prototype.retrieveViewModel=function(e,t,a){var n=this,o=a?{vat:a}:void 0;l.WebRequest({url:"/account/ajax_change_plan",data:o,subject_user:this.getUserId(),success:function(t){var a=JSON.parse(t);n._isMounted&&(n.log("change_plan_modal_available_plans_data_loaded"),e(a))},error:t})},t.prototype.onLoadPlanTransitions=function(e){var t=this;this.setState((function(a){var n,i=T.SubscriptionStatus.deserialize(e.serializedSubStatus),l=Q.convertLegacyPaymentInfo(e.paymentMethod);l.active_payment_method_type===j.AccountPaymentInfoType.Card&&(n=new O.ThreeDsHandler({updateThreeDsData:t.updateThreeDsData,submitThreeDsChallenge:t.ageGatingCheck,triggerThreeDsChallenge:function(){},submitThreeDsFingerprint:t.ageGatingCheck,triggerThreeDsFingerprint:function(){},isDesktop:!1,isSeleniumChangesTest:!1}).handle3DsMessage);var r=i.finalSubState,s=t.props,d=s.admissiblePlans,c=s.defaultSelectedPlan;if(!r.billingSchedule||!r.plan)throw"A base plan is required, in order to change it.";var u=t.getUrlOption(c||i.subState.plan.productType),p=i.subState.planSku.productType===C.ProductPlanType.PLUS||i.subState.planSku.productType===C.ProductPlanType.STANDARD,m=e.availablePlans.map((function(e){return v.CatalogSku.deserialize(e)})).filter((function(e){return!d||d.includes(e.productType)})),f=m.concat([i.finalSubState.planSku]).sort((function(e,t){return e.productType&&t.productType?te.indexOf(e.productType)-te.indexOf(t.productType):0}));f.every((function(e){return e.productType!==u}))&&(u=i.subState.plan.productType);var h=!1;t.props.origin===ee.PLUS_TO_FAMILY&&((h=g.shouldShowPlusToFamilyModal(p,f,e.expPlusToFamilyUpsellVariant))?u=C.ProductPlanType.FAMILY_PAYER:o.Notify.error(A.intl.formatMessage({id:"lBd15f",defaultMessage:"You cannot change plans at this time."})));var y=new q.QuotaFormatter(e.basicSkuQuotaGb),b=e.growthRevapiPaPlanManagementCompareData;return t.setLoggedRevAPIChangePlanPreviews(m),_.reportMetric("change_plan_age_gating",{ageGatingStatus:""+e.ageGatingResult}),{loadingContent:!1,subStatus:i,accountPaymentInfo:l,type:u,handle3DsMessage:n,basicSkuQuotaGb:y.spaceShortFormGb(),shouldShowPlusToFamilyModal:h,availablePlans:m,allSubSkus:f,growthRevapiPaPlanManagementCompareData:b,displayFamilyRoomCheckbox:e.displayFamilyRoomCheckbox,ageGatingResult:e.ageGatingResult}}),this.logTTI)},t.prototype.loadPlanTransitions=function(){var e=this;this.retrieveViewModel((function(t){e.onLoadPlanTransitions(t)}),this.onLoadTransitionsError)},t.prototype.getUserId=function(){return this.props.userIdOverride?this.props.userIdOverride:I.mustGetActiveUserId()},t.prototype.getChosenSku=function(){var e=this;if(this.state.allSubSkus)return this.state.allSubSkus.filter((function(t){return t.productType===e.state.type})).pop()},t.prototype.getChosenSkuCode=function(){var e=this.getChosenSku();return e?e.code:""},Object.defineProperty(t.prototype,"finalPlanType",{get:function(){var e=this.state.subStatus;return e&&e.finalSubState.plan&&e.finalSubState.plan.productType},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasTypeChanged",{get:function(){return this.finalPlanType&&this.finalPlanType!==this.state.type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasCurrentPlanChanged",{get:function(){return this.hasTypeChanged},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"subStatusScheduleId",{get:function(){var e=this.state.subStatus;return e&&e.finalSubState.billingSchedule?e.finalSubState.billingSchedule.id:C.ScheduleId.MONTHLY},enumerable:!1,configurable:!0}),t.prototype.log=function(e,t){E.ProEventsLogger.log(e,a.__assign(a.__assign({},t),{origin:this.props.origin}))},t.prototype.removeShowModalParams=function(){var e=n.get_href().match(/modal=([a-zA-Z_]*)/);e&&e.length>1&&("plan"===e[1]&&window.history.replaceState({},document.title,n.get_href().split("?")[0]))},t.prototype.changeProductPlan=function(e){this.setState((function(t){return{type:e}}))},t.prototype.changeProductPlanClosure=function(e){var t=this;return function(){t.changeProductPlan(e)}},t.prototype.renderPlanItems=function(){var e=this,t=this.state,a=t.type,n=t.allSubSkus,o=t.subStatus;if(n&&o&&o.subState.billingSchedule&&o.subState.plan&&o.subState.planSku&&o.finalSubState.plan&&o.finalSubState.planSku&&o.scheduledSubState&&o.scheduledSubState.billingSchedule)return n.map((function(t,n){if(t&&t.billingSchedule){var l,r,d=!1,u=o.isOnTrial?o.finalSubState.plan:o.subState.plan;u&&t.productType===u.productType&&(l=A.intl.formatMessage({id:"dhdo+T",defaultMessage:"(current plan)"}),d=!0),t.productType===C.ProductPlanType.TRANSFER||(null==u?void 0:u.productType)===C.ProductPlanType.TRANSFER?r=i.default.createElement("span",null,i.default.createElement("br",null),i.default.createElement("a",{href:"/transfer/plans",target:"_blank",rel:"noreferrer noopener"},A.intl.formatMessage({id:"Vu1ffz",defaultMessage:"See plan details"}))):t.productType===C.ProductPlanType.SYNC_EVERYTHING?r=i.default.createElement("span",null,i.default.createElement("br",null),i.default.createElement("a",{href:"https://help.dropbox.com/accounts-billing/plans-upgrades/dropbox-backup-plan",target:"_blank",rel:"noreferrer noopener"},A.intl.formatMessage({id:"qSkDre",defaultMessage:"See plan details"}))):t.productType!==C.ProductPlanType.HS_DBX_PRO_BUNDLE&&(r=i.default.createElement("span",null,i.default.createElement("br",null),i.default.createElement("a",{href:"/plans",target:"_blank",rel:"noreferrer noopener"},A.intl.formatMessage({id:"wo0qrl",defaultMessage:"See plan details"}))));var p=A.intl.formatMessage({id:"q0DZmp",defaultMessage:"Dropbox {plan_name}"},{plan_name:t.displayName()}),m=void 0;e.props.mode===$.CONFIRM&&t.productType===C.ProductPlanType.PROFESSIONAL&&(m={variant:s.BadgeVariant.NEW,color:s.BadgeColor.NEON_GREEN});var _,g=t.productType===(null==u?void 0:u.productType);return g&&e.props.hideDetailsCurrentPlan?r=i.default.createElement(i.default.Fragment,null):_=u&&g?J.getPlanFeatureDescription(u,e.props.getPlanFeatureDescriptionOptions):J.getPlanFeatureDescription(t,e.props.getPlanFeatureDescriptionOptions),i.default.createElement(j.GetAccountDeprecatedPlanChangePreviewComponent,{key:t.code,skip:d,variables:{vat:e.vatID,sku_code:t.code,country_override:D.getQueryArgs().country_override}},(function(n){var o,s=n.loading,u=null===(o=n.data)||void 0===o?void 0:o.account_deprecated_plan_change_preview,g=(null==u?void 0:u.formatted_base_price)?null==u?void 0:u.formatted_base_price:t.displayCost.toString();return i.default.createElement(c.AdminPricedListItem,{className:"test-plan-item-"+t.productType+" "+(d?"test-current-plan-item":""),key:t.code,isSelected:a===t.productType,title:p,titleWarningText:void 0,titleSecondaryText:l,description:_,detailsLink:r,loadingPrice:s,priceString:g,unit:t.billingSchedule.id===C.ScheduleId.MONTHLY?A.intl.formatMessage({id:"YRatzw",defaultMessage:"per month"}):A.intl.formatMessage({id:"4Wu5r9",defaultMessage:"per year"}),onClick:e.changeProductPlanClosure(t.productType),disableItem:e.isPlanScheduledToChange(),badge:m})}))}}))},t.prototype.renderBillingSection=function(){return i.default.createElement("div",null,i.default.createElement(d.AdminPricedList,null,this.renderPlanItems()),this.renderVat())},t.prototype.getVatErrorMessage=function(e){return"CA"===e?A.intl.formatMessage({id:"uNWF6T",defaultMessage:"Please enter a valid Tax ID, e.g. {examples}."},{examples:f.getVatExamples(e).join(", ")}):A.intl.formatMessage({id:"1dRSXy",defaultMessage:"Please enter a valid VAT number, e.g. {examples}."},{examples:f.getVatExamples(e).join(", ")})},t.prototype.getVatLabel=function(e){return"CA"===e?A.intl.formatMessage({id:"XDZLLI",defaultMessage:"Optional Tax ID (ex: GST, HST, QST)"}):A.intl.formatMessage({id:"jabE//",defaultMessage:"VAT number (optional)"})},t.prototype.vatValidator=function(e,t){return!t||f.validateVat(e,t)},t.prototype.isScheduledToChange=function(){return this.isPlanScheduledToChange()||this.isBillingScheduleToChange()||this.isEvhScheduledToChange()},t.prototype.isEvhScheduledToChange=function(){var e=this.state.subStatus;return!(!e||!e.scheduledSubState)&&e.subState.quantityForEvhAddOn()!==e.scheduledSubState.quantityForEvhAddOn()},t.prototype.isPlanScheduledToChange=function(){var e=this.state.subStatus;return!!(e&&e.subState.plan&&e.finalSubState.plan)&&e.subState.plan.productType!==e.finalSubState.plan.productType},t.prototype.isBillingScheduleToChange=function(){var e=this.state.subStatus;return!!(e&&e.subState.billingSchedule&&e.finalSubState.billingSchedule)&&e.subState.billingSchedule.id!==e.finalSubState.billingSchedule.id},t.prototype.getPlanNameWithEvhText=function(e){var t=this.state.subStatus;return t&&t.scheduledSubState&&t.scheduledSubState.quantityForEvhAddOn()>0?e+" "+A.intl.formatMessage({id:"NsQt0k",defaultMessage:"+ extended version history"}):e},t.prototype.renderScheduleTransitionText=function(e){var t=this.state.subStatus;if(t&&t.subState.plan){var a,n=i.default.createElement("a",{href:"#",onClick:this.handleCancelScheduleAction},A.intl.formatMessage({id:"e+rwVi",defaultMessage:"Cancel change"}));if(this.isPlanScheduledToChange())return i.default.createElement("span",{className:"plan-transition"},A.intl.formatMessage({id:"5eLA6l",defaultMessage:"You’ve already requested a change to your plan. If you want to choose a different plan or billing period, first cancel your pending change."})," ",n);if(!this.hasTypeChanged&&t.currentBillingSummary){var o=t.scheduledSubState,l=t.nextBillingSummary,r=t.subState,s=t.currentBillingSummary;a=this.isScheduledToChange()?A.intl.formatMessage({id:"EkFAkT",defaultMessage:"Starting on {date}, we’ll bill you once a {schedule_noun} for your Dropbox {plan}. Your new {schedule} total will be {scheduled_total}."},{plan:this.getPlanNameWithEvhText(o.plan.displayName()),date:r.formattedNextBillingDate,schedule:o.billingSchedule.scheduleDescriptionAdjective,schedule_noun:o.billingSchedule.scheduleDescriptionNoun,scheduled_total:b.Cash.formatWithTaxLabels(l.total,l),strong:function(e){return i.default.createElement("strong",null,e)}}):A.intl.formatMessage({id:"H2ofu+",defaultMessage:"Your Dropbox {plan} plan will renew on {date}. Your current {schedule} total is {recurring_total}."},{plan:this.getPlanNameWithEvhText(r.plan.displayName()),schedule:r.billingSchedule.scheduleDescriptionAdjective,recurring_total:b.Cash.formatWithTaxLabels(s.total,s),date:r.formattedNextBillingDate})}if(this.hasTypeChanged&&e){var d=w.logClickAndRedirect("de_cancel_link_click","/help/billing/cancel-dropbox-plus",{from:"change_plan_modal"}),c=w.logClickAndRedirect("de_legal_link_click","/help/billing/plus-refund",{from:"change_plan_modal"});a=i.default.createElement(V.ChangePlanPreviewSummary,{subChangePreview:e,onClickCancel:d,onClickLegal:c,currentSku:t.subState.planSku,chosenSku:this.getChosenSku(),chosenSkuName:this.getPlanNameWithEvhText(this.getChosenSku().displayName())})}return a?i.default.createElement("div",null,e||this.isScheduledToChange()?i.default.createElement("span",{className:"change-summary"},A.intl.formatMessage({id:"eSqPLW",defaultMessage:"Change summary"})):null,i.default.createElement("p",{className:"plan-transition"},a)):void 0}},t.prototype.renderChangeFooter=function(e,t){var a;return t===G.NetworkStatus.loading||t===G.NetworkStatus.setVariables?i.default.createElement("div",{className:"change-plan-modal__loading-indicator"},i.default.createElement("img",{src:N.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:A.intl.formatMessage({id:"QNTZp/",defaultMessage:"Loading"})})):t===G.NetworkStatus.error?(this.modalLogger.logModalError("change_preview","noncritical"),i.default.createElement("div",{className:"change-plan-modal__loading-indicator"},A.intl.formatMessage({id:"EUUBQX",defaultMessage:"There was an unexpected error. Please try again later or contact support."}))):(this.isPlanScheduledToChange()||(a=this.renderPaymentMethod()),i.default.createElement("div",{className:"plan-footer u-font-meta"},this.renderScheduleTransitionText(e),a))},t.prototype.acceptButtonDisabled=function(e){var t=this.state.accountPaymentInfo,a=this.state,n=a.loadingContent,o=a.submitting;return!(!n&&!o&&e&&t)||!this.hasUserSelectedDifferentPlan()},t.prototype.isValidVatCountry=function(){var e=this.state.accountPaymentInfo;return!!((null==e?void 0:e.vat_country_code)&&f.hasVat(e.vat_country_code))},Object.defineProperty(t.prototype,"vatID",{get:function(){var e=this.state,t=e.accountPaymentInfo,a=e.vat;return(null==t?void 0:t.vat_country_code)&&f.validateVat(t.vat_country_code,a)?a:""},enumerable:!1,configurable:!0}),t.prototype.shouldShowVatForPlan=function(e){return[C.ProductPlanType.PROFESSIONAL,C.ProductPlanType.TRANSFER,C.ProductPlanType.HS_DBX_PRO_BUNDLE].includes(e)},t.prototype.hasUserSelectedDifferentPlan=function(){return!this.isPlanScheduledToChange()&&this.hasTypeChanged},Object.defineProperty(t.prototype,"vatDisplayEnabled",{get:function(){var e=this.state,t=e.loadingContent,a=e.submitting;return!(!p.INDIVIDUAL_INVOICE_MODAL||t||a||!this.hasUserSelectedDifferentPlan()||!this.isValidVatCountry()||!this.finalPlanType||this.shouldShowVatForPlan(this.finalPlanType)||!this.shouldShowVatForPlan(this.state.type))},enumerable:!1,configurable:!0}),t.prototype.render=function(){var e=this,n=this.props,o=n.transitionPerformed,l=n.paymentInfo,r=n.mode,s=this.state,d=s.subStatus,c=s.loadingContent,p=s.submitting,m=s.type,_=s.vat,f=s.growthRevapiPaPlanManagementCompareData,b=s.accountPaymentInfo,v=s.availablePlans;return i.default.createElement(H.ApolloProvider,{client:z.getApolloClient()},f&&i.default.createElement(K.CompareRevApiAvailablePlans,{upcomingPlanId:d.finalSubState.planSku.code,legacyAvailablePlans:Q.convertLegacyAvailablePlansData(v),filterContractLength:j.AccountPlanFilterArgument.SameAsScheduled,filterProductFamily:j.AccountPlanFilterArgument.DifferentThanScheduled,context:"change_plan_modal"}),f&&i.default.createElement(K.CompareRevApiPaymentInfo,{legacyPaymentInfo:b}),i.default.createElement(j.GetAccountDeprecatedPlanChangePreviewComponent,{skip:!this.hasTypeChanged,variables:{vat:this.vatID,sku_code:this.getChosenSkuCode()}},(function(n){var s,b=n.networkStatus,v=n.loading,M=!(n.loading||n.error),E=n.data&&n.data.account_deprecated_plan_change_preview?n.data.account_deprecated_plan_change_preview:void 0,T=Q.convertLegacyChangePlanPreviewData(E),w=A.intl.formatMessage({id:"9q9Jhs",defaultMessage:"Change plan"}),I=A.intl.formatMessage({id:"5Dr7st",defaultMessage:"Cancel"}),D=A.intl.formatMessage({id:"X0xlzt",defaultMessage:"Confirm change"});if(c||e.state.shouldShowPlusToFamilyModal&&v)w="",D="",I="",s=i.default.createElement("div",{"data-testid":"loading-indicator",className:"change-plan-modal__loading-indicator"},i.default.createElement("div",{className:"change-plan-modal__loading-indicator__text"},A.intl.formatMessage({id:"IxHAnI",defaultMessage:"Loading account details..."})),i.default.createElement("img",{src:N.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:A.intl.formatMessage({id:"w1RdJ3",defaultMessage:"Loading"})}));else{var x=void 0;d&&o&&(P.DBModalStack.clear(),P.DBModalStack.register(u.CHANGE_IND_PLAN_MODAL_UPDATED,(function(){t.showInstance(a.__assign(a.__assign({},e.props),{transitionPerformed:e.transitionPerformedClosure}))})),x=i.default.createElement(h.CancellableNotificationsView,{subStatus:d,transitionPerformed:e.transitionPerformedClosure,displaySingleChangeCancellationItem:y.CancellationType.ALL,reOpenModalDialogAfterCancellation:!0,paymentInfo:l,displayNewTotal:!1})),s=i.default.createElement("div",null,x,e.renderBillingSection(),e.renderChangeFooter(T,b)),r===$.CONFIRM&&d&&(w=A.intl.formatMessage({id:"p+qbry",defaultMessage:"Confirm plan"}),d.finalSubState.plan.productType===m?(D=null,I=A.intl.formatMessage({id:"31Fc4k",defaultMessage:"Confirm"})):(D=A.intl.formatMessage({id:"/ifa0B",defaultMessage:"Upgrade plan"}),I=null))}var L=null;f&&!v&&T&&(L=i.default.createElement(K.CompareRevApiChangePlanPreview,{scheduledPlanID:d.finalSubState.planSku.code,offeringId:e.getChosenSkuCode(),vatId:e.vatID,legacyChangePlanPreviewData:T}));var k=e.state.allSubSkus&&e.state.allSubSkus.find((function(e){return e&&e.productType===C.ProductPlanType.FAMILY_PAYER}));return e.state.shouldShowPlusToFamilyModal&&e.state.subStatus&&k&&T&&e.state.accountPaymentInfo?i.default.createElement(i.default.Fragment,null,L,i.default.createElement(g.PlusToFamilyModal,{subStatus:e.state.subStatus,subChangePreview:T,familySku:k,accountPaymentInfo:e.state.accountPaymentInfo,acceptButtonDisabled:e.acceptButtonDisabled(M),onAccept:e.ageGatingCheck,submitting:p,onUpdateBillingInfo:e.showUpdateBillingModal,shouldShowVatInput:e.vatDisplayEnabled,onVatChange:e.onVatChange,vat:_})):i.default.createElement("div",{"data-testid":"change-plan-modal"},L,i.default.createElement(S.Modal,{acceptButtonDisabled:e.acceptButtonDisabled(M),acceptButtonText:D,className:"change-plan-modal",dismissButtonText:I,autoClose:!1,onAccept:e.onChangePlanConfirmation,onDismiss:e.onDismiss,submitting:p,title:w},s))})))},t.ChangePlanModal=r.requireCssWithComponent(t,["/static/css/teams/admin/widgets/change_plan_modal/change_plan_modal-vfl6DGbEg.css"]),t.displayName="ChangePlanModalView",t})(i.default.Component);t.ChangePlanModalView=ae})),define("modules/clean/account_page/widgets/plan/views/change_plan_preview_summary",["require","exports","tslib","modules/core/i18n","react","modules/clean/account_page/widgets/plan/constants"],(function(e,t,a,n,o,i){"use strict";function l(e,t){var a=i.planTypeToUpgrades[e];return void 0!==a&&a.includes(t)}function r(e,t){return t?n.intl.formatMessage({id:"QebzyJ",defaultMessage:"{price} (taxes included)"},{price:e}):e}Object.defineProperty(t,"__esModule",{value:!0}),t.priceWithTaxLabel=t.isPlanChangeUpgrade=t.ChangePlanPreviewSummary=void 0,o=a.__importDefault(o),t.ChangePlanPreviewSummary=function(e){if(!e.chosenSku||!e.currentSku)return o.default.createElement("noscript",null);var t,a={plan:e.chosenSkuName,date:e.subChangePreview.upcoming_bill_date,prorated_price:r(e.subChangePreview.immediate_price||"",e.subChangePreview.tax_included_in_total_amount||!1),schedule_noun:e.chosenSku.billingSchedule.scheduleDescriptionNoun,schedule:e.chosenSku.billingSchedule.scheduleDescriptionAdjective,scheduled_total:r(e.subChangePreview.upcoming_bill_total_price||"",e.subChangePreview.tax_included_in_total_amount||!1),strong:function(e){return o.default.createElement("strong",null,e)},cancelLink:function(t){return o.default.createElement("a",{"aria-label":n.intl.formatMessage({id:"mRCTvJ",defaultMessage:"CancelLink"}),href:"#",onClick:e.onClickCancel},t)},legalLink:function(t){return o.default.createElement("a",{"aria-label":n.intl.formatMessage({id:"g/nUIt",defaultMessage:"LegalLink"}),href:"#",onClick:e.onClickLegal},t)}};return t=l(e.currentSku.productType,e.chosenSku.productType)?n.intl.formatMessage({id:"IYLgtU",defaultMessage:"You’re upgrading your plan to Dropbox {plan}. <strong>We’ll charge you {prorated_price} now</strong>, which is prorated for the current billing period. Starting on {date} and until you <cancelLink>cancel</cancelLink>, we’ll bill you once a {schedule_noun} and your new {schedule} total will be {scheduled_total}. If you cancel, previous charges won’t be refunded <legalLink>unless it’s legally required</legalLink>."},a):n.intl.formatMessage({id:"f5t2Mw",defaultMessage:"Starting on {date}, your plan will be downgraded to Dropbox {plan} and your new {schedule} total will be {scheduled_total}. Charges will continue until you <cancelLink>cancel</cancelLink>, and previous charges won’t be refunded <legalLink>unless it’s legally required</legalLink>."},a),o.default.createElement("div",{className:"test-plan-transition-description"},t)},t.ChangePlanPreviewSummary.displayName="ChangePlanPreviewSummary",t.isPlanChangeUpgrade=l,t.priceWithTaxLabel=r})),define("modules/clean/account_page/widgets/plan/views/confirm_age_modal",["require","exports","tslib","classnames","react","modules/core/notify","modules/core/exception","modules/core/i18n","dig-components/modal","dig-components/typography","dig-components/text_fields","dig-components/buttons","api_v2/user_client","modules/clean/analytics","modules/clean/metrics/index","modules/clean/active_user","modules/clean/react/components/css","modules/core/browser","modules/clean/react/components/modal"],(function(e,t,a,n,o,i,l,r,s,d,c,u,p,m,_,g,f,h,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConfirmAgeModalView=t.reportMetric=void 0,n=a.__importDefault(n),o=a.__importDefault(o),h=a.__importStar(h),y=a.__importStar(y),t.reportMetric=function(e,t){_.getMetricsReporter().createStats({ns:"personal_plan_management",name:e},a.__assign({},t)).record(1)};var b=(function(e){function _(n){var o=e.call(this,n)||this;return o.onChange=function(e,t){var n=e.target.value,i=parseInt(n,10);n&&isNaN(i)||o.setState((function(e){var o;return a.__assign(a.__assign({},e),((o={})[t]=n,o.isValid=!0,o))}))},o.onBlur=function(e,t){var n=e.target.value;if(n){var i=parseInt(n,10);o.setState((function(e){var n;return a.__assign(a.__assign({},e),((n={})[t]=i.toString().padStart(2,"0"),n))}))}},o.onModalCloses=function(e,t){t||o.logEvent("age_gate_close"),o.setState((function(e){return a.__assign(a.__assign({},e),{open:!1})}))},o.onAccept=function(){return a.__awaiter(o,void 0,void 0,(function(){var e,n,o,s,d,c,u,p,m,_,g,f;return a.__generator(this,(function(y){switch(y.label){case 0:if(e=this.state,n=e.day,o=e.month,s=e.year,d=new Date(o+"/"+n+"/"+s),c=new Date,2!==n.length||2!==o.length||4!==s.length||isNaN(d.getTime())||d>c)return this.setState((function(e){return a.__assign(a.__assign({},e),{isValid:!1})})),[2];if(d.getMonth()+1!==parseInt(o,10))return this.setState((function(e){return a.__assign(a.__assign({},e),{isValid:!1})})),[2];u={success:"true"},y.label=1;case 1:return y.trys.push([1,3,4,5]),this.setState((function(e){return a.__assign(a.__assign({},e),{confirmDisabled:!0})})),[4,this.setBirthdate(d)];case 2:return p=y.sent(),this.logEvent("age_gate_submit"),[3,5];case 3:return y.sent(),i.Notify.error(r.intl.formatMessage({id:"sFDDem",defaultMessage:"There was an error setting your date of birth. Please try again."})),l.reportException({err:new Error("Error setting user date of birth"),severity:l.SEVERITY.NONCRITICAL,tags:["owner:subscription-mgmt","set_birthdate"]}),u.success="false",[2];case 4:return t.reportMetric("set_birthdate",u),this.setState((function(e){return a.__assign(a.__assign({},e),{confirmDisabled:!1})})),[7];case 5:return"will_be_disabled"===(null==p?void 0:p[".tag"])?[2,h.redirect("/age_gating/block")]:(m=this.props,_=m.onAccept,g=m.onErrorHandler,f=m.loggingExtra,_(g,f),this.onModalCloses(void 0,!0),[2])}}))}))},o.setBirthdate=function(e){return a.__awaiter(o,void 0,void 0,(function(){var t;return a.__generator(this,(function(a){return t=e.getTime()/1e3,[2,(new p.UserApiV2Client).ns("age_gating").rpc("set_birthdate",{birthdate_ts:t},{subjectUserId:g.mustGetActiveUserId()}).then((function(e){return e.gating_status}))]}))}))},o.logEvent=function(e){var t=o.props.currentPlan;m.ProEventsLogger.log(e,{current_plan:t})},o.state={open:!0,day:"",month:"",year:"",isValid:!0,confirmDisabled:!1},o.logEvent("age_gate_view"),o}return a.__extends(_,e),_.showInstance=function(e){s.Modal.setAppElement(document.getElementById("embedded-app")||document.body),y.Modal.showInstance(o.default.createElement(t.ConfirmAgeModalView,a.__assign({},e)))},_.prototype.render=function(){var e=this,t=this.state,a=t.open,i=t.day,l=t.month,p=t.year,m=t.isValid,_=t.confirmDisabled,g=r.intl.formatMessage({id:"QIV/Tj",defaultMessage:"Confirm your date of birth"}),f=r.intl.formatMessage({id:"CyX8FV",defaultMessage:"To use Dropbox Family, we need your date of birth."}),h=r.intl.formatMessage({id:"jsBun9",defaultMessage:"Day"}),y=r.intl.formatMessage({id:"5ymFrB",defaultMessage:"Month"}),b=r.intl.formatMessage({id:"brSw8D",defaultMessage:"Year"}),v=r.intl.formatMessage({id:"QQiv4/",defaultMessage:"Confirm"}),P=r.intl.formatMessage({id:"ztOd9D",defaultMessage:"Please enter a valid date of birth."}),M=r.intl.formatMessage({id:"Pxv2Bf",defaultMessage:"Close"}),S=n.default("confirm-age-modal");return o.default.createElement(s.Modal,{open:a,isCentered:!0,withCloseButton:M,shouldCloseOnOverlayClick:!1,overlayClassName:S,onRequestClose:this.onModalCloses},o.default.createElement(s.Modal.Header,{hasBottomSpacing:"title-standard"},o.default.createElement(d.Title,null,g)),o.default.createElement(s.Modal.Body,null,o.default.createElement(d.Text,{size:"large"},f),o.default.createElement("div",{className:"age-container"},o.default.createElement(c.FormRow,null,o.default.createElement(c.FormLabel,{htmlFor:"confirm-age-day"},h),o.default.createElement(c.TextInput,{placeholder:"DD","aria-label":h,id:"confirm-age-day",maxLength:2,onChange:function(t){return e.onChange(t,"day")},onBlur:function(t){return e.onBlur(t,"day")},value:i,isInvalid:!m})),o.default.createElement(c.FormRow,null,o.default.createElement(c.FormLabel,{htmlFor:"confirm-age-month"},y),o.default.createElement(c.TextInput,{placeholder:"MM","aria-label":y,id:"confirm-age-month",maxLength:2,onChange:function(t){return e.onChange(t,"month")},onBlur:function(t){return e.onBlur(t,"month")},value:l,isInvalid:!m})),o.default.createElement(c.FormRow,null,o.default.createElement(c.FormLabel,{htmlFor:"confirm-age-year"},b),o.default.createElement(c.TextInput,{placeholder:"YYYY","aria-label":b,id:"confirm-age-year",maxLength:4,onChange:function(t){return e.onChange(t,"year")},value:p,isInvalid:!m}))),!m&&o.default.createElement(d.Text,{color:"error"},P)),o.default.createElement(s.Modal.Footer,null,o.default.createElement(u.Button,{className:"confirm-age-button",variant:"primary",size:"large",onClick:this.onAccept,disabled:_},v)))},_.displayName="ConfirmAgeModal",_})(o.default.Component);t.ConfirmAgeModalView=f.requireCssWithComponent(b,["/static/css/teams/admin/widgets/confirm_age_modal/confirm_age_modal-vflZvu4ms.css"])})),define("modules/clean/account_page/widgets/plan/views/plus_to_family_modal",["require","exports","tslib","modules/core/exception","modules/core/browser","modules/core/i18n","modules/core/uri","react","modules/clean/account_page/util","modules/clean/react/components/modal","dig-components/typography","modules/clean/account_page/widgets/plan/views/individual_inline_payment_method","modules/clean/payments/skus/constants","modules/clean/family/constants","modules/constants/trademark","modules/clean/account_page/widgets/plan/views/update_billing_info","modules/clean/stormcrow/experiment","modules/clean/payments/skus/constants","modules/clean/payments/validation","modules/clean/react/arbor/aspen/elements/arbor_inputs","modules/clean/analytics","modules/clean/account_page/widgets/plan/views/change_plan_preview_summary"],(function(e,t,a,n,o,i,l,r,s,d,c,u,p,m,_,g,f,h,y,b,v,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlusToFamilyModal=t.shouldShowPlusToFamilyModal=t.PLUS_TO_FAMILY_MODAL=void 0,n=a.__importStar(n),o=a.__importStar(o),r=a.__importDefault(r),t.PLUS_TO_FAMILY_MODAL="plus_to_family_modal",t.shouldShowPlusToFamilyModal=function(e,t,a){if(!e)return n.reportException({err:new Error("Plus to Family Modal only available to Plus users"),severity:"non-critical"}),!1;var o=a&&f.Experiment(a).isActive;if(!o)return n.reportException({err:new Error("Plus to Family Modal only available to gated users"),severity:"non-critical"}),!1;var i=1===t.filter((function(e){return e&&e.productType===h.ProductPlanType.FAMILY_PAYER})).length;return i?i&&o:(n.reportException({err:new Error("Family plan not available"),severity:"non-critical"}),!1)};var M=(function(e){function n(){var a=null!==e&&e.apply(this,arguments)||this;return a.onDismiss=function(){v.ProEventsLogger.log("de_change_plan_modal_cancel_click",{from:t.PLUS_TO_FAMILY_MODAL}),a.removeURIModalQueryParam()},a.onAccept=function(){a.props.onAccept(void 0,{from:t.PLUS_TO_FAMILY_MODAL})},a.updateBillingInfo=function(){v.ProEventsLogger.log("de_update_billing_info_click",{from:t.PLUS_TO_FAMILY_MODAL}),a.props.onUpdateBillingInfo()},a.renderVatInput=function(){var e=a.props,t=e.vat,n=e.accountPaymentInfo.vat_country_code;if(a.props.shouldShowVatInput&&n)return r.default.createElement(b.ArborTextInput,{name:"vat",placeholderText:y.getVatPrefix(n),labelText:i.intl.formatMessage({id:"jabE//",defaultMessage:"VAT number (optional)"}),isValid:y.validateVat(n,t),errorText:i.intl.formatMessage({id:"1dRSXy",defaultMessage:"Please enter a valid VAT number, e.g. {examples}."},{examples:y.getVatExamples(n).join(", ")}),value:t,onChange:a.props.onVatChange})},a}return a.__extends(n,e),n.prototype.removeURIModalQueryParam=function(){var e=o.get_href().match(/modal=(plus_to_family*)/);if(e&&e.length>1){var t=l.URI.parse(o.get_href()).removeQuery("modal");window.history.replaceState({},document.title,t.toString())}},n.prototype.getPlanComparisonText=function(){var e=this.props,t=e.subStatus,a=e.familySku,n=t.finalSubState.plan,o=n.displayCost.toString(),l=a.displayCost.toString();return n.billingSchedule.id===p.ScheduleId.MONTHLY?i.intl.formatMessage({id:"hNT7DA",defaultMessage:"{count, plural, one{{newCost}/month for up to {count} user ({currentPlan} is {currentCost}/month for 1 user)} other {{newCost}/month for up to {count} users ({currentPlan} is {currentCost}/month for 1 user)}}"},{currentPlan:n.displayName(),currentCost:o,newCost:l,count:m.MAX_LICENSES}):i.intl.formatMessage({id:"dlmjiM",defaultMessage:"{count, plural, one{{newCost}/year for up to {count} user ({currentPlan} is {currentCost}/year for 1 user)} other {{newCost}/year for up to {count} users ({currentPlan} is {currentCost}/year for 1 user)}}"},{currentPlan:n.displayName(),currentCost:o,newCost:l,count:m.MAX_LICENSES})},n.prototype.renderPlusToFamilyPlanUpsell=function(){var e=this.props,a=e.subStatus,n=e.familySku,o=a.finalSubState.plan,l=n.content&&n.content.spaceShortFormGbRounded();return r.default.createElement("div",{className:"test-plus-family-plan-modal__content"},r.default.createElement(c.Text,null,i.intl.formatMessage({id:"NI7W3i",defaultMessage:"{count, plural, one{{familyPlan} includes the same features as Dropbox {currentPlan} (your current plan) for up to {count} member.} other{{familyPlan} includes the same features as Dropbox {currentPlan} (your current plan) for up to {count} members.}}"},{familyPlan:_.DROPBOX_FAMILY,currentPlan:o.displayName(),count:m.MAX_LICENSES})),r.default.createElement(c.Text,null,r.default.createElement("ul",null,r.default.createElement("li",null,this.getPlanComparisonText()),r.default.createElement("li",null,i.intl.formatMessage({id:"aE4CAA",defaultMessage:"Share {space} of encrypted cloud storage"},{space:l})),r.default.createElement("li",null,i.intl.formatMessage({id:"OX5PaW",defaultMessage:"Easily create shared spaces for photos, videos, docs, and more"})))),r.default.createElement(c.Text,{size:"small"},i.intl.formatMessage({id:"V3rkGP",defaultMessage:"Questions? Check out the <overview_link>Family plan overview</overview_link>."},{overview_link:function(e){return r.default.createElement(c.Link,{href:"#","aria-label":i.intl.formatMessage({id:"kc7uwV",defaultMessage:"FamilyPlanOverviewLink"}),onClick:s.logClickAndRedirect("de_family_plan_overview_link_click","/help/accounts-billing/plans-upgrades/dropbox-family-plan",{from:t.PLUS_TO_FAMILY_MODAL})},e)}})))},n.prototype.renderFooter=function(){return r.default.createElement("div",{className:"plus-family-plan-modal__footer"},this.renderVatInput(),r.default.createElement(c.Text,{color:"faint",isBold:!0,tagName:"p"},i.intl.formatMessage({id:"sIclY/",defaultMessage:"Plan change summary"})),r.default.createElement(c.Text,{size:"small",color:"faint"},this.getTransitionText()))},n.prototype.getTransitionText=function(){var e,a,n,o,l=this.props,d=l.subStatus,c=l.subChangePreview,m=l.familySku,_=l.accountPaymentInfo,f=d.finalSubState.plan,h=function(e){return r.default.createElement("a",{"aria-label":i.intl.formatMessage({id:"mRCTvJ",defaultMessage:"CancelLink"}),href:"#",onClick:s.logClickAndRedirect("de_cancel_link_click","/help/billing/cancel-dropbox-plus",{from:t.PLUS_TO_FAMILY_MODAL})},e)},y=function(e){return r.default.createElement("a",{"aria-label":i.intl.formatMessage({id:"g/nUIt",defaultMessage:"LegalLink"}),href:"#",onClick:s.logClickAndRedirect("de_legal_link_click","/help/billing/plus-refund",{from:t.PLUS_TO_FAMILY_MODAL})},e)},b=P.priceWithTaxLabel(null!==(e=c.upcoming_bill_total_price)&&void 0!==e?e:"",null!==(a=c.tax_included_in_total_amount)&&void 0!==a&&a),v=P.priceWithTaxLabel(null!==(n=c.immediate_price)&&void 0!==n?n:"",null!==(o=c.tax_included_in_total_amount)&&void 0!==o&&o),M=r.default.createElement(u.IndividualInlinePaymentMethodView,{accountPaymentInfo:_,renderUpdateLink:r.default.createElement(g.UpdateBillingInfoLink,{updateBillingCTA:this.updateBillingInfo})});return f.billingSchedule.id===p.ScheduleId.MONTHLY?i.intl.formatMessage({id:"5NWG7E",defaultMessage:"If you change from Dropbox {currentPlan} to Dropbox {plan}, we’ll charge you {proratedPrice} now. Starting on {date}, we’ll bill you {scheduledTotal} a month. Charges will continue until you <cancelLink>cancel</cancelLink>, and previous charges won’t be refunded unless it’s <legalLink>legally required</legalLink>. {paymentInfo}"},{currentPlan:d.finalSubState.plan.displayName(),plan:m.displayName(),proratedPrice:v,date:c.upcoming_bill_date,scheduledTotal:b,paymentInfo:M,cancelLink:h,legalLink:y}):i.intl.formatMessage({id:"KUkJyi",defaultMessage:"If you change from Dropbox {currentPlan} to Dropbox {plan}, we’ll charge you {proratedPrice} now. Starting on {date}, we’ll bill you {scheduledTotal} a year. Charges will continue until you <cancelLink>cancel</cancelLink>, and previous charges won’t be refunded unless it’s <legalLink>legally required</legalLink>. {paymentInfo}"},{currentPlan:d.finalSubState.plan.displayName(),plan:m.displayName(),proratedPrice:v,date:c.upcoming_bill_date,scheduledTotal:b,paymentInfo:M,cancelLink:h,legalLink:y})},n.prototype.render=function(){return r.default.createElement(d.Modal,{className:"plus-family-plan-modal",title:_.DROPBOX_FAMILY,acceptButtonDisabled:this.props.acceptButtonDisabled,acceptButtonText:i.intl.formatMessage({id:"e2x8vE",defaultMessage:"Change to {familyPlan} plan"},{familyPlan:_.TRADEMARK_FAMILY}),dismissButtonText:i.intl.formatMessage({id:"dTig7r",defaultMessage:"Cancel"}),autoClose:!1,onAccept:this.onAccept,onDismiss:this.onDismiss,submitting:this.props.submitting},this.renderPlusToFamilyPlanUpsell(),this.renderFooter())},n.displayName="PlusToFamilyModal",n})(r.default.Component);t.PlusToFamilyModal=M})),define("modules/clean/account_page/widgets/plan/views/change_schedule_modal",["require","exports","tslib","modules/core/browser","react","dig-components/typography","modules/clean/deprecated_ajax/ajax_jquery","modules/clean/analytics","modules/clean/subscription/tools/amp_logger","modules/clean/account_page/widgets/plan/constants","modules/clean/account_page/widgets/plan/views/cancel_changes_modal","modules/clean/account_page/widgets/plan/types","modules/clean/account_page/widgets/plan/views/individual_inline_payment_method","modules/clean/account_page/widgets/plan/views/update_billing_info","modules/clean/account_page/util","modules/clean/active_user","modules/clean/account_page/widgets/plan/views/change_confirmation_modal","modules/clean/dbmodal_stack","modules/clean/payments/cash","modules/clean/payments/skus/constants","modules/clean/payments/skus/subscription_change_plan","modules/clean/payments/skus/subscription_status","modules/clean/react/components/modal","modules/clean/react/payments/error/browser_update_required_modal","modules/clean/react/payments/update_individual_billing/update_individual_billing_modal_loader","modules/clean/react/payments/update_individual_billing/update_individual_store_creator","modules/core/i18n","modules/clean/account_page/constants","modules/core/notify","modules/clean/hql/index","dropbox/proto/hql_events/revenue/revenue","dropbox/proto/hql_events/extensions","dropbox/proto/hql_events/taxonomy","modules/clean/account_page/widgets/plan/revenue_api_migration_utils","modules/clean/account_page/widgets/plan/api","modules/clean/account_page/widgets/plan/revenue_api_migration_comparisons","@apollo/react-hooks","apiql/client/components/account-gql","modules/clean/account_page/widgets/plan/api"],(function(e,t,a,n,o,i,l,r,s,d,c,u,p,m,_,g,f,h,y,b,v,P,M,S,E,C,T,A,w,I,D,N,x,L,k,R,B,O,F){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChangeScheduleModalView=void 0,n=a.__importStar(n),o=a.__importDefault(o);var U=x.hql_events.TaxonomyAppSurface.AppSurface,q=x.hql_events.TaxonomyActionSurface.ActionSurface,V=(function(e){function t(a){var o=e.call(this,a)||this;return o._timeModalOpened=null,o.closeModals=function(){o.setState({open:!1})},o.onAccept=function(){var e,t,a=o.getSubChangePlan();a&&(a.finalSubState.billingSchedule.id===b.ScheduleId.MONTHLY&&(t=u.PerformPlanTransition.YEARLY,e=u.PerformPlanTransition.MONTHLY),a.finalSubState.billingSchedule.id===b.ScheduleId.YEARLY&&(t=u.PerformPlanTransition.MONTHLY,e=u.PerformPlanTransition.YEARLY),e&&t?(o.setState((function(e){return e.submitting=!0,e})),l.WebRequest({url:"/account/perform_personal_transition",data:{transition_change_type:e},subject_user:g.mustGetActiveUserId(),success:function(e){var t=JSON.parse(e);if(t.redirect)return n.redirect(t.redirect);w.Notify.success(T.intl.formatMessage({id:"dVc1qR",defaultMessage:"You’ve changed your billing period!"})),o.logChangeSchedule(),o.modalLogger.logModalSuccess(),o.props.transitionPerformed&&o.props.transitionPerformed(),o.closeModals()},error:function(){w.Notify.error(T.intl.formatMessage({id:"wiPRXu",defaultMessage:"There was an error changing the billing period!"})),o.modalLogger.logModalError("modal_submit"),o.setState((function(e){return e.submitting=!1,e}))}})):w.Notify.error(T.intl.formatMessage({id:"wiPRXu",defaultMessage:"There was an error changing the billing period!"})))},o.updateBillingInfo=function(e){r.ProEventsLogger.log("de_update_billing_info_click"),o.closeModals(),h.DBModalStack.register(C.BILLING_INFO_UPDATED,(function(){F.resetApolloStore(),t.showInstance(o.props)})),o.props.browserUpdateRequired?S.BrowserUpdateModalLoader.showInstance():E.IndividualUpdateBillingModalLoader.showInstance()},o.handleCancelScheduleAction=function(){return o.handleCancelActions(A.CancellationType.SCHEDULE),!1},o.handleCancelActions=function(e){var t=o.props.transitionPerformed;return c.CancelChangesModalConfirmationView.showInstance({transitionPerformed:t,cancellationType:e,reOpenModalDialogAfterCancellation:!1}),!1},o.transitionPerformedClosure=function(e){if(o.props.transitionPerformed)return o.props.transitionPerformed()},o.onDismissModal=function(){r.ProEventsLogger.log("de_cancel_billing_change_modal"),o.setState({open:!1})},o.state={loadingContent:!0,subChangePlans:[],submitting:!1,hasLicenseKey:!1,open:!0},o.modalLogger=s.getSubscriptionAMPLogger({ns:"personal",modal:s.ModalTypes.CHANGE_SCHEDULE_MODAL}),o}return a.__extends(t,e),Object.defineProperty(t.prototype,"isProfessionalTrialPlan",{get:function(){var e=this.state.subStatus;return!(!e||!e.subState.plan)&&e.subState.plan.productType===b.ProductPlanType.PROFESSIONAL_TRIAL},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isPlusTrialPlan",{get:function(){var e,t=this.state.subStatus;return(null===(e=null==t?void 0:t.subState.plan)||void 0===e?void 0:e.productType)===b.ProductPlanType.PLUS_TRIAL},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"productTypeStr",{get:function(){var e,t,a;return null===(a=null===(t=null===(e=this.state.subStatus)||void 0===e?void 0:e.subState)||void 0===t?void 0:t.plan)||void 0===a?void 0:a.productType.toString()},enumerable:!1,configurable:!0}),t.showInstance=function(e){M.Modal.showInstance(o.default.createElement(t,a.__assign({},e)))},t.prototype.componentDidMount=function(){this._timeModalOpened=Date.now(),this.logChangeScheduleModalOpen(),this.loadPlanTransitions()},t.prototype.logTTI=function(){if(this._timeModalOpened){var e=Date.now()-this._timeModalOpened;this.modalLogger.setProductPlanType(this.productTypeStr),this.modalLogger.logModalTTI(e)}},t.prototype.loadPlanTransitions=function(){var e=this;l.WebRequest({url:"/account/ajax_change_plan_schedule",subject_user:g.mustGetActiveUserId(),success:function(t){var n=JSON.parse(t);e.setState((function(e){var t,o=a.__assign({},e);o.loadingContent=!1,o.subStatus=P.SubscriptionStatus.deserialize(n.serializedSubStatus),o.paymentMethod=n.paymentMethod,o.hasLicenseKey=n.hasLicenseKey;var i=o.subStatus.finalSubState;if(!i.billingSchedule||!i.plan)throw"A base plan is required, in order to change it.";return o.subChangePlans=n.serializedSubChangePlans.map((function(e){return v.SubscriptionChangePlan.deserialize(e)})),o.allSubStatuses=o.subChangePlans.map((function(e){return e})),o.allSubStatuses.push(o.subStatus),o.growthRevapiPaPlanManagementCompareData=n.growthRevapiPaPlanManagementCompareData,r.ProEventsLogger.log("de_plan_tab_change_billing_load_modal",{from:(null===(t=o.subStatus.subState.billingSchedule)||void 0===t?void 0:t.id)===b.ScheduleId.MONTHLY?"monthly":"yearly"}),o}),e.logTTI)},error:function(){w.Notify.error(T.intl.formatMessage({id:"C2BKnZ",defaultMessage:"Failed to load modal."})),e.modalLogger.logModalError("modal_init"),e.closeModals()}})},t.prototype.getSubChangePlan=function(){var e=this;return this.state.subChangePlans.filter((function(t){var a=t.finalSubState;return!(!a.plan||!a.billingSchedule)&&(a.plan.productType===e.currentPlanType&&a.billingSchedule.id===e.scheduleToSwitchTo)})).pop()},Object.defineProperty(t.prototype,"subStatusScheduleId",{get:function(){var e=this.state.subStatus;return e&&e.finalSubState.billingSchedule?e.finalSubState.billingSchedule.id:b.ScheduleId.MONTHLY},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scheduleToSwitchTo",{get:function(){return this.state.subStatus&&this.state.subStatus.subState.billingSchedule.id===b.ScheduleId.MONTHLY?b.ScheduleId.YEARLY:b.ScheduleId.MONTHLY},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentPlanType",{get:function(){var e,t;return(null===(t=null===(e=this.state.subStatus)||void 0===e?void 0:e.finalSubState.plan)||void 0===t?void 0:t.productType)||b.ProductPlanType.STANDARD},enumerable:!1,configurable:!0}),t.prototype.logChangeScheduleModalOpen=function(){var e,t;this.props.isFromBillingTab?(e=q.CENTER_PANE_BILLING_TAB,t="de_billing_tab_change_billing_open_modal"):(e=q.CENTER_PANE_PLAN_TAB,t="de_plan_tab_change_billing_open_modal");var a=N.hql_events.HQLEventIdentity.create({eventClass:N.hql_events.HQLEventIdentity.EventClass.create({className:x.hql_events.TaxonomyClass.ClassName.SEE_AND_CLICK}),legacyEvent:N.hql_events.HQLEventIdentity.LegacyEvent.create({table:"pro_events",name:t}),actionEventId:N.hql_events.HQLEventIdentity.ActionEventIdentity.create({object:"change_billing_schedule_modal",action:x.hql_events.TaxonomyAction.Action.SHOWN})});I.logEvent(D.hql_events.ShownChangeBillingScheduleModal.create({hqlMetadata:N.hql_events.HQLMetadata.create({appSurface:U.WEB,actionSurface:e,identityOverride:a})}))},t.prototype.logChangeSchedule=function(){var e=this.state.subStatus;e&&e.subState.billingSchedule&&r.ProEventsLogger.log("de_change_billing_change_schedule",{from:e.subState.billingSchedule.id===b.ScheduleId.MONTHLY?"monthly":"yearly",to:e.subState.billingSchedule.id===b.ScheduleId.MONTHLY?"yearly":"monthly"})},t.prototype.isBillingScheduleToChange=function(){var e=this.state,t=e.subStatus;return!e.hasLicenseKey&&(!!(t&&t.subState.billingSchedule&&t.finalSubState.billingSchedule)&&t.subState.billingSchedule.id!==t.finalSubState.billingSchedule.id)},Object.defineProperty(t.prototype,"changesSummaryContent",{get:function(){var e=this,t=this.state,a=t.subStatus,n=t.paymentMethod,l=this.getSubChangePlan();if(a&&a.subState.plan){if(a.subState.plan.scheduleId!==a.finalSubState.plan.scheduleId&&!this.isProfessionalTrialPlan)return T.intl.formatMessage({id:"uGbqz6",defaultMessage:"You’ve already requested a change to your billing period. If you want to choose a different billing period, first cancel your pending change. <cancelChangeLink>Cancel change</cancelChangeLink>"},{cancelChangeLink:function(t){return o.default.createElement(i.Link,{href:"#","aria-label":T.intl.formatMessage({id:"7kgsyk",defaultMessage:"Cancel change"}),className:"change-confirmation-modal__link",onClick:e.handleCancelScheduleAction,variant:"primary",hasNoUnderline:!0},t)}});var r={nextBillingDate:a.subState.formattedNextBillingDate,scheduleId:l.finalSubState.billingSchedule.id,totalPrice:y.Cash.formatWithTaxLabels(l.nextBillingSummary.total,l.nextBillingSummary)},s=o.default.createElement(p.IndividualInlinePaymentMethodView,{accountPaymentInfo:L.convertLegacyPaymentInfo(n),renderUpdateLink:o.default.createElement(m.UpdateBillingInfoLink,{updateBillingCTA:this.updateBillingInfo}),transitionDetails:r});return T.intl.formatMessage({id:"pVEqbN",defaultMessage:"{paymentInfo}{br}{br}Charges will continue until you <cancelLink>cancel</cancelLink>, and previous charges won’t be refunded <legalLink>unless it’s legally required</legalLink>."},{br:o.default.createElement("br",null),strong:function(e){return o.default.createElement("strong",null,e)},cancelLink:function(e){return o.default.createElement(i.Link,{href:"#","aria-label":T.intl.formatMessage({id:"A3cCkZ",defaultMessage:"Cancel link"}),onClick:_.logClickAndRedirect("de_cancel_link_click","/help/billing/cancel-dropbox-plus",{from:"change_plan_modal"}),variant:"primary",hasNoUnderline:!0},e)},legalLink:function(e){return o.default.createElement(i.Link,{href:"#","aria-label":T.intl.formatMessage({id:"5Kyedz",defaultMessage:"Legal link"}),onClick:_.logClickAndRedirect("de_legal_link_click","/help/billing/plus-refund",{from:"change_plan_modal"}),variant:"primary",hasNoUnderline:!0},e)},paymentInfo:s})}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"acceptButtonDisabled",{get:function(){var e=this.state.paymentMethod,t=this.state,a=t.loadingContent,n=t.submitting;return a||n||!e||this.isBillingScheduleToChange()},enumerable:!1,configurable:!0}),t.prototype.render=function(){var e=this,a=this.state,n=a.subStatus,i=a.loadingContent,l=a.submitting,r=a.open,s=a.growthRevapiPaPlanManagementCompareData,c=this.props.transitionPerformed;n&&c&&!this.isProfessionalTrialPlan&&!this.isPlusTrialPlan&&(h.DBModalStack.clear(),h.DBModalStack.register(d.CHANGE_IND_PLAN_MODAL_UPDATED,(function(){t.showInstance({transitionPerformed:e.transitionPerformedClosure})})));var u=T.intl.formatMessage({id:"BKISIV",defaultMessage:"Confirm"}),p=T.intl.formatMessage({id:"d9/SE1",defaultMessage:"Cancel"}),_=this.isBillingScheduleToChange()&&!this.isProfessionalTrialPlan?T.intl.formatMessage({id:"ewZ2I2",defaultMessage:"Change billing period"}):this.scheduleToSwitchTo===b.ScheduleId.YEARLY?T.intl.formatMessage({id:"z17QUa",defaultMessage:"You’re switching to yearly billing"}):T.intl.formatMessage({id:"/tHQbR",defaultMessage:"You’re switching to monthly billing"}),g=o.default.createElement(m.UpdateBillingInfoButton,{updateBillingCTA:this.updateBillingInfo}),y=this.state.subChangePlans.map((function(e){return e.finalSubState.plan})).filter((function(e){return e}));return o.default.createElement(B.ApolloProvider,{client:k.getApolloClient()},s&&o.default.createElement(R.CompareRevApiAvailablePlans,{upcomingPlanId:n.finalSubState.planSku.code,legacyAvailablePlans:L.convertLegacyAvailablePlansData(y),filterContractLength:O.AccountPlanFilterArgument.DifferentThanScheduled,filterProductFamily:O.AccountPlanFilterArgument.SameAsScheduled,context:"change_schedule_modal"}),o.default.createElement(f.ChangeConfirmationModal,{acceptButtonDisabled:this.acceptButtonDisabled,acceptButtonText:u,description:this.changesSummaryContent,dismissButtonText:p,link:g,loadingContent:i,onAccept:this.onAccept,onDismiss:this.onDismissModal,open:r,submitting:l,title:_}))},t.displayName="ChangeScheduleModalView",t})(o.default.Component);t.ChangeScheduleModalView=V})),define("modules/clean/account_page/widgets/plan/views/disband_family_confirmation_modal",["require","exports","tslib","react","styled-components","dig-components/modal","dig-components/typography","dig-components/controls","modules/core/i18n","modules/clean/react/components/modal","modules/clean/dbmodal_stack","dig-components/buttons","modules/constants/trademark","family/common/links"],(function(e,t,a,n,o,i,l,r,s,d,c,u,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showDisbandModal=t.DisbandFamilyConfirmationModal=t.FAMILY_DISBAND_MODAL_GO_BACK=void 0,n=a.__importDefault(n);var _,g,f,h,y=(o=a.__importDefault(o)).default.div(_||(_=a.__makeTemplateObject(["\n  display: flex;\n  margin-bottom: var(--spacing__unit--2);\n  &:last-child {\n    margin-bottom: 0;\n  }\n"],["\n  display: flex;\n  margin-bottom: var(--spacing__unit--2);\n  &:last-child {\n    margin-bottom: 0;\n  }\n"]))),b=o.default(r.Checkbox)(g||(g=a.__makeTemplateObject(["\n  margin-top: var(--spacing__unit--0_5);\n  max-width: 20px;\n  flex: 1;\n  margin-right: var(--spacing__base_unit);\n"],["\n  margin-top: var(--spacing__unit--0_5);\n  max-width: 20px;\n  flex: 1;\n  margin-right: var(--spacing__base_unit);\n"]))),v=o.default.div(f||(f=a.__makeTemplateObject(["\n  margin-bottom: var(--spacing__unit--3);\n"],["\n  margin-bottom: var(--spacing__unit--3);\n"]))),P=o.default(l.Text)(h||(h=a.__makeTemplateObject(["\n  flex: 2;\n"],["\n  flex: 2;\n"]))),M=function(e){var t=e.children;return n.default.createElement(l.Link,{href:m.FAMILY_ROOM_HELP_CENTER_ARTICLE,target:"_blank",rel:"noreferrer",variant:"monochromatic"},t)};M.displayName="FamilyRoomHelpCenterArticle",t.FAMILY_DISBAND_MODAL_GO_BACK="disband_family_confirmation_modal:goback",t.DisbandFamilyConfirmationModal=function(e){var a=e.displayFamilyRoomCheckbox,o=n.default.useState(!1),r=o[0],m=o[1],_=n.default.useState(!1),g=_[0],f=_[1],h=n.default.useState(!1),S=h[0],E=h[1],C=n.default.useState(!1),T=C[0],A=C[1],w=!r||!g||a&&!S||T,I=function(){d.Modal.close()},D=function(){A(!1)};return n.default.createElement(i.Modal,{open:!0,className:"disband-family-confirmation-modal",overlayClassName:"disband-family-confirmation-modal-overlay",width:"small",onRequestClose:I},n.default.createElement(i.Modal.Header,{hasBottomSpacing:"title-standard"},n.default.createElement(l.Title,{isBold:!0},s.intl.formatMessage({id:"I9CTpA",defaultMessage:"Are you sure you want to change plans?"}))),n.default.createElement(i.Modal.Body,null,n.default.createElement(v,null,n.default.createElement(P,null,s.intl.formatMessage({id:"QDkSaP",defaultMessage:"{dropbox_family} will be canceled, and active members of your {family_plan} plan will have their accounts downgraded to {dropbox_basic}"},{dropbox_family:p.DROPBOX_FAMILY,family_plan:p.TRADEMARK_FAMILY,dropbox_basic:p.DROPBOX_BASIC}))),n.default.createElement(v,null,n.default.createElement(P,{isBold:!0},s.intl.formatMessage({id:"Md6TJX",defaultMessage:"If you still want to change plans, please acknowledge the following:"}))),n.default.createElement(y,null,n.default.createElement(b,{onChange:function(){m(!r)},checked:r,className:"disband-confirmation-checkbox downgrade-acknowledged"}),n.default.createElement(P,null,s.intl.formatMessage({id:"+E9wLh",defaultMessage:"By proceeding, {family_plan} plan members will be downgraded to a {basic_space_quota} {dropbox_basic} plan."},{family_plan:p.TRADEMARK_FAMILY,dropbox_basic:p.DROPBOX_BASIC,basic_space_quota:e.basicSkuQuotaGb}))),a&&n.default.createElement(y,null,n.default.createElement(b,{onChange:function(){E(!S)},checked:S,className:"disband-confirmation-checkbox family-shared-folder-acknowledged"}),n.default.createElement(P,null,s.intl.formatMessage({id:"DaDVT1",defaultMessage:"All members will keep a copy of your <link>Family Room folder.</link>"},{link:function(e){return n.default.createElement(M,null,e)}}))),n.default.createElement(y,null,n.default.createElement(b,{onChange:function(){f(!g)},checked:g,className:"disband-confirmation-checkbox over-quota-acknowledged"}),n.default.createElement(P,null,s.intl.formatMessage({id:"zGHPY9",defaultMessage:"If members are using more than {basic_space_quota} of storage, Dropbox will stop syncing, additional files can’t be uploaded, and files can’t be restored to earlier versions."},{basic_space_quota:e.basicSkuQuotaGb})))),n.default.createElement(i.Modal.Footer,null,n.default.createElement(u.Button,{className:"disband-family-confirmation-modal-back",disabled:T,variant:"transparent",onClick:function(){d.Modal.close(),c.DBModalStack.trigger(t.FAMILY_DISBAND_MODAL_GO_BACK,{})}},s.intl.formatMessage({id:"lhKaOC",defaultMessage:"Back"})),n.default.createElement(u.Button,{className:"disband-family-confirmation-modal-cancel",disabled:T,variant:"opacity",onClick:I},s.intl.formatMessage({id:"d9/SE1",defaultMessage:"Cancel"})),n.default.createElement(u.Button,{className:"disband-family-confirmation-modal-confirm",variant:"primary",onClick:function(){A(!0),e.confirmChangePlan(D)},disabled:w},s.intl.formatMessage({id:"ZCkVHN",defaultMessage:"Confirm change"}))))},t.showDisbandModal=function(e){d.Modal.showInstance(n.default.createElement(t.DisbandFamilyConfirmationModal,a.__assign({},e)))}})),define("modules/clean/account_page/widgets/plan/views/loading_view",["require","exports","tslib","react","modules/core/i18n","modules/clean/static_urls"],(function(e,t,a,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoadingView=void 0,n=a.__importStar(n),t.LoadingView=function(e){return n.createElement("div",{className:e.className},n.createElement("img",a.__assign({src:i.static_url("/static/images/icons/ajax-loading-small-blue-vflVk_QNP.gif"),alt:o.intl.formatMessage({id:"jybGUg",defaultMessage:"Loading"})},e.imageProps)))}})),define("modules/clean/account_page/widgets/plan/views/individual_inline_payment_method",["require","exports","tslib","react","modules/core/i18n","modules/clean/payments/skus/constants","apiql/client/components/account-gql"],(function(e,t,a,n,o,i,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IndividualInlinePaymentMethodView=void 0;var r=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.renderCreditCard=function(){var e=this.props,t=e.accountPaymentInfo,a=e.transitionDetails;if(t){var l=t.last_digits,r=void 0;if(a){var s=a.nextBillingDate,d=a.scheduleId,c=a.totalPrice;return r=d===i.ScheduleId.YEARLY?o.intl.formatMessage({id:"IK0bTU",defaultMessage:"Starting <strong>{date}</strong>, we’ll charge you <strong>{scheduled_total}</strong> per year on your card ending in <strong>{last4}</strong>."},{last4:l,date:s,scheduled_total:c,strong:function(e){return n.default.createElement("strong",null,e)}}):o.intl.formatMessage({id:"QRWsYu",defaultMessage:"Starting <strong>{date}</strong>, we’ll charge you <strong>{scheduled_total}</strong> per month on your card ending in <strong>{last4}</strong>."},{last4:l,date:s,scheduled_total:c,strong:function(e){return n.default.createElement("strong",null,e)}}),n.default.createElement("span",null,r," ")}return r=o.intl.formatMessage({id:"GK+TXw",defaultMessage:"We’ll charge your card ending in {last4}."},{last4:l}),n.default.createElement("span",null,r," ",this.props.renderUpdateLink)}return n.default.createElement("span",null)},t.prototype.renderDirectDebit=function(){var e=this.props,t=e.accountPaymentInfo,a=e.transitionDetails;if(t){var l=t.last_digits,r=void 0;if(a){var s=a.nextBillingDate,d=a.scheduleId,c=a.totalPrice;return r=d===i.ScheduleId.YEARLY?o.intl.formatMessage({id:"5ZcdXx",defaultMessage:"Starting <strong>{date}</strong>, we’ll charge you <strong>{scheduled_total}</strong> per year on your IBAN ending in <strong>{last4}</strong>."},{last4:l,date:s,scheduled_total:c,strong:function(e){return n.default.createElement("strong",null,e)}}):o.intl.formatMessage({id:"j+Ib+Z",defaultMessage:"Starting <strong>{date}</strong>, we’ll charge you <strong>{scheduled_total}</strong> per month on your IBAN ending in <strong>{last4}</strong>."},{last4:l,date:s,scheduled_total:c,strong:function(e){return n.default.createElement("strong",null,e)}}),n.default.createElement("span",null,r," ")}return r=o.intl.formatMessage({id:"RFtAL9",defaultMessage:"We’ll charge your IBAN ending in {last4}."},{last4:l}),n.default.createElement("span",null,r," ",this.props.renderUpdateLink)}return n.default.createElement("span",null)},t.prototype.renderPaypal=function(){var e=this.props,t=e.renderUpdateLink,a=e.transitionDetails;if(a){var l=a.nextBillingDate,r=a.scheduleId,s=a.totalPrice,d=r===i.ScheduleId.YEARLY?o.intl.formatMessage({id:"GvhVZe",defaultMessage:"Starting <strong>{date}</strong>, we’ll charge you <strong>{scheduled_total}</strong> per year on your PayPal account."},{date:l,scheduled_total:s,strong:function(e){return n.default.createElement("strong",null,e)}}):o.intl.formatMessage({id:"S7Wy/F",defaultMessage:"Starting <strong>{date}</strong>, we’ll charge you <strong>{scheduled_total}</strong> per month on your PayPal account."},{date:l,scheduled_total:s,strong:function(e){return n.default.createElement("strong",null,e)}});return n.default.createElement("span",null,d," ")}return n.default.createElement("span",null,o.intl.formatMessage({id:"aQ9deh",defaultMessage:"We’ll charge your PayPal account."})," ",t)},t.prototype.renderIdeal=function(){var e=this.props,t=e.renderUpdateLink,a=e.transitionDetails;if(a){var l=a.nextBillingDate,r=a.scheduleId,s=a.totalPrice,d=r===i.ScheduleId.YEARLY?o.intl.formatMessage({id:"TZiYnT",defaultMessage:"Starting <strong>{date}</strong>, we’ll charge you <strong>{scheduled_total}</strong> per year on your iDEAL account."},{date:l,scheduled_total:s,strong:function(e){return n.default.createElement("strong",null,e)}}):o.intl.formatMessage({id:"8MQcfN",defaultMessage:"Starting <strong>{date}</strong>, we’ll charge you <strong>{scheduled_total}</strong> per month on your iDEAL account."},{date:l,scheduled_total:s,strong:function(e){return n.default.createElement("strong",null,e)}});return n.default.createElement("span",null,d," ")}return n.default.createElement("span",null,o.intl.formatMessage({id:"7EJCsH",defaultMessage:"We’ll charge your iDEAL account."})," ",t)},t.prototype.render=function(){var e=this.props,t=e.accountPaymentInfo,a=e.paymentErrorMessage;if(!t&&a)return n.default.createElement("span",null,a," ",this.props.renderUpdateLink);if(!t)return n.default.createElement("span",null);switch(t.active_payment_method_type){case l.AccountPaymentInfoType.Card:return this.renderCreditCard();case l.AccountPaymentInfoType.Sepa:return this.renderDirectDebit();case l.AccountPaymentInfoType.Paypal:return this.renderPaypal();case l.AccountPaymentInfoType.Ideal:return this.renderIdeal();default:return n.default.createElement("span",null)}},t.displayName="IndividualInlinePaymentMethodView",t})((n=a.__importDefault(n)).default.Component);t.IndividualInlinePaymentMethodView=r})),define("modules/clean/account_page/widgets/plan/views/npt_billing_schedule_items",["require","exports","tslib","react","modules/core/i18n","modules/clean/teams/admin/widgets/admin_priced_list/admin_priced_list_item","modules/clean/payments/skus/constants","modules/clean/teams/admin/widgets/admin_priced_list/admin_priced_list"],(function(e,t,a,n,o,i,l,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NptBillingScheduleItems=void 0;var s=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.changeProductScheduleTypeClosure=function(e){var t=this;return function(){t.props.changeProductScheduleType(e)}},t.prototype.getScheduleDescription=function(e,t,a,n){switch(e){case l.ScheduleId.YEARLY:return o.intl.formatMessage({id:"Fd23KZ",defaultMessage:"{plan_name} is {price_per_year} per year. You’ll save {savePercentage} over monthly billing."},{plan_name:this.props.planName,price_per_year:a,savePercentage:n});case l.ScheduleId.MONTHLY:return o.intl.formatMessage({id:"XD9xb9",defaultMessage:"{plan_name} is {price_per_month} per month. You’ll spend {price_per_year} per year."},{plan_name:this.props.planName,price_per_month:t,price_per_year:a})}return""},t.prototype.getBillingItemTitle=function(e){switch(e){case l.ScheduleId.YEARLY:return o.intl.formatMessage({id:"onubGk",defaultMessage:"Billed yearly"});case l.ScheduleId.MONTHLY:return o.intl.formatMessage({id:"ytUb1D",defaultMessage:"Billed monthly"})}return""},t.prototype.render=function(){var e=this,t=this.props,a=t.trialPriceConversions,s=t.finalBillingScheduleId;return n.default.createElement(r.AdminPricedList,null,Object.keys(a).map((function(t){var r=parseInt(t,10),d=r===s,c=a[t],u=c.advertised_monthly_price,p=o.intl.formatMessage({id:"0OYZsq",defaultMessage:"per month"});return r===l.ScheduleId.YEARLY&&(u=c.advertised_yearly_price,p=o.intl.formatMessage({id:"1BL+ll",defaultMessage:"per year"})),n.default.createElement(i.AdminPricedListItem,{key:c.conversion_token.plan_sku_code,isSelected:d,title:e.getBillingItemTitle(r),titleWarningText:void 0,titleSecondaryText:void 0,description:e.getScheduleDescription(r,c.advertised_monthly_price,c.advertised_yearly_price,c.advertised_yearly_price_savings),price:void 0,priceString:u,detailsLink:void 0,unit:p,onClick:e.changeProductScheduleTypeClosure(r),disableItem:!1,recommended:r===l.ScheduleId.YEARLY})})))},t.displayName="NptBillingScheduleItems",t})((n=a.__importDefault(n)).default.Component);t.NptBillingScheduleItems=s})),define("modules/clean/account_page/widgets/plan/views/plan_status",["require","exports","tslib","modules/core/browser","react","styled-components","modules/clean/viewer","modules/core/assert","modules/core/uri","modules/core/i18n","modules/core/exception","modules/clean/react/payments/update_individual_billing/update_individual_billing_modal_loader","modules/clean/account_page/widgets/plan/strings","modules/clean/account_page/widgets/billing/payment_methods_util","modules/clean/payments/billing_instrument/payment_methods_util","modules/clean/payments/billing_instrument/payment_method_constants","modules/clean/static_urls","modules/clean/react/payments/error/browser_update_required_modal","modules/clean/payments/cash","modules/clean/account_page/widgets/plan/views/change_plan_modal","modules/clean/account_page/widgets/plan/views/cancel_subs_warning_modal","modules/clean/payments/skus/constants","modules/clean/analytics","modules/constants/trademark","dig-components/buttons","modules/clean/account_page/widgets/plan/views/basic_plan_status","modules/core/notify","modules/clean/hql/index","dropbox/proto/hql_events/activation/activation","dropbox/proto/hql_events/revenue/revenue","dropbox/proto/hql_events/extensions","dropbox/proto/hql_events/taxonomy","modules/clean/account_page/components/key_value_block","modules/clean/account_page/widgets/plan/views/addons/addon_section","modules/clean/account_page/widgets/plan/views/addons/constants"],(function(e,t,a,n,o,i,l,r,s,d,c,u,p,m,_,g,f,h,y,b,v,P,M,S,E,C,T,A,w,I,D,N,x,L,k){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlanStatus=void 0,n=a.__importStar(n),o=a.__importDefault(o),i=a.__importDefault(i),c=a.__importStar(c);var R,B,O=N.hql_events.TaxonomyAppSurface.AppSurface,F=N.hql_events.TaxonomyActionSurface.ActionSurface,U=i.default(x.KeyValueBlock)(J||(J=a.__makeTemplateObject(["\n  .account-key-value-block__value {\n    margin-right: 0;\n  }\n"],["\n  .account-key-value-block__value {\n    margin-right: 0;\n  }\n"]))),q=i.default.div($||($=a.__makeTemplateObject(["\n  display: flex;\n\n  .plan-status-section__link {\n    white-space: nowrap;\n    font-size: var(--type__body__standard--fontsize);\n  }\n"],["\n  display: flex;\n\n  .plan-status-section__link {\n    white-space: nowrap;\n    font-size: var(--type__body__standard--fontsize);\n  }\n"]))),V=i.default.div(ee||(ee=a.__makeTemplateObject(["\n  flex-grow: 1;\n  color: var(--color__faint__text);\n  font-size: var(--type__body__small--fontsize);\n  line-height: var(--type__body__large--lineheight);\n"],["\n  flex-grow: 1;\n  color: var(--color__faint__text);\n  font-size: var(--type__body__small--fontsize);\n  line-height: var(--type__body__large--lineheight);\n"]))),j=i.default.h1(te||(te=a.__makeTemplateObject(["\n  font-size: var(--type__body__large--fontsize);\n  margin-bottom: var(--spacing__unit--2);\n  color: var(--color__standard__text);\n"],["\n  font-size: var(--type__body__large--fontsize);\n  margin-bottom: var(--spacing__unit--2);\n  color: var(--color__standard__text);\n"]))),Y=i.default.p(ae||(ae=a.__makeTemplateObject(["\n  color: var(--color__faint__text);\n  font-size: var(--type__body__standard--fontsize);\n  line-height: var(--type__body__standard--lineheight);\n  width: 100%;\n  max-width: 520px;\n  padding-right: 8px;\n  box-sizing: border-box;\n"],["\n  color: var(--color__faint__text);\n  font-size: var(--type__body__standard--fontsize);\n  line-height: var(--type__body__standard--lineheight);\n  width: 100%;\n  max-width: 520px;\n  padding-right: 8px;\n  box-sizing: border-box;\n"]))),H=i.default.div(ne||(ne=a.__makeTemplateObject(["\n  flex-basis: 140px;\n  text-align: right;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  height: var(--spacing__unit--4);\n  margin-top: 30px;\n"],["\n  flex-basis: 140px;\n  text-align: right;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  height: var(--spacing__unit--4);\n  margin-top: 30px;\n"]))),G=i.default.span(oe||(oe=a.__makeTemplateObject(["\n  font-size: var(--type__body__small--fontsize);\n"],["\n  font-size: var(--type__body__small--fontsize);\n"]))),z=i.default.a(ie||(ie=a.__makeTemplateObject(["\n  font-style: italic;\n"],["\n  font-style: italic;\n"]))),W=i.default.div(le||(le=a.__makeTemplateObject(["\n  width: 36px;\n  margin: var(--spacing__base_unit) var(--spacing__unit--2) auto var(--spacing__base_unit);\n  height: 69px;\n"],["\n  width: 36px;\n  margin: var(--spacing__base_unit) var(--spacing__unit--2) auto var(--spacing__base_unit);\n  height: 69px;\n"]))),Q=i.default(E.Button)(re||(re=a.__makeTemplateObject(["\n  height: var(--spacing__unit--4);\n  margin: 0;\n  padding: 0;\n"],["\n  height: var(--spacing__unit--4);\n  margin: 0;\n  padding: 0;\n"]))),K=i.default(E.Button)(se||(se=a.__makeTemplateObject(["\n  line-height: var(--type__body__small--lineheight);\n  height: auto;\n  min-height: var(--spacing__unit--4);\n  margin: var(--spacing__unit--2) 0;\n  padding: var(--spacing__unit--0_5);\n  white-space: normal;\n"],["\n  line-height: var(--type__body__small--lineheight);\n  height: auto;\n  min-height: var(--spacing__unit--4);\n  margin: var(--spacing__unit--2) 0;\n  padding: var(--spacing__unit--0_5);\n  white-space: normal;\n"]))),X=i.default.p(de||(de=a.__makeTemplateObject(["\n  padding: 0;\n  margin: 0;\n"],["\n  padding: 0;\n  margin: 0;\n"]))),Z=i.default.div(ce||(ce=a.__makeTemplateObject(["\n  .plan-status-section__try-free-trial {\n    position: relative;\n\n    p {\n      width: 370px;\n      margin: 0;\n    }\n  }\n"],["\n  .plan-status-section__try-free-trial {\n    position: relative;\n\n    p {\n      width: 370px;\n      margin: 0;\n    }\n  }\n"])));(function(e){e[e.Cancel=0]="Cancel",e[e.Change=1]="Change",e[e.Manage=2]="Manage",e[e.Upgrade=3]="Upgrade"})(R||(R={})),(function(e){e.BUTTON="button",e.QUERY_PARAM="query_param"})(B||(B={}));var J,$,ee,te,ae,ne,oe,ie,le,re,se,de,ce,ue=(function(e){function t(t){var a=e.call(this,t)||this;return a.isOverQuota=function(){return a.usage>a.quota},a.logSeePlanDetails=function(){var e=a.props.isTransactionInformationPage;A.logEvent(w.hql_events.SelectMoreDetails.create({isTransactionInformationPage:Boolean(e),hqlMetadata:D.hql_events.HQLMetadata.create({appSurface:O.WEB,actionSurface:F.CENTER_PANE})})),M.ProEventsLogger.log("de_plan_tab_details_click")},a.cancelPlanClick=function(){a.props.isPersonalUser?n.redirect("/cancel-subscription"):n.redirect("/team/cancel")},a.hasAddons=function(){var e=a.props.addonsInfo;return!!e&&0!==e.length},a.canShowChangePlan=function(e){var t,n=a.props,o=n.subStatus,i=n.eligibleFor1tb,l=n.addonsLoadingState,r=[P.ProductPlanType.STANDARD,P.ProductPlanType.PLUS,P.ProductPlanType.PROFESSIONAL,P.ProductPlanType.TRANSFER,P.ProductPlanType.SYNC_EVERYTHING,P.ProductPlanType.HS_DBX_PRO_BUNDLE,P.ProductPlanType.FAMILY_PAYER];e||r.push(P.ProductPlanType.FAMILY_NONPAYER);var s=null===(t=null==o?void 0:o.subState.plan)||void 0===t?void 0:t.productType;return!(!s||-1===r.indexOf(s))&&(!("ready"===l&&a.hasAddons())&&(!(a.props.hasUnusedLicenseKey||!a.isInStandardSchedule()||i)&&!a.isExternallyManagedSubscription))},a.onUpdateBillingClick=function(e){e.preventDefault(),a.props.browserUpdateRequired?h.BrowserUpdateModalLoader.showInstance():u.IndividualUpdateBillingModalLoader.showInstance()},a.logUpgradeButtonClick=function(){var e=D.hql_events.HQLEventIdentity.create({eventClass:D.hql_events.HQLEventIdentity.EventClass.create({className:N.hql_events.TaxonomyClass.ClassName.SEE_AND_CLICK}),legacyEvent:D.hql_events.HQLEventIdentity.LegacyEvent.create({table:"pro_events",name:"de_plan_tab_upgrade_to_plus_click"}),actionEventId:D.hql_events.HQLEventIdentity.ActionEventIdentity.create({object:"basic_upgrade_button",action:N.hql_events.TaxonomyAction.Action.SELECT})});A.logEvent(I.hql_events.SelectBasicUpgradeButton.create({hqlMetadata:D.hql_events.HQLMetadata.create({appSurface:O.WEB,actionSurface:F.CENTER_PANE_PLAN_TAB,identityOverride:e})}))},a.redirectToUpgrade=function(){a.logUpgradeButtonClick(),M.ProEventsLogger.log("de_plan_tab_upgrade_to_plus_click");var e=a.isOverQuota()?"acc_plan_upgrade_overquota_btn":"acc_plan_upgrade",t=new s.URI({path:"/upgrade",query:{oqa:e}}).toString();n.redirect(t)},a.purchaseNowClick=function(){M.ProEventsLogger.log("de_plan_tab_purchase_now_click"),n.redirect("/pro/convert")},a.cancelTrialClick=function(){M.ProEventsLogger.log("de_plan_tab_cancel_trial_click");var e=a.props.modalCallbacks;if(null==e?void 0:e.openIndividualCancelSurvey)return e.openIndividualCancelSurvey();n.redirect("/account/plan?modal=individual_cancel_survey")},a.contactSupportClick=function(){M.ProEventsLogger.log("de_plan_tab_contact_support_click"),n.redirect("/support")},a.addPaymentClick=function(){M.ProEventsLogger.log("de_plan_tab_add_payment_method_click"),u.IndividualUpdateBillingModalLoader.showInstance()},a.logOpenChangePlanModal=function(){var e,t=a.props.subStatus;if((null===(e=null==t?void 0:t.subState.plan)||void 0===e?void 0:e.productClass)===P.ProductClass.PLAN){var n=t.subState.plan.productType;A.logEvent(I.hql_events.ShownChangePlanModal.create({currentProductPlanType:n,hqlMetadata:D.hql_events.HQLMetadata.create({appSurface:O.WEB,actionSurface:F.CENTER_PANE})})),M.ProEventsLogger.log("change_plan_modal_view",{current_product_plan_type:P.ProductPlanType[n]})}else c.reportException({err:new Error("Change plan modal opened without a plan"),severity:"non-critical"})},a.openChangePlanModal=function(e,t,o){void 0===t&&(t=B.BUTTON),void 0===o&&(o=b.ChangePlanOrigin.DEFAULT),e&&e.preventDefault(),a.props.isLoggedInUser||(a.props.isPersonalUser?n.redirect("/account/plan"):n.redirect("/team/admin/billing/manage"));var i=a.props,l=i.browserUpdateRequired,r=i.scheduledForDowngrade,d=i.paymentInfo;if(r)v.CancelChangesModalConfirmation.showInstance({transitionPerformed:a.props.onAddonUpdate,subStatus:a.props.subStatus,userIdOverride:a.getUserForModal()});else if(a.props.useChangePlanExperience){var c=s.URI.parse(n.get_href()).getQuery().option;c?n.redirect("/plan-configuration?option="+c):n.redirect("/plan-configuration")}else b.ChangePlanModalView.showInstance({browserUpdateRequired:l,transitionPerformed:a.props.onAddonUpdate,paymentInfo:d,origin:o,userIdOverride:a.getUserForModal()}),a.logOpenChangePlanModal()},a.renderContactSupportLink=function(){return o.default.createElement("a",{href:"#",className:"plan-status-section__link account-page__link plan-status-section__contact_support_link",onClick:a.contactSupportClick},d.intl.formatMessage({id:"NYuVLU",defaultMessage:"Contact support to change plan"}))},a.renderBillingPeriod=function(){var e=a.props,t=e.paymentInfo,n=e.scheduledForDowngrade,i=e.hasUnusedLicenseKey,l=e.subStatus;if(!a.isFamilyNonPayerPlan()&&!a.isBackupPlan()&&t&&a.props.showChangeBillingPeriod&&!i&&l&&l.subState.plan){var r=t.gateway_id,s=t.is_reseller_billing,c=t.end_date,u=t.deactivated,p=t.is_on_trial,_=t.reseller_name,g=t.reseller_link;if(!t.schedule_switchable&&!n&&!a.isProfessionalTrial()||a.isExternallyManagedSubscription){var f=m.getBillingDisabledMessage({gatewayId:r,isResellerBilling:s,resellerName:_,resellerLink:g,dropboxPlan:l.subState.plan.displayName(),endDate:c,deactivated:u,isOnTrial:p});return o.default.createElement(G,{className:"plan-status-section__message"},f)}if(!a.isPlusTrial())return t.is_in_grace_period?o.default.createElement("a",{href:"#",className:"plan-status-section__link account-page__link",onClick:a.onUpdateBillingClick},d.intl.formatMessage({id:"iq/tnl",defaultMessage:"Please update your billing information"})):void 0}},a.managePlanClick=function(){n.redirect("/team/admin/billing/manage")},a.createTrialCtaButtons=function(e,t){return void 0===e&&(e=!0),void 0===t&&(t=!1),t?o.default.createElement(H,{className:"plan-status-section__upgrade_btn trial-cta"},o.default.createElement(K,{className:"cancel-button",variant:"outline",onClick:a.cancelTrialClick},d.intl.formatMessage({id:"QJ3PjI",defaultMessage:"Cancel trial"}))):e?o.default.createElement(H,{className:"plan-status-section__upgrade_btn trial-cta"},o.default.createElement(Q,{className:"purchase-button",variant:"primary",onClick:a.purchaseNowClick},d.intl.formatMessage({id:"rki01J",defaultMessage:"Purchase Now"})),o.default.createElement(K,{className:"cancel-button",variant:"primary",onClick:a.cancelTrialClick},d.intl.formatMessage({id:"QJ3PjI",defaultMessage:"Cancel trial"}))):o.default.createElement(H,{className:"plan-status-section__upgrade_btn trial-cta"},o.default.createElement(E.Button,{className:"purchase-button",variant:"primary",onClick:a.purchaseNowClick},d.intl.formatMessage({id:"rki01J",defaultMessage:"Purchase Now"})))},a.renderPlanStatusTitle=function(e){return o.default.createElement(U,{className:"zero_padding plan-status__subscription-summary",keyText:d.intl.formatMessage({id:"oy8WXs",defaultMessage:"Subscriptions"}),valueText:e})},a.renderChangePlanButton=function(e){var t=a.props,n=t.paymentInfo,i=t.isLoggedInUser,l=t.isLoggedInAsTransactionOwner;if(i&&!l)return a.renderLoginInstructions(R.Change);var r=a.getChangePlanButtonText(),s=a.getChangePlanClickHandler(e);return o.default.createElement(H,{className:"plan-status-section__upgrade_btn"},o.default.createElement(E.Button,{className:"jest-change-plan-button",variant:"primary",onClick:s,disabled:null==n?void 0:n.is_in_grace_period},r))},a.getChangePlanButtonText=function(){return a.isFamilyNonPayerPlan()?d.intl.formatMessage({id:"I9CJF0",defaultMessage:"See other plans"}):d.intl.formatMessage({id:"w1kkK2",defaultMessage:"Change plan"})},a.getChangePlanClickHandler=function(e){var t=a.props.subStatus;return e?function(){t.subState.plan.isEnterprise?n.redirect("/team/admin/help?role=work"):n.redirect("/team/admin/billing/manage?show_switch_plan")}:a.isFamilyNonPayerPlan()?function(){M.ProEventsLogger.log("de_plan_tab_see_other_plans_family_member_click"),n.redirect(a.plansURL)}:a.openChangePlanModal},a.logUpgradeOverquotaBtn=function(e){M.GrowthEventsLogger.log("acc_plan_upgrade_overquota_btn",{action:e,button_text:"Upgrade now",destination_url:"http://www.dropbox.com/upgrade",location:"in_product",quota_status:"over",upsell_type:"modal"})},a.onUpgradePlanButtonClick=function(){a.logUpgradeOverquotaBtn("click"),a.redirectToUpgrade()},a.state={addonsInfoMinimized:!0},a}return a.__extends(t,e),t.prototype.componentDidMount=function(){var e=this,t=s.URI.parse(n.get_href()).getQuery().modal;if(t)if("plan"===t||"plus_to_family"===t)if(this.canShowChangePlan(!0)){var a="plan"===t?b.ChangePlanOrigin.DEFAULT:b.ChangePlanOrigin.PLUS_TO_FAMILY;Promise.resolve().then((function(){e.openChangePlanModal(void 0,B.QUERY_PARAM,a)}))}else T.Notify.error(d.intl.formatMessage({id:"Ruu9sN",defaultMessage:"You cannot change plans at this time."}));else"downgrade"===t&&this.props.scheduledForDowngrade&&v.CancelChangesModalConfirmation.showInstance({transitionPerformed:this.props.onAddonUpdate,subStatus:this.props.subStatus,userIdOverride:this.getUserForModal()})},Object.defineProperty(t.prototype,"plansURL",{get:function(){var e=this.props,t=e.isLoggedInUser,a={oqa:"acc_plan_upgrade"};return e.isTransactionInformationPage&&!t&&(a.trigger="nr"),this.isTransferPlan()?new s.URI({path:"/transfer/plans",query:a}).toString():this.isBackupPlan()?"https://help.dropbox.com/accounts-billing/plans-upgrades/dropbox-backup-plan":new s.URI({path:"/plans",query:a}).toString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"usage",{get:function(){return this.props.usageBreakdown.usage},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"quota",{get:function(){return this.props.usageBreakdown.quota||.01},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isExternallyManagedSubscription",{get:function(){var e=this.props,t=e.paymentInfo;return e.isExternallyBilled||t&&m.shouldHideBillingChange(t.gateway_id,t.is_reseller_billing)},enumerable:!1,configurable:!0}),t.prototype.renderCancelPlanButton=function(){return this.props.isLoggedInUser&&!this.props.isLoggedInAsTransactionOwner?this.renderLoginInstructions(R.Cancel):o.default.createElement(H,{className:"plan-status-section__upgrade_btn"},o.default.createElement(E.Button,{onClick:this.cancelPlanClick,variant:"outline"},d.intl.formatMessage({id:"vQndaY",defaultMessage:"Cancel plan"})))},t.prototype.isTransferPlan=function(){var e=this.props.subStatus;return!(!e||!e.subState.plan)&&e.subState.plan.productType===P.ProductPlanType.TRANSFER},t.prototype.isBackupPlan=function(){var e,t;return(null===(t=null===(e=this.props.subStatus)||void 0===e?void 0:e.subState.plan)||void 0===t?void 0:t.productType)===P.ProductPlanType.SYNC_EVERYTHING},t.prototype.isHSProPlan=function(){var e,t;return(null===(t=null===(e=this.props.subStatus)||void 0===e?void 0:e.subState.plan)||void 0===t?void 0:t.productType)===P.ProductPlanType.HS_DBX_PRO_BUNDLE},t.prototype.isFamilyPayerPlan=function(){var e,t;return(null===(t=null===(e=this.props.subStatus)||void 0===e?void 0:e.subState.plan)||void 0===t?void 0:t.productType)===P.ProductPlanType.FAMILY_PAYER},t.prototype.isFamilyNonPayerPlan=function(){var e,t;return(null===(t=null===(e=this.props.subStatus)||void 0===e?void 0:e.subState.plan)||void 0===t?void 0:t.productType)===P.ProductPlanType.FAMILY_NONPAYER},t.prototype.isFamilyPlan=function(){return this.isFamilyPayerPlan()||this.isFamilyNonPayerPlan()},t.prototype.isFreePlusPlan=function(){var e=this.props.subStatus;return!(!e||!e.subState.plan)&&e.subState.plan.productType===P.ProductPlanType.FREE},t.prototype.isInStandardSchedule=function(){var e=this.props.subStatus;if(e&&e.subState&&e.subState.billingSchedule){var t=e.subState.billingSchedule.id;return t===P.ScheduleId.MONTHLY||t===P.ScheduleId.YEARLY}return!1},t.prototype.isTaurusPlan=function(){var e=this.props.subStatus;if(e&&e.subState.plan){var t=e.subState.plan.productType;return t===P.ProductPlanType.PLUS||t===P.ProductPlanType.PLUS_TRIAL||t===P.ProductPlanType.PROFESSIONAL||t===P.ProductPlanType.PROFESSIONAL_TRIAL||t===P.ProductPlanType.PLUS_WITH_SS||t===P.ProductPlanType.PLUS_WITH_SS_TRIAL}return!1},t.prototype.getGatewayId=function(){var e=this.props.paymentInfo;return e?e.gateway_id:g.NOT_APPLICABLE},t.prototype.isTrialPlan=function(){return this.isPlusTrial()||this.isProfessionalTrial()},t.prototype.isPlusTrial=function(){var e=this.props.subStatus;return!(!e||!e.subState.plan)&&(e.subState.plan.productType===P.ProductPlanType.TRIAL||e.subState.plan.productType===P.ProductPlanType.PLUS_TRIAL)},t.prototype.isProfessionalTrial=function(){var e=this.props.subStatus;return!(!e||!e.subState.plan)&&e.subState.plan.productType===P.ProductPlanType.PROFESSIONAL_TRIAL},t.prototype.isLicensePlan=function(){var e=this.props,t=e.hasLicenseKey,a=e.paymentInfo;return!!a&&(t||_.isLicenseKey(a.gateway_id))},t.prototype.renderLoginInstructions=function(e){var t,a;return a=this.props.userEmail?this.props.userEmail:d.intl.formatMessage({id:"fZ1ZfV",defaultMessage:"the account user"}),t=e===R.Cancel?d.intl.formatMessage({id:"diOSTv",defaultMessage:"Please login as {email}{br}to cancel your plan."},{br:o.default.createElement("br",null),email:a}):e===R.Change?d.intl.formatMessage({id:"7/qGqI",defaultMessage:"Please login as {email}{br}to change your plan."},{br:o.default.createElement("br",null),email:a}):e===R.Manage?d.intl.formatMessage({id:"yHAcZL",defaultMessage:"Please login as {email}{br}to manage your plan."},{br:o.default.createElement("br",null),email:a}):e===R.Upgrade?d.intl.formatMessage({id:"EYQ0Wr",defaultMessage:"Please login as {email}{br}to upgrade your plan."},{br:o.default.createElement("br",null),email:a}):d.intl.formatMessage({id:"wBh1Uk",defaultMessage:"Please login as {email}."},{email:a}),o.default.createElement("div",{className:"plan-status-section__login-msg"},t)},t.prototype.getUserForModal=function(){var e=this.props,t=e.isPersonalUser,a=e.useSpecifiedRole,n=e.isLoggedInAsTransactionOwner,o=null;if(a&&n){var i=l.Viewer.get_viewer();o=t?i.personal_user?i.personal_user.id:null:i.work_user?i.work_user.id:null,r.assert(null!=o,"Could not find user for specified role; modal will fail")}return o},t.prototype.renderDropboxLogo=function(){return o.default.createElement(W,{className:"plan-status-section__icon u-mar-right-s"},o.default.createElement("img",{src:f.static_url("/static/images/logo_catalog/dropbox-business-icon_m1-vflczuza3.svg"),alt:""}))},t.prototype.getTeamName=function(){return this.props.isLoggedInAsTransactionOwner&&l.Viewer.get_viewer().team_name?l.Viewer.get_viewer().team_name:this.props.teamName?this.props.teamName:null},t.prototype.renderManagePlanButton=function(){return this.props.isLoggedInUser&&!this.props.isLoggedInAsTransactionOwner?this.renderLoginInstructions(R.Manage):o.default.createElement(H,{className:"plan-status-section__upgrade_btn"},o.default.createElement(E.Button,{variant:"primary",onClick:this.managePlanClick},d.intl.formatMessage({id:"RBsGH7",defaultMessage:"Manage plan"})))},t.prototype.renderBusinessPlanSection=function(){var e=this.props,t=e.subStatus,a=e.isTeamAdmin,n=e.scheduledForDowngrade,i=e.showCancelButton,r=e.addonsInfo,s=e.addonsLoadingState,c=e.browserUpdateRequired,u=e.onAddonUpdate;if(t&&t.subState.isDeactivatedTeam)return this.renderBasicPlanSection();if(t&&t.subState.plan){var p=t.subState.plan.productType===P.ProductPlanType.STANDARD,m=t.subState.plan.displayName(!1,p);p||(m=d.intl.formatMessage({id:"15/NF/",defaultMessage:"{trade_mark} {plan_title}"},{trade_mark:S.TRADEMARK_BUSINESS,plan_title:m}));var _,g,f="",h=this.getTeamName();h&&(a?(f=d.intl.formatMessage({id:"TcIDqw",defaultMessage:"You’re an admin of the {team_name} Dropbox account."},{team_name:h}),this.props.isLoggedInAsTransactionOwner||(f=d.intl.formatMessage({id:"J98s/Q",defaultMessage:"This account is an admin of the {team_name} Dropbox account."},{team_name:h}))):(f=d.intl.formatMessage({id:"jgGyr5",defaultMessage:"You’re a member of the {team_name} Dropbox account."},{team_name:h}),this.props.isLoggedInAsTransactionOwner||(f=d.intl.formatMessage({id:"2c6DhA",defaultMessage:"This account is a member of the {team_name} Dropbox account."},{team_name:h}))));var y=l.Viewer.get_viewer(),b=t.subState.plan.isEnterprise;return this.props.isLoggedInUser&&!this.props.isLoggedInAsTransactionOwner?_=this.renderLoginInstructions():b?_=null:a||!this.props.isLoggedInUser?(_=this.renderManagePlanButton(),i&&(_=n?this.renderManagePlanButton():this.renderCancelPlanButton())):!a&&y.is_paired&&(g=o.default.createElement("p",null,d.intl.formatMessage({id:"7bN4Js",defaultMessage:"Looking for details on another plan?"})," ",o.default.createElement(z,{className:"plan-status-section__link plan-status-section__link--inline account-page__link",href:"/account/plan?role=personal"},d.intl.formatMessage({id:"JejsPF",defaultMessage:"Visit your personal account page."})))),o.default.createElement(q,{className:"plan-status-section"},this.renderDropboxLogo(),o.default.createElement(V,{className:"plan-status-section__description"},o.default.createElement(j,{className:"plan-status-section__title"},m),o.default.createElement(Y,{className:"plan-status-section__title_description"},f),g,o.default.createElement(L.AddonSection,{addonSectionStatus:k.AddonSectionStatus.CURRENT,addonsInfo:r,addonsLoadingState:s,billingSchedule:t.finalSubState.billingSchedule,formattedSpecQuotaGb:t.subState.plan.formattedSpecQuotaGb,totalQuota:this.quota,onlyShowDescription:!0,browserUpdateRequired:c,onAddonUpdate:u,isPersonalUser:!1})),_)}},t.prototype.showBasicPlanWithTrial=function(){var e=this.props.trialsConfig;return e&&e.trialBanner&&e.currentPlan&&e.currentPlan.skuContent&&e.currentPlan.skuContent.name===S.TRADEMARK_BASIC},t.prototype.renderUpgradePlanButton=function(e){return this.props.trialsConfig&&this.props.trialsConfig.trialBanner?o.default.createElement("div",null):this.props.isLoggedInUser&&!this.props.isLoggedInAsTransactionOwner?this.renderLoginInstructions(R.Upgrade):(this.isOverQuota()&&this.logUpgradeOverquotaBtn("view"),o.default.createElement(H,{className:"plan-status-section__upgrade_btn"},o.default.createElement(E.Button,{variant:"primary",className:"jest-upgrade-plan-button",onClick:this.onUpgradePlanButtonClick},e)))},t.prototype.renderBasicPlanSection=function(){var e,t=this.props,a=t.subStatus,n=t.isLimitedTeam,i=t.isLockedTeam,l=t.isPaidTeam,r=S.DROPBOX_BASIC;if(a){i&&(null===(e=a.subState.planSku)||void 0===e?void 0:e.content)?r=p.getLockedTeamPlanName(l,a.subState.planSku.content.dropboxDisplayName()):!this.showBasicPlanWithTrial()&&a.subState.plan&&(r=a.subState.plan.displayName());var s=void 0;if(n||a.subState.isDeactivatedTeam){var c=this.getTeamName(),u=d.intl.formatMessage({id:"jgGyr5",defaultMessage:"You’re a member of the {team_name} Dropbox account."},{team_name:c});this.props.isLoggedInAsTransactionOwner||(u=d.intl.formatMessage({id:"2c6DhA",defaultMessage:"This account is a member of the {team_name} Dropbox account."},{team_name:c})),s=o.default.createElement(X,{className:"plan-status-section__team_desc"},u)}var m=this.isOverQuota()?d.intl.formatMessage({id:"F2lDMN",defaultMessage:"Upgrade now"}):d.intl.formatMessage({id:"IqV88I",defaultMessage:"Upgrade"}),_=this.renderUpgradePlanButton(m);return o.default.createElement(C.BasicPlanStatusSection,{planName:r,plansUrl:this.plansURL,limitedTeam:s,upgradePlanButton:_,hidePlansLink:this.isExternallyManagedSubscription,hideUpgradeButton:i})}},t.prototype.renderResellerPlan=function(){var e=d.intl.formatMessage({id:"mAtx6/",defaultMessage:"Dropbox {plus} 1TB"},{plus:S.TRADEMARK_PLUS});return o.default.createElement(q,{className:"plan-status-section"},this.renderDropboxLogo(),o.default.createElement(V,{className:"plan-status-section__description"},o.default.createElement(j,{className:"plan-status-section__title"},e),o.default.createElement(Y,{className:"plan-status-section__title_description"},this.renderBillingPeriod())))},t.prototype.renderPaidPlanSection=function(){var e=this.props,t=e.subStatus,a=e.isLimitedTeam,n=e.hasUnusedLicenseKey,i=e.paymentInfo,l=e.scheduledForDowngrade,r=e.isLoggedInAsTransactionOwner,s=e.showCancelButton,c=e.addonsInfo,u=e.addonsLoadingState,_=e.eligibleFor1tb,g=e.browserUpdateRequired,f=e.onAddonUpdate;if(t&&t.scheduledSubState&&t.subState.plan){var h,y,b,v,P,M,S=t.subState.plan,E=p.getPaidPlanName(S,!1,this.getGatewayId());if(m.shouldHideBillingSummary(i,t.subState.plan.productType)||(v=p.getPaidPlanDefaultBillingSummary(t.nextBillingSummary,t.finalSubState.billingSchedule)),n&&(P=r?d.intl.formatMessage({id:"E5PyhP",defaultMessage:"Your license key will be activated and no charge made to your payment method on file."}):d.intl.formatMessage({id:"Yutfxu",defaultMessage:"This account’s license key will be activated and no charge made to the payment method on file."})),!this.isExternallyManagedSubscription){var C="";if(this.isFamilyNonPayerPlan())C=d.intl.formatMessage({id:"w5oksG",defaultMessage:"You’re a member of the {family} plan."},{family:S.displayName()});else if(n)C=P||"";else if(!l){if(b=d.intl.formatMessage({id:"mNB218",defaultMessage:"<strong>{billing_summary}</strong> Renews on {date}."},{date:t.formattedNextBillingDate,billing_summary:v||"",strong:function(e){return o.default.createElement("strong",null,e)}}),C=p.getPlanFeatureDescription(S),this.hasAddons())C=p.getPriceBreakdownByPlan(t.nextBillingSummary,t.finalSubState.billingSchedule,t.scheduledSubState.plan)+" "+C}h=o.default.createElement("span",{className:"plan-status-section__description-content"},C," ")}if(l){var T=p.getPlanFeatureDescription(S);h=o.default.createElement("span",null,T," ")}if(a){var A=this.getTeamName(),w=d.intl.formatMessage({id:"X0wsLF",defaultMessage:"You’re a member of the {team_name} Dropbox account."},{team_name:A});r||(w=d.intl.formatMessage({id:"/IIBtR",defaultMessage:"This account is a member of the {team_name} Dropbox account."},{team_name:A})),y=o.default.createElement(X,{className:"plan-status-section__team_desc"},w)}return this.canShowChangePlan(!1)&&(M=this.renderChangePlanButton(!1)),s&&!l&&(M=this.renderCancelPlanButton()),o.default.createElement("div",null,this.renderPlanStatusTitle(b),o.default.createElement(q,{className:"plan-status-section"},this.renderDropboxLogo(),o.default.createElement(V,{className:"plan-status-section__description"},o.default.createElement(j,{className:"plan-status-section__title"},E),y,o.default.createElement(Y,{className:"plan-status-section__title_description"},h,this.renderPlanDetails(),o.default.createElement("br",null),this.renderBillingPeriod()),o.default.createElement(L.AddonSection,{addonSectionStatus:k.AddonSectionStatus.CURRENT,addonsInfo:c,addonsLoadingState:u,billingSchedule:t.finalSubState.billingSchedule,formattedSpecQuotaGb:t.subState.plan.formattedSpecQuotaGb,totalQuota:this.quota,eligibleFor1tb:_,browserUpdateRequired:g,onAddonUpdate:f,isPersonalUser:!0})),M))}},t.prototype.renderPlanDetails=function(){if(!this.isHSProPlan()){if(this.props.eligibleFor1tb||!this.isExternallyManagedSubscription&&!this.isInStandardSchedule()||this.isFreePlusPlan()||this.props.hasUnusedLicenseKey)return this.renderContactSupportLink();var e=d.intl.formatMessage({id:"GPqIVb",defaultMessage:"What’s included?"});if(this.isFamilyPlan())e=d.intl.formatMessage({id:"um7qHG",defaultMessage:"What’s included?"});else if(this.isTaurusPlan()){if(this.isExternallyManagedSubscription)return;e=d.intl.formatMessage({id:"RuKlo2",defaultMessage:"See plan details"})}else if(this.isBackupPlan())e=d.intl.formatMessage({id:"3hCG9P",defaultMessage:"See plan info"});else{if(this.isExternallyManagedSubscription)return;e=d.intl.formatMessage({id:"VEb96o",defaultMessage:"See available plans"})}return o.default.createElement("a",{className:"plan-status-section__link account-page__link jest-see-plan-details-btn",onClick:this.logSeePlanDetails,href:this.plansURL,target:"_blank",rel:"noopener noreferrer"},e)}},t.prototype.renderTrialSection=function(){var e=this.props,t=e.subStatus,a=e.paymentInfo;if(t&&t.subState&&t.subState.plan&&a){var n=a.gateway_id,i=a.trial_info;if(i){var l=o.default.createElement("noscript",null);_.isIOS(n)||_.isAndroid(n)||(l=this.createTrialCtaButtons(!i.is_trial_overdue,this.isProfessionalTrial()));var r,s=d.intl.formatMessage({id:"625HOw",defaultMessage:"Dropbox {plus}"},{plus:t.subState.plan.displayName(!1,!1,n)});return i.is_trial_overdue&&(s+=" "+d.intl.formatMessage({id:"yI+MEC",defaultMessage:"(Expired)"})),r=this.isProfessionalTrial()?m.getProfessionalTrialPlanDescription(t):m.getTrialDescription(n,i,t.formattedNextBillingDate),o.default.createElement(q,{className:"plan-status-section"},this.renderDropboxLogo(),o.default.createElement(V,{className:"plan-status-section__description"},o.default.createElement(j,{className:"plan-status-section__title"},s),o.default.createElement(Y,{className:"plan-status-section__title_description"},r," ",this.isProfessionalTrial()&&o.default.createElement("span",null,this.renderPlanDetails(),o.default.createElement("br",null),this.renderBillingPeriod()))),l)}}},Object.defineProperty(t.prototype,"hasSelfServablePaymentAfterLicensekey",{get:function(){var e=this.props.paymentInfo;return e&&!_.isLicenseKey(e.gateway_id)&&!m.shouldHidePaymentMethod(e.gateway_id)},enumerable:!1,configurable:!0}),t.prototype.renderLicensePlanSection=function(){var e=this.props,t=e.subStatus,a=e.isLoggedInAsTransactionOwner;if(!t||!t.subState||!t.subState.plan)return o.default.createElement("noscript",null);var n,i=d.intl.formatMessage({id:"625HOw",defaultMessage:"Dropbox {plus}"},{plus:t.subState.plan.displayName()}),l=o.default.createElement("noscript",null);if(this.props.hasUnusedLicenseKey){n=a?d.intl.formatMessage({id:"jQ1eDP",defaultMessage:"Your Dropbox {plus} plan was activated with a license key. Your next license key will be activated on {date}."},{plus:S.TRADEMARK_PLUS,date:t.formattedNextBillingDate}):d.intl.formatMessage({id:"yXjZBq",defaultMessage:"This Dropbox {plus} plan was activated with a license key. The next license key will be activated on {date}."},{plus:S.TRADEMARK_PLUS,date:t.formattedNextBillingDate});var r=o.default.createElement("noscript",null);if(this.hasSelfServablePaymentAfterLicensekey)r=o.default.createElement("div",null,d.intl.formatMessage({id:"flOh9z",defaultMessage:"No charge made to your payment method on file."})),this.props.isLoggedInAsTransactionOwner||(r=o.default.createElement("div",null,d.intl.formatMessage({id:"c1bGK9",defaultMessage:"No charge made to the payment method on file."})));else{var s=d.intl.formatMessage({id:"nswDHh",defaultMessage:"You can add your payment information now to have your subscription automatically renew when your keys expire."});this.props.isLoggedInAsTransactionOwner||(s=d.intl.formatMessage({id:"/Xs7Nm",defaultMessage:"The account owner can add payment information now to have this subscription automatically renew when the keys expire."})),r=o.default.createElement("div",null,s,o.default.createElement("br",null),o.default.createElement("a",{href:"#",onClick:this.addPaymentClick},d.intl.formatMessage({id:"2zkZ/z",defaultMessage:"Add payment method."})))}l=o.default.createElement("div",null,n,o.default.createElement("br",null),r)}else if(this.hasSelfServablePaymentAfterLicensekey&&!this.props.scheduledForDowngrade){var c=t.scheduledSubState.billingSchedule.scheduleDescriptionNoun,u=d.intl.formatMessage({id:"QoelR9",defaultMessage:"Your Dropbox {plus} plan was activated with a license key. The plan will renew on {date}."},{plus:S.TRADEMARK_PLUS,date:t.formattedNextBillingDate}),p=d.intl.formatMessage({id:"DrEa0N",defaultMessage:"{new_total} per {new_period} will be charged to your payment method on file."},{new_total:y.Cash.formatWithTaxLabels(t.nextBillingSummary.total,t.nextBillingSummary),new_period:c});this.props.isLoggedInAsTransactionOwner||(u=d.intl.formatMessage({id:"kQDw1e",defaultMessage:"This Dropbox {plus} plan was activated with a license key. The plan will renew on {date}."},{plus:S.TRADEMARK_PLUS,date:t.formattedNextBillingDate}),p=d.intl.formatMessage({id:"xhxvHj",defaultMessage:"{new_total} per {new_period} will be charged to the payment method on file."},{new_total:y.Cash.formatWithTaxLabels(t.nextBillingSummary.total,t.nextBillingSummary),new_period:c})),l=o.default.createElement("div",null,u,o.default.createElement("br",null),p,o.default.createElement("br",null),this.renderBillingPeriod())}else{u=d.intl.formatMessage({id:"6ejtCb",defaultMessage:"Your Dropbox {plus} plan was activated with a license key. The plan is active until {date}."},{plus:S.TRADEMARK_PLUS,date:t.formattedNextBillingDate});var m=d.intl.formatMessage({id:"vNTGeR",defaultMessage:"You can add your payment information now to have your subscription automatically renew when it expires."});this.props.isLoggedInAsTransactionOwner||(u=d.intl.formatMessage({id:"uTD2X0",defaultMessage:"This account’s Dropbox {plus} plan was activated with a license key. The plan is active until {date}."},{plus:S.TRADEMARK_PLUS,date:t.formattedNextBillingDate}),m=d.intl.formatMessage({id:"fEZEwT",defaultMessage:"The account owner can add payment information now to have this subscription automatically renew when it expires."})),l=o.default.createElement("div",null,u,o.default.createElement("br",null),m,o.default.createElement("br",null),o.default.createElement("a",{href:"#",onClick:this.addPaymentClick},d.intl.formatMessage({id:"fSZaj1",defaultMessage:"Add payment method."})))}return o.default.createElement(q,{className:"plan-status-section"},this.renderDropboxLogo(),o.default.createElement(V,{className:"plan-status-section__description"},o.default.createElement(j,{className:"plan-status-section__title"},i),o.default.createElement(Y,{className:"plan-status-section__title_description"},l),this.renderContactSupportLink()))},t.prototype.renderPlanSection=function(){var e=this.props,t=e.subStatus,a=e.isExternallyBilled,n=e.paymentInfo,o=e.isLimitedTeam;return this.showBasicPlanWithTrial()?this.renderBasicPlanSection():a&&void 0!==n&&null!==n.reseller_name?this.renderResellerPlan():a&&o&&void 0!==n&&n.gateway_id===g.NOT_APPLICABLE?void 0:t&&t.subState.plan&&[P.ProductFamily.PRO,P.ProductFamily.FAMILY].includes(t.subState.plan.productFamily)?this.isTrialPlan()?this.renderTrialSection():this.isLicensePlan()?this.renderLicensePlanSection():this.renderPaidPlanSection():this.renderBasicPlanSection()},t.prototype.render=function(){var e=this.props,t=e.isPersonalUser,a=e.isLimitedTeam,n=t||a?this.renderPlanSection():this.renderBusinessPlanSection();return o.default.createElement(Z,{className:"plan-status account-plan-section"},n)},t.displayName="PlanStatus",t})(o.default.Component);t.PlanStatus=ue})),define("modules/clean/account_page/widgets/plan/views/resubscribe_plan_upsell",["require","exports","tslib","react","modules/clean/react/components/css","dig-components/buttons","dig-components/typography","dropbox/proto/storefront_platform_js_init_data/types","modules/core/browser","modules/clean/account_page/widgets/plan/strings","modules/clean/analytics"],(function(e,t,a,n,o,i,l,r,s,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResubscribePlanUpsell=void 0,n=a.__importDefault(n),s=a.__importStar(s);var u=r.storefront_platform.StorefrontPlatformContractLengthUnit,p=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onResubscribeClick=function(e,t){return function(){c.ProEventsLogger.log("plan_resubscribe_click",{plan_id:e}),s.redirect(t)}},t.onPlanDetailsClick=function(e,t){return function(){c.ProEventsLogger.log("plan_details_click",{plan_id:e}),s.redirect(t)}},t}return a.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.planProductType,a=e.planDisplayName,o=e.planEndedDate,r=e.planBillingUnitPrice,s=e.planBillingFrequency,p=e.purchaseEndpoint,m=e.productDetailsEndpoint;if(!(t&&a&&o&&r&&(s===u.MONTH||s===u.YEAR)&&p&&m))return null;c.ProEventsLogger.log("plan_resubscribe_upsell_shown",{plan_id:t});var _=a,g=d.getResubscribeUpsellDescription(a,o,r,s);return n.default.createElement("div",{className:"resubscribe-plan-upsell"},n.default.createElement(l.Title,{size:"small",className:"resubscribe-plan-upsell__header"},_),n.default.createElement(l.Text,{className:"resubscribe-plan-upsell__description"},g),n.default.createElement("div",{className:"resubscribe-plan-upsell-actions"},n.default.createElement(i.Button,{variant:"outline",className:"resubscribe-plan-upsell-actions__resubscribe-button",onClick:this.onResubscribeClick(t,p)},d.getResubscribeUpsellResubscribeButtonText()),n.default.createElement(i.Button,{variant:"transparent",className:"resubscribe-plan-upsell-actions__plan-details-button",onClick:this.onPlanDetailsClick(t,m)},d.getResubscribeUpsellPlanDetailsButtonText())))},t.displayName="ResubscribePlanUpsellView",t})(n.default.Component);t.ResubscribePlanUpsell=o.requireCssWithComponent(p,["/static/css/growth_pages/account_plan_tab/resubscribe_plan_upsell-vflGFC8mz.css"])})),define("modules/clean/account_page/widgets/plan/views/update_billing_info",["require","exports","tslib","react","modules/core/i18n","dig-components/buttons"],(function(e,t,a,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UpdateBillingInfoButton=t.UpdateBillingInfoLink=void 0,n=a.__importDefault(n),t.UpdateBillingInfoLink=function(e){var t=e.className,a=e.updateBillingCTA;return n.default.createElement("a",{key:"updateBillingInfo",className:t||"",href:"#",onClick:function(e){e.stopPropagation(),e.preventDefault(),a(e)}},o.intl.formatMessage({id:"ipgitK",defaultMessage:"Update billing information"}))},t.UpdateBillingInfoLink.displayName="UpdateBillingInfoLink",t.UpdateBillingInfoButton=function(e){var t=e.updateBillingCTA;return n.default.createElement(i.Button,{variant:"transparent",onClick:function(e){e.stopPropagation(),e.preventDefault(),t(e)}},o.intl.formatMessage({id:"LcZnrF",defaultMessage:"Update billing info"}))},t.UpdateBillingInfoButton.displayName="UpdateBillingInfoButton"})),define("modules/clean/react/campaigns/campaign_events_api",["require","exports","tslib","react","modules/core/exception","api_v2/user_client","modules/clean/active_user","modules/clean/react/user_metadata/api"],(function(e,t,a,n,o,i,l,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CampaignContext=t.parseIntOrUndefined=t.reportException=t.logCampaignDismissed=t.setCampaignDismissedInUserMetadata=t.logCampaignClick=t.logCampaignImpressionDeclined=t.logCampaignImpression=t.createMegaphoneCampaignImpressionContextFromMegaphoneImpressionContext=t.createMegaphoneCampaignImpressionContext=t.createMegaphoneCampaignImpressionContextFromEnrichedCampaignImpressionContext=void 0,n=a.__importDefault(n),o=a.__importStar(o);function s(e,t,a){var n=void 0;try{n={campaignId:t,campaignVariantId:a,campaignImpressionId:e,userId:l.mustGetActiveUserId()}}catch(e){reportException({err:e})}return n}function reportException(e){var t=e.err,a=e.severity,n=void 0===a?o.SEVERITY.NONCRITICAL:a,i=e.exc_extra,l=void 0===i?{}:i;o.reportException({err:t,tags:["megaphone","robe"],severity:n,exc_extra:l})}function d(e,t,a){var n=new i.UserApiV2Client,o={megaphone_impression_id:e.campaignImpressionId,megaphone_request_context:{user_id:e.userId},campaign_event_name:t,campaign_event_info:a,campaign_id:c(e.campaignId),version_id:c(e.campaignVariantId)};return n.ns("megaphone").rpc("log_campaign_event",o,{subjectUserId:e.userId}).catch((function(a){reportException({err:a,exc_extra:{user_id:e.userId,impression_id:e.campaignImpressionId,event_name:t[".tag"]}})}))}function c(e){switch(typeof e){case"string":return parseInt(e,10);case"number":return e;default:return}}t.createMegaphoneCampaignImpressionContextFromEnrichedCampaignImpressionContext=function(e){return s(e.megaphoneImpressionId,e.campaignVariant.campaignId,e.campaignVariant.campaignVariantId)},t.createMegaphoneCampaignImpressionContext=s,t.createMegaphoneCampaignImpressionContextFromMegaphoneImpressionContext=function(e){var t,a,n,o;if(e.megaphone_impression_id)return s(e.megaphone_impression_id,null===(a=null===(t=e.version_info)||void 0===t?void 0:t.campaign_id)||void 0===a?void 0:a.toString(),null===(o=null===(n=e.version_info)||void 0===n?void 0:n.version_id)||void 0===o?void 0:o.toString())},t.logCampaignImpression=function(e){return d(e,{".tag":"impression"})},t.logCampaignImpressionDeclined=function(e){return d(e,{".tag":"impression_declined"})},t.logCampaignClick=function(e,t){return d(e,{".tag":"click"},{cta_id:t})},t.setCampaignDismissedInUserMetadata=function(e){var t;return a.__awaiter(this,void 0,void 0,(function(){var n,o;return a.__generator(this,(function(a){switch(a.label){case 0:return e.campaignId?[4,r.getUserMetadata(["CAMPAIGNS_TOOLKIT_USER_DISMISSED_CAMPAIGNS"],e.userId)]:[3,3];case 1:return n=a.sent(),o=n?null===(t=n.CAMPAIGNS_TOOLKIT_USER_DISMISSED_CAMPAIGNS)||void 0===t?void 0:t.concat(":",e.campaignId.toString()):e.campaignId.toString(),[4,r.setUserMetadata({CAMPAIGNS_TOOLKIT_USER_DISMISSED_CAMPAIGNS:o},e.userId)];case 2:a.sent(),a.label=3;case 3:return[2]}}))}))},t.logCampaignDismissed=function(e){return d(e,{".tag":"dismissed"})},t.reportException=reportException,t.parseIntOrUndefined=c,t.CampaignContext=n.default.createContext(void 0)})),define("modules/clean/family/constants",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MAX_LICENSES=t.getFamilyJoinUrl=t.FAMILY_INVITE_URI_PATH_SUCCESS=t.FAMILY_INVITE_URI_PATH=t.FAMILY_HOME_PATH=void 0,t.FAMILY_HOME_PATH="/h",t.FAMILY_INVITE_URI_PATH="/family/invite",t.FAMILY_INVITE_URI_PATH_SUCCESS="/family/invite?success",t.getFamilyJoinUrl=function(e){return"/family/join/"+e},t.MAX_LICENSES=6})),define("modules/clean/react/growth/trials/util",["require","exports","tslib","api_v2/user_client","modules/clean/payments/skus/constants"],(function(e,t,a,n,o){"use strict";function i(e){return{href:e.href,onClickType:e.on_click_type,text:e.text}}var l;Object.defineProperty(t,"__esModule",{value:!0}),t.getTransitionChangeType=t.PerformPlanTransitionForTrials=t.fetchModalConfig=t.formatCtaConfigResult=void 0,t.formatCtaConfigResult=i,t.fetchModalConfig=function(e,t){return a.__awaiter(this,void 0,Promise,(function(){var o,l,r,s,d,c,u,p,m,_;return a.__generator(this,(function(a){switch(a.label){case 0:o={primaryCTA:{}},l=new n.UserApiV2Client,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,l.ns("trials").rpc("get_trials_modal_config",{modal_type:t},{subjectUserId:e})];case 2:return r=a.sent(),s=r.description,d=r.features,c=r.heading,u=r.primary_cta,p=r.secondary_cta,m=u?i(u):void 0,_=p?i(p):void 0,[2,{description:s,features:d,heading:c,primaryCTA:m,secondaryCTA:_}];case 3:return a.sent(),[2,o];case 4:return[2]}}))}))},(function(e){e[e.PLUS=3]="PLUS",e[e.PROFESSIONAL=4]="PROFESSIONAL"})(l=t.PerformPlanTransitionForTrials||(t.PerformPlanTransitionForTrials={})),t.getTransitionChangeType=function(e){if(e.finalSubState.planSku){if(e.finalSubState.planSku.productType===o.ProductPlanType.PLUS)return l.PLUS;if(e.finalSubState.planSku.productType===o.ProductPlanType.PROFESSIONAL)return l.PROFESSIONAL}return null}})),define("modules/clean/react/payments/edit_invoice_address_modal/edit_invoice_address_modal_loader",["require","exports","tslib","modules/core/notify","react","modules/clean/react/components/css","modules/clean/react/sprite","modules/core/uri","modules/core/i18n","modules/clean/react/arbor/aspen/elements/arbor_inputs","modules/clean/payments/validation","modules/clean/react/components/modal","dig-components/modal","dig-components/typography","spectrum/button/index","modules/clean/static_urls","modules/clean/react/tooltip","modules/clean/analytics","modules/clean/deprecated_ajax/ajax_as_promised_jquery","modules/clean/subscription/tools/amp_logger"],(function(e,t,a,n,o,i,l,r,s,d,c,u,p,m,_,g,f,h,y,b){"use strict";function v(e){return function(t){return null==t||t.length<=e}}function P(e,t){return o.default.createElement(f.Tooltip,{position:f.TooltipPosition.RIGHT,tooltip_contents:t},e,o.default.createElement(l.Sprite,{group:"web",name:"info",className:"info-sprite",alt:""}))}Object.defineProperty(t,"__esModule",{value:!0}),t.EditInvoiceAddressModalLoader=void 0,o=a.__importDefault(o),u=a.__importStar(u);var M=s.intl.formatMessage({id:"F5ADP7",defaultMessage:"Country and postal code must match your account’s payment information."}),S=s.intl.formatMessage({id:"XjVAbc",defaultMessage:"Your tax rate on this invoice cannot be updated."}),E={addressName:s.intl.formatMessage({id:"B6dG2q",defaultMessage:"Billing name"}),address:s.intl.formatMessage({id:"fz9og9",defaultMessage:"Billing address"}),city:s.intl.formatMessage({id:"QnFif0",defaultMessage:"City"}),state:s.intl.formatMessage({id:"pyUCBn",defaultMessage:"State"}),zip:P(s.intl.formatMessage({id:"10Ms2o",defaultMessage:"Postal code"}),M),country:P(s.intl.formatMessage({id:"1SPrvR",defaultMessage:"Country"}),M),exclusionId:s.intl.formatMessage({id:"eZAuK1",defaultMessage:"VAT number (optional)"}),exclusionIdWithTooltip:P(s.intl.formatMessage({id:"eZAuK1",defaultMessage:"VAT number (optional)"}),S)},C=(function(e){function i(t){var n=e.call(this,t)||this;return n.disableds={addressName:!1,address:!1,city:!1,state:!1,zip:!0,country:!0,exclusionId:!1,exclusionIdWithTooltip:!1},n.addressNameLength=100,n.addressLength=250,n.cityLength=50,n.stateLength=50,n.vatLength=25,n.undefinedLength=void 0,n.validateHandlers={addressName:v(n.addressNameLength),address:v(n.addressLength),city:v(n.cityLength),state:v(n.stateLength),zip:function(){return!0},country:function(){return!0},exclusionId:function(){return!0},exclusionIdWithTooltip:function(){return!0}},n.maxLengths={addressName:n.addressNameLength,address:n.addressLength,city:n.cityLength,state:n.stateLength,zip:n.undefinedLength,country:n.undefinedLength,exclusionId:n.vatLength,exclusionIdWithTooltip:n.vatLength},n.errorTexts={addressName:s.intl.formatMessage({id:"M9vy6c",defaultMessage:"Too long"}),address:s.intl.formatMessage({id:"M9vy6c",defaultMessage:"Too long"}),city:s.intl.formatMessage({id:"M9vy6c",defaultMessage:"Too long"}),state:s.intl.formatMessage({id:"M9vy6c",defaultMessage:"Too long"}),zip:"",country:"",exclusionId:"",exclusionIdWithTooltip:""},n.onSave=function(){var e=n.state.formState,t=n.props.invoice;if(e)if(n.logActions("edit_billing_address_started"),n.setState({submitting:!0}),n.isInputValid()){var a={address_name:e.addressName,address:e.address,city:e.city,state:e.state,exclusion_id:e.exclusionId};t&&(a.invoice_id=r.URI.parse(t.link).getQuery().id.toString()),n.makeEditBillingAddressRequest(a)}else n.setState({submitting:!1,showErrors:!0})},n.onCancel=function(){n.logActions("edit_billing_address_cancelled"),n.setState((function(e){return a.__assign(a.__assign({},e),{open:!1})}))},n.state={submitting:!1,showErrors:!1,open:!0},t.isTeam?(n.editUrl="/edit_billing_address",n.viewModelUrl="/edit_billing_address_view_model",n.vatClass="grid__item--1-1",n.modalClass="edit-invoice-modal"):(n.editUrl="/edit_billing_address_individual",n.viewModelUrl="/edit_billing_address_individual_view_model",n.vatClass="grid__item--1-2",n.modalClass="edit-invoice-modal professional-modal"),n}return a.__extends(i,e),i.showInstance=function(e,a){var n=o.default.createElement(t.EditInvoiceAddressModalLoader,{invoice:e,isTeam:a});u.Modal.showInstance(n)},i.showUpdateTaxProfileModal=function(e,a){var n=o.default.createElement(t.EditInvoiceAddressModalLoader,{isTeam:e,onUpdated:a});u.Modal.showInstance(n)},i.prototype.componentDidMount=function(){var e,t=void 0;this.props.invoice&&(t=null===(e=r.URI.parse(this.props.invoice.link).getQuery().id)||void 0===e?void 0:e.toString(),this.disableds.exclusionIdWithTooltip=!0),this.makeRequest(t)},i.prototype.makeRequest=function(e){return a.__awaiter(this,void 0,void 0,(function(){var t,n;return a.__generator(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),t={invoice_id:e},[4,y.WebRequest({url:this.viewModelUrl,data:t,dataType:"json"})];case 1:return n=o.sent(),c.hasVat(n.countryCode)&&(this.errorTexts.exclusionId=s.intl.formatMessage({id:"LW2miv",defaultMessage:"Please enter a valid VAT number, e.g. {examples}."},{examples:c.getVatExamples(n.countryCode).join(", ")}),this.validateHandlers.exclusionId=function(e){return!e||c.validateVat(n.countryCode,e)}),this.setState({formState:n}),[3,3];case 2:return o.sent(),this.setState((function(e){return a.__assign(a.__assign({},e),{open:!1})})),[3,3];case 3:return[2]}}))}))},i.prototype.render=function(){var e,t=this.state,a=t.formState,n=t.showErrors,i=t.submitting,l=this.props,r=l.isTeam,d=l.invoice;if(a){var f=null;if(c.hasVat(a.countryCode)){var h=c.getVatPrefix(a.countryCode);f=d?this.renderInput("exclusionIdWithTooltip",this.vatClass):this.renderInput("exclusionId",this.vatClass,h)}e=r?o.default.createElement("div",{className:".type--arbor grid__container grid__container--p-large  grid--x-bookend"},this.renderInstructions(a.countryCode),this.renderInput("addressName","grid__item--1-1"),this.renderInput("address","grid__item--1-1"),this.renderInput("city","grid__item--1-2"),this.renderInput("state","grid__item--11-24"),this.renderInput("zip","grid__item--7-24"),this.renderInput("country","grid__item--2-3"),f):o.default.createElement("div",{className:".type--arbor grid__container grid__container--p-large  grid--x-bookend"},this.renderInput("addressName","grid__item--1-1"),this.renderInput("address","grid__item--1-2"),this.renderInput("city","grid__item--1-4"),this.renderInput("state","grid__item--1-4"),this.renderInput("zip","grid__item--1-2"),this.renderInput("country","grid__item--1-2"),f,this.renderInstructions(a.countryCode))}else e=o.default.createElement("div",{className:"loading-spinner"},o.default.createElement("img",{src:g.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:s.intl.formatMessage({id:"jybGUg",defaultMessage:"Loading"})}));var y=o.default.createElement(p.Modal.Footer,{hasTopBorder:!r,className:"oq-modal__buttons"},o.default.createElement(_.Button,{className:"edit-invoice-modal__cancel-button",variant:"secondary",onClick:this.onCancel},s.intl.formatMessage({id:"d9/SE1",defaultMessage:"Cancel"})),o.default.createElement(_.Button,{disabled:!a||i||n&&!this.isInputValid(),variant:"primary",onClick:this.onSave},s.intl.formatMessage({id:"F5NZs5",defaultMessage:"Save changes"})));return o.default.createElement(p.Modal,{open:this.state.open,isCentered:!0,withCloseButton:s.intl.formatMessage({id:"bv7A4+",defaultMessage:"Close"}),onRequestClose:this.onCancel,overlayClassName:this.modalClass,shouldCloseOnOverlayClick:!1,onAfterClose:u.Modal.close},o.default.createElement(p.Modal.Header,{hasBottomSpacing:"title-standard"},o.default.createElement(m.Title,{color:"faint",isBold:!1,size:"small"},s.intl.formatMessage({id:"/WFCIJ",defaultMessage:"Edit invoice details"}))),o.default.createElement(p.Modal.Body,null,o.default.createElement("div",{className:"dynamic-content"},e)),y)},i.prototype.logActions=function(e){this.props.isTeam?h.TeamsWebActionsLogger.log(e):h.UserActivityLogger.log("web",e)},i.prototype.makeEditBillingAddressRequest=function(e){return a.__awaiter(this,void 0,void 0,(function(){var t,o,i,l,r;return a.__generator(this,(function(d){switch(d.label){case 0:t=this.props,o=t.onUpdated,i=t.isTeam,l=b.getSubscriptionAMPLogger({ns:i?"team":"personal",modal:b.ModalTypes.EDIT_INVOICE_MODAL}),d.label=1;case 1:return d.trys.push([1,3,4,5]),r=this.editUrl,[4,y.WebRequest({url:r,data:e})];case 2:return d.sent(),this.logActions("edit_billing_address_success"),n.Notify.success(s.intl.formatMessage({id:"Il5prr",defaultMessage:"Invoice details updated."})),l.logModalSuccess(),[3,5];case 3:return d.sent(),this.logActions("edit_billing_address_edit_failure"),l.logModalError("modal_submit"),[3,5];case 4:return o&&o(),this.setState((function(e){return a.__assign(a.__assign({},e),{open:!1})})),[7];case 5:return[2]}}))}))},i.prototype.renderInstructions=function(e){var t,a=this.props.invoice;if(t=a?s.intl.formatMessage({id:"Wc4dM+",defaultMessage:"You are editing details for the {date} invoice."},{date:a.date}):s.intl.formatMessage({id:"MhniSh",defaultMessage:"You are editing details for all future invoices. To edit past invoices, click “Edit” on the invoice item instead."}),c.hasVat(e)){var n=s.intl.formatMessage({id:"Qyx8hc",defaultMessage:"Please note that changing your VAT number could impact your applicable tax rate."});a&&(n=s.intl.formatMessage({id:"q3KPUy",defaultMessage:"To add or change a VAT number or request a tax refund, contact support."})),t=t.concat(" ",n)}return o.default.createElement(m.Text,{variant:"paragraph",size:"small",color:"faint",className:"grid__item--1-1 instructions"},t)},i.prototype.renderInput=function(e,t,a){var n=this.state,i=n.formState,l=n.showErrors,r="";return i&&(r=i[e]),o.default.createElement(d.ArborTextInput,{name:e,id:e,containerClassName:t,isValid:l?!!this.validateHandlers[e](r)&&"":"",labelText:E[e],errorText:this.errorTexts[e],value:r,onChange:this.onChangeFactory(e),disabled:this.disableds[e],placeholderText:a,maxLength:this.maxLengths[e]})},i.prototype.onChangeFactory=function(e){var t=this;return function(a,n,o){var i=t.state.formState;i&&t.setState((function(t){return i[e]=o,t}))}},i.prototype.isInputValid=function(){var e=this.state.formState;return!!e&&(this.validateHandlers.addressName(e.addressName)&&this.validateHandlers.address(e.address)&&this.validateHandlers.city(e.city)&&this.validateHandlers.state(e.state)&&this.validateHandlers.exclusionId(e.exclusionId))},i.displayName="EditInvoiceAddressModal",i})(o.default.Component);t.EditInvoiceAddressModalLoader=i.requireCssWithComponent(C,["/static/css/payments/edit_invoice_address_modal/edit_invoice_address_modal-vflTqEhcT.css"])})),define("modules/clean/react/payments/downgrade/components/downgrade_family_manager_data",["require","exports","tslib","react","spectrum/checkbox/index","modules/core/i18n","modules/clean/react/components/css","modules/clean/display_format","modules/constants/trademark","modules/clean/react/payments/downgrade/components/downgrade_helpers","dig-components/icons","dig-components/icons/src","modules/clean/dropbox_form","family/common/features"],(function(e,t,a,n,o,i,l,r,s,d,c,u,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DowngradeFamilyManagerData=t.DowngradeFamilyManagerHeader=t.DowngradeFamilyManagerFooter=t.DowngradeFamilyFeatureItem=t.DowngradeFamilyManagerDataView=void 0;var _=(function(e){function l(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={disbandFamilyAcknowledged:!1,overQuotaAcknowledged:!1,familySharedFolderAcknowledged:!1},t.handleDisbandFamilyAcknowledgment=function(e){t.setState({disbandFamilyAcknowledged:!t.state.disbandFamilyAcknowledged})},t.handleOverQuotaAcknowledgment=function(e){t.setState({overQuotaAcknowledged:!t.state.overQuotaAcknowledged})},t.handleFamilySharedFolderAcknowledgement=function(e){t.setState({familySharedFolderAcknowledged:!t.state.familySharedFolderAcknowledged})},t.hasFamilySharedFolder=function(){var e;return!!(null===(e=t.props.familyFeatureFlags)||void 0===e?void 0:e[m.FAMILY_FEATURE_FLAGS.HAS_FAMILY_SHARED_FOLDER])},t.renderFamilyAcknowledgements=function(){var e=t.props.freeQuota,a=t.hasFamilySharedFolder(),l=t.state,d=l.overQuotaAcknowledged,c=l.disbandFamilyAcknowledged,u=l.familySharedFolderAcknowledged;return n.default.createElement("div",null,n.default.createElement("div",{className:"family-payer-disband-downgrade"},n.default.createElement(o.Checkbox,{className:"family-payer-disband-downgrade-check disband-acknowledgement",checked:c?"checked":"unchecked",onChange:t.handleDisbandFamilyAcknowledgment}),n.default.createElement("p",null,i.intl.formatMessage({id:"gMMxaZ",defaultMessage:"You and every member of your {trademark_family} plan will be downgraded to {dropbox_basic}, which only allows up to {free_quota} of storage."},{trademark_family:s.TRADEMARK_FAMILY,dropbox_basic:s.DROPBOX_BASIC,free_quota:r.format_bytes(e,0)}))),n.default.createElement("div",{className:"family-payer-disband-downgrade"},n.default.createElement(o.Checkbox,{className:"family-payer-disband-downgrade-check over-quota-acknowledgement",checked:d?"checked":"unchecked",onChange:t.handleOverQuotaAcknowledgment}),n.default.createElement("p",null,i.intl.formatMessage({id:"Uu4dKU",defaultMessage:"If you or a member of your plan are using more than {free_quota} of storage, you’ll be over-quota. That means your files will stop syncing, you won’t be able to upload any new files or folders, and you won’t be able to restore earlier versions of your files."},{free_quota:r.format_bytes(e,0)}))),a&&n.default.createElement("div",{className:"family-payer-disband-downgrade"},n.default.createElement(o.Checkbox,{checked:u?"checked":"unchecked",className:"family-payer-disband-downgrade-check","data-testid":"family-shared-folder-acknowledgement",onChange:t.handleFamilySharedFolderAcknowledgement}),n.default.createElement("p",null,i.intl.formatMessage({id:"jaE2Yv",defaultMessage:"Your Family Room folder will dissolve. All members will receive a copy of the folder in their Dropbox."}))))},t}return a.__extends(l,e),l.prototype.shouldDisableConfirmDowngradeButton=function(){return!this.state.overQuotaAcknowledged||!this.state.disbandFamilyAcknowledged||!(!this.hasFamilySharedFolder()||this.state.familySharedFolderAcknowledged)},l.prototype.render=function(){var e=d.createFamilyFeatureList(this.props.currentPlanSpace,this.props.basicDeviceLimit);return n.default.createElement("div",null,n.default.createElement(t.DowngradeFamilyManagerHeader,{handleChangeMindCTA:this.props.handleChangeMindCTA}),n.default.createElement("div",{className:"section section--features family-payer-benefits-section"},n.default.createElement("h3",{className:"type--title-4"},i.intl.formatMessage({id:"R07Z49",defaultMessage:"Without {dropbox_family}, you’ll lose access to the following:"},{dropbox_family:s.DROPBOX_FAMILY})),n.default.createElement("ul",{className:"features-list family-payer-features-list"},e.map((function(e,a){return n.default.createElement(t.DowngradeFamilyFeatureItem,{key:a,featureInfo:e})}))),n.default.createElement("div",null,n.default.createElement("p",null,i.intl.formatMessage({id:"I5xM/O",defaultMessage:"If you still want to cancel, please acknowledge the following:"})),this.renderFamilyAcknowledgements())),n.default.createElement(t.DowngradeFamilyManagerFooter,{shouldDisableConfirmDowngradeButton:this.shouldDisableConfirmDowngradeButton(),handleContactSupportCTA:this.props.handleContactSupportCTA,handleChangeMindCTA:this.props.handleChangeMindCTA}))},l.displayName="DowngradeFamilyManagerData",l})((n=a.__importDefault(n)).default.Component);t.DowngradeFamilyManagerDataView=_,t.DowngradeFamilyFeatureItem=function(e){var t=e.featureInfo,a=t.header,o=t.description;return n.default.createElement("li",{className:"features-list__item family-payer-features-list-item"},n.default.createElement(c.UIIcon,{src:u.CloseLine}),n.default.createElement("div",{className:"family-payer-downgrade-feature-description"},a,n.default.createElement("div",{className:"features-list__copy"},o)))},t.DowngradeFamilyFeatureItem.displayName="DowngradeFamilyFeatureItem",t.DowngradeFamilyManagerFooter=function(e){var t=e.handleContactSupportCTA,a=e.handleChangeMindCTA,o=e.shouldDisableConfirmDowngradeButton,l=[d.downgradePageButtonsMap[d.DowngradeButtonTypes.ContactSupport],d.downgradePageButtonsMap[d.DowngradeButtonTypes.StayWithFamily]];return n.default.createElement("section",{className:"section section--buttons family-payer-section-buttons"},n.default.createElement("div",{className:"section-content"},n.default.createElement("div",{className:"buttons"},l.map((function(e){return n.default.createElement("div",{key:e.type,className:"buttons__item"},n.default.createElement("h3",{className:"type--copy-large"},e.header),n.default.createElement(d.DowngradePageButton,{isPrimaryButton:!0,buttonInfo:e,onClickCTA:(o=e.type,o===d.DowngradeButtonTypes.StayWithFamily?a:t)}));var o})),n.default.createElement("div",{className:"buttons__item downgrade-button"},n.default.createElement("h3",{className:"type--copy-large"},i.intl.formatMessage({id:"FkaCY0",defaultMessage:"I’m sure"})),n.default.createElement(p.DropboxForm,{action:"/downgrade/process",method:"post"},n.default.createElement(d.DowngradeConfirmationButton,{shouldDisableButton:o}))))))},t.DowngradeFamilyManagerFooter.displayName="DowngradeFamilyManagerFooter",t.DowngradeFamilyManagerHeader=function(e){return n.default.createElement("header",{className:"section section--hero family-payer-header-section"},n.default.createElement("div",{className:"section-content"},n.default.createElement("h1",{className:"type--title-2 type--first type--center"},i.intl.formatMessage({id:"TejRDA",defaultMessage:"Are you sure you want to cancel {dropbox_family}?"},{dropbox_family:s.DROPBOX_FAMILY})),n.default.createElement("h2",{className:"type--copy-standard"},i.intl.formatMessage({id:"Gj7aSc",defaultMessage:"You and your family members will lose access to the plan’s storage and features, <span>and your accounts will be downgraded to {dropbox_basic}.</span>"},{dropbox_basic:s.DROPBOX_BASIC,span:function(e){return n.default.createElement("span",{className:"quota-drop"},e)}})),n.default.createElement(d.DowngradePageButton,{isPrimaryButton:!0,buttonInfo:d.downgradePageButtonsMap[d.DowngradeButtonTypes.ChangedMind],onClickCTA:e.handleChangeMindCTA})))},t.DowngradeFamilyManagerHeader.displayName="DowngradeFamilyManagerHeader",t.DowngradeFamilyManagerData=l.requireCssWithComponent(_,["/static/css/pro/pages/downgrade-vfle_vhUD.css"])})),define("modules/clean/react/payments/update_individual_billing/update_individual_billing_modal_loader",["require","exports","tslib","classnames","react","spectrum/button/index","modules/core/notify","modules/core/i18n","modules/clean/analytics","modules/clean/deprecated_ajax/ajax_jquery","modules/clean/react/components/css","modules/clean/react/components/modal","dig-components/modal","dig-components/typography","modules/clean/static_urls","modules/clean/react/payments/unified_module/unified_payment_form_async","modules/clean/subscription/tools/amp_logger","modules/core/uri","modules/core/browser","dig-components/snackbar","dig-components/buttons","dig-components/icons","dig-components/icons/src"],(function(e,t,a,n,o,i,l,r,s,d,c,u,p,m,_,g,f,h,y,b,v,P,M){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IndividualUpdateBillingModalLoader=void 0,n=a.__importDefault(n),o=a.__importDefault(o),d=a.__importStar(d),u=a.__importStar(u),y=a.__importStar(y);var S=(function(e){function c(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={submitting:!1,open:!0,showRedirectForAutoConvertSnackbar:!1},t.onAccept=function(){var e,a;t.unifiedPaymentFormAsync&&t.unifiedPaymentFormAsync.onAccept(),s.UserActivityLogger.log("web","update_billing_modal_started",{isNptBillingModal:null===(e=t.state.loadedProps)||void 0===e?void 0:e.showNptBillingModal,project:null===(a=t.state.loadedProps)||void 0===a?void 0:a.trialProjectType})},t.onDismiss=function(){var e,n;s.UserActivityLogger.log("web","update_billing_modal_cancelled",{isNptBillingModal:null===(e=t.state.loadedProps)||void 0===e?void 0:e.showNptBillingModal,project:null===(n=t.state.loadedProps)||void 0===n?void 0:n.trialProjectType}),t.setState((function(e){return a.__assign(a.__assign({},e),{open:!1})}))},t.saveUnifiedPaymentFormAsync=function(e){t.unifiedPaymentFormAsync=e},t.setSubmittingStatus=function(e){t.setState((function(t){return a.__assign(a.__assign({},t),{submitting:e})}))},t.onSuccess=function(){t.setState((function(e){return a.__assign(a.__assign({},e),{open:!1})})),t.modalLogger.logModalSuccess()},t.onError=function(){t.modalLogger.logModalError("modal_submit")},t.closeRedirectForAutoConvertSnackbar=function(){t.setState({showRedirectForAutoConvertSnackbar:!1})},t}return a.__extends(c,e),c.showInstance=function(){u.Modal.showInstance(o.default.createElement(t.IndividualUpdateBillingModalLoader,null))},c.prototype.componentDidMount=function(){var e=this;this.modalLogger=f.getSubscriptionAMPLogger({ns:"personal",modal:f.ModalTypes.UPDATE_BILLING_MODAL});var t=Date.now();d.WebRequest({url:"/account/unified_payment_view",success:function(n){var o,i,l=JSON.parse(n),r="auto_convert"===h.URI.parse(y.get_href()).getQuery().reason;e.setState((function(e){return a.__assign(a.__assign({},e),{loadedProps:{viewModel:l,showNptBillingModal:l.paymentExperiments.showNptBillingModal,trialProjectType:l.paymentExperiments.trialProjectType},showRedirectForAutoConvertSnackbar:r})})),s.UserActivityLogger.log("web","update_billing_modal_success",{isNptBillingModal:null===(o=e.state.loadedProps)||void 0===o?void 0:o.showNptBillingModal,project:null===(i=e.state.loadedProps)||void 0===i?void 0:i.trialProjectType});var d=Date.now()-t;e.modalLogger.logModalTTI(d)},error:function(t){l.Notify.error(r.intl.formatMessage({id:"EZm8Rx",defaultMessage:"Failed to load modal."})),s.UserActivityLogger.log("web","update_billing_modal_failure",{request_id:t.getResponseHeader("x-dropbox-request-id"),status:t.status}),e.modalLogger.logModalError("modal_init"),e.setState((function(e){return a.__assign(a.__assign({},e),{open:!1})}))}})},Object.defineProperty(c.prototype,"modalTitle",{get:function(){var e,t=r.intl.formatMessage({id:"OyZpYC",defaultMessage:"Update billing information"});return(null===(e=this.state.loadedProps)||void 0===e?void 0:e.showNptBillingModal)&&(t=r.intl.formatMessage({id:"yacDmF",defaultMessage:"Step 1/2: add your billing info"})),t},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"primaryButtonText",{get:function(){var e,t=r.intl.formatMessage({id:"vBFpIq",defaultMessage:"Save changes"});return(null===(e=this.state.loadedProps)||void 0===e?void 0:e.showNptBillingModal)&&(t=r.intl.formatMessage({id:"1ZUfS7",defaultMessage:"Next"})),t},enumerable:!1,configurable:!0}),c.prototype.renderButtons=function(){var e=this.state,t=e.loadedProps,a=e.submitting;return o.default.createElement(p.Modal.Footer,{hasTopBorder:!0,className:"db-modal-buttons"},o.default.createElement(i.Button,{className:"cancel-button",variant:"secondary",onClick:this.onDismiss},r.intl.formatMessage({id:"whhn4M",defaultMessage:"Cancel"})),o.default.createElement(i.Button,{className:"js-save-button",disabled:!t||a,variant:"primary",onClick:this.onAccept},this.primaryButtonText))},c.prototype.renderContent=function(){var e=this.state.loadedProps;return e?o.default.createElement(g.UnifiedPaymentFormAsync,{isSubmittingStatus:this.setSubmittingStatus,onSuccess:this.onSuccess,ref:this.saveUnifiedPaymentFormAsync,isTeam:!1,preloadedViewModel:e.viewModel,onError:this.onError}):o.default.createElement("div",{className:"loading-spinner"},o.default.createElement("img",{src:_.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:r.intl.formatMessage({id:"oXILe3",defaultMessage:"Loading"})}))},c.prototype.renderRedirectForAutoConvertSnackbar=function(){return o.default.createElement(b.Snackbar,{open:this.state.showRedirectForAutoConvertSnackbar,timeout:6e3,onRequestClose:this.closeRedirectForAutoConvertSnackbar},o.default.createElement(P.UIIcon,{src:M.WarningLine}),o.default.createElement(b.Snackbar.Message,null,r.intl.formatMessage({id:"SGQt9u",defaultMessage:"Manage your trial billing details on your account page."})),o.default.createElement(b.Snackbar.Actions,null,o.default.createElement(v.Button,{variant:"transparent",inverse:!0,onClick:this.closeRedirectForAutoConvertSnackbar},r.intl.formatMessage({id:"Bs0dLM",defaultMessage:"Got it"}))))},c.prototype.render=function(){var e=n.default("update-billing-modal");return o.default.createElement(p.Modal,{open:this.state.open,isCentered:!0,withCloseButton:r.intl.formatMessage({id:"Pxv2Bf",defaultMessage:"Close"}),overlayClassName:e,onRequestClose:this.onDismiss,shouldCloseOnOverlayClick:!1,onAfterClose:u.Modal.close,modalBaseIndex:1050},o.default.createElement(p.Modal.Header,{hasBottomSpacing:"title-standard"},o.default.createElement(m.Title,{isBold:!1,size:"small"},this.modalTitle)),o.default.createElement(p.Modal.Body,{hasVerticalSpacing:!0},this.renderContent()),this.renderButtons(),this.renderRedirectForAutoConvertSnackbar())},c.displayName="UpdateBillingModalLoaderView",c})(o.default.Component);t.IndividualUpdateBillingModalLoader=c.requireCssWithComponent(S,["/static/css/pro/components/update_billing_modal_individual-vfljJUHvA.css"])})),define("modules/clean/react/payments/update_individual_billing/update_individual_store_creator",["require","exports","tslib","redux","redux-thunk","modules/clean/redux/unsupported","modules/clean/analytics","modules/clean/dbmodal_stack","modules/clean/react/components/modal","modules/clean/react/payments/common/middleware/payments_ux_logger","modules/clean/react/payments/common/form/middleware/middleware","modules/clean/react/payments/common/payments/state/store_creator","modules/clean/react/payments/common/form_value_factory","modules/clean/react/snackbar","modules/clean/top_notif","modules/core/i18n","modules/core/notify"],(function(e,t,a,n,o,i,l,r,s,d,c,u,p,m,_,g,f){"use strict";function h(e){return function(e){return function(a){if("SubmitFormSuccess"!==a.type)return e(a);var n=e(a),o=void 0!==a.additionalData&&a.additionalData.showRebillUpsell;return l.ProEventsLogger.log("update_billing_open_save_changes_success"),_.TopNotificationBar.hideById("rebill-bar"),o?(f.Notify.clear(),m.Snackbar.complete(g.intl.formatMessage({id:"jMyZGp",defaultMessage:"Payment method successfully updated."})),r.DBModalStack.trigger(t.BILLING_INFO_UPDATED,{showChangePlanConfirm:!0})):(f.Notify.success(g.intl.formatMessage({id:"p28rXC",defaultMessage:"We’ve successfully updated your account’s billing information."})),s.Modal.close(),r.DBModalStack.trigger(t.BILLING_INFO_UPDATED,null)),n}}}function y(e,t,a){var n=e.vat,o=e.cpf,i=e.countryCode,l=e.userInfo,r=u.createPaymentFormData(e,t,a),s=r.city,d=r.address,c=r.phone,m=r.name,_=r.paymentMethod,g=r.countryCode,f=r.zipCode,h=r.vat,y=r.cpf,b=r.nonce,v=r.payPalNonce,P=r.adyenEncryptedCard,M=r.encryptedCardForNetworkToken,S=r.applePayToken,E=r.bin,C=r.browserInfo,T=r.threeDsData,A=r.accountHolderName,w=r.iban,I=r.mandateSigned,D=r.termsAndService,N=r.idealBankId,x=r.idealBankName;return{city:s,address:d,phone:c,name:m,paymentMethod:_,countryCode:g,zipCode:f,vat:n?p.FormValueFactory.createVat(n,i):h,cpf:o?p.FormValueFactory.createCpf(o):y,cpfName:p.FormValueFactory.createCpfNamePrefill("","",l.displayName),nonce:b,payPalNonce:v,adyenEncryptedCard:P,encryptedCardForNetworkToken:M,applePayToken:S,bin:E,browserInfo:C,threeDsData:T,accountHolderName:A,iban:w,mandateSigned:I,termsAndService:D,idealBankId:N,idealBankName:x}}Object.defineProperty(t,"__esModule",{value:!0}),t.createFormData=t.createBillingStore=t.submitFormSuccessMiddleware=t.BILLING_INFO_UPDATED=void 0,n=a.__importStar(n),o=a.__importDefault(o),t.BILLING_INFO_UPDATED="billing_info_modal:updated",t.submitFormSuccessMiddleware=h,t.createBillingStore=function(e,t){var a=(function(e){var t=(function(e){var t=u.createPaymentPageState(e).paymentFormSpec;return{countryToCurrencyMap:e.countryToCurrencyMap,submitSuccess:!1,submitState:null,submitting:!1,submitSeq:0,paypalEmail:"",requestId:e.requestId,paymentFormSpec:t}})(e),a=(function(e){var t=u.createPaymentPricingState(e),a=t.countryCode,n=t.countryCodeLoading,o=t.hasCurrencyChanged,i=t.hasTaxChangedWithinCountry,l=t.loadingPrices,r=t.requestToken,s=t.recentLoadEvent;return{countryCode:a,countryCodeLoading:n,hasCurrencyChanged:o,hasTaxChangedWithinCountry:i,loadingPrices:l,requestToken:r,recentLoadEvent:s}})(e);return{pricingState:a,pageState:t,formData:y(e,t,a)}})(e),l=n.applyMiddleware(o.default,c.submitFormErrorMiddleware,h,new d.PaymentsUXLogger(e.requestId).reduxMiddleware);return i.createStore(t,a,l)},t.createFormData=y})),define("modules/clean/subscription/tools/amp_logger",["require","exports","apex-metrics/index","modules/clean/metrics/index"],(function(e,t,a,n){"use strict";var o,i;Object.defineProperty(t,"__esModule",{value:!0}),t.findInitLoggingErrorSeverity=t.logTabError=t.getSubscriptionAMPLogger=t.SubscriptionAMPLogger=t.ModalTypes=void 0,(function(e){e.PERSONAL="personal_plan_management",e.TEAM="team_plan_management"})(o||(o={})),(function(e){e.SUCCESS="modal_success",e.ERROR="modal_error",e.TTI="modal_tti"})(i||(i={})),(function(e){e.CHANGE_LICENSES_MODAL="change_licenses_modal",e.CHANGE_PLAN_MODAL="change_plan_modal",e.CHANGE_PLAN_DUAL_MODAL="change_plan_dual_modal",e.CHANGE_SCHEDULE_MODAL="change_schedule_modal",e.CANCEL_CHANGES_MODAL="cancel_changes_modal",e.CANCEL_SURVEY_MODAL="cancel_survey_modal",e.CANCEL_SUBS_WARNING_MODAL="cancel_subs_warning_modal",e.UPDATE_BILLING_MODAL="update_billing_modal",e.EDIT_INVOICE_MODAL="edit_invoice_modal"})(t.ModalTypes||(t.ModalTypes={}));var l=(function(){function e(e){this.namespace="team"===e.ns?o.TEAM:o.PERSONAL,this.modal=e.modal,this.productPlanType=e.productPlanType||"unknown"}return e.prototype.logModalTTI=function(e){n.getMetricsReporter().createStats({ns:this.namespace,name:i.TTI},{modal:this.modal,productType:this.productPlanType}).recordDuration(e,a.TimeUnit.MILLISECONDS)},e.prototype.logModalSuccess=function(){this.logModalEvent(i.SUCCESS)},e.prototype.logModalError=function(e,t){this.logModalEvent(i.ERROR,{errorType:e,errorSeverity:t})},e.prototype.setProductPlanType=function(e){e&&(this.productPlanType=e)},e.prototype.logModalEvent=function(e,t){void 0===t&&(t={});var a={modal:this.modal,productType:this.productPlanType};t.errorType&&(a.errorType=t.errorType,a.errorSeverity=t.errorSeverity||"critical"),n.getMetricsReporter().createStats({ns:this.namespace,name:e},a).record(1)},e})();t.SubscriptionAMPLogger=l,t.getSubscriptionAMPLogger=function(e){return new l(e)},t.logTabError=function(e,t,a){void 0===a&&(a="unknown");var i={tab:e,productType:a,errorType:t};n.getMetricsReporter().createStats({ns:o.PERSONAL,name:"account_tab_error"},i).record(1)},t.findInitLoggingErrorSeverity=function(e){return e&&e.responseText&&e.responseText.indexOf("err:")>-1?"noncritical":e&&e.status&&"success"===(e=e).status?"noncritical":"critical"}})),define("modules/clean/teams/admin/lib/billing_history",["require","exports","modules/clean/teams/admin/types/billing_history"],(function(e,t,a){"use strict";function n(e){var t=e.description;return!!t&&(-1!==t.indexOf("Google")||-1!==t.indexOf("Apple")&&-1===t.indexOf("ApplePay"))}Object.defineProperty(t,"__esModule",{value:!0}),t.getHistoryData=t.SelectedYearTypes=void 0,t.SelectedYearTypes={ALL_TIME:"all-time",YEAR_TO_DATE:"year-to-date"},t.getHistoryData=function(e,o){void 0===o&&(o=t.SelectedYearTypes.ALL_TIME);var i=(function(e){for(var t,o=[],i=0;i<e.length;i++){var l=e[i];if(i<e.length-1){var r=e[i+1],s=n(r)||n(l);if(l.type===a.BillingRowType.Payment&&r.type===a.BillingRowType.Invoice&&(r.billed===l.paid||r.billed==="("+l.paid+")"||s)&&r.date===l.date){var d={id:i,invoice:r,payment:l,isMobile:s};o.push(d),i++;continue}}l.type===a.BillingRowType.Payment?o.push({id:i,payment:l,isMobile:n(l)}):o.push({id:i,invoice:l,isMobile:(t=l,!!t.billed&&t.billed.indexOf("GPD")>-1)})}return o})(e),l=(new Date).getFullYear().toString();return o===t.SelectedYearTypes.ALL_TIME||(i=o===t.SelectedYearTypes.YEAR_TO_DATE?i.filter((function(e){return e.payment?-1!==e.payment.date.indexOf(l):!!e.invoice&&-1!==e.invoice.date.indexOf(l)})):i.filter((function(e){return e.payment?-1!==e.payment.date.indexOf(o):!!e.invoice&&-1!==e.invoice.date.indexOf(o)}))),i=i.filter((function(e){return e.invoice&&null!==e.invoice.description||e.payment&&null!==e.payment.description}))}})),define("modules/clean/teams/admin/types/billing_history",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BillingRowType=void 0,(function(e){e[e.Invoice=0]="Invoice",e[e.Payment=1]="Payment",e[e.Legacy=2]="Legacy"})(t.BillingRowType||(t.BillingRowType={}))})),define("modules/clean/teams/admin/widgets/admin_priced_list/admin_priced_list",["require","exports","tslib","react","modules/clean/react/components/css"],(function(e,t,a,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AdminPricedList=void 0;var i=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){return n.default.createElement("div",{className:"admin-priced-list"},n.default.createElement("div",null,this.props.children))},t.displayName="AdminPricedListView",t})((n=a.__importDefault(n)).default.Component);t.AdminPricedList=o.requireCssWithComponent(i,["/static/css/teams/admin/widgets/admin_priced_list/admin_priced_list-vfl4n4jXj.css"])})),define("modules/clean/teams/admin/widgets/admin_priced_list/admin_priced_list_item",["require","exports","tslib","react","classnames","modules/core/i18n","modules/clean/react/badge","modules/clean/account_page/widgets/plan/views/loading_view"],(function(e,t,a,n,o,i,l,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AdminPricedListItem=void 0,n=a.__importDefault(n),o=a.__importDefault(o);var s=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onChange=function(){},t}return a.__extends(t,e),t.prototype.renderTitleWarningText=function(){var e=this.props.titleWarningText;if(e)return n.default.createElement("span",{className:"admin-priced-list-item__content_title_warning"}," ",e)},t.prototype.renderTitleSecondaryText=function(){var e=this.props.titleSecondaryText;if(e)return n.default.createElement("span",{className:"admin-priced-list-item__content_title_secondary"}," ",e)},t.prototype.renderRecommendedSign=function(){var e=this.props,t=e.titleSecondaryText,a=e.titleWarningText,o=e.recommended;if(!t&&!a&&o)return n.default.createElement("div",{className:"admin-priced-list-item__content_title_recommended"},i.intl.formatMessage({id:"430h7a",defaultMessage:"RECOMMENDED"}))},t.prototype.renderEffectiveDate=function(){var e=this.props,t=e.price,a=e.priceString,o=e.effectiveDate;if(!t&&!a)return n.default.createElement("div",{className:"admin-priced-list-item__content_title_effective_date"},o)},t.prototype.getClickHandler=function(){if(!this.props.disableItem)return this.props.onClick},t.prototype.render=function(){var e,t,i,s=this.props,d=s.description,c=s.price,u=s.title,p=s.unit,m=s.detailsLink,_=s.disableItem,g=s.effectiveDate,f=s.loadingPrice,h=this.props.className?this.props.className:"";f||(this.props.priceString?(t=this.props.priceString,i=p):c?(t=c.toString(),i=p):(t=g?"":"-",i=""));var y=o.default(((e={"admin-priced-list-item":!0,active:!0===this.props.isSelected})[h]=!0,e.disabled=_,e));return n.default.createElement("div",{className:y,onClick:this.getClickHandler()},n.default.createElement("div",{className:"admin-priced-list-item__content"},n.default.createElement("div",{className:"admin-priced-list-item__content_title"},n.default.createElement("input",{type:"radio",checked:this.props.isSelected,onChange:this.onChange,disabled:this.props.disableItem}),n.default.createElement("h1",{className:"admin-priced-list-item__content_title_text"},u,this.props.badge&&n.default.createElement(l.Badge,a.__assign({},this.props.badge)),this.renderTitleWarningText(),this.renderTitleSecondaryText()),this.renderRecommendedSign(),this.renderEffectiveDate()),n.default.createElement("div",{className:"admin-priced-list-item__content_description u-font-meta"},d,m)),f?n.default.createElement(r.LoadingView,null):t&&n.default.createElement("div",{className:"admin-priced-list-item__pricing"},n.default.createElement("div",{className:"admin-priced-list-item__pricing_price"},t),n.default.createElement("div",{className:"admin-priced-list-item__pricing_unit"},i)))},t.displayName="AdminPricedListItem",t})(n.default.Component);t.AdminPricedListItem=s})),define("modules/clean/teams/admin/widgets/billing_history/billing_history_row",["require","exports","tslib","react","modules/core/i18n","modules/clean/react/payments/edit_invoice_address_modal/edit_invoice_address_modal_loader","modules/clean/analytics","modules/clean/react/tooltip","modules/clean/react/sprite","dig-components/buttons"],(function(e,t,a,n,o,i,l,r,s,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BillingHistoryTableRow=void 0;var c=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onEdit=function(){var e=t.props,a=e.row,n=e.isTeam;a.invoice&&i.EditInvoiceAddressModalLoader.showInstance(a.invoice,n)},t.logReceiptLinkClick=function(){t.props.logAccountBillingTabEvents&&l.ProEventsLogger.log("de_billing_tab_receipt_link_click")},t.logInvoiceLinkClick=function(){t.props.logAccountBillingTabEvents&&l.ProEventsLogger.log("de_billing_tab_invoice_link_click")},t}return a.__extends(t,e),t.prototype.renderDate=function(){var e=this.props.row,t=e.invoice,a=e.payment;return t&&t.date?t.date:a&&a.date?a.date:null},t.prototype.renderDescription=function(){var e=this.props.row,t=e.invoice,a=e.payment,i=e.isMobile,l=null,r=null;return t&&t.description?l=t.description:a&&a.description&&(l=a.description),i&&t&&t.description&&a&&a.description&&(l=a.description+" | "+t.description),(t&&t.isVoided||a&&a.isVoided)&&(r=n.default.createElement("span",null," (",o.intl.formatMessage({id:"Raqf73",defaultMessage:"Voided"}),")")),n.default.createElement("div",null,n.default.createElement("p",{className:"description-line"},n.default.createElement("span",null,l),r))},t.prototype.renderLinks=function(){var e=[];if(!0===this.props.renderPublicLinks)e=this.renderInvoiceAndReceiptLink(this.props.publicInvoiceLink,this.props.publicReceiptLink);else{var t=this.props,a=t.row,i=t.showEditInvoiceModal,l=t.canEditBilling,r=a.invoice,s=a.payment,c="",u="";r&&r.link&&(c=r.link),!a.isMobile&&s&&s.link&&(u=s.link),e=this.renderInvoiceAndReceiptLink(c,u),i&&r&&!r.isOpen&&r.isEditable&&l&&e.push(n.default.createElement(d.Button,{variant:"transparent",key:"edit-link",className:"button-as-link",onClick:this.onEdit},o.intl.formatMessage({id:"UwFkjc",defaultMessage:"Edit"}))),e.length||(r&&r.infoTooltip?e.push(this.renderInfoTooltip(r)):s&&s.infoTooltip&&e.push(this.renderInfoTooltip(s)))}return e.length?n.default.createElement("span",null,e):null},t.prototype.renderInvoiceAndReceiptLink=function(e,t){var a=[];return e&&a.push(n.default.createElement("a",{key:"invoice-link",className:"account-page__link",href:e,target:"_blank",rel:"noopener noreferrer",onClick:this.logInvoiceLinkClick},o.intl.formatMessage({id:"+fOIGM",defaultMessage:"Invoice"}))),t&&a.push(n.default.createElement("a",{key:"payment-link",className:"account-page__link",href:t,target:"_blank",rel:"noopener noreferrer",onClick:this.logReceiptLinkClick},o.intl.formatMessage({id:"9s47b8",defaultMessage:"Receipt"}))),a},t.prototype.renderInfoTooltip=function(e){return n.default.createElement(r.Tooltip,{position:r.TooltipPosition.TOP,tooltip_contents:e.infoTooltip},n.default.createElement(s.Sprite,{group:"teams",name:"info_active",alt:"",className:"info-sprite"}))},t.prototype.renderPrice=function(){var e=this.props.row,t=e.invoice,a=e.payment;if(e.isMobile)return null;var o=null;return t&&a?o=t.isVoided||a.isVoided?n.default.createElement("span",{className:"row-content__price--line-through"},t.billed):t.billed:a?o=a.paid:t&&(o=t.billed),o},t.prototype.render=function(){var e=this.props.row;return e.invoice||e.payment?n.default.createElement("tr",{className:"row-content","data-variant":!0},n.default.createElement("td",{className:"row-content__date"},this.renderDate()),n.default.createElement("td",{className:"row-content__description"},this.renderDescription()),n.default.createElement("td",{className:"row-content__links"},this.renderLinks()),n.default.createElement("td",{className:"row-content__price"},this.renderPrice())):null},t.defaultProps={canEditBilling:!0},t.displayName="BillingHistoryTableRowComponent",t})((n=a.__importDefault(n)).default.Component);t.BillingHistoryTableRow=c})),define("modules/clean/teams/admin/widgets/billing_history/billing_history_table",["require","exports","tslib","react","styled-components","modules/core/i18n","modules/clean/teams/admin/widgets/billing_history/billing_history_row","modules/clean/account_page/widgets/billing/billing_history/types","dig-components/menu","dig-components/buttons"],(function(e,t,a,n,o,i,l,r,s,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BillingHistoryTable=void 0,n=a.__importDefault(n);var c,u=(o=a.__importDefault(o)).default.div(c||(c=a.__makeTemplateObject(["\n  .billing-table-container {\n    border-radius: 0;\n    border: 1px solid var(--color__faint__border);\n    .billing-history-table {\n      width: 100%;\n      border-collapse: collapse;\n\n      .row-header {\n        background-color: var(--color__faint__background);\n        padding: var(--spacing__unit--2) 0;\n        color: var(--color__faint__text);\n        font-size: var(--type__body__standard--fontsize);\n        height: auto;\n        font-weight: normal;\n      }\n\n      .caret {\n        vertical-align: middle;\n      }\n\n      .date-header-cell {\n        font-weight: normal;\n        text-align: left;\n        color: var(--color__faint__text);\n      }\n\n      .date-row {\n        padding-left: var(--spacing__unit--2);\n        padding-right: var(--spacing__unit--3);\n        width: 80px;\n        font-weight: normal;\n        text-align: left;\n        font-size: var(--type__body__small--fontsize);\n        color: var(--color__faint__text);\n      }\n\n      .desc-row {\n        font-weight: normal;\n        text-align: left;\n        font-size: var(--type__body__small--fontsize);\n        color: var(--color__faint__text);\n      }\n\n      .price-row {\n        padding-left: var(--spacing__unit--3);\n        padding-right: var(--spacing__unit--2);\n        width: 100px;\n        font-weight: normal;\n        text-align: left;\n        font-size: var(--type__body__small--fontsize);\n        color: var(--color__faint__text);\n      }\n\n      .row-content {\n        height: 56px;\n        border-top: 1px solid var(--color__faint__border);\n        color: var(--color__standard__text);\n        &__links {\n          white-space: nowrap;\n          padding: var(--spacing__base_unit);\n          text-align: right;\n          a,\n          button {\n            &:not(:first-child) {\n              margin-left: var(--spacing__base_unit);\n            }\n            &:not(:first-child):before {\n              content: none;\n            }\n          }\n        }\n      }\n      .row-content__date {\n        padding-left: var(--spacing__unit--2);\n        padding-right: var(--spacing__unit--3);\n        width: 80px;\n        text-align: left;\n        color: var(--color__standard__text);\n      }\n\n      .row-content__description {\n        color: var(--color__standard__text);\n        .description-line {\n          margin: 0;\n        }\n      }\n      .row-content__price {\n        padding-left: var(--spacing__unit--3);\n        padding-right: var(--spacing__unit--2);\n        width: 100px;\n        text-align: left;\n        color: var(--color__standard__text);\n      }\n\n      .billing-history-row {\n        border-top: 1px solid var(--color__faint__border);\n      }\n\n      .billing-history-col {\n        text-align: center;\n        height: ver(--spacing__unit--5);\n      }\n\n      .account-page__link {\n        color: inherit;\n        padding-bottom: var(--spacing__unit--0_5);\n        border-bottom: 1px solid var(--color__standard__border);\n        font-weight: var(--type__body__standard--fontweight_strong);\n        &:hover {\n          border-bottom: 1px solid var(--color__standard__text);\n        }\n      }\n    }\n  }\n"],["\n  .billing-table-container {\n    border-radius: 0;\n    border: 1px solid var(--color__faint__border);\n    .billing-history-table {\n      width: 100%;\n      border-collapse: collapse;\n\n      .row-header {\n        background-color: var(--color__faint__background);\n        padding: var(--spacing__unit--2) 0;\n        color: var(--color__faint__text);\n        font-size: var(--type__body__standard--fontsize);\n        height: auto;\n        font-weight: normal;\n      }\n\n      .caret {\n        vertical-align: middle;\n      }\n\n      .date-header-cell {\n        font-weight: normal;\n        text-align: left;\n        color: var(--color__faint__text);\n      }\n\n      .date-row {\n        padding-left: var(--spacing__unit--2);\n        padding-right: var(--spacing__unit--3);\n        width: 80px;\n        font-weight: normal;\n        text-align: left;\n        font-size: var(--type__body__small--fontsize);\n        color: var(--color__faint__text);\n      }\n\n      .desc-row {\n        font-weight: normal;\n        text-align: left;\n        font-size: var(--type__body__small--fontsize);\n        color: var(--color__faint__text);\n      }\n\n      .price-row {\n        padding-left: var(--spacing__unit--3);\n        padding-right: var(--spacing__unit--2);\n        width: 100px;\n        font-weight: normal;\n        text-align: left;\n        font-size: var(--type__body__small--fontsize);\n        color: var(--color__faint__text);\n      }\n\n      .row-content {\n        height: 56px;\n        border-top: 1px solid var(--color__faint__border);\n        color: var(--color__standard__text);\n        &__links {\n          white-space: nowrap;\n          padding: var(--spacing__base_unit);\n          text-align: right;\n          a,\n          button {\n            &:not(:first-child) {\n              margin-left: var(--spacing__base_unit);\n            }\n            &:not(:first-child):before {\n              content: none;\n            }\n          }\n        }\n      }\n      .row-content__date {\n        padding-left: var(--spacing__unit--2);\n        padding-right: var(--spacing__unit--3);\n        width: 80px;\n        text-align: left;\n        color: var(--color__standard__text);\n      }\n\n      .row-content__description {\n        color: var(--color__standard__text);\n        .description-line {\n          margin: 0;\n        }\n      }\n      .row-content__price {\n        padding-left: var(--spacing__unit--3);\n        padding-right: var(--spacing__unit--2);\n        width: 100px;\n        text-align: left;\n        color: var(--color__standard__text);\n      }\n\n      .billing-history-row {\n        border-top: 1px solid var(--color__faint__border);\n      }\n\n      .billing-history-col {\n        text-align: center;\n        height: ver(--spacing__unit--5);\n      }\n\n      .account-page__link {\n        color: inherit;\n        padding-bottom: var(--spacing__unit--0_5);\n        border-bottom: 1px solid var(--color__standard__border);\n        font-weight: var(--type__body__standard--fontweight_strong);\n        &:hover {\n          border-bottom: 1px solid var(--color__standard__text);\n        }\n      }\n    }\n  }\n"]))),p=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.buildFooterIfNecessary=function(){if(null!==this.props.footer)return n.default.createElement("tfoot",{className:"row-footer"},this.props.footer)},t.prototype.buildHeaderDate=function(){var e=this;return n.default.createElement("th",{className:"row-header date-row"},n.default.createElement(s.Menu.Wrapper,{onSelection:this.props.onSelection},(function(t){var o=t.getContentProps,l=t.getTriggerProps;return n.default.createElement(n.default.Fragment,null,n.default.createElement(d.Button,a.__assign({className:"date-header-cell"},l(),{variant:"transparent",withDropdownIcon:!0,hasNoUnderline:!0}),i.intl.formatMessage({id:"65pLwc",defaultMessage:"Date"})),n.default.createElement(s.Menu.Content,a.__assign({},o()),n.default.createElement(s.Menu.Segment,{withLabel:i.intl.formatMessage({id:"HXV3TA",defaultMessage:"Order"})},n.default.createElement(s.Menu.SelectItem,{value:r.BillingHistoryOrder.ASCENDING,selected:r.BillingHistoryOrder.ASCENDING===e.props.order},i.intl.formatMessage({id:"KyJseU",defaultMessage:"Ascending"})),n.default.createElement(s.Menu.SelectItem,{value:r.BillingHistoryOrder.DESCENDING,selected:r.BillingHistoryOrder.DESCENDING===e.props.order},i.intl.formatMessage({id:"Njd630",defaultMessage:"Descending"}))),n.default.createElement(s.Menu.Segment,{withLabel:i.intl.formatMessage({id:"2X0e4z",defaultMessage:"Show"})},n.default.createElement(s.Menu.SelectItem,{value:"all_time",selected:"all_time"===e.props.filter},i.intl.formatMessage({id:"261J2J",defaultMessage:"All time"})),n.default.createElement(s.Menu.SelectItem,{value:"year_to_date",selected:"year_to_date"===e.props.filter},i.intl.formatMessage({id:"EqTfoU",defaultMessage:"Year-to-date"})),e.renderMenuItems())))})))},t.prototype.renderMenuItems=function(){var e=[],t=this.props,a=t.filters,o=t.filter;return a&&a.forEach((function(t){e.push(n.default.createElement(s.Menu.SelectItem,{key:t,value:t,selected:t===o},t))})),e},t.prototype.render=function(){var e,t=this.props,a=t.amountLabel,o=t.canEditBilling,r=t.displayNoTransactionsOnEmptyRecords,s=t.showEditInvoiceModal,d=t.logAccountBillingTabEvents,c=t.isTeam,p=t.renderPublicLinks,m=t.publicInvoiceLink,_=t.publicReceiptLink,g=this.props.billingHistoryRecords,f=a||i.intl.formatMessage({id:"PoJI4y",defaultMessage:"Price"});if(r&&0===g.length){var h=this.props.noTransactionLabel?this.props.noTransactionLabel:i.intl.formatMessage({id:"SNLY2j",defaultMessage:"No transactions"});e=n.default.createElement("tr",{className:"row-content"},n.default.createElement("td",{className:"row-content__date"}),n.default.createElement("td",{className:"row-content__description"},h),n.default.createElement("td",{className:"row-content__links"}),n.default.createElement("td",{className:"row-content__price"}))}return n.default.createElement(u,null,n.default.createElement("div",{className:"billing-table-container"},n.default.createElement("table",{className:"billing-history-table",cellSpacing:"0"},n.default.createElement("thead",null,n.default.createElement("tr",null,this.buildHeaderDate(),n.default.createElement("th",{className:"row-header desc-row u-font-meta",colSpan:2},i.intl.formatMessage({id:"VfjryA",defaultMessage:"Description"})),n.default.createElement("th",{className:"row-header price-row u-font-meta"},f))),this.buildFooterIfNecessary(),n.default.createElement("tbody",null,e,g.map((function(e,t){return n.default.createElement(l.BillingHistoryTableRow,{canEditBilling:o,isTeam:c,key:e.id,logAccountBillingTabEvents:d,renderPublicLinks:p,publicInvoiceLink:m,publicReceiptLink:_,row:e,showEditInvoiceModal:s})}))))))},t.defaultProps={onSelection:function(){}},t.displayName="BillingHistoryTableComponent",t})(n.default.Component);t.BillingHistoryTable=p})),define("modules/clean/teams/admin/widgets/billing_notifications/cancellable_item",["require","exports","tslib","react","modules/core/i18n","classnames","dig-components/buttons"],(function(e,t,a,n,o,i,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CancellableItemView=void 0,n=a.__importDefault(n),i=a.__importDefault(i);var r=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){var e,t,a=this.props,o=a.title,r=a.description,s=a.handleAction,d=a.useCTA,c=a.CTAText,u=this.props.className?this.props.className:"",p=i.default("cancellable-item__title",{"cancellable-item__title--alternate":this.props.useAlternateStyle}),m=i.default(((e={"cancellable-item__button":!0,"link-button":!0,"link-button--alternate":this.props.useAlternateStyle})[u]=!0,e));return d&&(t=n.default.createElement(l.Button,{variant:"transparent",className:m,onClick:s},c)),n.default.createElement("div",{className:"cancellable-item"},n.default.createElement("span",{className:p},o)," ",n.default.createElement("span",{className:"cancellable-item__desc"},r),t)},t.defaultProps={CTAText:o.intl.formatMessage({id:"7kgsyk",defaultMessage:"Cancel change"}),useCTA:!1},t.displayName="CancellableItemView",t})(n.default.Component);t.CancellableItemView=r})),define("modules/clean/react/growth/trials/requests",["require","exports","tslib","modules/clean/deprecated_ajax/ajax_jquery","modules/core/i18n","modules/clean/react/growth/logging_util","modules/clean/react/growth/trials/util","modules/core/notify","modules/clean/react/growth/trials/types","modules/clean/react/snackbar","api_v2/user_client"],(function(e,t,a,n,o,i,l,r,s,d,c){"use strict";function u(e,t,n,o,l,r,s,d,u){return a.__awaiter(this,void 0,void 0,(function(){var _,g,f,h;return a.__generator(this,(function(a){switch(a.label){case 0:return a.trys.push([0,5,,6]),_=new c.UserApiV2Client,g=null,n!==i.RequestType.START_TRIAL?[3,2]:[4,_.ns("trials").rpc("start",o,{subjectUserId:l})];case 1:return g=a.sent(),[3,4];case 2:return n!==i.RequestType.CANCEL_TRIAL?[3,4]:[4,_.ns("trials").rpc("cancel",o,{subjectUserId:l})];case 3:g=a.sent(),a.label=4;case 4:return g&&"ok"===g.status?m(e,t,n,r):p(e,t,n,void 0,d,u),[3,6];case 5:return f=a.sent(),h=s?s(f):void 0,p(e,t,n,h,d,u),[3,6];case 6:return[2]}}))}))}function p(e,t,a,n,l,s){var c=n||o.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."});i.logAjaxError(e,t,a,{errorMessage:c}),r.Notify.error(c),s&&d.Snackbar.close(s),l&&l()}function m(e,t,a,n,o){i.logAjaxSuccess(e,t,a),n&&(o?n(o):n())}function _(e,t,a,n,l,r){var s="cancel-trial-notification";d.Snackbar.sync(o.intl.formatMessage({id:"jXr05+",defaultMessage:"Canceling trial..."}),!1,s);return u(e,t,i.RequestType.CANCEL_TRIAL,{trial_sku_code:a,trial_project_type:e},n,(function(){d.Snackbar.complete(o.intl.formatMessage({id:"RBkBP9",defaultMessage:"You’ve successfully canceled your trial."}),s),l&&l()}),(function(e){if(e.error&&"not_in_trial"===e.error[".tag"])return o.intl.formatMessage({id:"Ui1I/f",defaultMessage:"You’ve already canceled your trial."})}),r,s)}function g(e,t,a,l){var r="cancel-trial-notification";d.Snackbar.sync(o.intl.formatMessage({id:"jXr05+",defaultMessage:"Canceling trial..."}),!1,r);var s=i.RequestType.CANCEL_TRIAL,c=function(){d.Snackbar.complete(o.intl.formatMessage({id:"RBkBP9",defaultMessage:"You’ve successfully canceled your trial."}),r),a&&a()};n.WebRequest({url:"/downgrade/process",data:{trial_project_type:e},success:function(){return m(e,t,s,c)},error:function(a,n,o){return p(e,t,s,o,l,r)}})}Object.defineProperty(t,"__esModule",{value:!0}),t.enableAutoConvert=t.getPriceConversionsForSchedule=t.transitionPlan=t.cancelTransitionTrial=t.cancelPlatformTrial=t.cancelTrial=t.startTrial=void 0,n=a.__importStar(n),t.startTrial=function(e,t,a,n,o,l,r){return u(e,t,i.RequestType.START_TRIAL,{trial_sku_code:a,trial_duration:n,trial_project_type:e},o,l,void 0,r)},t.cancelTrial=function(e,t,a,n,o,i,l){return n===s.TrialSource.TRANSITIONS_TRIAL?g(e,t,i,l):n===s.TrialSource.PLATFORM_TRIAL?_(e,t,a,o,i,l):null},t.cancelPlatformTrial=_,t.cancelTransitionTrial=g,t.transitionPlan=function(e,t,a,o,r,s){var d=i.RequestType.TRANSITION_PLAN,c=l.getTransitionChangeType(e);c?n.WebRequest({type:"POST",url:"/account/perform_personal_transition",data:{transition_change_type:c},subject_user:t,success:function(){return m(a,o,d,r)},error:function(e,t,n){return p(a,o,d,n,s)}}):p(a,o,d)},t.getPriceConversionsForSchedule=function(e,t,n,o,l,r){return a.__awaiter(this,void 0,void 0,(function(){var s,d;return a.__generator(this,(function(a){switch(a.label){case 0:s=i.RequestType.GET_PRICE_CONVERSIONS_FOR_SCHEDULE,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,(new c.UserApiV2Client).ns("trials").rpc("get_price_conversions_for_schedule",o,{subjectUserId:e})];case 2:return(d=a.sent())?m(t,n,s,l,d):p(t,n,s,void 0,r),[3,4];case 3:return a.sent(),p(t,n,s,void 0,r),[3,4];case 4:return[2]}}))}))},t.enableAutoConvert=function(e,t,n,o,l,r){return a.__awaiter(this,void 0,void 0,(function(){var s,d;return a.__generator(this,(function(a){switch(a.label){case 0:s=i.RequestType.ENABLE_AUTO_CONVERT,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,(new c.UserApiV2Client).ns("trials").rpc("enable_auto_convert",o,{subjectUserId:e})];case 2:return(d=a.sent())&&"ok"===d.status?m(t,n,s,l,d):p(t,n,s,void 0,r),[3,4];case 3:return a.sent(),p(t,n,s,void 0,r),[3,4];case 4:return[2]}}))}))}})),define("modules/clean/react/payments/unified_module/unified_actions/unified_submit_action",["require","exports","tslib","modules/clean/payments/payment_form/payment_form_spec","modules/clean/react/payments/common/form/actions/actions","modules/clean/react/payments/unified_module/unified_data_export"],(function(e,t,a,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.submitUnifiedForm=void 0,n=a.__importStar(n),t.submitUnifiedForm=function(e,t,a,l){return void 0===l&&(l={}),function(r,s){var d,c=s(),u=c.formData.countryCode.formattedValue,p=c.pageState.paymentFormSpec,m=c.formData.paymentMethod.formattedValue,_=i.getPaymentFieldNamesToSubmit(u,p,m);l.payment_method=c.formData.paymentMethod.formattedValue,l.request_id=c.pageState.requestId,l.submit_seq=c.pageState.submitSeq,d=c.pageState.paymentFormSpec.isTeam()?m===n.PaymentMethod.CreditCard?"/team/payments/ajax_update_billing_credit_card":m===n.PaymentMethod.DirectDeposit?"/team/payments/ajax_update_billing_direct_debit":"/team/payments/ajax_update_billing_paypal":m===n.PaymentMethod.CreditCard?"/update_credit_card_billing_info_ajax":m===n.PaymentMethod.DirectDeposit?"/update_direct_debit_billing_info_ajax":m===n.PaymentMethod.Ideal?"/update_ideal_billing_info_ajax":"/paypal_billing_info",r(o.submitForm(d,_,e,l,void 0,t,a))}}})),define("modules/clean/react/payments/unified_module/unified_actions/unified_store",["require","exports","tslib","redux","modules/clean/react/payments/common/form/actions/actions","modules/clean/react/payments/update_team_billing/update_team_actions","modules/clean/react/payments/buy/actions/page_actions","modules/clean/react/payments/unified_module/unified_actions/unified_submit_action","modules/clean/react/payments/checkout/components/payment_method_form/apple_pay"],(function(e,t,a,n,o,i,l,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bindUnifiedBillingActions=void 0,n=a.__importStar(n),o=a.__importStar(o),i=a.__importStar(i),l=a.__importStar(l),r=a.__importStar(r),t.bindUnifiedBillingActions=function(e){return n.bindActionCreators({applePayAction:s.applePayAction,updateHistory:l.updateHistory,showFormFieldErrors:o.showFormFieldErrors,submitBillingForm:r.submitUnifiedForm,updatePaymentMethod:o.updatePaymentMethod,updateCountryCode:i.updateBillingCountryCode,updateZipCode:o.updateZipCode,updateVat:o.updateVat,updateCpf:o.updateCpf,updateCpfName:o.updateCpfName,updateNonce:o.updateNonce,updatePayPalNonce:o.updatePayPalNonce,updateAdyenEncryptedCard:o.updateAdyenEncryptedCard,updateEncryptedCardForNetworkToken:o.updateEncryptedCardForNetworkToken,updateApplePayToken:o.updateApplePayToken,updateBrowserInfo:o.updateBrowserInfo,updateThreeDsData:o.updateThreeDsData,triggerThreeDsChallenge:o.triggerThreeDsChallenge,triggerThreeDsFingerprint:o.triggerThreeDsFingerprint,updateBIN:o.updateBIN,updateAccountHolderName:o.updateAccountHolderName,updateIBAN:o.updateIBAN,updateMandateSigned:o.updateMandateSigned,updateIdealBank:o.updateIdealBank,blurCCField:o.blurCCField,blurZipCode:o.blurZipCode,blurVat:o.blurVat,blurCpf:o.blurCpf,blurAccountHolderName:o.blurAccountHolderName,blurIBAN:o.blurIBAN},e.dispatch)}})),define("modules/clean/react/payments/unified_module/unified_fields/unified_cpf_field",["require","exports","tslib","react","modules/clean/react/payments/unified_module/unified_fields/unified_fields_base/unified_text_input_field","modules/clean/react/payments/common/form_value_helpers","modules/core/i18n"],(function(e,t,a,n,o,i,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnifiedCPFField=void 0;var r=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onCpfChange=function(e){t.props.actions.updateCpf(e.value)},t.onCpfNameChange=function(e){t.props.actions.updateCpfName(e.value)},t}return a.__extends(t,e),t.prototype.cpfErrorString=function(){var e=this.props.formData.cpf;return!i.FormValueHelper.isValid(e)&&e.showError?l.intl.formatMessage({id:"MQDRWx",defaultMessage:"Please enter a valid CPF number."}):""},t.prototype.render=function(){var e=this.props,t=e.paymentSpec,a=e.formData,i=null;return t.should_require_cpf(a.countryCode.formattedValue,a.paymentMethod.formattedValue)&&(i=n.default.createElement("div",{className:"grid__item"},n.default.createElement(o.UnifiedTextInputField,{autoSetupForm:a.cpf,name:"cpf",labelText:l.intl.formatMessage({id:"Z1BdZ2",defaultMessage:"CPF/CNPJ"}),errorText:this.cpfErrorString(),onChange:this.onCpfChange}),n.default.createElement(o.UnifiedTextInputField,{labelDivClassName:"billing-cpf grid__item",name:"cpf_name",labelText:l.intl.formatMessage({id:"cJojIg",defaultMessage:"Name"}),value:a.cpfName.rawValue,onChange:this.onCpfNameChange}))),i},t.displayName="UnifiedCPFField",t})((n=a.__importDefault(n)).default.Component);t.UnifiedCPFField=r})),define("modules/clean/react/payments/unified_module/unified_fields/unified_vat_field",["require","exports","tslib","classnames","react","modules/clean/react/payments/unified_module/unified_fields/unified_fields_base/unified_text_input_field","modules/clean/react/payments/common/form_value_helpers","modules/core/i18n","modules/clean/payments/validation"],(function(e,t,a,n,o,i,l,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnifiedVatField=void 0,n=a.__importDefault(n);var d=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.onVatChange=function(e){this.props.actions.updateVat(e.value)},t.prototype.vatErrorString=function(){var e=this.props.formData.vat;return!l.FormValueHelper.isValid(e)&&e.showError?r.intl.formatMessage({id:"iRjYtd",defaultMessage:"Please enter a valid VAT number (ex: {examples})."},{examples:s.getVatExamples(this.props.formData.countryCode.formattedValue).join(", ")}):""},t.prototype.render=function(){var e=this.props,t=e.paymentSpec,a=e.formData,l=null;if(t.should_show_vat_for_country(a.countryCode.formattedValue)){var d=s.getVatPrefix(a.countryCode.formattedValue),c=n.default({"billing-vat":!0,grid__item:!0});l=o.default.createElement(i.UnifiedTextInputField,{labelDivClassName:c,autoSetupForm:a.vat,name:"vat",labelText:r.intl.formatMessage({id:"eZAuK1",defaultMessage:"VAT number (optional)"}),errorText:this.vatErrorString(),placeholder:d,onChange:this.onVatChange.bind(this)})}return l},t.displayName="UnifiedVatField",t})((o=a.__importDefault(o)).default.Component);t.UnifiedVatField=d})),define("modules/clean/react/payments/unified_module/unified_fields/unified_fields_base/unified_generic_input",["require","exports","tslib","classnames","dompurify","react"],(function(e,t,a,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnifiedGenericInput=void 0,n=a.__importDefault(n),o=a.__importStar(o);var l=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){var e=n.default({"input__label--errormodal":Boolean(this.props.errorText)},this.props.className,"label-input","input__label"),t=i.default.createElement("label",{className:"label "+(this.props.labelClass?this.props.labelClass:""),htmlFor:this.props.htmlFor},this.props.labelText),a=null;this.props.labelAfterElement&&(a=t,t=null);var l=null;l=this.props.rightLabelElement?i.default.createElement("div",{className:"grid__item grid--x-bookend"},t,i.default.createElement("div",null,this.props.rightLabelElement)):t;var r=null;this.props.errorText?r=this.props.errorText:this.props.errorHTML&&(r=i.default.createElement("span",{dangerouslySetInnerHTML:{__html:o.sanitize(this.props.errorHTML)}}));var s=i.default.createElement("label",{className:"error-message",htmlFor:this.props.htmlFor},r);return i.default.createElement("div",{className:e},l,this.props.children,a,s)},t.displayName="UnifiedGenericInput",t})((i=a.__importDefault(i)).default.Component);t.UnifiedGenericInput=l})),define("modules/clean/react/payments/unified_module/unified_fields/unified_fields_base/unified_select_input_field",["require","exports","tslib","react","react-dom","modules/clean/react/payments/unified_module/unified_fields/unified_fields_base/unified_generic_input"],(function(e,t,a,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnifiedLabeledSelectInput=void 0,n=a.__importDefault(n),o=a.__importStar(o);var l=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.onChange=function(e){this.props.onChange&&this.props.onChange(o.findDOMNode(this.input))},t.prototype.onClick=function(e){this.props.onClick&&this.props.onClick(o.findDOMNode(this.input))},t.prototype.componentDidMount=function(){if(this.props.onChange){var e=o.findDOMNode(this.input),t=e.value;t&&t!==this.props.value&&this.props.onChange(e)}},t.prototype.render=function(){var e=this,t=this.props,a=t.name,o=t.className,l=t.labelClass,r=t.labelText,s=t.rightLabelElement,d=t.errorText,c=t.errorHTML,u=t.autoComplete;return n.default.createElement(i.UnifiedGenericInput,{className:o,errorHTML:c,errorText:d,labelClass:l,htmlFor:a,labelText:r,rightLabelElement:s},n.default.createElement("select",{autoComplete:u,className:"option-selector",id:a,name:a,onChange:this.onChange.bind(this),onClick:this.onClick.bind(this),value:this.props.value,ref:function(t){e.input=t}},this.props.children))},t.displayName="UnifiedLabeledSelectInput",t})(n.default.Component);t.UnifiedLabeledSelectInput=l})),define("modules/clean/react/payments/unified_module/unified_fields/unified_fields_base/unified_text_input_field",["require","exports","tslib","classnames","react","react-dom","modules/clean/react/payments/common/form_value_helpers","modules/clean/react/payments/unified_module/unified_fields/unified_fields_base/unified_generic_input"],(function(e,t,a,n,o,i,l,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnifiedTextInputField=void 0,n=a.__importDefault(n),o=a.__importDefault(o),i=a.__importStar(i);var s=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onBlur=function(e){t.props.onBlur&&t.props.onBlur(i.findDOMNode(t.refToInput))},t.onFocus=function(e){t.props.onFocus&&t.props.onFocus(i.findDOMNode(t.refToInput))},t.onChange=function(e){t.props.onChange&&t.props.onChange(i.findDOMNode(t.refToInput))},t}return a.__extends(t,e),t.prototype.componentDidMount=function(){if(this.props.onChange){var e=i.findDOMNode(this.refToInput),t=e.value;t&&t!==this.props.value&&this.props.onChange(e)}},t.prototype.render=function(){var e=this,t=this.props,a=t.labelDivClassName,i=t.disabled,s=t.errorText,d=t.errorHTML,c=t.labelClass,u=t.labelText,p=t.maxLength,m=t.name,_=t.placeholder,g=t.value,f=t.autoComplete,h=t.autoSetupForm,y=this.props.type||"text",b=null;if(h){var v=h.errorState&&h.showError;g=g||h.rawValue,d=d||h.serverError,d=v?d:void 0,s=v?s:void 0;var P="billing-"+m+"-input",M=""!==h.formattedValue&&l.FormValueHelper.isValid(h)?"billing-"+m+"-input--valid":"";b=n.default({baseInputClass:P,invalidClass:M});var S="billing-"+m;a=n.default(a,S,{grid__item:!0})}var E=n.default({input__text:!0,"input__text--errormodal":Boolean(s)||Boolean(d)},this.props.inputClassName,b);return o.default.createElement(r.UnifiedGenericInput,{className:a,errorHTML:d,errorText:s,htmlFor:m,labelClass:c,labelText:u},o.default.createElement("input",{autoComplete:f,className:E,type:y,name:m,id:m,ref:function(t){e.refToInput=t},value:null===g?"":g,disabled:i,onBlur:this.onBlur,onChange:this.onChange,onFocus:this.onFocus,maxLength:p,placeholder:_}))},t.displayName="UnifiedTextInputField",t})(o.default.Component);t.UnifiedTextInputField=s})),define("modules/clean/react/payments/unified_module/unified_address_form",["require","exports","tslib","react","modules/core/i18n","modules/clean/react/payments/common/form_value_helpers","modules/clean/react/payments/common/constants","modules/clean/react/payments/unified_module/unified_fields/unified_fields_base/unified_text_input_field","modules/clean/react/payments/unified_module/unified_fields/unified_fields_base/unified_select_input_field"],(function(e,t,a,n,o,i,l,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnifiedAddressForms=void 0;var d=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onCountryCodeChange=function(e){t.props.actions.updateCountryCode(e.value)},t.onZipCodeBlur=function(e){t.props.actions.blurZipCode(e.value)},t.onZipCodeChange=function(e){t.props.actions.updateZipCode(e.value)},t.zipCodeErrorString=function(){var e=t.props.formData.zipCode;return!i.FormValueHelper.isValid(e)&&e.showError?l.ZipCodeErrorMessage:""},t}return a.__extends(t,e),t.prototype.renderCountrySelector=function(e){var t=this,a="grid__item--2-3";!0===e&&(a="grid__item");var i=this.props.countryList.map((function(e){var a=e[0],o=e[1];return n.default.createElement("option",{key:"location-"+a,value:a,"aria-selected":a===t.props.formData.countryCode.formattedValue},o)}));return n.default.createElement(s.UnifiedLabeledSelectInput,{autoComplete:"country",className:a,labelText:o.intl.formatMessage({id:"1SPrvR",defaultMessage:"Country"}),name:"country_code",onChange:this.onCountryCodeChange,value:this.props.formData.countryCode.rawValue},i)},t.prototype.renderZipCodeInput=function(){var e=o.intl.formatMessage({id:"5kJrVX",defaultMessage:"Postal Code"}),t="US"===this.props.formData.countryCode.formattedValue?o.intl.formatMessage({id:"ciLB6A",defaultMessage:"Billing ZIP"}):e,a=!this.props.paymentSpec.allow_zip_code_for_country(this.props.formData.countryCode.formattedValue);return n.default.createElement(r.UnifiedTextInputField,{autoComplete:"postal-code",labelDivClassName:"billing-zip payment-info__zip grid__item grid__item--7-24",disabled:a,errorText:this.zipCodeErrorString(),errorHTML:this.props.formData.zipCode.serverError,labelText:t,name:"zip",onChange:this.onZipCodeChange,value:this.props.formData.zipCode.rawValue,onBlur:this.onZipCodeBlur})},t.prototype.render=function(){return n.default.createElement(n.default.Fragment,null,this.renderCountrySelector(!1),this.renderZipCodeInput())},t.displayName="UnifiedAddressForms",t})((n=a.__importDefault(n)).default.Component);t.UnifiedAddressForms=d})),define("modules/clean/react/payments/unified_module/unified_payment_form_async",["require","exports","tslib","react","modules/core/i18n","modules/clean/react/payments/unified_module/unified_payment_form","modules/clean/react/payments/unified_module/unified_actions/unified_store","modules/clean/react/payments/common/form/actions/actions","modules/clean/react/payments/update_team_billing/update_team_store_creator","modules/clean/react/payments/update_team_billing/reducers","modules/clean/payments/payment_form/payment_form_spec","modules/clean/deprecated_ajax/ajax_jquery","modules/core/notify","modules/clean/static_urls","modules/clean/react/payments/update_individual_billing/update_individual_store_creator","modules/clean/analytics"],(function(e,t,a,n,o,i,l,r,s,d,c,u,p,m,_,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnifiedPaymentFormAsync=void 0,n=a.__importDefault(n),u=a.__importStar(u);var f=(function(e){function t(t){var a=e.call(this,t)||this;return a.calledOnSuccess=!1,a.calledOnError=!1,a.loaded=!1,a.handleLoadSuccess=function(e){if(e.isError)a.setState({}),a.handleLoadFailure();else{var t={countryList:e.countryList,iframeUrl:e.iframeUrl,vat:e.vat,userInfo:e.userInfo,countryToCurrencyMap:e.countryToCurrencyMap,countryCode:e.countryCode,serializedPaymentFormSpec:e.serializedPaymentFormSpec,requestId:e.requestId,submitSeq:0};a.loaded=!0,a.iFrameUrl=e.iframeUrl,a.countryList=e.countryList,a.paymentExperiments=e.paymentExperiments,a.paymentOptionalSettings=e.paymentOptionalSettings,a.props.isTeam?a.store=s.createBillingStore(t,d.BillingReducer):a.store=_.createBillingStore(t,d.BillingReducer),a.setState(a.store.getState()),a.store.subscribe((function(){var e=a.store.getState();if(!e.pageState.submitSuccess)if(a.props.isSubmittingStatus){var t=a.props.isSubmittingStatus;a.setState((function(a){return t(e.pageState.submitting),e}))}else a.setState((function(t){return e}));e.pageState.submitSuccess&&!a.calledOnSuccess&&(a.props.onSuccess(),a.calledOnSuccess=!0),"error"===e.pageState.submitState&&a.props.onError&&!a.calledOnError&&(a.props.onError(),a.calledOnError=!0)}))}},a.handleLoadFailure=function(){p.Notify.error(o.intl.formatMessage({id:"gaNMlz",defaultMessage:"Failed to load payment form."}))},a.saveUnifiedPaymentMethodForm=function(e){a.unifiedPaymentForm=e},a.prepareForSubmission=function(){return g.UserActivityLogger.log("web","update_billing_modal_try_submit",{payment_method:c.PaymentMethod[a.state.formData.paymentMethod.rawValue],country_code:a.state.formData.countryCode.rawValue,zip_code:a.state.formData.zipCode.rawValue,isNptBillingModal:a.paymentExperiments.showNptBillingModal,project:a.paymentExperiments.trialProjectType}),a.unifiedPaymentForm.prepareForSubmission()},a.onAccept=function(e){void 0===e&&(e=r.SubmitFormTriggerType.ButtonClick),a.actions.submitBillingForm(a.prepareForSubmission,a.unifiedPaymentForm.getCreditCardFrame().handle3DsMessage,e,a.generateAdditionalInfo())},a.iFrameUrl="",a}return a.__extends(t,e),t.prototype.componentDidMount=function(){var e=this;this.props.preloadedViewModel?this.handleLoadSuccess(this.props.preloadedViewModel):u.WebRequest({url:"/account/unified_payment_view",data:{isTeam:this.props.isTeam},success:function(t){var a=JSON.parse(t);e.handleLoadSuccess(a)},error:function(){e.handleLoadFailure()}})},Object.defineProperty(t.prototype,"actions",{get:function(){return l.bindUnifiedBillingActions(this.store)},enumerable:!1,configurable:!0}),t.prototype.generateAdditionalInfo=function(){var e={};return this.paymentOptionalSettings.showRebillUpsell&&(e.showRebillUpsell=this.paymentOptionalSettings.showRebillUpsell),this.paymentOptionalSettings.isScheduledDowngradeToBasic,e},t.prototype.renderLoading=function(){return n.default.createElement("div",{className:"loading-spinner"},n.default.createElement("img",{src:m.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:o.intl.formatMessage({id:"jybGUg",defaultMessage:"Loading"})}))},t.prototype.render=function(){return this.loaded?n.default.createElement("div",{className:"payment-info-section"},n.default.createElement("div",{className:"payment-method-section grid__container"},n.default.createElement(i.UnifiedPaymentForm,{ref:this.saveUnifiedPaymentMethodForm,paymentSpec:this.state.pageState.paymentFormSpec,iframeUrl:this.iFrameUrl,countryList:this.countryList,formData:this.state.formData,actions:this.actions,submitForm:this.onAccept,payment_experiments:this.paymentExperiments,payment_optional_settings:this.paymentOptionalSettings}))):this.renderLoading()},t.displayName="UnifiedPaymentFormAsync",t})(n.default.Component);t.UnifiedPaymentFormAsync=f})),define("modules/clean/react/payments/unified_module/unified_payment_form",["require","exports","tslib","classnames","modules/clean/analytics","react","modules/core/i18n","modules/clean/react/payments/checkout/components/payment_method_form/credit_card_frame","modules/clean/react/payments/checkout/components/payment_method_form/direct_debit_form","modules/clean/payments/payment_form/payment_form_spec","modules/clean/react/payments/checkout/components/payment_method_form/payment_method_selector","modules/clean/react/payments/unified_module/unified_fields/unified_cpf_field","modules/clean/react/payments/unified_module/unified_fields/unified_vat_field","modules/clean/react/payments/unified_module/unified_address_form","modules/clean/react/payments/unified_module/unified_data_export","modules/clean/react/payments/buy/components/payments/ideal_form","dig-components/typography"],(function(e,t,a,n,o,i,l,r,s,d,c,u,p,m,_,g,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnifiedPaymentForm=void 0,n=a.__importDefault(n);var h=(function(e){function t(t){return e.call(this,t)||this}return a.__extends(t,e),t.prototype.getPaymentData=function(){return _.getDataIfValid(this.props.formData,this.props.paymentSpec,this.prepareForSubmission(),this.props.payment_experiments)},t.prototype.componentDidMount=function(){var e=this.props.formData.countryCode.formattedValue;o.TeamsWebActionsLogger.log("uj-billing-country",{country:e}),"BR"===e&&o.TeamsWebActionsLogger.log("uj-cpf-viewed-field"),this.props.actions.updateHistory()},t.prototype.prepareForSubmission=function(){return this.props.formData.paymentMethod.formattedValue===d.PaymentMethod.CreditCard?this.creditCardFrame.tokenize():Promise.resolve(!0)},t.prototype.getCreditCardFrame=function(){return this.creditCardFrame},t.prototype.renderLocationFields=function(){var e,t,a=this.props,n=a.paymentSpec,o=a.formData,r=null,s=l.intl.formatMessage({id:"8vkOAo",defaultMessage:"Please note: changing your billing location could impact your applicable tax rate."});return n.should_show_vat_for_country(o.countryCode.formattedValue)&&(s=l.intl.formatMessage({id:"RCr4JC",defaultMessage:"Please note: changing your billing location or VAT number could impact your applicable tax rate."})),this.props.payment_experiments.showNptBillingModal&&(s=l.intl.formatMessage({id:"C8NyKM",defaultMessage:"You won't be charged until you confirm your purchase on the next screen."})),this.props.paymentSpec.isTeam()||(r=i.default.createElement("div",{className:(null===(e=this.props.payment_optional_settings)||void 0===e?void 0:e.isScheduledDowngradeToBasic)?"disclaimer-message-full-width":"disclaimer-message"},s,(null===(t=this.props.payment_optional_settings)||void 0===t?void 0:t.isScheduledDowngradeToBasic)&&i.default.createElement("span",null," ",l.intl.formatMessage({id:"GweSkC",defaultMessage:"Updating your billing information will cancel your scheduled plan downgrade. If you still wish to downgrade, you will need to schedule it again."})))),i.default.createElement("div",{className:"location-info-fields grid__item grid--x-bookend"},i.default.createElement(m.UnifiedAddressForms,{paymentSpec:this.props.paymentSpec,formData:this.props.formData,actions:this.props.actions,countryList:this.props.countryList}),i.default.createElement(p.UnifiedVatField,{paymentSpec:this.props.paymentSpec,formData:this.props.formData,actions:this.props.actions,payment_experiments:this.props.payment_experiments}),i.default.createElement(u.UnifiedCPFField,{paymentSpec:this.props.paymentSpec,formData:this.props.formData,actions:this.props.actions,payment_experiments:this.props.payment_experiments}),i.default.createElement(f.Text,{size:"small",color:"faint",variant:"paragraph"},r))},t.prototype.render=function(){var e=this,t=this.props,a=t.paymentSpec,o=t.actions,l=t.formData,u=this.renderLocationFields(),p=u;l.paymentMethod.formattedValue===d.PaymentMethod.DirectDeposit?p=i.default.createElement(s.DirectDebitForm,{locationFields:u,formData:l,actions:o}):l.paymentMethod.formattedValue===d.PaymentMethod.Ideal&&(p=i.default.createElement(g.IdealForm,{locationFields:u,formData:l,actions:o,idealBanks:a.idealBanks()}));var m=n.default({grid__item:!0,"payment-form":!0,"payment-form--responsive":!0});return i.default.createElement("div",{className:m},i.default.createElement(c.PaymentMethodSelector,{isTeam:!1,paymentSpec:a,paymentMethod:l.paymentMethod.rawValue,updatePaymentMethod:this.props.actions.updatePaymentMethod,countryCode:l.countryCode.rawValue,zipCode:l.zipCode.rawValue}),i.default.createElement(r.CreditCardFrame,{getHeightFromIframe:!0,iframeUrl:this.props.iframeUrl,isResponsive:!0,hidden:l.paymentMethod.formattedValue!==d.PaymentMethod.CreditCard,actions:this.props.actions,ref:function(t){e.creditCardFrame=t},nonce:l.nonce,bin:l.bin,submitForm:this.props.submitForm}),p)},t.displayName="UnifiedPaymentForm",t})((i=a.__importDefault(i)).default.Component);t.UnifiedPaymentForm=h})),define("modules/clean/react/payments/unified_module/unified_data_export",["require","exports","tslib","modules/clean/payments/payment_form/payment_form_spec","modules/clean/react/payments/business/state/business_state","modules/clean/react/payments/common/form_value_helpers"],(function(e,t,a,n,o,i){"use strict";function l(e,t,a){var o=["countryCode"];return t.allow_zip_code_for_country(e)&&o.push("zipCode"),t.should_show_vat_for_country(e)&&o.push("vat"),t.should_require_cpf(e,a)&&(o.push("cpf"),o.push("cpfName")),a===n.PaymentMethod.CreditCard?(o.push("nonce"),o.push("adyenEncryptedCard"),o.push("encryptedCardForNetworkToken"),o.push("bin"),o.push("browserInfo"),o.push("threeDsData")):a===n.PaymentMethod.DirectDeposit?o.push("accountHolderName","iban","mandateSigned"):a===n.PaymentMethod.Ideal?o.push("idealBankId","idealBankName"):a===n.PaymentMethod.ApplePay&&o.push("applePayToken"),o}function r(e,t){return t[e]}Object.defineProperty(t,"__esModule",{value:!0}),t.getPaymentFieldNamesToSubmit=t.getDataIfValid=void 0,n=a.__importStar(n),t.getDataIfValid=function(e,t,a,n){var s=l(e.countryCode.formattedValue,t,e.paymentMethod.formattedValue);return(function(e,t){for(var a=0,n=e;a<n.length;a++){var o=r(n[a],t);if(!i.FormValueHelper.isValid(o))return!1}return!0})(s,e)?a.then((function(){return(function(e,t){for(var a={},n=0,i=e;n<i.length;n++){var l=i[n];a[o.fieldsToServerProps[l]]=r(l,t).formattedValue}return a})(s,e)})):Promise.resolve(null)},t.getPaymentFieldNamesToSubmit=l})),define("modules/clean/react/payments/checkout/components/inputs/radio_input",["require","exports","tslib","react","react-dom"],(function(e,t,a,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RadioInput=void 0,n=a.__importDefault(n),o=a.__importStar(o);var i=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.onChange=function(e){this.props.onChange&&this.props.onChange(o.findDOMNode(this.input))},t.prototype.componentDidMount=function(){if(this.props.onChange){var e=o.findDOMNode(this.input),t=e.checked;t&&t!==this.props.checked&&this.props.onChange(e)}},t.prototype.render=function(){var e=this,t=this.props,a=t.name,o=t.id,i=t.className,l=t.checked,r=t.value,s=t.disabled;return n.default.createElement("input",{type:"radio",className:i,name:a,id:o,value:r,checked:l,onChange:this.onChange.bind(this),disabled:s,ref:function(t){e.input=t}})},t.displayName="RadioInput",t})(n.default.Component);t.RadioInput=i})),define("modules/clean/react/payments/checkout/components/payment_method_form/payment_method_option",["require","exports","tslib","react","modules/core/i18n","classnames","modules/clean/payments/payment_form/payment_form_spec","modules/clean/react/payments/checkout/components/inputs/radio_input","modules/clean/react/payments/pro/components/inputs/inputs"],(function(e,t,a,n,o,i,l,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PaymentMethodOption=void 0,n=a.__importDefault(n),i=a.__importDefault(i);var d=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.onChange=function(e){this.props.onSelected(this.props.paymentMethod)},t.prototype.render=function(){var e,t=this.props,a=t.icons,d=t.labelText,c=t.paymentMethod,u=[],p=["payment-method-option","payment-info__option"];if(this.props.isTeam?(p.push("grid__item"),p.push("grid__item--medium--shrink"),p.push("grid--y-middle"),p.push("grid__container--p-micro")):this.props.numberOfPaymentMethods&&this.props.numberOfPaymentMethods>2?p.push("grid__item--medium--1-4"):p.push("grid__item--medium--1-2"),d&&(e="payment-method-label#debit",u.push(n.default.createElement("span",{key:e,className:"debit"},this.props.labelText))),a){if(c===l.PaymentMethod.CreditCard){var m=a.join(", ").replace("_","-"),_=o.intl.formatMessage({id:"IBCGt3",defaultMessage:"Credit card. We accept {payment_methods}"},{payment_methods:m});e="payment-method-label#creditcard",u.push(n.default.createElement("span",{key:e,className:"ax-visually-hidden"},_))}else c===l.PaymentMethod.PayPal&&(e="payment-method-label#paypal",u.push(n.default.createElement("span",{key:e,className:"ax-visually-hidden"},o.intl.formatMessage({id:"RxvBVG",defaultMessage:"Paypal"}))));for(var g=0,f=a;g<f.length;g++){var h=f[g];e="payment-method-icon#"+h,u.push(n.default.createElement("span",{key:e,className:h}))}}return this.props.isTeam?n.default.createElement("div",{className:i.default(p)},n.default.createElement(r.RadioInput,{name:"payment_method",id:"payment_method_"+c,value:c.toString(),checked:this.props.selected,onChange:this.onChange.bind(this)}),n.default.createElement("label",{htmlFor:"payment_method_"+c,className:"payment-method-label"},u)):n.default.createElement("div",{className:i.default(p)},n.default.createElement(s.LabeledRadioInput,{id:"payment_method_"+c,name:"payment_method",className:"payment-info__payment",value:c.toString(),checked:this.props.selected,onClick:this.onChange.bind(this)}),n.default.createElement("label",{htmlFor:"payment_method_"+c,className:"payment-info__method-label",onClick:this.onChange.bind(this)},u))},t.displayName="PaymentMethodOption",t})(n.default.Component);t.PaymentMethodOption=d})),define("modules/clean/react/payments/checkout/components/payment_method_form/payment_method_selector",["require","exports","tslib","react","modules/clean/payments/payment_form/payment_form_spec","modules/clean/react/payments/checkout/components/payment_method_form/payment_method_option","modules/core/i18n"],(function(e,t,a,n,o,i,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PaymentMethodSelector=void 0;var r=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onPaymentMethodSelected=function(e){t.props.updatePaymentMethod(e)},t}return a.__extends(t,e),t.prototype.getLabelForMethodId=function(e){return e===o.PaymentMethod.CreditCard?n.default.createElement(i.PaymentMethodOption,{key:"payment-method#"+e,paymentMethod:o.PaymentMethod.CreditCard,selected:this.props.paymentMethod===o.PaymentMethod.CreditCard,onSelected:this.onPaymentMethodSelected,icons:this.props.paymentSpec.supported_credit_cards_for_country(this.props.countryCode),isTeam:this.props.isTeam,numberOfPaymentMethods:this.props.paymentSpec.available_payment_methods_for_country(this.props.countryCode).length}):e===o.PaymentMethod.PayPal?n.default.createElement(i.PaymentMethodOption,{key:"payment-method#"+e,paymentMethod:o.PaymentMethod.PayPal,selected:this.props.paymentMethod===o.PaymentMethod.PayPal,onSelected:this.onPaymentMethodSelected,icons:["paypal"],isTeam:this.props.isTeam,numberOfPaymentMethods:this.props.paymentSpec.available_payment_methods_for_country(this.props.countryCode).length}):e===o.PaymentMethod.DirectDeposit?n.default.createElement(i.PaymentMethodOption,{key:"payment-method#"+e,isTeam:this.props.isTeam,labelText:l.intl.formatMessage({id:"H1vHwe",defaultMessage:"Direct Debit"}),numberOfPaymentMethods:this.props.paymentSpec.available_payment_methods_for_country(this.props.countryCode).length,onSelected:this.onPaymentMethodSelected,paymentMethod:o.PaymentMethod.DirectDeposit,selected:this.props.paymentMethod===o.PaymentMethod.DirectDeposit}):e===o.PaymentMethod.Ideal?n.default.createElement(i.PaymentMethodOption,{key:"payment-method#"+e,isTeam:this.props.isTeam,paymentMethod:o.PaymentMethod.Ideal,selected:this.props.paymentMethod===o.PaymentMethod.Ideal,onSelected:this.onPaymentMethodSelected,icons:["ideal"],numberOfPaymentMethods:this.props.paymentSpec.available_payment_methods_for_country(this.props.countryCode).length,labelText:l.intl.formatMessage({id:"DgNBM/",defaultMessage:"iDEAL"})}):null},t.prototype.render=function(){var e=this,t=this.props,a=t.countryCode,o=t.paymentSpec.available_payment_methods_for_country(a).map((function(t){return e.getLabelForMethodId(t)}));return n.default.createElement("div",{className:"payment-method-selector payment-info__selector grid__item"},o)},t.displayName="PaymentMethodSelector",t})((n=a.__importDefault(n)).default.Component);t.PaymentMethodSelector=r})),define("modules/clean/react/payments/update_team_billing/reducers",["require","exports","tslib","modules/clean/react/payments/common/form/reducers/reducers","modules/clean/react/payments/common/payments/reducers/reducers","modules/clean/react/payments/common/pricing/reducers/reducers"],(function(e,t,a,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BillingReducer=void 0,t.BillingReducer=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.reduce((function(e,t){return function(a,n){return t(e(a,n),n)}}))}.apply(void 0,a.__spreadArrays([function(e,t){return"SubmitFormSuccess"!==t.type?e:a.__assign(a.__assign({},e),{pageState:a.__assign(a.__assign({},e.pageState),{submitSuccess:!0})})},n.FormReducer],o.PaymentMethodReducers,i.TransitionManagementReducers))})),define("modules/clean/react/payments/update_team_billing/update_team_actions",["require","exports","tslib","modules/core/i18n","modules/core/notify","modules/clean/payments/payment_form/payment_form_spec","modules/clean/react/payments/common/form/actions/actions"],(function(e,t,a,n,o,i,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateBillingCountryCode=t.submitTeamBillingForm=void 0,i=a.__importStar(i),t.submitTeamBillingForm=function(e,t,a){return function(n,o){var r,s=o(),d=s.formData.countryCode.formattedValue,c=s.pageState.paymentFormSpec,u=["countryCode"];c.allow_zip_code_for_country(d)&&u.push("zipCode"),c.should_show_vat_for_country(d)&&u.push("vat"),c.should_require_cpf(d,s.formData.paymentMethod.formattedValue)&&u.push("cpf"),s.formData.paymentMethod.formattedValue===i.PaymentMethod.CreditCard?(u.push("nonce"),u.push("adyenEncryptedCard"),u.push("encryptedCardForNetworkToken"),u.push("bin"),u.push("browserInfo"),u.push("threeDsData"),r="/team/payments/ajax_update_billing_credit_card"):s.formData.paymentMethod.formattedValue===i.PaymentMethod.DirectDeposit?(u.push("accountHolderName","iban","mandateSigned"),r="/team/payments/ajax_update_billing_direct_debit"):r="/team/payments/ajax_update_billing_paypal",n(l.submitForm(r,u,e,{payment_method:s.formData.paymentMethod.formattedValue,request_id:s.pageState.requestId,submit_seq:s.pageState.submitSeq},void 0,t,a))}},t.updateBillingCountryCode=function(e){return function(t,a){var i=a(),r=i.pageState.countryToCurrencyMap;!(e in r)&&i.formData.countryCode.formattedValue in r?o.Notify.error(n.intl.formatMessage({id:"K81Lqx",defaultMessage:"You can’t change to a country with a different currency. For help, contact support."}),3):t(l.updateCountryCode(e))}}})),define("modules/clean/react/payments/update_team_billing/update_team_store_creator",["require","exports","tslib","redux","redux-thunk","modules/clean/react/payments/common/middleware/payments_ux_logger","modules/clean/redux/unsupported","modules/clean/analytics","modules/clean/dbmodal_stack","modules/clean/react/components/modal","modules/clean/react/payments/common/form/middleware/middleware","modules/clean/react/payments/common/payments/state/store_creator","modules/clean/react/payments/common/form_value_factory","modules/core/i18n","modules/core/notify","modules/clean/react/payments/update_individual_billing/update_individual_store_creator"],(function(e,t,a,n,o,i,l,r,s,d,c,u,p,m,_,g){"use strict";function f(e){return function(e){return function(t){if("SubmitFormSuccess"!==t.type)return e(t);var a=e(t);return _.Notify.success(m.intl.formatMessage({id:"w5p44x",defaultMessage:"We’ve successfully updated your team’s billing information."})),r.TeamsWebActionsLogger.log("update_billing_open_save_changes_success"),d.Modal.close(),s.DBModalStack.trigger(g.BILLING_INFO_UPDATED,null),a}}}function h(e,t,a){var n=e.vat,o=e.countryCode,i=e.userInfo,l=u.createPaymentFormData(e,t,a),r=l.paymentMethod,s=l.countryCode,d=l.zipCode,c=l.vat,m=l.cpf,_=l.nonce,g=l.payPalNonce,f=l.adyenEncryptedCard,h=l.encryptedCardForNetworkToken,y=l.applePayToken,b=l.bin,v=l.browserInfo,P=l.threeDsData,M=l.accountHolderName,S=l.iban,E=l.mandateSigned,C=l.termsAndService,T=l.idealBankId,A=l.idealBankName;return{city:l.city,phone:l.phone,name:l.name,address:l.address,paymentMethod:r,countryCode:s,zipCode:d,vat:n?p.FormValueFactory.createVat(n,o):c,cpf:m,cpfName:p.FormValueFactory.createCpfNamePrefill("","",i.displayName),nonce:_,payPalNonce:g,bin:b,browserInfo:v,threeDsData:P,adyenEncryptedCard:f,encryptedCardForNetworkToken:h,applePayToken:y,accountHolderName:M,iban:S,mandateSigned:E,termsAndService:C,idealBankId:T,idealBankName:A}}Object.defineProperty(t,"__esModule",{value:!0}),t.createFormData=t.createBillingStore=t.submitFormSuccessMiddleware=void 0,n=a.__importStar(n),o=a.__importDefault(o),t.submitFormSuccessMiddleware=f,t.createBillingStore=function(e,t){var a=(function(e){var t=(function(e){var t=u.createPaymentPageState(e).paymentFormSpec;return{countryToCurrencyMap:e.countryToCurrencyMap,submitState:null,submitSuccess:!1,submitting:!1,submitSeq:0,paypalEmail:"",requestId:e.requestId,paymentFormSpec:t}})(e),a=(function(e){var t=u.createPaymentPricingState(e),a=t.countryCode,n=t.countryCodeLoading,o=t.hasCurrencyChanged,i=t.hasTaxChangedWithinCountry,l=t.loadingPrices,r=t.recentLoadEvent,s=t.requestToken;return{countryCode:a,countryCodeLoading:n,hasCurrencyChanged:o,hasTaxChangedWithinCountry:i,loadingPrices:l,recentLoadEvent:r,requestToken:s}})(e);return{pricingState:a,pageState:t,formData:h(e,t,a)}})(e),r=n.applyMiddleware(o.default,c.submitFormErrorMiddleware,f,new i.PaymentsUXLogger(e.requestId).reduxMiddleware);return l.createStore(t,a,r)},t.createFormData=h}));
//# sourceMappingURL=pkg-account_subscription_core.min.js-vflDIGYWE.map